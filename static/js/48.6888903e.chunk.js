(this.webpackJsonp=this.webpackJsonp||[]).push([[48],{3903:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringBase",(function(){return b})),n.d(t,"KeyringBaseMock",(function(){return y}));var r=n(2),i=n.n(r),o=n(6),a=n.n(o),c=n(9),d=n.n(c),s=n(14),u=n.n(s),f=n(7),l=n.n(f);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var b=function(e){d()(n,e);var t=p(n);function n(e){var n;return(n=t.call(this,e.options)).vault=e,n}return n.prototype.addressFromBase=function(){var e=i()((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),a()(n)}(n(1585).VaultContext),y=function(e){d()(n,e);var t=p(n);function n(){return t.apply(this,arguments)}return a()(n)}(b)},3905:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringSoftwareBase",(function(){return x}));var r=n(4),i=n.n(r),o=n(3),a=n.n(o),c=n(2),d=n.n(c),s=n(6),u=n.n(s),f=n(9),l=n.n(f),p=n(14),b=n.n(p),y=n(7),h=n.n(y),v=n(19),m=n(23);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return b()(this,n)}}var x=function(e){l()(n,e);var t=T(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=d()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new m.OneKeyInternalError("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return v.default.engine.info("signTransaction",this.networkId,e),w(w({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=d()((function*(e,t){var n=this,r=t.password;if("undefined"===typeof r)throw new m.OneKeyInternalError("Software signing requires a password.");var o=yield this.getDbAccount(),a=Object.values(yield this.getSigners(r,[o.address])),c=i()(a,1)[0];return v.default.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return n.engine.providerManager.signMessage(n.networkId,e,c)})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},u()(n)}(n(3903).KeyringBase)},3912:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"VaultBaseChainOnly",(function(){return R})),n.d(t,"VaultBase",(function(){return H}));var r=n(202),i=n.n(r),o=n(3),a=n.n(o),c=n(60),d=n.n(c),s=n(2),u=n.n(s),f=n(6),l=n.n(f),p=n(9),b=n.n(p),y=n(14),h=n.n(y),v=n(7),m=n.n(v),g=n(21),w=n.n(g),T=n(167),x=n.n(T),I=n(11),A=n(19),E=n(24),P=n(68),k=n(23),O=n(182),N=n(947),D=n(52),S=n(1585);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var i=m()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}if(E.default.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var R=function(e){b()(n,e);var t=B(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.initProvider=function(){var e=u()((function*(){var e=(yield this.getNetwork()).impl;d()(N.IMPL_MAPPINGS[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=u()((function*(e){throw new k.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new k.NotImplemented},r.getEthersProvider=function(){var e=u()((function*(){throw new k.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=u()((function*(e){var t=this.createClientFromURL(e),n=performance.now(),r=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r.checkRpcBatchSupport=function(){var e=u()((function*(e){throw new k.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.getDisplayAddress=function(){var e=u()((function*(e){return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||!n)throw new k.InvalidAddress;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=u()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=u()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new k.InvalidTokenAddress;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateCanCreateNextAccount=function(){var e=u()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=u()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=u()((function*(e,t,n){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:C({},"string"===typeof n?{tokenAddress:n}:{})}})))}));return function(t,n,r){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=u()((function*(e){return 0}));return function(t){return e.apply(this,arguments)}}(),r.fetchBalanceDetails=function(){var e=u()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password;return Promise.resolve(void 0)}));return function(){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfoMap=function(){var e=u()((function*(){var e=yield this.getNetwork();return Object(O.getAccountNameInfoByImpl)(e.impl)}));return function(){return e.apply(this,arguments)}}(),r.canAutoCreateNextAccount=function(){var e=u()((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=u()((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(){var e=u()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=u()((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),r.checkIsUnlimitedAllowance=function(){var e=u()((function*(e){throw new k.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.checkIsApprovedForAll=function(){var e=u()((function*(e){throw new k.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.checkIsBatchTransfer=function(){var e=u()((function*(e){throw new k.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.getFeePricePerUnit=function(){var e=u()((function*(){throw new k.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.fetchRpcChainId=function(){var e=u()((function*(e){return null}));return function(t){return e.apply(this,arguments)}}(),r.getTxWaitingSeconds=function(){var e=u()((function*(){return[]}));return function(){return e.apply(this,arguments)}}(),r.getUserNFTAssets=function(){var e=u()((function*(e){e.serviceData;return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),l()(n)}(S.VaultContext),H=function(t){b()(r,t);var n=B(r);function r(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).uuid=x.a.v4().toString(),e}var o=r.prototype;return o.init=function(){var e=u()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),o.initKeyring=function(){var e=u()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var e=u()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),o.signAndSendTransaction=function(){var e=u()((function*(e,t,n){var r=yield this.signTransaction(e,t);return n?C(C({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(C(C({},r),{},{encodedTx:e.encodedTx}))}));return function(t,n,r){return e.apply(this,arguments)}}(),o.broadcastTransaction=function(){var e=u()((function*(e,t){A.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var n=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return A.default.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),C(C({},e),{},{txid:n,encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),o.buildEncodedTxFromBatchTransfer=function(){var e=u()((function*(e){throw new k.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.buildEncodedTxsFromSetApproveForAll=function(){var e=u()((function*(e,t){throw new k.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.activateAccount=function(){var e=u()((function*(){throw new k.NotImplemented}));return function(){return e.apply(this,arguments)}}(),o.activateToken=function(){var e=u()((function*(e,t){throw new k.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.getTokenAllowance=function(){var e=u()((function*(e,t){throw new k.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.batchTokensAllowance=function(){var e=u()((function*(e,t){throw new k.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.getOutputAccount=function(){var e=u()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:i()(e,"pub","")}}));return function(){return e.apply(this,arguments)}}(),o.getAccountBalance=function(){var e=u()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=yield this.getDbAccount(),o=i.address;return this.getBalances((t?[{address:o}]:[]).concat(e.map((function(e){return{address:o,tokenAddress:e}}))),n,r)}));return function(t){return e.apply(this,arguments)}}(),o.updatePendingTxs=function(){var e=u()((function*(e){throw new k.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.getAccountNonce=function(){var e=u()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),o.fixActionDirection=function(){var e=u()((function*(e){var t,n,r,i,o=e.action,a=e.accountAddress;(o.direction=D.IDecodedTxDirection.OTHER,o.type===D.IDecodedTxActionType.NATIVE_TRANSFER)&&(o.direction=yield this.buildTxActionDirection({from:(null==(t=o.nativeTransfer)?void 0:t.from)||"",to:(null==(n=o.nativeTransfer)?void 0:n.to)||"",address:a}));o.type===D.IDecodedTxActionType.TOKEN_TRANSFER&&(o.direction=yield this.buildTxActionDirection({from:(null==(r=o.tokenTransfer)?void 0:r.from)||"",to:(null==(i=o.tokenTransfer)?void 0:i.to)||"",address:a}));return o}));return function(t){return e.apply(this,arguments)}}(),o.fixDecodedTx=function(){var e=u()((function*(e){var t,n;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var r=null==(n=e.encodedTx)?void 0:n.nonce;e.nonce=d()(r)?e.nonce:new w.a(r).toNumber();for(var i=e.owner,o=0;o<e.actions.length;o+=1){var a=e.actions[o];yield this.fixActionDirection({action:a,accountAddress:i})}if(e.outputActions)for(var c=0;c<e.outputActions.length;c+=1){var s=e.outputActions[c];yield this.fixActionDirection({action:s,accountAddress:i})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.fixHistoryTx=function(){var e=u()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.buildHistoryTx=function(){var e=u()((function*(e){var t=e.historyTxToMerge,n=(e.encodedTx,e.decodedTx),r=e.signedTx,i=e.isSigner,o=e.isLocalCreated,a=(null==r?void 0:r.txid)||(null==n?void 0:n.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var c=yield this.getAccountAddress();n.txid=a||n.txid,n.owner=c,i&&(n.signer=c),null!=r&&r.txKey&&(n.extraInfo?n.extraInfo.txKey=r.txKey:n.extraInfo={txKey:r.txKey});var d=C(C({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(o)},t),{},{decodedTx:n});return d=yield this.fixHistoryTx(d),Promise.resolve(d)}));return function(t){return e.apply(this,arguments)}}(),o.checkIsScamHistoryTx=function(){var e=u()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),o.fetchOnChainHistory=function(){var e=u()((function*(e){throw new k.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.fixAddressCase=function(e){return Promise.resolve(e)},o.buildTxActionDirection=function(){var e=u()((function*(e){var t=e.from,n=e.to,r=e.address;return t=yield this.fixAddressCase(t||""),n=yield this.fixAddressCase(n),r=yield this.fixAddressCase(r),t===n&&t===r?D.IDecodedTxDirection.SELF:t&&t===r?D.IDecodedTxDirection.OUT:n&&n===r?D.IDecodedTxDirection.IN:D.IDecodedTxDirection.OTHER}));return function(t){return e.apply(this,arguments)}}(),o.getNextNonce=function(){var e=u()((function*(e,t){var n,r,i=null!=(n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce)?n:0,o=(yield this.engine.getHistory(e,t.id,void 0,!1),yield P.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),a=yield P.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),c=Math.max(d()(o)?0:o+1,i);if(Number.isNaN(c)&&(c=i),c>i)for(var s=i;s<c;s+=1)if(!a.includes(s)){c=s;break}if(c<i&&(c=i),c-i>=I.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new k.PendingQueueTooLong(I.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return c}));return function(t,n){return e.apply(this,arguments)}}(),o.validateSendAmount=function(e,t,n){return Promise.resolve(!0)},o.notifyChainChanged=function(e,t){},o.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},o.getPrivateKeyByCredential=function(t){return Promise.resolve(e.from(t.startsWith("0x")?t.slice(2):t,"hex"))},o.getMinDepositAmount=function(){var e=u()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),o.specialCheckEncodedTx=function(){var e=u()((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),o.getAllUsedAddress=function(){var e=u()((function*(){return Promise.resolve([])}));return function(){return e.apply(this,arguments)}}(),l()(r)}(R)}.call(this,n(26).Buffer)},3913:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"KeyringHardwareBase",(function(){return h}));var r=n(2),i=n.n(r),o=n(6),a=n.n(o),c=n(9),d=n.n(c),s=n(14),u=n.n(s),f=n(7),l=n.n(f),p=n(431),b=n(163);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var h=function(t){d()(r,t);var n=y(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.getHardwareInfo=function(){var e=i()((function*(){var e,t,n,r=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==r?void 0:r.mac)?e:"",deviceId:null!=(t=null==r?void 0:r.deviceId)?t:"",deviceType:null!=(n=null==r?void 0:r.deviceType)?n:""}}));return function(){return e.apply(this,arguments)}}(),o.getWalletPassphraseState=function(){var e=i()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(b.isPassphraseWallet)(e)}}));return function(){return e.apply(this,arguments)}}(),o.getHardwareSDKInstance=function(){var t=i()((function*(){var t,n,r,i,o;return null!=(o=yield null==(t=e)||null==(n=t.$backgroundApiProxy)||null==(r=n.backgroundApi)||null==(i=r.serviceHardware)||null==i.getSDKInstance?void 0:i.getSDKInstance())?o:p.HardwareSDK}));return function(){return t.apply(this,arguments)}}(),o.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},a()(r)}(n(3903).KeyringBase)}.call(this,n(58))},3914:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringHdBase",(function(){return w}));var r=n(3),i=n.n(r),o=n(2),a=n.n(o),c=n(6),d=n.n(c),s=n(9),u=n.n(s),f=n(14),l=n.n(f),p=n(7),b=n.n(p),y=n(610),h=n(23);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var i=b()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l()(this,n)}}var w=function(e){u()(n,e);var t=g(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=a()((function*(e,t){var n=(yield this.getDbAccount()).path.split("/"),r=t||[n.pop()],i=n.join("/"),o=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof o)throw new h.OneKeyInternalError("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(y.batchGetPrivateKeys)(a,o,e,i,r).reduce((function(e,t){var n;return m(m({},e),{},((n={})[t.path]=t.extendedKey.key,n))}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},d()(n)}(n(3905).KeyringSoftwareBase)},3915:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringImportedBase",(function(){return y}));var r=n(2),i=n.n(r),o=n(6),a=n.n(o),c=n(9),d=n.n(c),s=n(14),u=n.n(s),f=n(7),l=n.n(f),p=n(23);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var y=function(e){d()(n,e);var t=b(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=i()((function*(e,t){if("undefined"!==typeof t)throw new p.NotImplemented("Getting private keys from extended private key");var n=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof n)throw new p.OneKeyInternalError("Unable to get credential.");return{"":n}}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(n)}(n(3905).KeyringSoftwareBase)},3916:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringWatchingBase",(function(){return y}));var r=n(2),i=n.n(r),o=n(6),a=n.n(o),c=n(9),d=n.n(c),s=n(14),u=n.n(s),f=n(7),l=n.n(f),p=n(23);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l()(e);if(t){var i=l()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u()(this,n)}}var y=function(e){d()(n,e);var t=b(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=i()((function*(e,t){throw new p.OneKeyInternalError("signTransaction is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=i()((function*(e,t){throw new p.OneKeyInternalError("signMessage is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(n)}(n(3903).KeyringBase)},3918:function(e,t,n){"use strict";n.r(t),n.d(t,"convertDeviceError",(function(){return c}));var r=n(70),i=n(90),o=n(19);n(24);function a(e,t){return"string"!==typeof t?null:e===r.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new i.ConnectTimeoutError({message:t}):t.includes("Bridge network error")?new i.BridgeNetworkError({message:t}):null}function c(e){var t,n=e||{},c=n.code,d=n.error,s=n.message,u=null!=(t=null!=d?d:s)?t:"Unknown error";if(a(c,u))return a(c,u);switch(o.default.hardwareSDK.info("Device Utils Convert Device Error:",c,u),c){case r.HardwareErrorCode.UnknownError:return new i.UnknownHardwareError(e);case r.HardwareErrorCode.DeviceFwException:return new i.FirmwareVersionTooLow(e);case r.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof u&&-1!==u.indexOf("ui-device_bootloader_mode")?new i.NotInBootLoaderMode(e):new i.UnknownHardwareError(e);case r.HardwareErrorCode.DeviceCheckDeviceIdError:return new i.DeviceNotSame(e);case r.HardwareErrorCode.DeviceNotFound:return new i.DeviceNotFind(e);case r.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new i.NotInBootLoaderMode(e);case r.HardwareErrorCode.DeviceInterruptedFromOutside:case r.HardwareErrorCode.DeviceInterruptedFromUser:return new i.UserCancelFromOutside(e);case r.HardwareErrorCode.DeviceNotSupportPassphrase:return new i.NotSupportPassphraseError(e);case r.HardwareErrorCode.IFrameLoadFail:return new i.InitIframeLoadFail(e);case r.HardwareErrorCode.IframeTimeout:return new i.InitIframeTimeout(e);case r.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new i.FirmwareDownloadFailed(e);case r.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new i.FirmwareUpdateManuallyEnterBoot(e);case r.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new i.FirmwareUpdateAutoEnterBootFailure(e);case r.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new i.FirmwareUpdateLimitOneDevice(e);case r.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new i.FirmwareVersionTooLow(e);case r.HardwareErrorCode.NewFirmwareUnRelease:return new i.NewFirmwareUnRelease(e);case r.HardwareErrorCode.NewFirmwareForceUpdate:return new i.NewFirmwareForceUpdate(e);case r.HardwareErrorCode.NetworkError:return new i.NetworkError(e);case r.HardwareErrorCode.BlePermissionError:return new i.NeedBluetoothTurnedOn(e);case r.HardwareErrorCode.BleLocationError:return new i.NeedBluetoothPermissions({message:u});case r.HardwareErrorCode.BleLocationServicesDisabled:return new i.BleLocationServiceError({message:u});case r.HardwareErrorCode.BleDeviceNotBonded:return new i.DeviceNotBonded(e);case r.HardwareErrorCode.BleDeviceBondError:return new i.DeviceBondError(e);case r.HardwareErrorCode.BleWriteCharacteristicError:return new i.BleWriteCharacteristicError(e);case r.HardwareErrorCode.BleScanError:return new i.BleScanError({message:u});case r.HardwareErrorCode.BleAlreadyConnected:return new i.BleAlreadyConnectedError(e);case r.HardwareErrorCode.RuntimeError:return-1!==u.indexOf("EIP712 blind sign is disabled")?new i.OpenBlindSign(e):-1!==u.indexOf("Unknown message")||-1!==u.indexOf("Failure_UnexpectedMessage")?new i.UnknownMethod(e):new i.UnknownHardwareError(e);case r.HardwareErrorCode.PinInvalid:return new i.InvalidPIN(e);case r.HardwareErrorCode.DeviceCheckPassphraseStateError:return new i.InvalidPassphrase(e);case r.HardwareErrorCode.DeviceOpenedPassphrase:return new i.DeviceOpenedPassphrase(e);case r.HardwareErrorCode.DeviceNotOpenedPassphrase:return new i.DeviceNotOpenedPassphrase(e);case r.HardwareErrorCode.PinCancelled:case r.HardwareErrorCode.ActionCancelled:return new i.UserCancel(e);case r.HardwareErrorCode.BridgeNotInstalled:case i.CustomOneKeyHardwareError.NeedOneKeyBridge:return new i.NeedOneKeyBridge(e);case r.HardwareErrorCode.BridgeNetworkError:return new i.BridgeNetworkError(e);case r.HardwareErrorCode.BridgeTimeoutError:return new i.BridgeTimeoutError(e);case r.HardwareErrorCode.PollingTimeout:return new i.ConnectTimeoutError(e);case r.HardwareErrorCode.PollingStop:return new i.ConnectPollingStopError(e);case r.HardwareErrorCode.BlindSignDisabled:return new i.OpenBlindSign(e);case r.HardwareErrorCode.FileAlreadyExists:return new i.FileAlreadyExistError(e);case r.HardwareErrorCode.CheckDownloadFileError:return new i.IncompleteFileError(e);case r.HardwareErrorCode.NotInSigningMode:return new i.NotInSigningModeError(e);default:return new i.UnknownHardwareError(e)}}},4159:function(e,t,n){var r=n(4160),i=n(1365),o=n(666),a=n(4161),c=n(237);e.exports=function(e,t,n){var d=c(e)?r:a,s=arguments.length<3;return d(e,o(t,4),n,s,i)}},4160:function(e,t){e.exports=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}},4161:function(e,t){e.exports=function(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}},4162:function(e,t,n){"use strict";var r,i;n.r(t),n.d(t,"BatchTransferMethods",(function(){return r})),n.d(t,"BatchTransferSelectors",(function(){return i})),function(e){e.disperseNFT="disperseNFT(address,address[],uint256[],uint256[])",e.disperseEther="disperseEther(address[],uint256[])",e.disperseToken="disperseToken(address,address[],uint256[])",e.disperseTokenSimple="disperseTokenSimple(address,address[],uint256[])",e.disperseEtherSameValue="disperseEtherSameValue(address[],uint256)",e.disperseTokenSameValue="disperseTokenSameValue(address,address[],uint256)"}(r||(r={})),function(e){e.disperseNFT="0x39039af6",e.disperseEther="0xe63d38ed",e.disperseToken="0xc73a2d60",e.disperseTokenSimple="0x51ba162c",e.disperseEtherSameValue="0xc263a3e4",e.disperseTokenSameValue="0x17546c6c"}(i||(i={}))},4563:function(e,t,n){var r=n(2761),i=n(1643),o=n(1598),a=n(1597),c=o((function(e,t){return a(e)?r(e,i(t,1,a,!0)):[]}));e.exports=c},4564:function(e){e.exports=JSON.parse('{"_format":"hh-sol-artifact-1","contractName":"ERC1155","sourceName":"contracts/token/ERC1155/ERC1155.sol","abi":[{"inputs":[{"internalType":"string","name":"uri_","type":"string"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"account","type":"address"},{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":false,"internalType":"bool","name":"approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256[]","name":"ids","type":"uint256[]"},{"indexed":false,"internalType":"uint256[]","name":"values","type":"uint256[]"}],"name":"TransferBatch","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"operator","type":"address"},{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"TransferSingle","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"string","name":"value","type":"string"},{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"}],"name":"URI","type":"event"},{"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"uint256","name":"id","type":"uint256"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address[]","name":"accounts","type":"address[]"},{"internalType":"uint256[]","name":"ids","type":"uint256[]"}],"name":"balanceOfBatch","outputs":[{"internalType":"uint256[]","name":"","type":"uint256[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"address","name":"operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256[]","name":"ids","type":"uint256[]"},{"internalType":"uint256[]","name":"amounts","type":"uint256[]"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"safeBatchTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"operator","type":"address"},{"internalType":"bool","name":"approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes4","name":"interfaceId","type":"bytes4"}],"name":"supportsInterface","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"uri","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}],"bytecode":"0x60806040523480156200001157600080fd5b50604051620015cb380380620015cb83398101604081905262000034916200011b565b6200003f8162000046565b5062000233565b80516200005b9060029060208401906200005f565b5050565b8280546200006d90620001f7565b90600052602060002090601f016020900481019282620000915760008555620000dc565b82601f10620000ac57805160ff1916838001178555620000dc565b82800160010185558215620000dc579182015b82811115620000dc578251825591602001919060010190620000bf565b50620000ea929150620000ee565b5090565b5b80821115620000ea5760008155600101620000ef565b634e487b7160e01b600052604160045260246000fd5b600060208083850312156200012f57600080fd5b82516001600160401b03808211156200014757600080fd5b818501915085601f8301126200015c57600080fd5b81518181111562000171576200017162000105565b604051601f8201601f19908116603f011681019083821181831017156200019c576200019c62000105565b816040528281528886848701011115620001b557600080fd5b600093505b82841015620001d95784840186015181850187015292850192620001ba565b82841115620001eb5760008684830101525b98975050505050505050565b600181811c908216806200020c57607f821691505b6020821081036200022d57634e487b7160e01b600052602260045260246000fd5b50919050565b61138880620002436000396000f3fe608060405234801561001057600080fd5b50600436106100875760003560e01c80634e1273f41161005b5780634e1273f41461010a578063a22cb4651461012a578063e985e9c51461013d578063f242432a1461017957600080fd5b8062fdd58e1461008c57806301ffc9a7146100b25780630e89341c146100d55780632eb2c2d6146100f5575b600080fd5b61009f61009a366004610b3f565b61018c565b6040519081526020015b60405180910390f35b6100c56100c0366004610b82565b610222565b60405190151581526020016100a9565b6100e86100e3366004610ba6565b610274565b6040516100a99190610c0c565b610108610103366004610d6b565b610308565b005b61011d610118366004610e15565b610354565b6040516100a99190610f1b565b610108610138366004610f2e565b61047e565b6100c561014b366004610f6a565b6001600160a01b03918216600090815260016020908152604080832093909416825291909152205460ff1690565b610108610187366004610f9d565b61048d565b60006001600160a01b0383166101fc5760405162461bcd60e51b815260206004820152602a60248201527f455243313135353a2061646472657373207a65726f206973206e6f742061207660448201526930b634b21037bbb732b960b11b60648201526084015b60405180910390fd5b506000908152602081815260408083206001600160a01b03949094168352929052205490565b60006001600160e01b03198216636cdb3d1360e11b148061025357506001600160e01b031982166303a24d0760e21b145b8061026e57506301ffc9a760e01b6001600160e01b03198316145b92915050565b60606002805461028390611002565b80601f01602080910402602001604051908101604052809291908181526020018280546102af90611002565b80156102fc5780601f106102d1576101008083540402835291602001916102fc565b820191906000526020600020905b8154815290600101906020018083116102df57829003601f168201915b50505050509050919050565b6001600160a01b0385163314806103245750610324853361014b565b6103405760405162461bcd60e51b81526004016101f39061103c565b61034d85858585856104d2565b5050505050565b606081518351146103b95760405162461bcd60e51b815260206004820152602960248201527f455243313135353a206163636f756e747320616e6420696473206c656e677468604482015268040dad2e6dac2e8c6d60bb1b60648201526084016101f3565b6000835167ffffffffffffffff8111156103d5576103d5610c1f565b6040519080825280602002602001820160405280156103fe578160200160208202803683370190505b50905060005b8451811015610476576104498582815181106104225761042261108a565b602002602001015185838151811061043c5761043c61108a565b602002602001015161018c565b82828151811061045b5761045b61108a565b602090810291909101015261046f816110b6565b9050610404565b509392505050565b6104893383836106af565b5050565b6001600160a01b0385163314806104a957506104a9853361014b565b6104c55760405162461bcd60e51b81526004016101f39061103c565b61034d858585858561078f565b81518351146105345760405162461bcd60e51b815260206004820152602860248201527f455243313135353a2069647320616e6420616d6f756e7473206c656e677468206044820152670dad2e6dac2e8c6d60c31b60648201526084016101f3565b6001600160a01b03841661055a5760405162461bcd60e51b81526004016101f3906110cf565b3360005b845181101561064157600085828151811061057b5761057b61108a565b6020026020010151905060008583815181106105995761059961108a565b602090810291909101810151600084815280835260408082206001600160a01b038e1683529093529190912054909150818110156105e95760405162461bcd60e51b81526004016101f390611114565b6000838152602081815260408083206001600160a01b038e8116855292528083208585039055908b1682528120805484929061062690849061115e565b925050819055505050508061063a906110b6565b905061055e565b50846001600160a01b0316866001600160a01b0316826001600160a01b03167f4a39dc06d4c0dbc64b70af90fd698a233a518aa5d07e595d983b8c0526c8f7fb8787604051610691929190611176565b60405180910390a46106a78187878787876108b9565b505050505050565b816001600160a01b0316836001600160a01b0316036107225760405162461bcd60e51b815260206004820152602960248201527f455243313135353a2073657474696e6720617070726f76616c20737461747573604482015268103337b91039b2b63360b91b60648201526084016101f3565b6001600160a01b03838116600081815260016020908152604080832094871680845294825291829020805460ff191686151590811790915591519182527f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31910160405180910390a3505050565b6001600160a01b0384166107b55760405162461bcd60e51b81526004016101f3906110cf565b3360006107c185610a1d565b905060006107ce85610a1d565b90506000868152602081815260408083206001600160a01b038c168452909152902054858110156108115760405162461bcd60e51b81526004016101f390611114565b6000878152602081815260408083206001600160a01b038d8116855292528083208985039055908a1682528120805488929061084e90849061115e565b909155505060408051888152602081018890526001600160a01b03808b16928c821692918816917fc3d58168c5ae7397731d063d5bbf3d657854427343f4c083240f7aacaa2d0f62910160405180910390a46108ae848a8a8a8a8a610a68565b505050505050505050565b6001600160a01b0384163b156106a75760405163bc197c8160e01b81526001600160a01b0385169063bc197c81906108fd90899089908890889088906004016111a4565b6020604051808303816000875af1925050508015610938575060408051601f3d908101601f1916820190925261093591810190611202565b60015b6109e45761094461121f565b806308c379a00361097d575061095861123b565b80610963575061097f565b8060405162461bcd60e51b81526004016101f39190610c0c565b505b60405162461bcd60e51b815260206004820152603460248201527f455243313135353a207472616e7366657220746f206e6f6e2d455243313135356044820152732932b1b2b4bb32b91034b6b83632b6b2b73a32b960611b60648201526084016101f3565b6001600160e01b0319811663bc197c8160e01b14610a145760405162461bcd60e51b81526004016101f3906112c5565b50505050505050565b60408051600180825281830190925260609160009190602080830190803683370190505090508281600081518110610a5757610a5761108a565b602090810291909101015292915050565b6001600160a01b0384163b156106a75760405163f23a6e6160e01b81526001600160a01b0385169063f23a6e6190610aac908990899088908890889060040161130d565b6020604051808303816000875af1925050508015610ae7575060408051601f3d908101601f19168201909252610ae491810190611202565b60015b610af35761094461121f565b6001600160e01b0319811663f23a6e6160e01b14610a145760405162461bcd60e51b81526004016101f3906112c5565b80356001600160a01b0381168114610b3a57600080fd5b919050565b60008060408385031215610b5257600080fd5b610b5b83610b23565b946020939093013593505050565b6001600160e01b031981168114610b7f57600080fd5b50565b600060208284031215610b9457600080fd5b8135610b9f81610b69565b9392505050565b600060208284031215610bb857600080fd5b5035919050565b6000815180845260005b81811015610be557602081850181015186830182015201610bc9565b81811115610bf7576000602083870101525b50601f01601f19169290920160200192915050565b602081526000610b9f6020830184610bbf565b634e487b7160e01b600052604160045260246000fd5b601f8201601f1916810167ffffffffffffffff81118282101715610c5b57610c5b610c1f565b6040525050565b600067ffffffffffffffff821115610c7c57610c7c610c1f565b5060051b60200190565b600082601f830112610c9757600080fd5b81356020610ca482610c62565b604051610cb18282610c35565b83815260059390931b8501820192828101915086841115610cd157600080fd5b8286015b84811015610cec5780358352918301918301610cd5565b509695505050505050565b600082601f830112610d0857600080fd5b813567ffffffffffffffff811115610d2257610d22610c1f565b604051610d39601f8301601f191660200182610c35565b818152846020838601011115610d4e57600080fd5b816020850160208301376000918101602001919091529392505050565b600080600080600060a08688031215610d8357600080fd5b610d8c86610b23565b9450610d9a60208701610b23565b9350604086013567ffffffffffffffff80821115610db757600080fd5b610dc389838a01610c86565b94506060880135915080821115610dd957600080fd5b610de589838a01610c86565b93506080880135915080821115610dfb57600080fd5b50610e0888828901610cf7565b9150509295509295909350565b60008060408385031215610e2857600080fd5b823567ffffffffffffffff80821115610e4057600080fd5b818501915085601f830112610e5457600080fd5b81356020610e6182610c62565b604051610e6e8282610c35565b83815260059390931b8501820192828101915089841115610e8e57600080fd5b948201945b83861015610eb357610ea486610b23565b82529482019490820190610e93565b96505086013592505080821115610ec957600080fd5b50610ed685828601610c86565b9150509250929050565b600081518084526020808501945080840160005b83811015610f1057815187529582019590820190600101610ef4565b509495945050505050565b602081526000610b9f6020830184610ee0565b60008060408385031215610f4157600080fd5b610f4a83610b23565b915060208301358015158114610f5f57600080fd5b809150509250929050565b60008060408385031215610f7d57600080fd5b610f8683610b23565b9150610f9460208401610b23565b90509250929050565b600080600080600060a08688031215610fb557600080fd5b610fbe86610b23565b9450610fcc60208701610b23565b93506040860135925060608601359150608086013567ffffffffffffffff811115610ff657600080fd5b610e0888828901610cf7565b600181811c9082168061101657607f821691505b60208210810361103657634e487b7160e01b600052602260045260246000fd5b50919050565b6020808252602e908201527f455243313135353a2063616c6c6572206973206e6f7420746f6b656e206f776e60408201526d195c881bdc88185c1c1c9bdd995960921b606082015260800190565b634e487b7160e01b600052603260045260246000fd5b634e487b7160e01b600052601160045260246000fd5b6000600182016110c8576110c86110a0565b5060010190565b60208082526025908201527f455243313135353a207472616e7366657220746f20746865207a65726f206164604082015264647265737360d81b606082015260800190565b6020808252602a908201527f455243313135353a20696e73756666696369656e742062616c616e636520666f60408201526939103a3930b739b332b960b11b606082015260800190565b60008219821115611171576111716110a0565b500190565b6040815260006111896040830185610ee0565b828103602084015261119b8185610ee0565b95945050505050565b6001600160a01b0386811682528516602082015260a0604082018190526000906111d090830186610ee0565b82810360608401526111e28186610ee0565b905082810360808401526111f68185610bbf565b98975050505050505050565b60006020828403121561121457600080fd5b8151610b9f81610b69565b600060033d11156112385760046000803e5060005160e01c5b90565b600060443d10156112495790565b6040516003193d81016004833e81513d67ffffffffffffffff816024840111818411171561127957505050505090565b82850191508151818111156112915750505050505090565b843d87010160208285010111156112ab5750505050505090565b6112ba60208286010187610c35565b509095945050505050565b60208082526028908201527f455243313135353a204552433131353552656365697665722072656a656374656040820152676420746f6b656e7360c01b606082015260800190565b6001600160a01b03868116825285166020820152604081018490526060810183905260a06080820181905260009061134790830184610bbf565b97965050505050505056fea2646970667358221220a690293c88d6344935ce74699232e93a05c2c54bc9e019a4c16e196e6916539864736f6c634300080d0033","deployedBytecode":"0x608060405234801561001057600080fd5b50600436106100875760003560e01c80634e1273f41161005b5780634e1273f41461010a578063a22cb4651461012a578063e985e9c51461013d578063f242432a1461017957600080fd5b8062fdd58e1461008c57806301ffc9a7146100b25780630e89341c146100d55780632eb2c2d6146100f5575b600080fd5b61009f61009a366004610b3f565b61018c565b6040519081526020015b60405180910390f35b6100c56100c0366004610b82565b610222565b60405190151581526020016100a9565b6100e86100e3366004610ba6565b610274565b6040516100a99190610c0c565b610108610103366004610d6b565b610308565b005b61011d610118366004610e15565b610354565b6040516100a99190610f1b565b610108610138366004610f2e565b61047e565b6100c561014b366004610f6a565b6001600160a01b03918216600090815260016020908152604080832093909416825291909152205460ff1690565b610108610187366004610f9d565b61048d565b60006001600160a01b0383166101fc5760405162461bcd60e51b815260206004820152602a60248201527f455243313135353a2061646472657373207a65726f206973206e6f742061207660448201526930b634b21037bbb732b960b11b60648201526084015b60405180910390fd5b506000908152602081815260408083206001600160a01b03949094168352929052205490565b60006001600160e01b03198216636cdb3d1360e11b148061025357506001600160e01b031982166303a24d0760e21b145b8061026e57506301ffc9a760e01b6001600160e01b03198316145b92915050565b60606002805461028390611002565b80601f01602080910402602001604051908101604052809291908181526020018280546102af90611002565b80156102fc5780601f106102d1576101008083540402835291602001916102fc565b820191906000526020600020905b8154815290600101906020018083116102df57829003601f168201915b50505050509050919050565b6001600160a01b0385163314806103245750610324853361014b565b6103405760405162461bcd60e51b81526004016101f39061103c565b61034d85858585856104d2565b5050505050565b606081518351146103b95760405162461bcd60e51b815260206004820152602960248201527f455243313135353a206163636f756e747320616e6420696473206c656e677468604482015268040dad2e6dac2e8c6d60bb1b60648201526084016101f3565b6000835167ffffffffffffffff8111156103d5576103d5610c1f565b6040519080825280602002602001820160405280156103fe578160200160208202803683370190505b50905060005b8451811015610476576104498582815181106104225761042261108a565b602002602001015185838151811061043c5761043c61108a565b602002602001015161018c565b82828151811061045b5761045b61108a565b602090810291909101015261046f816110b6565b9050610404565b509392505050565b6104893383836106af565b5050565b6001600160a01b0385163314806104a957506104a9853361014b565b6104c55760405162461bcd60e51b81526004016101f39061103c565b61034d858585858561078f565b81518351146105345760405162461bcd60e51b815260206004820152602860248201527f455243313135353a2069647320616e6420616d6f756e7473206c656e677468206044820152670dad2e6dac2e8c6d60c31b60648201526084016101f3565b6001600160a01b03841661055a5760405162461bcd60e51b81526004016101f3906110cf565b3360005b845181101561064157600085828151811061057b5761057b61108a565b6020026020010151905060008583815181106105995761059961108a565b602090810291909101810151600084815280835260408082206001600160a01b038e1683529093529190912054909150818110156105e95760405162461bcd60e51b81526004016101f390611114565b6000838152602081815260408083206001600160a01b038e8116855292528083208585039055908b1682528120805484929061062690849061115e565b925050819055505050508061063a906110b6565b905061055e565b50846001600160a01b0316866001600160a01b0316826001600160a01b03167f4a39dc06d4c0dbc64b70af90fd698a233a518aa5d07e595d983b8c0526c8f7fb8787604051610691929190611176565b60405180910390a46106a78187878787876108b9565b505050505050565b816001600160a01b0316836001600160a01b0316036107225760405162461bcd60e51b815260206004820152602960248201527f455243313135353a2073657474696e6720617070726f76616c20737461747573604482015268103337b91039b2b63360b91b60648201526084016101f3565b6001600160a01b03838116600081815260016020908152604080832094871680845294825291829020805460ff191686151590811790915591519182527f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31910160405180910390a3505050565b6001600160a01b0384166107b55760405162461bcd60e51b81526004016101f3906110cf565b3360006107c185610a1d565b905060006107ce85610a1d565b90506000868152602081815260408083206001600160a01b038c168452909152902054858110156108115760405162461bcd60e51b81526004016101f390611114565b6000878152602081815260408083206001600160a01b038d8116855292528083208985039055908a1682528120805488929061084e90849061115e565b909155505060408051888152602081018890526001600160a01b03808b16928c821692918816917fc3d58168c5ae7397731d063d5bbf3d657854427343f4c083240f7aacaa2d0f62910160405180910390a46108ae848a8a8a8a8a610a68565b505050505050505050565b6001600160a01b0384163b156106a75760405163bc197c8160e01b81526001600160a01b0385169063bc197c81906108fd90899089908890889088906004016111a4565b6020604051808303816000875af1925050508015610938575060408051601f3d908101601f1916820190925261093591810190611202565b60015b6109e45761094461121f565b806308c379a00361097d575061095861123b565b80610963575061097f565b8060405162461bcd60e51b81526004016101f39190610c0c565b505b60405162461bcd60e51b815260206004820152603460248201527f455243313135353a207472616e7366657220746f206e6f6e2d455243313135356044820152732932b1b2b4bb32b91034b6b83632b6b2b73a32b960611b60648201526084016101f3565b6001600160e01b0319811663bc197c8160e01b14610a145760405162461bcd60e51b81526004016101f3906112c5565b50505050505050565b60408051600180825281830190925260609160009190602080830190803683370190505090508281600081518110610a5757610a5761108a565b602090810291909101015292915050565b6001600160a01b0384163b156106a75760405163f23a6e6160e01b81526001600160a01b0385169063f23a6e6190610aac908990899088908890889060040161130d565b6020604051808303816000875af1925050508015610ae7575060408051601f3d908101601f19168201909252610ae491810190611202565b60015b610af35761094461121f565b6001600160e01b0319811663f23a6e6160e01b14610a145760405162461bcd60e51b81526004016101f3906112c5565b80356001600160a01b0381168114610b3a57600080fd5b919050565b60008060408385031215610b5257600080fd5b610b5b83610b23565b946020939093013593505050565b6001600160e01b031981168114610b7f57600080fd5b50565b600060208284031215610b9457600080fd5b8135610b9f81610b69565b9392505050565b600060208284031215610bb857600080fd5b5035919050565b6000815180845260005b81811015610be557602081850181015186830182015201610bc9565b81811115610bf7576000602083870101525b50601f01601f19169290920160200192915050565b602081526000610b9f6020830184610bbf565b634e487b7160e01b600052604160045260246000fd5b601f8201601f1916810167ffffffffffffffff81118282101715610c5b57610c5b610c1f565b6040525050565b600067ffffffffffffffff821115610c7c57610c7c610c1f565b5060051b60200190565b600082601f830112610c9757600080fd5b81356020610ca482610c62565b604051610cb18282610c35565b83815260059390931b8501820192828101915086841115610cd157600080fd5b8286015b84811015610cec5780358352918301918301610cd5565b509695505050505050565b600082601f830112610d0857600080fd5b813567ffffffffffffffff811115610d2257610d22610c1f565b604051610d39601f8301601f191660200182610c35565b818152846020838601011115610d4e57600080fd5b816020850160208301376000918101602001919091529392505050565b600080600080600060a08688031215610d8357600080fd5b610d8c86610b23565b9450610d9a60208701610b23565b9350604086013567ffffffffffffffff80821115610db757600080fd5b610dc389838a01610c86565b94506060880135915080821115610dd957600080fd5b610de589838a01610c86565b93506080880135915080821115610dfb57600080fd5b50610e0888828901610cf7565b9150509295509295909350565b60008060408385031215610e2857600080fd5b823567ffffffffffffffff80821115610e4057600080fd5b818501915085601f830112610e5457600080fd5b81356020610e6182610c62565b604051610e6e8282610c35565b83815260059390931b8501820192828101915089841115610e8e57600080fd5b948201945b83861015610eb357610ea486610b23565b82529482019490820190610e93565b96505086013592505080821115610ec957600080fd5b50610ed685828601610c86565b9150509250929050565b600081518084526020808501945080840160005b83811015610f1057815187529582019590820190600101610ef4565b509495945050505050565b602081526000610b9f6020830184610ee0565b60008060408385031215610f4157600080fd5b610f4a83610b23565b915060208301358015158114610f5f57600080fd5b809150509250929050565b60008060408385031215610f7d57600080fd5b610f8683610b23565b9150610f9460208401610b23565b90509250929050565b600080600080600060a08688031215610fb557600080fd5b610fbe86610b23565b9450610fcc60208701610b23565b93506040860135925060608601359150608086013567ffffffffffffffff811115610ff657600080fd5b610e0888828901610cf7565b600181811c9082168061101657607f821691505b60208210810361103657634e487b7160e01b600052602260045260246000fd5b50919050565b6020808252602e908201527f455243313135353a2063616c6c6572206973206e6f7420746f6b656e206f776e60408201526d195c881bdc88185c1c1c9bdd995960921b606082015260800190565b634e487b7160e01b600052603260045260246000fd5b634e487b7160e01b600052601160045260246000fd5b6000600182016110c8576110c86110a0565b5060010190565b60208082526025908201527f455243313135353a207472616e7366657220746f20746865207a65726f206164604082015264647265737360d81b606082015260800190565b6020808252602a908201527f455243313135353a20696e73756666696369656e742062616c616e636520666f60408201526939103a3930b739b332b960b11b606082015260800190565b60008219821115611171576111716110a0565b500190565b6040815260006111896040830185610ee0565b828103602084015261119b8185610ee0565b95945050505050565b6001600160a01b0386811682528516602082015260a0604082018190526000906111d090830186610ee0565b82810360608401526111e28186610ee0565b905082810360808401526111f68185610bbf565b98975050505050505050565b60006020828403121561121457600080fd5b8151610b9f81610b69565b600060033d11156112385760046000803e5060005160e01c5b90565b600060443d10156112495790565b6040516003193d81016004833e81513d67ffffffffffffffff816024840111818411171561127957505050505090565b82850191508151818111156112915750505050505090565b843d87010160208285010111156112ab5750505050505090565b6112ba60208286010187610c35565b509095945050505050565b60208082526028908201527f455243313135353a204552433131353552656365697665722072656a656374656040820152676420746f6b656e7360c01b606082015260800190565b6001600160a01b03868116825285166020820152604081018490526060810183905260a06080820181905260009061134790830184610bbf565b97965050505050505056fea2646970667358221220a690293c88d6344935ce74699232e93a05c2c54bc9e019a4c16e196e6916539864736f6c634300080d0033","linkReferences":{},"deployedLinkReferences":{}}')},4565:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"ethereumGetAddress",(function(){return x})),n.d(t,"solanaSignTransaction",(function(){return A})),n.d(t,"btcSignTransaction",(function(){return E})),n.d(t,"nearSignTransaction",(function(){return P})),n.d(t,"solanaGetAddress",(function(){return k})),n.d(t,"ethereumSignMessage",(function(){return D})),n.d(t,"ethereumSignTransaction",(function(){return F})),n.d(t,"getXpubs",(function(){return B}));var r=n(3),i=n.n(r),o=n(2),a=n.n(o),c=n(22),d=n(138),s=n(168),u=n(84),f=n(21),l=n(1459),p=n(46),b=n(3918),y=n(11),h=n(163),v=n(376),m=n(23),g=n(114);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n,r){return I.apply(this,arguments)}function I(){return(I=a()((function*(e,t,n,r){var i,o,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5?arguments[5]:void 0,d=arguments.length>6?arguments[6]:void 0;try{o=yield e.evmGetAddress(t,n,T({path:r,showOnOneKey:a,chainId:d},c))}catch(s){throw new m.OneKeyHardwareError(s)}if(o.success&&null!=(i=o.payload)&&i.address)return h.fixAddressCase({address:o.payload.address,impl:y.IMPL_EVM});throw Object(b.convertDeviceError)(o.payload)}))).apply(this,arguments)}function A(){throw new m.NotImplemented}function E(){throw new m.NotImplemented}function P(){throw new m.NotImplemented}function k(e){return O.apply(this,arguments)}function O(){return(O=a()((function*(e){return Promise.reject(new Error("not implemented"))}))).apply(this,arguments)}function N(e){if(!e.success)throw Object(b.convertDeviceError)(e.payload);return e.payload}function D(e){return S.apply(this,arguments)}function S(){return(S=a()((function*(t){var n=t.HardwareSDK,r=t.connectId,i=t.deviceId,o=t.passphraseState,a=t.path,c=t.message,d=t.chainId;if(c.type===g.ETHMessageTypes.TYPED_DATA_V1)throw u.web3Errors.provider.unsupportedMethod("Sign message method="+c.type+" not supported for this device");if(c.type===g.ETHMessageTypes.ETH_SIGN||c.type===g.ETHMessageTypes.PERSONAL_SIGN){var s;try{if(!Object(p.isHexString)(c.message))throw new Error("not hex string");s=e.from(c.message.replace("0x",""),"hex")}catch(P){s=e.from("")}var f=c.message;0===s.length&&(f=e.from(c.message,"utf-8").toString("hex"));var y=yield n.evmSignMessage(r,i,T({path:a,messageHex:f,chainId:d},o));if(!y.success)throw Object(b.convertDeviceError)(y.payload);var h=N(y);return"0x"+((null==h?void 0:h.signature)||"")}if(c.type===g.ETHMessageTypes.TYPED_DATA_V3||c.type===g.ETHMessageTypes.TYPED_DATA_V4){var v=c.type===g.ETHMessageTypes.TYPED_DATA_V4,m=JSON.parse(c.message),w=l.TypedDataUtils.sanitizeData(m),x=l.TypedDataUtils.hashStruct("EIP712Domain",w.domain,w.types,v).toString("hex"),I=l.TypedDataUtils.hashStruct(w.primaryType,w.message,w.types,v).toString("hex"),A=yield n.evmSignTypedData(r,i,T({path:a,metamaskV4Compat:!!v,data:m,domainHash:x,messageHash:I,chainId:d},o));if(!A.success)throw Object(b.convertDeviceError)(A.payload);var E=N(A);return"0x"+((null==E?void 0:E.signature)||"")}throw u.web3Errors.rpc.methodNotFound("Sign message method="+c.type+" not found")}))).apply(this,arguments)}function F(e,t,n,r,i,o,a){return C.apply(this,arguments)}function C(){return(C=a()((function*(e,t,n,r,i,o,a){var u,l,p,y,h=o.outputs[0];if("undefined"===typeof h.tokenAddress?(p=h.address,y=Object(v.toBigIntHex)(h.value)):(p=h.tokenAddress,y="0x0"),"undefined"===typeof o.feeLimit||"undefined"===typeof o.nonce)throw new m.OneKeyInternalError("Incomplete unsigned tx.");var g,w,x,I,A=null==(u=o.payload)?void 0:u.EIP1559Enabled;A?g={to:p,value:y,gasLimit:Object(v.toBigIntHex)(o.feeLimit),nonce:"0x"+o.nonce.toString(16),data:(null==(w=o.payload)?void 0:w.data)||"0x",chainId:parseInt(i),maxFeePerGas:Object(v.toBigIntHex)(o.payload.maxFeePerGas),maxPriorityFeePerGas:Object(v.toBigIntHex)(o.payload.maxPriorityFeePerGas)}:g={to:p,value:y,gasPrice:Object(v.toBigIntHex)(null!=(x=o.feePricePerUnit)?x:new f.BigNumber(0)),gasLimit:Object(v.toBigIntHex)(o.feeLimit),nonce:"0x"+o.nonce.toString(16),data:(null==(I=o.payload)?void 0:I.data)||"0x",chainId:parseInt(i)};var E,P,k,O,N={to:g.to,value:g.value,gasPrice:g.gasPrice,gasLimit:g.gasLimit,nonce:parseInt(g.nonce,16),data:g.data,chainId:g.chainId};A&&(N.type=2,N.maxFeePerGas=null!=(E=null==(P=g)?void 0:P.maxFeePerGas)?E:void 0,N.maxPriorityFeePerGas=null!=(k=null==(O=g)?void 0:O.maxPriorityFeePerGas)?k:void 0);try{l=yield e.evmSignTransaction(t,n,T({path:r,transaction:g},a))}catch(H){throw new m.OneKeyHardwareError(H)}if(l.success){var D=l.payload,S=D.v,F=D.r,C=D.s,B=Object(c.splitSignature)({v:Number(S),r:F,s:C}),R=Object(s.serialize)(N,B);return{txid:Object(d.keccak256)(R),rawTx:R}}throw Object(b.convertDeviceError)(l.payload)}))).apply(this,arguments)}function B(e,t,n,r,i,o,a,c,d){return R.apply(this,arguments)}function R(){return(R=a()((function*(e,t,n,r,i,o,a,c,d){if(t!==y.IMPL_EVM||"address"!==r)return Promise.resolve([]);var s,u=n.length>1;try{s=u?yield e.evmGetAddress(o,a,T({bundle:n.map((function(e){return{path:e,showOnOneKey:!1,chainId:d}}))},c)):yield e.evmGetAddress(o,a,T({path:n[0],showOnOneKey:!1,chainId:d},c))}catch(f){throw new m.OneKeyHardwareError(f)}if(s.success)return s.payload instanceof Array?s.payload.map((function(e){var n=e.path,r=e.address;return{path:n,info:h.fixAddressCase({address:r,impl:t})}})):[{path:s.payload.path,info:h.fixAddressCase({address:s.payload.address,impl:t})}];throw Object(b.convertDeviceError)(s.payload)}))).apply(this,arguments)}}.call(this,n(26).Buffer)},6114:function(e,t,n){"use strict";n.r(t),n.d(t,"IDecodedTxEvmType",(function(){return Ue})),n.d(t,"default",(function(){return Ye}));var r=n(1077),i=n.n(r),o=n(452),a=n.n(o),c=n(4563),d=n.n(c),s=n(698),u=n.n(s),f=n(154),l=n.n(f),p=n(15),b=n.n(p),y=n(60),h=n.n(y),v=n(4159),m=n.n(v),g=n(13),w=n.n(g),T=n(3),x=n.n(T),I=n(4),A=n.n(I),E=n(2),P=n.n(E),k=n(6),O=n.n(k),N=n(33),D=n.n(N),S=n(9),F=n.n(S),C=n(14),B=n.n(C),R=n(7),H=n.n(R),M=n(554),j=n(4564),K=n(2386),_=n(2387),L=n(21),U=n.n(L),G=n(491),V=n(862),W=n(112),J=n(367),z=n(46),Y=n(2388),q=n(36),X=n(11),Q=n(19),Z=n(150),$=n(376),ee=n(23),te=n(1529),ne=n(182),re=n(391),ie=n(1070),oe=n(1345),ae=n(4162),ce=n(1011),de=n(114),se=n(1069),ue=n(308),fe=n(52),le=n(196),pe=n(3912),be=n(453),ye=n(598),he=n(717),ve=n(3918),me=n(163),ge=n(4565),we=n(317),Te=n(117),xe=n(3913),Ie=n(158);function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){x()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=H()(e);if(t){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B()(this,n)}}var ke=function(e){F()(n,e);var t=Pe(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=P()((function*(e){var t=yield this.getHardwareSDKInstance(),n=yield this.getAccountPath(),r=yield this.getNetworkChainId(),i=yield this.getHardwareInfo(),o=i.connectId,a=i.deviceId,c=yield this.getWalletPassphraseState();return ge.ethereumSignTransaction(t,o,a,n,r,e,c)}));return function(t){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=P()((function*(e,t){var n=yield this.getHardwareSDKInstance(),r=yield this.getAccountPath(),i=yield this.getNetworkChainId(),o=yield this.getHardwareInfo(),a=o.connectId,c=o.deviceId,d=yield this.getWalletPassphraseState();return Promise.all(e.map((function(e){return ge.ethereumSignMessage({HardwareSDK:n,connectId:a,deviceId:c,passphraseState:d,path:r,message:e,chainId:Number(i)})})))}));return function(t,n){return e.apply(this,arguments)}}(),r.prepareAccounts=function(){var e=P()((function*(e){var t,n=this,r=yield this.getHardwareSDKInstance(),i=yield this.getNetworkChainId(),o=yield this.getHardwareInfo(),a=o.connectId,c=o.deviceId,d=yield this.getWalletPassphraseState(),s=e.indexes,u=e.names,f=e.type,l=e.template,p=e.coinType,b=Object(we.slicePathTemplate)(l),y=b.pathPrefix,h=b.pathSuffix,v=l===(yield this.vault.getAccountNameInfoMap()).ledgerLive.template,m=s.map((function(e){return y+"/"+h.replace("{index}",""+e)}));if("SEARCH_ACCOUNTS"===f){var g,w={path:y,showOnOneKey:!1,chainId:Number(i)};v&&(w={bundle:m.map((function(e){return{path:e,showOnOneKey:!1,chainId:Number(i)}})),useBatch:!0});try{g=yield r.evmGetPublicKey(a,c,Ee(Ee({},w),d))}catch(C){throw Q.default.engine.error(C),new ee.OneKeyHardwareError(C)}if(!g.success)throw Object(ve.convertDeviceError)(g.payload);if(v)t=yield Promise.all(g.payload.map(function(){var e=P()((function*(e){return{path:e.path,info:me.fixAddressCase({address:yield n.engine.providerManager.addressFromPub(n.networkId,e.publicKey),impl:X.IMPL_EVM})}}));return function(t){return e.apply(this,arguments)}}()));else{var T=g.payload.xpub,x=Ie.ethers.utils.HDNode.fromExtendedKey(T);t=s.map((function(e){return{path:y+"/"+h.replace("{index}",""+e),info:me.fixAddressCase({address:x.derivePath(""+e).address,impl:X.IMPL_EVM})}}))}}else t=yield ge.getXpubs(r,X.IMPL_EVM,m,"address",f,a,c,d,Number(i));var I=[],A=0,E=yield this.getNetworkImpl(),k=Object(ne.getAccountNameInfoByTemplate)(E,l).prefix,O=Object(ne.getAccountNameInfoByImpl)(E).ledgerLive.template===l;for(var N of t){var D=N.path,S=N.info,F=(u||[])[A]||k+" #"+(s[A]+1);I.push({id:O?this.walletId+"--"+D+"--LedgerLive":this.walletId+"--"+D,name:F,type:Te.AccountType.SIMPLE,path:D,coinType:p,pub:"",address:S,template:l}),A+=1}return I}));return function(t){return e.apply(this,arguments)}}(),r.getAddress=function(){var e=P()((function*(e){var t=yield this.getHardwareSDKInstance(),n=yield this.getNetworkChainId(),r=yield this.getHardwareInfo(),i=r.connectId,o=r.deviceId,a=yield this.getWalletPassphraseState();return yield ge.ethereumGetAddress(t,i,o,e.path,e.showOnOneKey,a,Number(n))}));return function(t){return e.apply(this,arguments)}}(),r.batchGetAddress=function(){var e=P()((function*(e){var t=yield this.getHardwareSDKInstance(),n=yield this.getNetworkChainId(),r=yield this.getHardwareInfo(),i=r.connectId,o=r.deviceId,a=yield this.getWalletPassphraseState(),c=yield t.evmGetAddress(i,o,Ee(Ee({},a),{},{bundle:e.map((function(e){return{path:e.path,showOnOneKey:!!e.showOnOneKey,chainId:Number(n)}}))}));if(!c.success)throw Object(ve.convertDeviceError)(c.payload);return c.payload.map((function(e){var t,n;return{path:null!=(t=e.path)?t:"",address:null!=(n=e.address)?n:""}}))}));return function(t){return e.apply(this,arguments)}}(),O()(n)}(xe.KeyringHardwareBase),Oe=n(610);function Ne(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=H()(e);if(t){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B()(this,n)}}var De=function(e){F()(n,e);var t=Ne(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getSigners=function(){var e=P()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new ee.OneKeyInternalError("EVM signers number should be 1.");if(t[0]!==r.address)throw new ee.OneKeyInternalError("Wrong address required for signing.");var i=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof i)throw new ee.OneKeyInternalError("Unable to get signer.");return(n={})[r.address]=new oe.Signer(i,e,"secp256k1"),n}));return function(t,n){return e.apply(this,arguments)}}(),r.prepareAccounts=function(){var e=P()((function*(e){var t=e.password,n=e.indexes,r=e.names,i=e.coinType,o=e.template,a=(yield this.engine.dbApi.getCredential(this.walletId,t)).seed,c=Object(we.slicePathTemplate)(o),d=c.pathPrefix,s=c.pathSuffix,u=Object(Oe.batchGetPublicKeys)("secp256k1",a,t,d,n.map((function(e){return s.replace("{index}",e.toString())})));if(u.length!==n.length)throw new ee.OneKeyInternalError("Unable to get publick key.");var f=[],l=0,p=yield this.getNetworkImpl(),b=Object(ne.getAccountNameInfoByTemplate)(p,o).prefix;for(var y of u){var h=y.path,v=y.extendedKey.key.toString("hex"),m=yield this.engine.providerManager.addressFromPub(this.networkId,v),g=(r||[])[l]||b+" #"+(n[l]+1),w=Object(ne.getAccountNameInfoByImpl)(p).ledgerLive.template===o;f.push({id:w?this.walletId+"--"+h+"--LedgerLive":this.walletId+"--"+h,name:g,type:Te.AccountType.SIMPLE,path:h,coinType:i,pub:v,address:m,template:o}),l+=1}return f}));return function(t){return e.apply(this,arguments)}}(),O()(n)}(n(3914).KeyringHdBase),Se=n(748);function Fe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=H()(e);if(t){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B()(this,n)}}var Ce=function(e){F()(n,e);var t=Fe(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getSigners=function(){var e=P()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new ee.OneKeyInternalError("EVM signers number should be 1.");if(t[0]!==r.address)throw new ee.OneKeyInternalError("Wrong address required for signing.");var i=Object.values(yield this.getPrivateKeys(e)),o=A()(i,1)[0];return(n={})[r.address]=new oe.Signer(o,e,"secp256k1"),n}));return function(t,n){return e.apply(this,arguments)}}(),r.prepareAccounts=function(){var e=P()((function*(e){var t=e.name,n=e.privateKey;if(32!==n.length)throw new ee.OneKeyInternalError("Invalid private key.");var r=Se.secp256k1.publicFromPrivate(n).toString("hex"),i=yield this.engine.providerManager.addressFromPub(this.networkId,r);return Promise.resolve([{id:"imported--"+X.COINTYPE_ETH+"--"+r,name:t||"",type:Te.AccountType.SIMPLE,path:"",coinType:X.COINTYPE_ETH,pub:r,address:i}])}));return function(t){return e.apply(this,arguments)}}(),O()(n)}(n(3915).KeyringImportedBase);function Be(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=H()(e);if(t){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B()(this,n)}}var Re=function(e){F()(n,e);var t=Be(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=P()((function*(e,t){var n,r=null==(n=e.payload)?void 0:n.encodedTx,i=yield this.getDbAccount();return Q.default.sendTx.info("KeyringWatching > signTransaction >>>>> ",i.address,r),Promise.resolve({txid:"1111",rawTx:"11118888"})}));return function(t,n){return e.apply(this,arguments)}}(),r.prepareAccounts=function(){var e=P()((function*(e){var t=e.name,n=e.target,r=e.accountIdPrefix,i=yield this.engine.providerManager.verifyAddress(this.networkId,n),o=i.normalizedAddress;if(!i.isValid||"undefined"===typeof o)throw new ee.InvalidAddress;return Promise.resolve([{id:r+"--"+X.COINTYPE_ETH+"--"+o,name:t||"",type:Te.AccountType.SIMPLE,path:"",coinType:X.COINTYPE_ETH,pub:"",address:o}])}));return function(t){return e.apply(this,arguments)}}(),O()(n)}(n(3916).KeyringWatchingBase),He=n(2711),Me=["to","value","data","customData","gas","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","nonce"],je=["gas","gasLimit"];function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){x()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=H()(e);if(t){var i=H()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return B()(this,n)}}var Ue,Ge=[q.OnekeyNetwork.optimism,q.OnekeyNetwork.toptimism],Ve=_.abi,We=j.abi,Je=K.abi;function ze(e){var t,n,r,i,o,a;return{feeLimit:null==(t=e.feeLimit)?void 0:t.toFixed(),feePricePerUnit:null==(n=e.feePricePerUnit)?void 0:n.toFixed(),maxPriorityFeePerGas:null==(r=e.payload)||null==(i=r.maxPriorityFeePerGas)?void 0:i.toFixed(),maxFeePerGas:null==(o=e.payload)||null==(a=o.maxFeePerGas)?void 0:a.toFixed()}}!function(e){e.NativeTransfer="NativeTransfer",e.TokenTransfer="TokenTransfer",e.TokenApprove="TokenApprove",e.Swap="Swap",e.NftTransfer="NftTransfer",e.Transaction="Transaction",e.ContractDeploy="ContractDeploy"}(Ue||(Ue={}));var Ye=function(e){F()(n,e);var t=Le(n);function n(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).settings=He.default,e.keyringMap={hd:De,hw:ke,imported:Ce,watching:Re,external:Re},e.decodeTxMemoizee=Object(Z.memoizee)(function(){var t=P()((function*(t,n){return e.decodeTx(t,n)}));return function(e,n){return t.apply(this,arguments)}}(),{promise:!0,primitive:!0,max:1,maxAge:Object(z.getTimeDurationMs)({minute:3})}),e.isContractAddress=Object(Z.memoizee)(function(){var t=P()((function*(t){try{yield e.validateAddress(t);var n=yield e.getJsonRPCClient();return yield n.isContract(t)}catch(r){return Promise.resolve(!1)}}));return function(e){return t.apply(this,arguments)}}(),{promise:!0,max:50}),e}var r=n.prototype;return r.getEthersProvider=function(){var e=P()((function*(){var e,t,n=yield this.getNetwork(),r=n.rpcURL;return this._ethersProvider&&(null==(e=this._ethersProvider)||null==(t=e.connection)?void 0:t.url)===r||(this._ethersProvider=new Ie.ethers.providers.JsonRpcProvider(n.rpcURL)),this._ethersProvider}));return function(){return e.apply(this,arguments)}}(),r.getJsonRPCClient=function(){var e=P()((function*(){return yield this.engine.providerManager.getClient(this.networkId)}));return function(){return e.apply(this,arguments)}}(),r.decodedTxToLegacy=function(e){throw new Error("decodedTxToLegacy in EVM not implemented.")},r.decodeTx=function(){var e=P()((function*(e,t){var n=yield this.legacyDecodeTx(e,t);return yield this.decodedTxLegacyToModern({decodedTxLegacy:n,encodedTx:e,payload:t})}));return function(t,n){return e.apply(this,arguments)}}(),r.decodeBatchTransferTx=function(){var e=P()((function*(e,t,n){var r,i=ye.EVMTxDecoder.getDecoder(this.engine),o=yield this.helper.parseToNativeTx(t);Number.isFinite(o.chainId)||(o.chainId=Number(yield this.getNetworkChainId()));var a=i.parseBatchTransfer(o),c=A()(a,1)[0];if(!c)return null;var d=[],s=yield this.getNetwork(),u=yield this.getAccountAddress();switch(c.name){case"disperseEther":for(var f=c.args[0],l=c.args[1],p=yield this.engine.getNativeTokenInfo(this.networkId),b=0;b<f.length;b+=1)d.push({type:fe.IDecodedTxActionType.NATIVE_TRANSFER,direction:yield this.buildTxActionDirection({from:t.from,to:f[b],address:u}),nativeTransfer:yield this.buildNativeTransferAction({fromAddress:t.from,toAddress:f[b],amount:new U.a(l[b].toString()).shiftedBy(-p.decimals).toFixed(),value:l[b].toString()})});break;case"disperseToken":case"disperseTokenSimple":var y=c.args[0],h=c.args[1],v=c.args[2],m=yield this.engine.ensureTokenInDB(this.networkId,y);if(!m)break;for(var g=0;g<h.length;g+=1)d.push({type:fe.IDecodedTxActionType.TOKEN_TRANSFER,direction:yield this.buildTxActionDirection({from:t.from,to:h[g],address:u}),tokenTransfer:yield this.buildTokenTransferAction({info:{token:m,from:t.from,recipient:h[g],amount:new U.a(v[g].toString()).shiftedBy(-m.decimals).toFixed(),amountValue:v[g].toString()}})});break;case"disperseNFT":for(var w=c.args[0],T=c.args[1],x=c.args[2],I=c.args[3],E=0;E<I.length;E+=1){var P,k=(null==n||null==(P=n.nftInfos)?void 0:P[E].asset)||(yield Object(re.getAsset)({accountId:this.accountId,networkId:this.networkId,contractAddress:T[E],tokenId:new U.a(x[E].toString()).toFixed(),local:!0}));k&&d.push({type:fe.IDecodedTxActionType.NFT_TRANSFER,direction:yield this.buildTxActionDirection({from:t.from,to:w,address:u}),nftTransfer:yield this.buildNFTTransferAcion({asset:k,amount:new U.a(I[E].toString()).toFixed(),from:t.from,to:w})})}break;default:return null}var O,N=e.gasInfo,D=new U.a(N.gasLimit).toFixed();return O=N.maxFeePerGas?{eip1559:!0,limit:D,price1559:{baseFee:"0",maxPriorityFeePerGas:new U.a(N.maxPriorityFeePerGas).shiftedBy(-s.feeDecimals).toFixed(),maxPriorityFeePerGasValue:N.maxPriorityFeePerGas,maxFeePerGas:new U.a(N.maxFeePerGas).shiftedBy(-s.feeDecimals).toFixed(),maxFeePerGasValue:N.maxFeePerGas,gasPrice:new U.a(N.gasPrice||N.maxFeePerGas).shiftedBy(-s.feeDecimals).toFixed(),gasPriceValue:N.gasPrice||N.maxFeePerGas}}:{limit:D,price:new U.a(N.gasPrice).shiftedBy(-s.feeDecimals).toFixed(),priceValue:N.gasPrice},{txid:e.txHash,owner:u,signer:t.from||u,nonce:new U.a(null!=(r=t.nonce)?r:0).toNumber(),actions:[].concat(d),status:fe.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,encodedTx:t,feeInfo:O,payload:n,extraInfo:null}}));return function(t,n,r){return e.apply(this,arguments)}}(),r.legacyDecodeTx=function(){var e=P()((function*(e,t){var n=yield this.helper.parseToNativeTx(e);return Number.isFinite(n.chainId)||(n.chainId=Number(yield this.getNetworkChainId())),ye.EVMTxDecoder.getDecoder(this.engine).decodeTx({vault:this,rawTx:n,payload:t})}));return function(t,n){return e.apply(this,arguments)}}(),r.decodedTxLegacyToModern=function(){var e=P()((function*(e){var t=e.decodedTxLegacy,n=e.encodedTx,r=e.payload,i=e.interactInfo;if(n.to===ie.batchTransferContractAddress[this.networkId]){var o=yield this.decodeBatchTransferTx(t,n,r);if(o)return o}var a,c=yield this.getAccountAddress(),d=yield this.getNetwork(),s=yield this.engine.getNativeTokenInfo(this.networkId),u={type:fe.IDecodedTxActionType.UNKNOWN,direction:yield this.buildTxActionDirection({from:t.fromAddress,to:t.toAddress,address:c}),unknownAction:{extraInfo:{}}};if(n.value){var f=new U.a(n.value);!f.isNaN()&&f.gt(0)&&(a={type:fe.IDecodedTxActionType.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:n.from||t.fromAddress,to:n.to,amount:f.shiftedBy(-d.decimals).toFixed(),amountValue:f.toFixed(),extraInfo:null}})}if(t.txType===ye.EVMDecodedTxType.NATIVE_TRANSFER&&(u.type=fe.IDecodedTxActionType.NATIVE_TRANSFER,u.nativeTransfer=yield this.buildNativeTransferAction(t),a=void 0),t.txType===ye.EVMDecodedTxType.TOKEN_TRANSFER&&(u.type=fe.IDecodedTxActionType.TOKEN_TRANSFER,u.tokenTransfer=yield this.buildTokenTransferAction(t)),t.txType===ye.EVMDecodedTxType.TOKEN_APPROVE){var l,p=t.info;u.type=fe.IDecodedTxActionType.TOKEN_APPROVE,u.tokenApprove={tokenInfo:p.token,owner:null!=(l=n.from)?l:c,spender:p.spender,amount:p.amount,amountValue:p.value,isMax:p.isUInt256Max,extraInfo:null}}if(t.txType===ye.EVMDecodedTxType.ERC721_TRANSFER||t.txType===ye.EVMDecodedTxType.ERC1155_TRANSFER){var b=null;if(null!=r&&r.nftInfo)b=null==r?void 0:r.nftInfo;else if(t.contractCallInfo){var y=t.contractCallInfo,h=y.args||[],v=A()(h,4),m=v[0],g=v[1],w=v[2],T=v[3],x=yield Object(re.getAsset)({accountId:this.accountId,networkId:this.networkId,contractAddress:y.contractAddress,tokenId:w,local:!0});x&&(b={from:m,to:g,amount:new U.a(T).toFixed(),asset:x})}b&&(u.type=fe.IDecodedTxActionType.NFT_TRANSFER,u.nftTransfer=yield this.buildNFTTransferAcion(b))}"InternalSwap"===(null==r?void 0:r.type)&&null!=r&&r.swapInfo&&(u.internalSwap=_e(_e({},r.swapInfo),{},{extraInfo:null}),u.type=fe.IDecodedTxActionType.INTERNAL_SWAP,a=void 0),"InternalStake"===(null==r?void 0:r.type)&&null!=r&&r.stakeInfo&&(u.internalStake=_e(_e({},r.stakeInfo),{},{extraInfo:null}),u.type=fe.IDecodedTxActionType.INTERNAL_STAKE,a=void 0);var I,E=t.gasInfo,P=new U.a(E.gasLimit).toFixed();return I=E.maxFeePerGas?{eip1559:!0,limit:P,price1559:{baseFee:"0",maxPriorityFeePerGas:new U.a(E.maxPriorityFeePerGas).shiftedBy(-d.feeDecimals).toFixed(),maxPriorityFeePerGasValue:E.maxPriorityFeePerGas,maxFeePerGas:new U.a(E.maxFeePerGas).shiftedBy(-d.feeDecimals).toFixed(),maxFeePerGasValue:E.maxFeePerGas,gasPrice:new U.a(E.gasPrice||E.maxFeePerGas).shiftedBy(-d.feeDecimals).toFixed(),gasPriceValue:E.gasPrice||E.maxFeePerGas}}:{limit:P,price:new U.a(E.gasPrice).shiftedBy(-d.feeDecimals).toFixed(),priceValue:E.gasPrice},{txid:t.txHash,owner:c,signer:t.fromAddress,nonce:t.nonce||0,actions:[u,a].filter(Boolean),status:fe.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,encodedTx:n,payload:r,feeInfo:I,interactInfo:i,extraInfo:{}}}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxFromTransfer=function(){var e=P()((function*(e){if(!e.to)throw new Error("Invalid transferInfo.to params");var t=yield this.getNetwork(),n=Boolean(e.token),r=e.amount,i=e.nftTokenId,o=e.isNFT,a=e.nftType,c=new U.a(r);if(c.isNaN()&&(c=new U.a("0")),n){var d,s;if(o&&a&&i){var u,f=Object(re.buildEncodeDataWithABI)({type:a,from:e.from,to:e.to,id:i,amount:c.toFixed()});return{from:e.from,to:null!=(u=e.token)?u:"",value:"0x0",data:f}}var l=yield this.engine.ensureTokenInDB(this.networkId,null!=(d=e.token)?d:"");if(!l)throw new Error("Token not found: "+e.token);var p=Object($.toBigIntHex)(c.shiftedBy(l.decimals)),b=""+be.Erc20MethodSelectors.tokenTransfer+M.defaultAbiCoder.encode(["address","uint256"],[e.to,p]).slice(2);return{from:e.from,to:null!=(s=e.token)?s:"",value:"0x0",data:b}}var y=Object($.toBigIntHex)(c.shiftedBy(t.decimals));return{from:e.from,to:e.to,value:y,data:"0x"}}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxFromBatchTransfer=function(){var e=P()((function*(e){var t,n,r,i=e.transferInfos,o=e.prevNonce,a=yield this.getNetwork(),c=yield this.getDbAccount(),d=i[0],s=Boolean(d.token),u=d.nftTokenId,f=d.isNFT,l=d.nftType,p=void 0!==o?o+1:yield this.getNextNonce(a.id,c),b=ie.batchTransferContractAddress[a.id];if(!b)throw new Error(a.name+" has not deployed a batch transfer contract");var y=new U.a(0);if(s)if(f&&l&&u)t=ae.BatchTransferSelectors.disperseNFT,n=["address","address[]","uint256[]","uint256[]"],r=[d.to].concat(w()(m()(i,(function(e,t){return e[0].push(t.token||""),e[1].push(t.nftTokenId||""),e[2].push(new U.a("erc1155"===t.nftType?t.amount:0).toFixed()),e}),[[],[],[]])));else{var h,v=yield this.engine.ensureTokenInDB(this.networkId,null!=(h=d.token)?h:"");if(!v)throw new Error("Token not found: "+d.token);t=ae.BatchTransferSelectors.disperseTokenSimple,n=["address","address[]","uint256[]"],r=[v.tokenIdOnNetwork].concat(w()(m()(i,(function(e,t){var n=new U.a(t.amount);return e[0].push(t.to),e[1].push(Object($.toBigIntHex)(n.shiftedBy(v.decimals))),e}),[[],[]])))}else t=ae.BatchTransferSelectors.disperseEther,n=["address[]","uint256[]"],r=m()(i,(function(e,t){var n=new U.a(t.amount).shiftedBy(a.decimals);return y=y.plus(n),e[0].push(t.to),e[1].push(n.toFixed()),e}),[[],[]]);return{from:d.from,to:b,data:""+t+M.defaultAbiCoder.encode(n,r).slice(2),value:s?"0x0":Object($.toBigIntHex)(y),nonce:String(p)}}));return function(t){return e.apply(this,arguments)}}(),r.buildEncodedTxFromWrapperTokenDeposit=function(e){var t=e.amount,n=e.from,r=e.contract,i=be.WrapperTokenMethodSelectors.doposit,o=new U.a(t),a=Object($.toBigIntHex)(o.shiftedBy(18));return{from:n,to:r,value:a,data:""+i+M.defaultAbiCoder.encode(["uint256"],[a]).slice(2)}},r.buildEncodedTxFromWrapperTokenWithdraw=function(e){var t=e.amount,n=e.from,r=e.contract,i=be.WrapperTokenMethodSelectors.withdraw,o=new U.a(t),a=Object($.toBigIntHex)(o.shiftedBy(18));return{from:n,to:r,value:"0x0",data:""+i+M.defaultAbiCoder.encode(["uint256"],[a]).slice(2)}},r.buildEncodedTxFromApprove=function(){var e=P()((function*(e,t){var n=yield Promise.all([this.getNetwork(),this.engine.ensureTokenInDB(this.networkId,e.token),this.validateAddress(e.spender),this.getDbAccount()]),r=A()(n,4),i=r[0],o=r[1],a=r[2],c=r[3];if("undefined"===typeof o)throw new Error("Token not found: "+e.token);var d=void 0!==t?t+1:yield this.getNextNonce(i.id,c),s=new U.a(e.amount),u=Object($.toBigIntHex)(s.isNaN()?new U.a(2).pow(256).minus(1):s.shiftedBy(o.decimals)),f=""+be.Erc20MethodSelectors.tokenApprove+M.defaultAbiCoder.encode(["address","uint256"],[a,u]).slice(2);return{from:e.from,to:e.token,value:"0x0",data:f,nonce:String(d)}}));return function(t,n){return e.apply(this,arguments)}}(),r.buildEncodedTxsFromSetApproveForAll=function(){var e=P()((function*(e,t){var n=yield this.getNetwork(),r=yield this.getDbAccount(),i=void 0!==t?t+1:yield this.getNextNonce(n.id,r),o=e.map((function(e,t){return{from:e.from,to:e.to,data:""+("erc1155"===e.type?be.Erc1155MethodSelectors.setApprovalForAll:be.Erc721MethodSelectors.setApprovalForAll)+M.defaultAbiCoder.encode(["address","bool"],[e.spender,e.approved]).slice(2),value:"0x0",nonce:i+t}}));return Promise.resolve(o)}));return function(t,n){return e.apply(this,arguments)}}(),r.getReadProvider=function(){var e=P()((function*(){var e=yield Y.default.getModule(),t=yield this.getEthersProvider();if(t)return new e.MulticallProvider(t,{verbose:!0})}));return function(){return e.apply(this,arguments)}}(),r.checkIsUnlimitedAllowance=function(){var e=P()((function*(e){var t=e.owner,n=e.spender,r=e.token;try{var i,o=yield this.getReadProvider(),a=new G.Contract(r,Je,o),c=yield a.functions.allowance(t,n),d=String(yield c[0]),s=yield a.functions.totalSupply(),u=null==s||null==(i=s[0])||null==i.toString?void 0:i.toString();return{isUnlimited:new U.a(d).gt(new U.a(u)),allowance:d}}catch(f){return{isUnlimited:!1,allowance:0}}}));return function(t){return e.apply(this,arguments)}}(),r.checkIsApprovedForAll=function(){var e=P()((function*(e){var t=e.owner,n=e.spender,r=e.token,i=e.type;try{var o=yield this.getReadProvider(),a=new G.Contract(r,"erc1155"===i?We:Ve,o),c=yield a.functions.isApprovedForAll(t,n);return A()(c,1)[0]}catch(d){return!1}}));return function(t){return e.apply(this,arguments)}}(),r.checkIsBatchTransfer=function(){var e=P()((function*(e){return Promise.resolve(e.to===ie.batchTransferContractAddress[this.networkId])}));return function(t){return e.apply(this,arguments)}}(),r.updateEncodedTx=function(){var e=P()((function*(e,t,n){if(n.type===fe.IEncodedTxUpdateType.tokenApprove){var r=t;return this.updateEncodedTxTokenApprove(e,r.amount)}return n.type===fe.IEncodedTxUpdateType.transfer?this.updateEncodedTxTransfer(e,t):n.type===fe.IEncodedTxUpdateType.advancedSettings?this.updateEncodedTxAdvancedSettings(e,t):n.type===fe.IEncodedTxUpdateType.customData?this.updateEncodedTxCustomData(e,t):Promise.resolve(e)}));return function(t,n,r){return e.apply(this,arguments)}}(),r.updateEncodedTxCustomData=function(){var e=P()((function*(e,t){return e.customData=t,Promise.resolve(e)}));return function(t,n){return e.apply(this,arguments)}}(),r.updateEncodedTxAdvancedSettings=function(){var e=P()((function*(e,t){return this.settings.nonceEditable&&t.currentNonce&&(e.nonce=t.currentNonce),!this.settings.hexDataEditable||h()(t.currentHexData)||e.data&&"0x"!==e.data||e.data===t.currentHexData||(e.data=t.currentHexData),Promise.resolve(e)}));return function(t,n){return e.apply(this,arguments)}}(),r.updateEncodedTxTransfer=function(){var e=P()((function*(e,t){var n=yield this.legacyDecodeTx(e),r=t.amount,i=new U.a(r);if(n.txType===ye.EVMDecodedTxType.NATIVE_TRANSFER){var o=yield this.getNetwork();e.value=Object($.toBigIntHex)(i.dp(U.a.min(i.decimalPlaces()-2,o.decimals-2).toNumber(),U.a.ROUND_FLOOR).shiftedBy(o.decimals))}if(n.txType===ye.EVMDecodedTxType.TOKEN_TRANSFER){var a=n.info,c=Object($.toBigIntHex)(i.shiftedBy(a.token.decimals)),d=""+be.Erc20MethodSelectors.tokenTransfer+M.defaultAbiCoder.encode(["address","uint256"],[a.recipient,c]).slice(2);e.data=d}return e}));return function(t,n){return e.apply(this,arguments)}}(),r.updateEncodedTxTokenApprove=function(){var e=P()((function*(e,t){var n=be.Erc20MethodSelectors.tokenApprove,r=yield this.legacyDecodeTx(e);if(r.txType!==ye.EVMDecodedTxType.TOKEN_APPROVE)throw new Error("Not a approve transaction.");var i,o=r.info,a=o.token,c=o.spender;if(t===ye.InfiniteAmountText||t===ye.InfiniteAmountHex)i=ye.InfiniteAmountHex;else{var d=new U.a(t);if(d.isNaN())throw new Error("Invalid amount input: "+t);i=Object($.toBigIntHex)(d.shiftedBy(a.decimals))}var s=""+n+M.defaultAbiCoder.encode(["address","uint256"],[c,i]).slice(2);return _e(_e({},e),{},{data:s})}));return function(t,n){return e.apply(this,arguments)}}(),r.buildUnsignedTxFromEncodedTx=function(){var e=P()((function*(e){var t=yield this.getNetwork(),n=yield this.getDbAccount(),r=e.to,i=e.value,o=e.data,a=e.customData,c=e.gas,d=e.gasLimit,s=e.gasPrice,u=e.maxFeePerGas,f=e.maxPriorityFeePerGas,l=e.nonce,p=b()(e,Me);Q.default.sendTx.info("buildUnsignedTxFromEncodedTx >>>> encodedTx",e);var y=null!=d?d:c,v=new U.a(null!=l?l:"NaN"),m=v.isNaN()?yield this.getNextNonce(t.id,n):v.toNumber(),g=Object(oe.fillUnsignedTxObj)({shiftFeeDecimals:!1,network:t,dbAccount:n,to:r,valueOnChain:i,extra:_e({data:o,customData:a,feeLimit:h()(y)?void 0:new U.a(y),feePricePerUnit:h()(s)?void 0:new U.a(s),maxFeePerGas:u,maxPriorityFeePerGas:f,nonce:m},p)});Q.default.sendTx.info("buildUnsignedTxFromEncodedTx >>>> fillUnsignedTx",g,ze(g));var w=yield this.engine.providerManager.buildUnsignedTx(this.networkId,g);return Q.default.sendTx.info("buildUnsignedTxFromEncodedTx >>>> buildUnsignedTx",w,ze(w)),e.nonce=m,_e(_e({},w),{},{encodedTx:e})}));return function(t){return e.apply(this,arguments)}}(),r._toNormalAmount=function(e,t){var n=Ie.ethers.BigNumber.from(e);return Ie.ethers.utils.formatUnits(n,t)},r.fetchFeeInfo=function(){var e=P()((function*(e){var t,n,r,i,o,a,c,d,s,f,p=_e(_e({},e),{},{nonce:1,gasPrice:"1"}),y=p.gas,v=p.gasLimit,m=b()(p,je),g=yield this.getNetwork(),w=yield this.engine.getGasInfo(this.networkId),T=w.prices,x=w.networkCongestion,I=w.estimatedTransactionCount;5===T.length&&(T=T.slice(1,4));var A=null==(t=this.settings.subNetworkSettings)?void 0:t[this.networkId];null!=A&&A.isIntegerGasPrice&&(T=T.map((function(e){return l()(e)?new U.a(e).toFixed(0):e})));var E,P=(yield this.decodeTxMemoizee(e)).actions;if(1===P.length&&(null==P||null==(n=P[0])?void 0:n.type)===fe.IDecodedTxActionType.NATIVE_TRANSFER)try{E=yield this.buildUnsignedTxFromEncodedTx(_e(_e({},m),{},{value:this.networkId===q.OnekeyNetwork.fevm?"0x1":"0x0"}))}catch(_){}if("undefined"===typeof E)try{E=yield this.buildUnsignedTxFromEncodedTx(m)}catch(L){throw Q.default.common.error(L),L}var k="0";if(Ge.includes(this.networkId)){var O,N,D=Ie.ethers.utils.serializeTransaction({value:e.value,data:e.data,gasLimit:"0x"+(null!=(O=null==(N=E)?void 0:N.feeLimit)?O:new U.a("0")).toString(16),to:e.to,chainId:10,gasPrice:"0xf4240",nonce:1}),S="0x49948e0e"+M.defaultAbiCoder.encode(["bytes"],[D]).slice(2),F=yield this.getJsonRPCClient(),C=yield F.rpc.call("eth_call",[{to:"0x420000000000000000000000000000000000000F",data:S},"latest"]);k=new U.a(C).shiftedBy(-g.feeDecimals).toFixed()}var B=Boolean((null==(r=T)?void 0:r.length)&&(null==(i=T)?void 0:i.every((function(e){return"object"===typeof e})))),R=new U.a(null!=(o=null!=(a=e.gas)?a:e.gasLimit)?o:0).toFixed(),H=e.gasPrice?this._toNormalAmount(e.gasPrice,g.feeDecimals):void 0;B&&(H=u()(_e({},T[0]),{maxPriorityFeePerGas:e.maxPriorityFeePerGas?this._toNormalAmount(e.maxPriorityFeePerGas,g.feeDecimals):void 0,maxFeePerGas:e.maxFeePerGas?this._toNormalAmount(e.maxFeePerGas,g.feeDecimals):void 0}));var j=U.a.max(null!=(c=null==(d=E)?void 0:d.feeLimit)?c:"0",null!=y?y:"0",null!=v?v:"0").toFixed(),K=h()(null==(s=E)?void 0:s.feeLimitForDisplay)?void 0:new U.a(null==(f=E)?void 0:f.feeLimitForDisplay).toFixed();return{nativeSymbol:g.symbol,nativeDecimals:g.decimals,feeSymbol:g.feeSymbol,feeDecimals:g.feeDecimals,eip1559:B,limit:j,limitForDisplay:K,prices:T,defaultPresetIndex:"1",tx:_e({eip1559:B,limit:R},B?{price1559:H}:{price:H}),baseFeeValue:k,extraInfo:{networkCongestion:x,estimatedTransactionCount:I}}}));return function(t){return e.apply(this,arguments)}}(),r.attachFeeInfoToEncodedTx=function(){var e=P()((function*(e){var t=yield this.getNetwork(),n=e.encodedTx,r=e.feeInfoValue,i=_e({},n);if(h()(r.limit)||(i.gas=Object($.toBigIntHex)(new U.a(r.limit)),i.gasLimit=Object($.toBigIntHex)(new U.a(r.limit))),r.eip1559){if(!h()(r.price1559)){var o,a,c=r.price1559;i.maxFeePerGas=Object($.toBigIntHex)(new U.a(null!=(o=null==c?void 0:c.maxFeePerGas)?o:0).shiftedBy(t.feeDecimals)),i.maxPriorityFeePerGas=Object($.toBigIntHex)(new U.a(null!=(a=null==c?void 0:c.maxPriorityFeePerGas)?a:0).shiftedBy(t.feeDecimals)),delete i.gasPrice}}else h()(r.price)||(i.gasPrice=Object($.toBigIntHex)(new U.a(r.price).shiftedBy(t.feeDecimals)));return Promise.resolve(i)}));return function(t){return e.apply(this,arguments)}}(),r.mmGetPublicKey=function(){var e=P()((function*(e){var t=yield this.getDbAccount();if(t.id.startsWith("hd-")||t.id.startsWith("imported")){var n=this.keyring,r=e.password;if("undefined"===typeof r)throw new ee.OneKeyInternalError("password required");var i=(yield n.getSigners(r,[t.address]))[t.address];return this.engineProvider.mmGetPublicKey(i)}throw new ee.NotImplemented("Only software keryings support getting encryption key.")}));return function(t){return e.apply(this,arguments)}}(),r.mmDecrypt=function(){var e=P()((function*(e,t){var n=yield this.getDbAccount();if(n.id.startsWith("hd-")||n.id.startsWith("imported")){var r=this.keyring,i=t.password;if("undefined"===typeof i)throw new ee.OneKeyInternalError("password required");var o=(yield r.getSigners(i,[n.address]))[n.address];return this.engineProvider.mmDecrypt(e,o)}throw new ee.NotImplemented("Only software keryings support mm decryption.")}));return function(t,n){return e.apply(this,arguments)}}(),r.personalECRecover=function(){var e=P()((function*(e,t){return this.engineProvider.ecRecover({type:de.ETHMessageTypes.PERSONAL_SIGN,message:e},t)}));return function(t,n){return e.apply(this,arguments)}}(),r.getTokenAllowance=function(){var e=P()((function*(e,t){var n=yield Promise.all([this.getDbAccount(),this.engine.ensureTokenInDB(this.networkId,e)]),r=A()(n,2),i=r[0],o=r[1];if("undefined"===typeof o)throw new Error;var a="0xdd62ed3e"+M.defaultAbiCoder.encode(["address","address"],[i.address,t]).slice(2),c=yield this.getJsonRPCClient(),d=yield c.rpc.call("eth_call",[{to:o.tokenIdOnNetwork,data:a},"latest"]);return new U.a(d).shiftedBy(-o.decimals)}));return function(t,n){return e.apply(this,arguments)}}(),r.batchTokensAllowance=function(){var e=P()((function*(e,t){for(var n=[],r=0;r<t.length;r+=1){var i=t[r],o=yield Promise.all([this.getDbAccount(),this.engine.ensureTokenInDB(this.networkId,e)]),a=A()(o,2),c=a[0],d=a[1];if("undefined"===typeof d)throw new Error;var s="0xdd62ed3e"+M.defaultAbiCoder.encode(["address","address"],[c.address,i]).slice(2);n.push({to:d.tokenIdOnNetwork,data:s})}var u=yield this.getJsonRPCClient();return(yield u.batchEthCall(n)).map((function(e){return Number(e)}))}));return function(t,n){return e.apply(this,arguments)}}(),r.getOutputAccount=function(){var e=P()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,displayAddress:Ie.ethers.utils.getAddress(e.address),template:e.template}}));return function(){return e.apply(this,arguments)}}(),r.getDisplayAddress=function(e){return Promise.resolve(Ie.ethers.utils.getAddress(e))},r.getExportedCredential=function(){var e=P()((function*(e){var t=yield this.getDbAccount();if(t.id.startsWith("hd-")||t.id.startsWith("imported")){var n=this.keyring,r=Object.values(yield n.getPrivateKeys(e)),i=A()(r,1)[0];return"0x"+Object(W.decrypt)(e,i).toString("hex")}throw new ee.OneKeyInternalError("Only credential of HD or imported accounts can be exported")}));return function(t){return e.apply(this,arguments)}}(),r.buildNativeTransferAction=function(){var e=P()((function*(e){return{tokenInfo:yield this.engine.getNativeTokenInfo(this.networkId),from:e.fromAddress,to:e.toAddress,amount:e.amount,amountValue:e.value,extraInfo:null}}));return function(t){return e.apply(this,arguments)}}(),r.buildTokenTransferAction=function(){var e=P()((function*(e){var t,n=yield this.getAccountAddress(),r=e.info;return{tokenInfo:r.token,from:null!=(t=r.from)?t:n,to:r.recipient,amount:r.amount,amountValue:r.value,extraInfo:null}}));return function(t){return e.apply(this,arguments)}}(),r.buildNFTTransferAcion=function(){var e=P()((function*(e){return Promise.resolve({asset:e.asset,amount:e.amount,send:e.from,receive:e.to,extraInfo:null})}));return function(t){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=P()((function*(e){var t=yield this.getJsonRPCClient();try{return yield t.rpc.call(e.method,e.params)}catch(n){throw Object(oe.extractResponseError)(n)}}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){return new V.Geth(e)},r.fetchTokenInfos=function(e){return this.engine.providerManager.getTokenInfos(this.networkId,e)},r.getAccountNonce=function(){var e=P()((function*(){return yield Object(he.getTxCount)(yield this.getAccountAddress(),this)}));return function(){return e.apply(this,arguments)}}(),r.updatePendingTxs=function(){var e=P()((function*(e){var t=ye.EVMTxDecoder.getDecoder(this.engine),n=e.filter((function(e){return"rawTx"in e})).filter((function(e){return e.status===ce.HistoryEntryStatus.PENDING})).map(function(){var e=P()((function*(e){return{entry:e,decodedItem:yield t.decodeHistoryEntry(e)}}));return function(t){return e.apply(this,arguments)}}());if(!n.length)return{};var r=yield Promise.all(n),i=yield this.getTransactionStatuses(r.map((function(e){return e.decodedItem.txHash}))),o=r[0].decodedItem.fromAddress,a=yield Object(he.getTxCount)(o,this),c={};return i.forEach((function(e,t){var n=r[t],i=n.entry,o=n.decodedItem,d=i.id,s=o.nonce;e===J.TransactionStatus.NOT_FOUND||e===J.TransactionStatus.INVALID?!h()(s)&&s<a&&(c[d]=ce.HistoryEntryStatus.DROPPED):e===J.TransactionStatus.CONFIRM_AND_SUCCESS?c[d]=ce.HistoryEntryStatus.SUCCESS:e===J.TransactionStatus.CONFIRM_BUT_FAILED&&(c[d]=ce.HistoryEntryStatus.FAILED)})),Object.keys(c).length>0&&(yield this.engine.dbApi.updateHistoryEntryStatuses(c)),c}));return function(t){return e.apply(this,arguments)}}(),r.mergeDecodedTx=function(){var e=P()((function*(e){var t,n=e.decodedTx,r=(e.encodedTx,e.historyTx),i=(e.rawTx,e.covalentTx),o=(e.rpcReceiptTx,e.nftTxs),a=e.isCovalentApiAvailable,c=yield this.getNetwork();r&&(n=_e(_e({},r.decodedTx),{},{encodedTx:null!=(t=n.encodedTx)?t:r.decodedTx.encodedTx}));if(i){var d,s,u=new Date(i.block_signed_at).getTime();n.updatedAt=u,n.createdAt=null!=(d=n.createdAt)?d:u,n.status=i.successful?fe.IDecodedTxStatus.Confirmed:fe.IDecodedTxStatus.Failed,n.signer=i.from_address||n.signer,n.outputActions=(null==(s=i.parsedDecodedTx)?void 0:s.outputActions)||n.outputActions;var f=new U.a(i.gas_price).toFixed(),l=Object(le.convertFeeValueToGwei)({value:f,network:c}),p=new U.a(i.gas_offered).toFixed(),b=new U.a(i.gas_spent).toFixed(),y={priceValue:f,price:l,limit:p,limitUsed:b};if(n.feeInfo=n.feeInfo||y,n&&n.feeInfo&&(n.feeInfo.limitUsed=b,n.feeInfo.limit=p,n.feeInfo.eip1559)){var h=n.feeInfo.price1559;h.gasPrice=l,h.gasPriceValue=f}n.isFinal=!0}n.status!==fe.IDecodedTxStatus.Pending&&(a||n.createdAt&&Date.now()-n.createdAt>X.HISTORY_CONSTS.SET_IS_FINAL_EXPIRED_IN&&(n.isFinal=!0));var v=yield this.getAccountAddress();return n=this.mergeNFTTx({address:v,decodedTx:n,nftTxs:o}),Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.mergeNFTTx=function(e){var t=e.address,n=e.decodedTx,r=e.nftTxs;if(r){var i,o=r.map((function(e){return Object(re.createOutputActionFromNFTTransaction)({transaction:e,address:t})})).filter(Boolean),a=null!=(i=n.outputActions)?i:[],c=null==a?void 0:a.filter((function(e){var t=e.tokenTransfer,n=e.tokenApprove,i=e.nftTransfer;if(t||n||i){var o,a=null!=(o=null==t?void 0:t.tokenInfo)?o:null==n?void 0:n.tokenInfo,c=null==i?void 0:i.asset;if(a){var d=a.tokenIdOnNetwork,s=a.id;if(r.find((function(e){return e.contractAddress===d&&e.tokenId===s})))return!1}if(c)if(r.find((function(e){return(e.contractAddress===c.contractAddress||e.tokenAddress===c.tokenAddress)&&(e.tokenId===c.tokenId||e.contractTokenId===c.contractTokenId)})))return!1}return!0}));n.outputActions=[].concat(w()(c),w()(o))}return n},r.fetchOnChainHistory=function(){var e=P()((function*(e){var t=this,n=e.tokenIdOnNetwork,r=e.localHistory,i=void 0===r?[]:r,o=i.filter((function(e){return e.decodedTx.isFinal})).map((function(e){return e.decodedTx.txid})),a=yield this.getNetworkChainId(),c=yield this.getAccountAddress(),s=yield this.getJsonRPCClient(),u=[],f=[],p=!1;try{var b=yield te.fetchCovalentHistoryRaw({chainId:a,address:c,contract:n});p=!0,u=(f=b.data.items).map((function(e){return e.tx_hash}))}catch(m){u=i.filter((function(e){return!!e.isLocalCreated})).map((function(e){return e.decodedTx.txid}))}var y=(u=(u=d()(u,o)).filter(Boolean)).map((function(e){return["eth_getTransactionByHash",[e]]})),h=[];if(y.length)try{h=yield s.rpc.batchCall(y)}catch(m){}var v=yield Object(re.getNFTTransactionHistory)(c,this.networkId);return(yield Promise.all(u.map(function(){var e=P()((function*(e,r){var o,a,d,s,u=h.find((function(t){return(null==t?void 0:t.hash)===e})),b=Boolean(u);u&&b&&u.input&&!u.data&&(u.data=u.input);var y,g=i.find((function(t){return t.decodedTx.txid===e}));if(null!=g&&null!=(o=g.decodedTx)&&o.isFinal)return null;(u=u||(null==g||null==(a=g.decodedTx)?void 0:a.encodedTx))&&(l()(u.nonce)&&(u.nonce=null!=(y=new U.a(u.nonce).toNumber())?y:0));var w=f.find((function(t){return t.tx_hash===e}));w&&(w=yield te.parseCovalentTxToDecodedTx({covalentTx:w,address:c,vault:t,encodedTx:u}));var T=null==(d=w)?void 0:d.parsedDecodedTx;if(!T&&null!=(s=w)&&s.onlyInvolvedInDelegateVotesChanged)return null;if(u)try{T=yield t.decodeTx(u,null)}catch(m){}if(!T)return null;var x=v[e];return(T=yield t.mergeDecodedTx({decodedTx:T,encodedTx:u,historyTx:g,covalentTx:w,nftTxs:x,isCovalentApiAvailable:p})).tokenIdOnNetwork=n,t.buildHistoryTx({decodedTx:T,encodedTx:u,historyTxToMerge:g})}));return function(t,n){return e.apply(this,arguments)}}()))).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),r.checkIsScamHistoryTx=function(){var e=P()((function*(e){try{var t=e.decodedTx,n=t.encodedTx,r=null==n?void 0:n.from.toLowerCase(),i=null==n?void 0:n.to.toLowerCase(),o=(yield this.getAccountAddress()).toLocaleLowerCase();if(r===o||i===o)return!1;for(var a=t.outputActions||t.actions,c=0;c<a.length;c+=1){var d,s,u,f,l=a[c];if(l.type!==fe.IDecodedTxActionType.TOKEN_TRANSFER)return!1;if(l.type===fe.IDecodedTxActionType.TOKEN_TRANSFER&&null!=(d=l.tokenTransfer)&&d.amount&&!new U.a(null==(s=l.tokenTransfer)?void 0:s.amount).isZero()){var p,b=yield this.getNetworkImpl(),y=null!=(p=X.UNIQUE_TOKEN_SYMBOLS[b])?p:[],h=l.tokenTransfer.tokenInfo;return!!(y.includes(h.symbol.toUpperCase())&&h.riskLevel&&h.riskLevel>ue.TokenRiskLevel.WARN)}if(l.type===fe.IDecodedTxActionType.TOKEN_TRANSFER&&null!=(u=l.tokenTransfer)&&u.amount&&new U.a(null==(f=l.tokenTransfer)?void 0:f.amount).isZero()&&[l.tokenTransfer.from.toLocaleLowerCase(),l.tokenTransfer.to.toLocaleLowerCase()].includes(r))return!1}return!0}catch(v){return!1}}));return function(t){return e.apply(this,arguments)}}(),r.fixAddressCase=function(e){return Promise.resolve(a()(e||""))},r.getAccountNameInfoMap=function(){var e=P()((function*(){var e=yield this.getNetwork(),t=Object(ne.getAccountNameInfoByImpl)(e.impl);return e.id!==q.OnekeyNetwork.etc&&(t=i()(t,"etcNative")),t}));return function(){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=P()((function*(e){var t=e.accounts;return e.networkId!==q.OnekeyNetwork.etc?t.filter((function(e){return e.coinType!==X.COINTYPE_ETC})):Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(e){var t=e.previousNetwork,n=e.newNetwork,r=e.activeAccountId,i=(null==t?void 0:t.id)===q.OnekeyNetwork.etc,o=(null==n?void 0:n.id)===q.OnekeyNetwork.etc,a=(null==n?void 0:n.impl)===X.IMPL_EVM&&!o,c=(null==t?void 0:t.impl)===X.IMPL_EVM&&!i,d=null==r?void 0:r.indexOf("m/44'/61'/0'/"),s=i&&a&&!!d;return Promise.resolve({shouldChangeActiveAccount:s,shouldReloadAccountList:!s&&(o&&c)})},r.canAutoCreateNextAccount=function(){var e=P()((function*(e){return Promise.resolve(!0)}));return function(t){return e.apply(this,arguments)}}(),r.checkRpcBatchSupport=function(){var e=P()((function*(e){var t,r=yield this.getJsonRPCClient(),i=performance.now();try{var o=yield r.rpc.batchCall([["eth_getBlockByNumber",["latest",!1]],["eth_getBalance",["0xf44371ccc370662734cfc4b78b1beadf7012bc5d","latest"]],["eth_gasPrice",[]]],void 0,void 0,!0,!1),a=parseInt(o[0].number);if(Number.isNaN(a)||"string"!==typeof o[1]||"string"!==typeof o[2])throw new Error("[evm.getClientEndpointStatus] Invalid response "+JSON.stringify(o));t={rpcBatchSupported:!0,responseTime:Math.floor(performance.now()-i),latestBlock:a}}catch(c){(t=yield D()(H()(n.prototype),"getClientEndpointStatus",this).call(this,e)).rpcBatchSupported=!1}return t}));return function(t){return e.apply(this,arguments)}}(),r.fetchRpcChainId=function(){var e=P()((function*(e){var t=yield this.engine.providerManager.getEVMChainId(e);return String(t)}));return function(t){return e.apply(this,arguments)}}(),r.getUserNFTAssets=function(){var e=P()((function*(e){var t=e.serviceData;return Promise.resolve({type:se.NFTAssetType.EVM,data:t})}));return function(t){return e.apply(this,arguments)}}(),O()(n)}(pe.VaultBase)}}]);