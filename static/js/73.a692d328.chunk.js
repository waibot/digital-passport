(this.webpackJsonp=this.webpackJsonp||[]).push([[73],{4018:function(t,e,n){"use strict";n.r(e),n.d(e,"useEvmWalletsAndAccounts",(function(){return m})),n.d(e,"useEnabledAccountDynamicAccounts",(function(){return v})),n.d(e,"usePriceAlertlist",(function(){return P})),n.d(e,"checkAccountCanSubscribe",(function(){return _}));var r=n(3),c=n.n(r),i=n(2),o=n.n(i),a=n(4),u=n.n(a),s=n(1),l=n(182),f=n(245),d=n(93),b=n(11),p=n(17),O=n(45);function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y=function(t){return[f.ADDRESS_ZERO,f.DUMMY_ADDRESS,f.DUMMY_ADDRESS_2,f.DUMMY_ADDRESS_3].includes(t)},m=function(){var t=p.default.engine,e=Object(s.useState)([]),n=u()(e,2),r=n[0],c=n[1],i=Object(O.useRuntime)().wallets,a=Object(s.useCallback)(o()((function*(){var e=yield Promise.all(i.map(function(){var e=o()((function*(e){var n,r=yield t.getAccounts(e.accounts);return h(h({},e),{},{accounts:null!=(n=null==r?void 0:r.filter((function(t){if(!t)return!1;var e=t||{},n=e.address,r=e.coinType;return!y(n)&&!!Object(l.isCoinTypeCompatibleWithImpl)(r,b.IMPL_EVM)})))?n:[]})}));return function(t){return e.apply(this,arguments)}}()));return c(e),e})),[t,i]);return Object(s.useEffect)((function(){a()}),[a]),{wallets:r,getWalletsAndAccounts:a}},v=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=Object(s.useState)(!1),n=u()(e,2),r=n[0],c=n[1],i=p.default.serviceNotification,a=m(),l=a.wallets,f=a.getWalletsAndAccounts,d=Object(s.useState)([]),b=u()(d,2),O=b[0],j=b[1],h=Object(s.useCallback)(o()((function*(){var t=yield i.queryAccountDynamic();j(t)})),[i]),y=Object(s.useCallback)(o()((function*(){c(!0);try{yield h(),yield f()}finally{c(!1)}})),[h,f]);return Object(s.useEffect)((function(){t&&y()}),[y,t]),{loading:r,wallets:l,enabledAccounts:O,refresh:y}},P=function(){var t=p.default.serviceNotification,e=Object(s.useState)(!1),n=u()(e,2),r=n[0],c=n[1],i=Object(s.useState)([]),a=u()(i,2),l=a[0],f=a[1],d=Object(s.useCallback)(o()((function*(){c(!0);try{var e=yield t.queryPriceAlertList();f(e||[])}catch(n){}c(!1)})),[t]);return Object(s.useEffect)((function(){d()}),[d]),{alerts:l,loading:r,fetchPriceAlerts:d}},_=function(){var t=o()((function*(t,e){if(!t)return!1;var n=t||{},r=n.address,c=n.coinType;return!y(r)&&(!!Object(l.isCoinTypeCompatibleWithImpl)(c,b.IMPL_EVM)&&!(yield Object(d.makeTimeoutPromise)({asyncFunc:function(){var t=o()((function*(){return p.default.validator.isContractAddress(e,r)}));return function(){return t.apply(this,arguments)}}(),timeout:6e3,timeoutResult:!1})))}));return function(e,n){return t.apply(this,arguments)}}()},4140:function(t,e,n){"use strict";var r;n.r(e),n.d(e,"PushNotificationRoutes",(function(){return r})),function(t){t.GuideToPushFirstTime="GuideToPushFirstTime"}(r||(r={}))},4296:function(t,e,n){"use strict";n.r(e),n.d(e,"GuideToPushFirstTimeCheck",(function(){return x}));var r=n(57),c=n(63),i=n(12),o=n(20),a=n(51),u=n(27),s=n(3),l=n.n(s),f=n(2),d=n.n(f),b=n(1),p=n(44),O=n(88),j=n(163),h=n(19),y=(n(24),n(17)),m=n(111),v=n(16),P=n(86),_=n(177),g=n(46),A=n(4018),D=n(4140),E=n(0);function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){l()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function x(){var t=Object(m.default)(),e=y.default.serviceBootstrap,n=Object(b.useCallback)((function(){var n=!0;return function(){var r=d()((function*(){yield Object(g.wait)(1e3);var r=yield e.checkShouldShowNotificationGuide();n&&r&&t.navigate(v.RootRoutes.Modal,{screen:v.ModalRoutes.PushNotification,params:{screen:D.PushNotificationRoutes.GuideToPushFirstTime}})}));return function(){return r.apply(this,arguments)}}()(),function(){n=!1}}),[t,e]);return Object(p.useFocusEffect)(n),null}e.default=function(){var t=Object(O.default)(),e=y.default.dispatch,n=y.default.serviceNotification,s=Object(A.useEvmWalletsAndAccounts)().wallets;Object(b.useEffect)((function(){e(Object(_.setGuideToPushFistTime)(!0))}),[e]);var l=Object(b.useCallback)(d()((function*(){var t=s.map((function(t){return t.accounts.map((function(e){return S(S({},e),{},{passphrase:Object(j.isPassphraseWallet)(t)})}))})).flat().slice(0,50),e=yield n.filterContractAddresses(t.map((function(t){return t.address})));yield n.addAccountDynamicBatch({data:t.filter((function(t){return e.some((function(e){return e===t.address}))})).map((function(t){return{passphrase:t.passphrase,accountId:t.id,address:t.address,name:t.name}}))})})),[s,n]),f=Object(b.useCallback)(function(){var t=d()((function*(t){var r=t.close;null==r||r(),e(Object(P.setPushNotificationConfig)({pushEnable:!0,priceAlertEnable:!0,btcAndEthPriceAlertEnable:!0,favoriteTokensPriceAlertEnable:!0,accountActivityPushEnable:!0}));try{yield n.syncPushNotificationConfig(),yield l()}catch(c){h.default.notification.error("close notification addAccountDynamics error",c)}}));return function(e){return t.apply(this,arguments)}}(),[e,l,n]),p=Object(b.useMemo)((function(){return[{icon:"\ud83d\udea8",title:t.formatMessage({id:"form__price_volatility"}),desc:t.formatMessage({id:"form__price_volatility_desc"})},{icon:"\ud83d\udcc8",title:t.formatMessage({id:"form__price_alert"}),desc:t.formatMessage({id:"title__no_alert_desc"},{0:"tokens"})},{icon:"\ud83d\udc64",title:t.formatMessage({id:"form__account_activity"}),desc:t.formatMessage({id:"account_activity_desc"})}]}),[t]);return Object(E.jsx)(r.default,{height:"560px",hideSecondaryAction:!0,onPrimaryActionPress:f,primaryActionProps:{type:"primary"},primaryActionTranslationId:"action__allow",children:Object(E.jsxs)(c.default,{position:"relative",height:"full",children:[Object(E.jsx)(a.default,{position:"absolute",bottom:"-12px",width:"full",children:Object(E.jsx)(u.default.Body2,{children:t.formatMessage({id:"content__you_can_change_this_option_later_in_the_settings"})})}),Object(E.jsxs)(a.default,{children:[Object(E.jsx)(o.default,{fontSize:56,children:"\ud83d\udd14"}),Object(E.jsx)(u.default.DisplayLarge,{children:t.formatMessage({id:"title__notifications"})})]}),p.map((function(t,e){return Object(E.jsxs)(i.default,{px:"4",flexDirection:"row",mt:0===e?"64px":4,children:[Object(E.jsx)(u.default.DisplayLarge,{mr:"4",children:t.icon}),Object(E.jsxs)(i.default,{flex:1,children:[Object(E.jsx)(u.default.Body1Strong,{mb:"1",children:t.title}),Object(E.jsx)(u.default.Body2,{flex:1,numberOfLines:2,color:"text-subdued",children:t.desc})]})]},t.icon)}))]})})}},5228:function(t,e,n){"use strict";n.r(e);var r=n(50),c=n(4296),i=n(4140),o=n(234),a=n(0),u=Object(o.default)(),s=[{name:i.PushNotificationRoutes.GuideToPushFirstTime,component:c.default}];e.default=function(){var t=Object(r.default)();return Object(a.jsx)(u.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!t},children:s.map((function(t){return Object(a.jsx)(u.Screen,{name:t.name,component:t.component},t.name)}))})}}}]);