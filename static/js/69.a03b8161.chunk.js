(this.webpackJsonp=this.webpackJsonp||[]).push([[69],{4035:function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),a=n(15),o=n.n(a),c=n(20),s=n(108),u=n(0),l=["text","short","prefix"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=function(e){var t=e.text,n=e.short,r=e.prefix,i=o()(e,l),a=t;return n&&(a=Object(s.shortenAddress)(a)),Object(u.jsxs)(c.default,f(f({},i),{},{children:[!!r&&r,a]}))};p.displayName="Address",p.defaultProps={short:!1},t.default=p},4077:function(e,t,n){"use strict";n.r(t);var r=n(3),i=n.n(r),a=n(4035),o=n(12),c=n(27),s=n(0);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=function(e){var t=e.name,n=e.address,r=e.amount,i=e.priorityAmount,u=e.notShowAddress,d=e.containerProps,f=void 0===d?{}:d,p=e.color,v=null,y=!1,m=!1;null!=t?v=t:null==n||u||(y=!0);var b=null;return i||y||!n||u?(null!=v||y)&&(b=null!=r?r:null):m=!0,Object(s.jsx)(o.default,l(l({alignItems:"center",flexDirection:"row",justifyContent:"flex-start"},f),{},{children:!!(v||b||y||m)&&Object(s.jsxs)(o.default,{children:[!(!v&&!y)&&(y?Object(s.jsx)(a.default,{typography:"Body2Strong",text:n,short:!0,color:p||"text-default"}):Object(s.jsx)(c.default.Body2Strong,{color:p||"text-default",isTruncated:!0,children:v})),!(!b&&!m)&&(m?Object(s.jsx)(a.default,{color:p||"text-subdued",typography:"Body2",text:n,short:!0}):Object(s.jsx)(c.default.Body2,{color:p||"text-subdued",children:b}))]})}))};d.defaultProps={avatarSize:"md",hiddenAvatar:!1},t.default=d},4127:function(e,t,n){"use strict";n.r(t),n.d(t,"ExportResult",(function(){return r})),n.d(t,"useExportData",(function(){return v}));var r,i=n(2),a=n.n(i),o=n(316),c=n.n(o),s=n(4),u=n.n(s),l=n(1),d=n(17),f=n(214),p=n(1073);function v(){var e=Object(p.default)().showVerify,t=d.default.serviceCloudBackup,n=Object(l.useCallback)(function(){var e=a()((function*(e){var n=yield t.getDataForBackup(e);return{status:r.SUCCESS,data:n}}));return function(t){return e.apply(this,arguments)}}(),[t]);return{exportDataRequest:Object(l.useCallback)(a()((function*(){return new Promise((function(i){t.getDataForBackup("").then((function(t){!function(e){var t=!0;return Object.entries(e).forEach((function(e){var n=u()(e,2),r=(n[0],n[1]);c()(r)||(t=!1)})),t}(JSON.parse(t.publicData))?e((function(e){n(e).then((function(e){i(e)}))}),(function(){i({status:r.CANCEL})}),null,f.ValidationFields.Secret):i({status:r.EMPTY})}))}))})),[n,t,e])}}!function(e){e.SUCCESS="success",e.EMPTY="empty",e.CANCEL="cancel"}(r||(r={}))},4141:function(e,t,n){"use strict";n.r(t),n.d(t,"CameraType",(function(){return r})),n.d(t,"FlashMode",(function(){return i})),n.d(t,"AutoFocus",(function(){return a})),n.d(t,"WhiteBalance",(function(){return o})),n.d(t,"ImageType",(function(){return c})),n.d(t,"VideoCodec",(function(){return s})),n.d(t,"VideoStabilization",(function(){return u})),n.d(t,"VideoQuality",(function(){return l}));var r,i,a,o,c,s,u,l,d=n(43);n.d(t,"PermissionStatus",(function(){return d.PermissionStatus})),function(e){e.front="front",e.back="back"}(r||(r={})),function(e){e.on="on",e.off="off",e.auto="auto",e.torch="torch"}(i||(i={})),function(e){e.on="on",e.off="off",e.auto="auto",e.singleShot="singleShot"}(a||(a={})),function(e){e.auto="auto",e.sunny="sunny",e.cloudy="cloudy",e.shadow="shadow",e.incandescent="incandescent",e.fluorescent="fluorescent",e.continuous="continuous",e.manual="manual"}(o||(o={})),function(e){e.png="png",e.jpg="jpg"}(c||(c={})),function(e){e.H264="avc1",e.HEVC="hvc1",e.JPEG="jpeg",e.AppleProRes422="apcn",e.AppleProRes4444="ap4h"}(s||(s={})),function(e){e.off="off",e.standard="standard",e.cinematic="cinematic",e.auto="auto"}(u||(u={})),function(e){e["2160p"]="2160p",e["1080p"]="1080p",e["720p"]="720p",e["480p"]="480p",e["4:3"]="4:3"}(l||(l={}))},4269:function(e,t,n){"use strict";n.r(t),n.d(t,"showMigrateDataModal",(function(){return L}));var r,i=n(3),a=n.n(i),o=n(474),c=n(54),s=n(183),u=n(51),l=n(82),d=n(236),f=n(40),p=n(201),v=n(12),y=n(20),m=n(76),b=n(48),g=n(2),h=n.n(g),O=n(316),j=n.n(O),P=n(4),w=n.n(P),x=n(1),A=n(44),S=n(1244),E=n(88),C=n(29),M=n(508),D=n(846),_=n(16),R=n(24),T=n(17),k=n(99),N=n(334),B=n(393),I=n(4127),U=n(0);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.Success=0]="Success",e[e.Fail=1]="Fail",e[e.Connecting=2]="Connecting"}(r||(r={}));var z=Object(B.deviceInfo)(),V=function(e){var t=e.serverAddress,n=e.serverInfo,i=e.closeOverlay,a=T.default.serviceMigrate,g=Object(x.useRef)(n),O=Object(x.useState)((function(){return n?r.Success:r.Connecting})),P=w()(O,2),F=P[0],q=P[1],V=Object(x.useState)(z),L=w()(V,2),W=L[0],H=L[1],G=Object(x.useState)(g.current),Q=w()(G,2),J=Q[0],K=Q[1],Y=Object(x.useMemo)((function(){return Object(B.parseDeviceInfo)(W)}),[W]),X=Object(x.useMemo)((function(){if(J)return Object(B.parseDeviceInfo)(J)}),[J]),Z=Object(x.useState)(!0),$=w()(Z,2),ee=$[0],te=$[1],ne=Object(E.default)(),re=Object(I.useExportData)().exportDataRequest,ie=Object(A.useNavigation)();Object(x.useEffect)((function(){F===r.Connecting&&setTimeout((function(){a.connectServer(t).then((function(e){e?"string"===typeof e?("ERR_NETWORK"===e&&R.default.isNativeIOS&&Object(k.showDialog)(Object(U.jsx)(D.default,{type:"localNetwork"})),q(r.Fail)):(g.current=e,K(e),q(r.Success)):q(r.Fail)}))}),500)}),[F,t,a]),Object(x.useEffect)((function(){F===r.Success&&void 0!==g.current&&(ee?(H(z),K(g.current)):(H(g.current),K(z)))}),[F,W,ee,J]);var ae=Object(x.useCallback)(h()((function*(){var e=yield re(),n=e.status,r=e.data;if(n===I.ExportResult.SUCCESS){var i=yield a.sendDataToServer({ipAddress:t,data:JSON.stringify(r)});return i&&X?b.default.show({title:"\ud83e\uddd9 "+ne.formatMessage({id:"msg__data_sent_to_platform"},{platform:X.name})}):b.default.show({title:ne.formatMessage({id:"form__failed"})},{type:"error"}),i}return n===I.ExportResult.EMPTY&&b.default.show({title:ne.formatMessage({id:"msg__no_data_available"})},{type:"default"}),!1})),[re,ne,X,t,a]),oe=Object(x.useCallback)(h()((function*(){var e=yield a.getDataFromServer({ipAddress:t});return!!e&&("number"===typeof e?void(e===M.MigrateErrorCode.ConnectFail&&q(r.Fail)):function(e){var t=!0;return Object.entries(e).forEach((function(e){var n=w()(e,2),r=(n[0],n[1]);j()(r)||(t=!1)})),t}(JSON.parse(e.public))?(b.default.show({title:ne.formatMessage({id:"msg__no_data_available"})},{type:"default"}),!1):(a.disConnectServer(t),i(),ie.navigate(_.RootRoutes.Onboarding,{screen:N.EOnboardingRoutes.MigrationPreview,params:{data:e}}),!0))})),[i,ne,ie,t,a]),ce=Object(x.useState)(!1),se=w()(ce,2),ue=se[0],le=se[1],de=Object(x.useCallback)(h()((function*(){le(!0),ee?(yield ae(),a.disConnectServer(t),i()):yield oe(),le(!1)})),[i,oe,ee,ae,t,a]),fe=Object(x.useMemo)((function(){return F===r.Connecting?Object(U.jsx)(p.default,{title:"",subTitle:Object(U.jsxs)(v.default,{children:[Object(U.jsx)(m.default,{size:"lg"}),Object(U.jsx)(y.default,{mt:"12px",typography:"DisplayMedium",children:ne.formatMessage({id:"content__connecting"})})]})}):F===r.Fail?Object(U.jsx)(p.default,{emoji:"\ud83d\udeab",title:ne.formatMessage({id:"modal__failed_to_connect"}),subTitle:ne.formatMessage({id:"modal__migrating_data_connection_failed_desc"})}):F===r.Success&&X&&Y?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsxs)(v.default,{bgColor:"surface-default",borderRadius:"12px",borderColor:"border-subdued",borderWidth:C.default.hairlineWidth,children:[Object(U.jsxs)(v.default,{py:"16px",children:[Object(U.jsx)(y.default,{typography:"Body2",color:"text-subdued",ml:"16px",children:ne.formatMessage({id:"content__from"})}),Object(U.jsxs)(v.default,{paddingX:"16px",flexDirection:"row",mt:"12px",children:[Object(U.jsx)(f.default,{name:Y.logo,size:24,color:"icon-subdued"}),Object(U.jsx)(y.default,{typography:"Body1Strong",flex:1,ml:"8px",children:Y.name}),ee&&Object(U.jsx)(S.View,{from:{scale:0},animate:{scale:1},transition:{type:"timing"},children:Object(U.jsx)(d.default,{size:"sm",type:"info",title:ne.formatMessage({id:"content__current"})})})]})]}),Object(U.jsx)(v.default,{borderBottomWidth:C.default.hairlineWidth,borderColor:"border-subdued"}),Object(U.jsxs)(v.default,{py:"16px",children:[Object(U.jsx)(y.default,{typography:"Body2",color:"text-subdued",ml:"16px",children:ne.formatMessage({id:"content__to"})}),Object(U.jsxs)(v.default,{paddingX:"16px",flexDirection:"row",justifyContent:"space-between",mt:"12px",children:[Object(U.jsx)(f.default,{name:X.logo,size:24,color:"icon-subdued"}),Object(U.jsx)(y.default,{typography:"Body1Strong",flex:1,ml:"8px",children:X.name}),!ee&&Object(U.jsx)(S.View,{from:{scale:0},animate:{scale:1},transition:{type:"timing"},children:Object(U.jsx)(d.default,{size:"sm",type:"info",title:ne.formatMessage({id:"content__current"})})})]})]}),Object(U.jsx)(u.default,{position:"absolute",width:"full",height:"full",children:Object(U.jsx)(l.default,{onPress:function(){te((function(e){return!e}))},name:"SwitchVerticalOutline",circle:!0,type:"basic",size:"base",iconColor:"icon-default"})})]}),Object(U.jsxs)(v.default,{mt:"24px",children:[ue&&!ee&&Object(U.jsx)(s.default,{customIconName:"EllipsisHorizontalCircleMini",title:ne.formatMessage({id:"modal__migrating_data_awaiting_confirmation"},{from:Y.name}),alertType:"success",dismiss:!1}),Object(U.jsx)(c.default,{mt:"12px",size:"xl",type:"primary",onPress:de,isLoading:ue,children:ne.formatMessage({id:"action__migrate"})})]})]}):void 0}),[F,ne,ue,ee,de,Y,X]);return Object(U.jsx)(o.default,{title:ne.formatMessage({id:"modal__migrating_data"}),headerDescription:F===r.Success?Object(U.jsxs)(y.default,{typography:"Caption",color:"text-success",children:["\ud83c\udf89 ",ne.formatMessage({id:"modal__migrating_data_desc"})]}):null,closeOverlay:function(){a.disConnectServer(t),i()},children:fe})},L=function(e){return Object(k.showOverlay)((function(t){return Object(U.jsx)(V,q(q({},e),{},{closeOverlay:t}))}))}},5296:function(e,t,n){"use strict";n.r(t);var r=n(50),i=n(57),a=n(47),o=n(41),c=n(4077),s=n(12),u=n(27),l=n(2),d=n.n(l),f=n(126),p=n(299),v=n(44),y=n(88),m=n(17),b=n(45),g=n(80),h=n(1151),O=n(473),j=n(16),P=n(95),w=n(0),x=function(){var e,t=Object(y.default)(),n=Object(v.useNavigation)(),r=Object(v.useRoute)().params,l=r.address,x=r.possibleNetworks,A=void 0===x?[]:x,S=Object(p.default)().bottom,E=Object(f.default)({defaultValues:{network:A[0]}}),C=E.control,M=E.getValues,D=Object(b.useActiveWalletAccount)(),_=D.account,R=D.wallet;return Object(w.jsx)(i.default,{onPrimaryActionPress:d()((function*(){var e=m.default.serviceNetwork;yield e.changeActiveNetwork(M("network"));var t=Object(b.getActiveWalletAccount)(),r=t.accountId,i=t.networkId;n.navigate(j.RootRoutes.Modal,{screen:j.ModalRoutes.Send,params:{screen:P.SendModalRoutes.PreSendToken,params:{accountId:r,networkId:i,from:"",to:l,amount:""}}})})),primaryActionTranslationId:"action__next",hideSecondaryAction:!0,header:t.formatMessage({id:"modal__preview"}),scrollViewProps:{pb:S+"px",children:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(s.default,{borderColor:"border-subdued",borderWidth:"1px",borderRadius:"12px",borderStyle:"dashed",alignItems:"center",justifyContent:"center",p:"20px",mb:"32px",children:Object(w.jsx)(u.default.Body2,{textAlign:"center",wordBreak:"break-all",children:l})}),Object(w.jsxs)(a.default,{children:[Object(w.jsx)(h.default,{hideHelpText:!0,selectableNetworks:A,control:C,name:"network"}),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(u.default.Body2Strong,{mb:1,children:t.formatMessage({id:"form__account"})}),Object(w.jsxs)(o.default,{p:"15px",borderWidth:1,borderColor:"border-disabled",borderRadius:"12px",alignItems:"center",bg:"surface-disabled",children:[Object(w.jsx)(O.default,{walletImage:null==R?void 0:R.type,hwWalletType:(null==R?void 0:R.deviceType)||Object(g.getDeviceTypeByDeviceId)(null==R?void 0:R.associatedDevice),avatar:null==R?void 0:R.avatar,size:"sm",mr:"12px"}),Object(w.jsx)(c.default,{color:"text-disabled",hiddenAvatar:!0,address:null!=(e=null==_?void 0:_.address)?e:"",name:null==_?void 0:_.name})]})]})]})]})}})};x.displayName="PreviewSend";var A=x,S=n(51),E=n(54),C=n(4),M=n.n(C),D=n(1),_=n.n(D),R=n(3),T=n.n(R),k=n(6),N=n.n(k),B=n(9),I=n.n(B),U=n(14),F=n.n(U),q=n(7),z=n.n(q),V=n(43),L=n(28);function W(e){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)return navigator.mediaDevices.getUserMedia(e);var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||function(){var e=new Error("Permission unimplemented");throw e.code=0,e.name="NotAllowedError",e};return new Promise((function(n,r){t.call(navigator,e,n,r)}))}function H(e){return"Permission dismissed"===e.message?{status:V.PermissionStatus.UNDETERMINED,expires:"never",canAskAgain:!0,granted:!1}:{status:V.PermissionStatus.DENIED,expires:"never",canAskAgain:!0,granted:!1}}function G(){return(G=d()((function*(){try{return yield W({video:!0}),{status:V.PermissionStatus.GRANTED,expires:"never",canAskAgain:!0,granted:!0}}catch(e){return H({message:e.message})}}))).apply(this,arguments)}function Q(){return(Q=d()((function*(){var e,t;if(null==(e=navigator)||null==(t=e.permissions)||!t.query)throw new V.UnavailabilityError("expo-barcode-scanner","navigator.permissions API is not available");switch((yield navigator.permissions.query({name:"camera"})).state){case"prompt":return{status:V.PermissionStatus.UNDETERMINED,expires:"never",canAskAgain:!0,granted:!1};case"granted":return{status:V.PermissionStatus.GRANTED,expires:"never",canAskAgain:!0,granted:!0};case"denied":return{status:V.PermissionStatus.DENIED,expires:"never",canAskAgain:!0,granted:!1}}}))).apply(this,arguments)}var J={get name(){return"ExpoBarCodeScannerModule"},get BarCodeType(){return{code39mod43:"code39mod43",code138:"code138",interleaved2of5:"interleaved2of5",aztec:"aztec",ean13:"ean13",ean8:"ean8",qr:"qr",pdf417:"pdf417",upc_e:"upc_e",datamatrix:"datamatrix",code39:"code39",code93:"code93",itf14:"itf14",codabar:"codabar",code128:"code128",upc_a:"upc_a"}},get Type(){return{front:"front",back:"back"}},requestPermissionsAsync:function(){var e=d()((function*(){return function(){return G.apply(this,arguments)}()}));return function(){return e.apply(this,arguments)}}(),getPermissionsAsync:function(){var e=d()((function*(){return function(){return Q.apply(this,arguments)}()}));return function(){return e.apply(this,arguments)}}()},K=n(333),Y=n(38);function X(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=z()(e);if(t){var i=z()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return F()(this,n)}}var Z=function(e){I()(n,e);var t=X(n);function n(){return t.apply(this,arguments)}return n.prototype.render=function(){return _.a.createElement(Y.default,null,_.a.createElement(K.default,null,"BarCodeScanner Component not supported on the web"))},N()(n)}(_.a.Component);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){T()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=z()(e);if(t){var i=z()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return F()(this,n)}}var ne=J.BarCodeType,re=J.Type,ie=function(e){I()(n,e);var t=te(n);function n(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).lastEvents={},e.lastEventsTimes={},e.onObjectDetected=function(t){return function(n){var r=n.nativeEvent,i=r.type;e.lastEvents[i]&&e.lastEventsTimes[i]&&JSON.stringify(r)===e.lastEvents[i]&&Date.now()-e.lastEventsTimes[i]<500||t&&(t(r),e.lastEventsTimes[i]=new Date,e.lastEvents[i]=JSON.stringify(r))}},e}n.getPermissionsAsync=function(){var e=d()((function*(){return J.getPermissionsAsync()}));return function(){return e.apply(this,arguments)}}(),n.requestPermissionsAsync=function(){var e=d()((function*(){return J.requestPermissionsAsync()}));return function(){return e.apply(this,arguments)}}(),n.scanFromURLAsync=function(){var e=d()((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.values(ne);if(!J.scanFromURLAsync)throw new V.UnavailabilityError("expo-barcode-scanner","scanFromURLAsync");if(Array.isArray(t)&&!t.length)throw new Error("No barCodeTypes specified; provide at least one barCodeType for scanner");if("ios"===L.default.OS){if(Array.isArray(t)&&!t.includes(ne.qr))throw new Error("Only QR type is supported by scanFromURLAsync() on iOS");return yield J.scanFromURLAsync(e,[ne.qr])}return yield J.scanFromURLAsync(e,t)}));return function(t){return e.apply(this,arguments)}}();var r=n.prototype;return r.render=function(){var e=this.convertNativeProps(this.props),t=this.props.onBarCodeScanned;return D.createElement(Z,ee(ee({},e),{},{onBarCodeScanned:this.onObjectDetected(t)}))},r.convertNativeProps=function(e){var t={};for(var r of Object.entries(e)){var i=M()(r,2),a=i[0],o=i[1];"string"===typeof o&&n.ConversionTables[a]?t[a]=n.ConversionTables[a][o]:t[a]=o}return t},N()(n)}(D.Component);ie.Constants={BarCodeType:ne,Type:re},ie.ConversionTables={type:re},ie.defaultProps={type:re.back,barCodeTypes:Object.values(ne)},ie.usePermissions=Object(V.createPermissionHook)({getMethod:ie.getPermissionsAsync,requestMethod:ie.requestPermissionsAsync});ie.Constants,ie.getPermissionsAsync;var ae=ie.requestPermissionsAsync,oe=(ie.scanFromURLAsync,n(1638)),ce=n(235),se=n(24),ue=n(846),le=n(778),de=n(1067),fe=n(4269),pe=n(393),ve=n(6106),ye=function(e){var t=e.style,n=e.isActive,r=e.children,i=e.onQrcodeScanned;return n?Object(w.jsx)(ve.default,{style:t,onBarCodeScanned:function(e){var t=e.data;return i(t)},barCodeScannerSettings:{barCodeTypes:[ie.Constants.BarCodeType.qr]},children:r}):null};ye.displayName="ScanCamera";var me=ye,be=n(2338),ge=n(697),he=function(){var e,t=Object(y.default)(),n=Object(p.default)().bottom,a=Object(D.useState)(V.PermissionStatus.UNDETERMINED),c=M()(a,2),u=c[0],l=c[1],f=Object(D.useRef)(!1),m=Object(v.useIsFocused)(),b=Object(r.default)(),g=Object(le.default)(),h=null==(e=Object(v.useRoute)().params)?void 0:e.onScanCompleted,O=Object(D.useCallback)((function(e){if(!f.current&&e){if(f.current=!0,h)return h(e),void g.goBack();var t=Object(de.handleScanResult)(e);if(t){if(t.type===ge.ScanSubResultCategory.MIGRATE)return g.goBack(),void setTimeout((function(){Object(fe.showMigrateDataModal)({serverAddress:e.replace(pe.OneKeyMigrateQRCodePrefix,"")})}),150);g.replace(ge.ScanQrcodeRoutes.ScanQrcodeResult,t)}else g.goBack()}}),[g,h]),j=Object(D.useCallback)(d()((function*(){var e=yield Object(oe.launchImageLibraryAsync)({base64:!0,allowsMultipleSelection:!1});if(!e.canceled){var t=yield Object(be.scanFromURLAsync)(e.assets[0].uri);t&&O(t)}})),[O]),P=Object(D.useCallback)(d()((function*(){O(yield Object(ce.getClipboard)())})),[O]);return Object(D.useEffect)((function(){ae().then((function(e){var t=e.status;return l(t)}))}),[]),Object(D.useEffect)((function(){m&&(f.current=!1)}),[m]),u===V.PermissionStatus.GRANTED?Object(w.jsx)(i.default,{hidePrimaryAction:!0,hideSecondaryAction:!0,header:t.formatMessage({id:"title__scan_qr_code"}),headerDescription:se.default.isNativeIOSPhone?Object(w.jsx)(s.default,{h:"8px"}):void 0,height:"535px",footer:Object(w.jsxs)(o.default,{mb:n,py:"16px",px:b?"16px":"24px",space:"12px",justifyContent:"center",children:[Object(w.jsx)(E.default,{flexGrow:b?1:void 0,size:b?"xl":"base",onPress:j,leftIconName:"PhotoMini",children:t.formatMessage({id:"action__choose_an_image"})}),se.default.canGetClipboard?Object(w.jsx)(E.default,{flexGrow:b?1:void 0,size:b?"xl":"base",leftIconName:"ClipboardMini",onPress:P,children:t.formatMessage({id:"action__paste"})}):null]}),staticChildrenProps:{flex:1},children:Object(w.jsx)(me,{style:{flex:1},isActive:m,onQrcodeScanned:O,children:Object(w.jsx)(S.default,{position:"absolute",top:0,right:0,bottom:0,left:0,overflow:"hidden",children:Object(w.jsx)(s.default,{borderWidth:400,borderColor:"rgba(0,0,0,.5)",borderRadius:"425px",children:Object(w.jsx)(s.default,{size:"256px",borderWidth:4,borderColor:"white",borderRadius:"24px"})})})})}):u===V.PermissionStatus.DENIED?Object(w.jsx)(ue.default,{type:"camera"}):null};he.displayName="ScanQrcode";var Oe=he,je=n(48),Pe=n(29),we=n(1066),xe=n(334),Ae=n(190);function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ee=function(e){var t=e.data,n=Object(v.useNavigation)(),r=Object(D.useMemo)((function(){return[{id:"form__add_to_address_book",onPress:function(){n.navigate(j.RootRoutes.Modal,{screen:j.ModalRoutes.AddressBook,params:{screen:we.AddressBookRoutes.NewAddressRoute,params:{address:t}}})},icon:"UserPlusOutline"},{id:"form__imported_as_a_watch_account",onPress:function(){n.replace(j.RootRoutes.Onboarding,{screen:xe.EOnboardingRoutes.RecoveryWallet,params:{mode:"watching",presetText:t}})},icon:"EyeOutline"}]}),[t,n]);return Object(w.jsx)(Ae.default,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){T()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({options:r},e))},Ce=function(){var e=Object(y.default)(),t=Object(p.default)().bottom,n=Object(r.default)(),a=Object(v.useRoute)().params,c=a.data,l=a.hideMoreMenu,d=Object(D.useCallback)((function(){Object(ce.copyToClipboard)(c),je.default.show({title:e.formatMessage({id:"msg__copied"})})}),[c,e]);return Object(w.jsx)(i.default,{size:n?void 0:"lg",height:"516px",header:e.formatMessage({id:"content__info"}),footer:Object(w.jsx)(s.default,{borderTopColor:"divider",pb:t+"px",borderTopWidth:Pe.default.hairlineWidth,children:Object(w.jsxs)(o.default,{justifyContent:"flex-end",py:"4",px:n?4:6,alignItems:"center",space:4,children:[Object(w.jsx)(E.default,{size:n?"xl":"base",onPress:d,leftIconName:"Square2StackOutline",flex:n?1:void 0,children:e.formatMessage({id:"action__copy"})}),l?null:Object(w.jsx)(Ee,{data:c,placement:"top left",width:"280px",children:Object(w.jsx)(E.default,{size:n?"xl":"base",leftIconName:"EllipsisVerticalOutline",flex:n?1:void 0,children:e.formatMessage({id:"action__more _options"})})})]})}),scrollViewProps:{pb:t+"px",children:Object(w.jsx)(u.default.Display2XLarge,{wordBreak:"break-all",children:c})}})},Me=n(234),De=Object(Me.default)(),_e=[{name:ge.ScanQrcodeRoutes.ScanQrcode,component:Oe},{name:ge.ScanQrcodeRoutes.ScanQrcodeResult,component:Ce},{name:ge.ScanQrcodeRoutes.PreviewSend,component:A}];t.default=function(){var e=Object(r.default)();return Object(w.jsx)(De.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:_e.map((function(e){return Object(w.jsx)(De.Screen,{name:e.name,component:e.component},e.name)}))})}},6106:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return We})),n.d(t,"Constants",(function(){return He})),n.d(t,"getPermissionsAsync",(function(){return Ge})),n.d(t,"requestPermissionsAsync",(function(){return Qe})),n.d(t,"getCameraPermissionsAsync",(function(){return Je})),n.d(t,"requestCameraPermissionsAsync",(function(){return Ke})),n.d(t,"getMicrophonePermissionsAsync",(function(){return Ye})),n.d(t,"requestMicrophonePermissionsAsync",(function(){return Xe}));var r=n(3),i=n.n(r),a=n(2),o=n.n(a),c=n(6),s=n.n(c),u=n(9),l=n.n(u),d=n(14),f=n.n(d),p=n(7),v=n.n(p),y=n(43),m=n(1),b=n(184),g=n(15),h=n.n(g),O=n(29),j=n(38),P=n(176),w=n(4141),x=n(4),A=n.n(x);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e){return M.apply(this,arguments)}function M(){return(M=o()((function*(e){var t=function(e){return{optional:[{sourceId:e}]}},n=function(e){var t=e.deviceId;return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"===typeof t&&t.ideal?t.ideal:null},r=yield new Promise((function(e){return MediaStreamTrack.getSources((function(t){return e(t)}))})),i=null,a=null;r.forEach((function(e){"audio"===e.kind?i=e.id:"video"===e.kind&&(a=e.id)}));var o=n(e.audioConstraints);o&&(i=o);var c=n(e.videoConstraints);return c&&(a=c),[t(i),t(a)]}))).apply(this,arguments)}function D(e,t,n){return _.apply(this,arguments)}function _(){return(_=o()((function*(e,t,n){var r={video:"undefined"===typeof n||n};return e||(r.audio="undefined"===typeof t||t),yield k(r)}))).apply(this,arguments)}function R(e){return T.apply(this,arguments)}function T(){return(T=o()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(U())return yield D(t,e.audio,e.video);var n=yield C(e),r=A()(n,2),i=r[0],a=r[1];return yield D(t,i,a)}))).apply(this,arguments)}function k(e){return N.apply(this,arguments)}function N(){return(N=o()((function*(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return yield B(E(E({},e),{},{video:t||e.video}))}catch(n){if(!t&&"ConstraintNotSatisfiedError"===n.name)return yield k(e,!0);throw n}}))).apply(this,arguments)}function B(e){return I.apply(this,arguments)}function I(){return(I=o()((function*(e){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)return navigator.mediaDevices.getUserMedia(e);var t=navigator.mozGetUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia;return new Promise((function(n,r){return t.call(navigator,e,n,r)}))}))).apply(this,arguments)}function U(){return y.Platform.isDOMAvailable&&!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia)}function F(e){return q.apply(this,arguments)}function q(){return(q=o()((function*(e){return yield L(["front","user","facetime"],"user",e)}))).apply(this,arguments)}function z(e){return V.apply(this,arguments)}function V(){return(V=o()((function*(e){return yield L(["back","rear"],"environment",e)}))).apply(this,arguments)}function L(e,t,n){return W.apply(this,arguments)}function W(){return(W=o()((function*(e,t,n){if(!n){if(!navigator.mediaDevices.enumerateDevices)return null;n=yield navigator.mediaDevices.enumerateDevices()}var r=n.filter((function(e){return"videoinput"===e.kind})),i=r.filter((function(t){return e.some((function(e){return t.label.toLowerCase().includes(e)}))})),a=A()(i,1)[0],o=r.filter((function(e){if(!("getCapabilities"in e))return null;var n=e.getCapabilities();return n.facingMode?n.facingMode.find((function(e){return t})):null})),c=A()(o,1)[0];return(null==c?void 0:c.deviceId)||(null==a?void 0:a.deviceId)||null}))).apply(this,arguments)}function H(e){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)return navigator.mediaDevices.getUserMedia(e);var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||function(){var e=new Error("Permission unimplemented");throw e.code=0,e.name="NotAllowedError",e};return new Promise((function(n,r){t.call(navigator,e,n,r)}))}function G(e){return"Permission dismissed"===e.message?{status:y.PermissionStatus.UNDETERMINED,expires:"never",canAskAgain:!0,granted:!1}:{status:y.PermissionStatus.DENIED,expires:"never",canAskAgain:!0,granted:!1}}function Q(){return J.apply(this,arguments)}function J(){return(J=o()((function*(){try{return yield H({video:!0}),{status:y.PermissionStatus.GRANTED,expires:"never",canAskAgain:!0,granted:!0}}catch(e){return G({message:e.message})}}))).apply(this,arguments)}function K(e){return Y.apply(this,arguments)}function Y(){return(Y=o()((function*(e){var t,n;if(null==(t=navigator)||null==(n=t.permissions)||!n.query)throw new y.UnavailabilityError("expo-camera","navigator.permissions API is not available");switch((yield navigator.permissions.query({name:e})).state){case"prompt":return{status:y.PermissionStatus.UNDETERMINED,expires:"never",canAskAgain:!0,granted:!1};case"granted":return{status:y.PermissionStatus.GRANTED,expires:"never",canAskAgain:!0,granted:!0};case"denied":return{status:y.PermissionStatus.DENIED,expires:"never",canAskAgain:!0,granted:!1}}}))).apply(this,arguments)}var X,Z,$={get name(){return"ExponentCameraManager"},get Type(){return{back:"back",front:"front"}},get FlashMode(){return{on:"on",off:"off",auto:"auto",torch:"torch"}},get AutoFocus(){return{on:"on",off:"off",auto:"auto",singleShot:"singleShot"}},get WhiteBalance(){return{auto:"auto",continuous:"continuous",manual:"manual"}},get VideoQuality(){return{}},get VideoStabilization(){return{}},isAvailableAsync:function(){var e=o()((function*(){return U()}));return function(){return e.apply(this,arguments)}}(),takePicture:function(){var e=o()((function*(e,t){return yield t.takePicture(e)}));return function(t,n){return e.apply(this,arguments)}}(),pausePreview:function(){var e=o()((function*(e){yield e.pausePreview()}));return function(t){return e.apply(this,arguments)}}(),resumePreview:function(){var e=o()((function*(e){return yield e.resumePreview()}));return function(t){return e.apply(this,arguments)}}(),getAvailableCameraTypesAsync:function(){var e=o()((function*(){if(!U()||!navigator.mediaDevices.enumerateDevices)return[];var e=yield navigator.mediaDevices.enumerateDevices();return(yield Promise.all([(yield F(e))&&w.CameraType.front,(yield z())&&w.CameraType.back])).filter(Boolean)}));return function(){return e.apply(this,arguments)}}(),getAvailablePictureSizes:function(){var e=o()((function*(e,t){return yield t.getAvailablePictureSizes(e)}));return function(t,n){return e.apply(this,arguments)}}(),getPermissionsAsync:function(){var e=o()((function*(){return K("camera")}));return function(){return e.apply(this,arguments)}}(),requestPermissionsAsync:function(){var e=o()((function*(){return Q()}));return function(){return e.apply(this,arguments)}}(),getCameraPermissionsAsync:function(){var e=o()((function*(){return K("camera")}));return function(){return e.apply(this,arguments)}}(),requestCameraPermissionsAsync:function(){var e=o()((function*(){return Q()}));return function(){return e.apply(this,arguments)}}(),getMicrophonePermissionsAsync:function(){var e=o()((function*(){return K("microphone")}));return function(){return e.apply(this,arguments)}}(),requestMicrophonePermissionsAsync:function(){var e=o()((function*(){try{return yield H({audio:!0}),{status:y.PermissionStatus.GRANTED,expires:"never",canAskAgain:!0,granted:!0}}catch(e){return G({message:e.message})}}));return function(){return e.apply(this,arguments)}}()},ee=n(423),te=n.n(ee);function ne(e){switch(e){case"torch":return!0;case"on":case"off":case"auto":default:return!1}}function re(e){switch(e){case"on":case"auto":return"continuous";case"off":return"none";case"singleShot":return"single-shot";default:return}}function ie(e){switch(e){case"on":case"auto":return"continuous";case"off":return"manual";case"singleShot":return"single-shot";default:return}}var ae=Object.keys({"3840x2160":3840/2160,"1920x1080":1920/1080,"1280x720":1280/720,"640x480":640/480,"352x288":352/288}),oe=((X={})[w.ImageType.jpg]="image/jpeg",X[w.ImageType.png]="image/png",X),ce={audio:!1,video:!0},se=((Z={})[w.CameraType.front]="user",Z[w.CameraType.back]="environment",Z),ue={user:w.CameraType.front,environment:w.CameraType.back};function le(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||e.readyState!==e.HAVE_ENOUGH_DATA)return null;var n=de(e,t),r=n.getContext("2d",{alpha:!1});if(!r||!n.width||!n.height)return null;var i=r.getImageData(0,0,n.width,n.height);return i}function de(e,t){var n=t.scale,r=void 0===n?1:n,i=t.isImageMirror,a=void 0!==i&&i,o=function(e,t,n){var r=e*n;return{width:r,height:t/(e/r)}}(e.videoWidth,e.videoHeight,r),c=o.width,s=o.height,u=document.createElement("canvas");u.width=c,u.height=s;var l=u.getContext("2d",{alpha:!1});if(!l)throw new Error("Context is not defined");return a&&l.setTransform(-1,0,0,1,u.width,0),l.drawImage(e,0,0,c,s),u}function fe(e,t){var n=function(e){var t={scale:1,imageType:w.ImageType.png,isImageMirror:!1};for(var n in e)n in e&&void 0!==e[n]&&n in t&&(t[n]=e[n]);return t}(t),r=de(e,n),i=n.imageType,a=n.quality;return function(e,t,n){te()(Object.values(w.ImageType).includes(t),"expo-camera: "+t+" is not a valid ImageType. Expected a string from: "+Object.values(w.ImageType).join(", "));var r=oe[t];return t===w.ImageType.jpg?(te()(n<=1&&n>=0,"expo-camera: "+n+" is not a valid image quality. Expected a number from 0...1"),e.toDataURL(r,n)):e.toDataURL(r)}(r,i,void 0===a?.92:a)}function pe(e,t,n){var r={audio:!1,video:{}};if(function(e,t,n){return void 0!==e&&void 0!==t&&void 0!==n}(e,t,n))return ce;var i,a=navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints?navigator.mediaDevices.getSupportedConstraints():null;if(!a||!a.facingMode||!a.width||!a.height)return ce;if(e&&Object.values(w.CameraType).includes(e)){var o=se[e];if(/WebKit/.test(navigator.userAgent)&&!/Edg/.test(navigator.userAgent)){var c,s="user"===o?"exact":"ideal";r.video.facingMode=((c={})[s]=o,c)}else r.video.facingMode={ideal:se[e]}}return(i=r.video)&&"boolean"!==typeof i.video&&(r.video.width=t,r.video.height=n),r}function ve(){return(ve=o()((function*(e,t,n){try{return yield ye(e,t,n)}catch(i){if(i instanceof OverconstrainedError&&"facingMode"===i.constraint){var r=e===w.CameraType.back?w.CameraType.front:w.CameraType.back;return yield ye(r,t,n)}throw i}}))).apply(this,arguments)}function ye(e,t,n){return me.apply(this,arguments)}function me(){return(me=o()((function*(e,t,n){var r=pe(e,t,n);return yield R(r)}))).apply(this,arguments)}function be(e,t){return ge.apply(this,arguments)}function ge(){return(ge=o()((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=t&&t.getVideoTracks&&(yield Promise.all(t.getVideoTracks().map((function(t){return he(e,t,n)}))))}))).apply(this,arguments)}function he(e,t){return Oe.apply(this,arguments)}function Oe(){return(Oe=o()((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.getCapabilities(),i={},a=["exposureCompensation","colorTemperature","iso","brightness","contrast","saturation","sharpness","focusDistance","zoom"];for(var o of a)r[o]&&(i[o]=we(r[o],n[o]));function c(t,i,a){return xe({constraintKey:t,settingsKey:i,convertedSetting:a(n[i]),capabilities:r,settings:n,cameraType:e})}r.focusMode&&void 0!==n.autoFocus&&(i.focusMode=c("focusMode","autoFocus",ie)),r.torch&&void 0!==n.flashMode&&(i.torch=c("torch","flashMode",ne)),r.whiteBalanceMode&&void 0!==n.whiteBalance&&(i.whiteBalanceMode=c("whiteBalanceMode","whiteBalance",re));try{yield t.applyConstraints({advanced:[i]})}catch(s){0}}))).apply(this,arguments)}function je(e){e&&(e.getAudioTracks&&e.getAudioTracks().forEach((function(e){return e.stop()})),e.getVideoTracks&&e.getVideoTracks().forEach((function(e){return e.stop()})),"function"===typeof e.stop&&e.stop())}function Pe(e,t){var n,r=null!=(n=window.URL.createObjectURL)?n:window.webkitURL.createObjectURL;if("undefined"!==typeof e.srcObject?e.srcObject=t:"undefined"!==typeof e.mozSrcObject?e.mozSrcObject=t:t&&r&&(e.src=r(t)),!t){var i,a,o,c=null!=(i=window.URL.revokeObjectURL)?i:window.webkitURL.revokeObjectURL,s=null!=(a=null!=(o=e.src)?o:e.srcObject)?a:e.mozSrcObject;c&&"string"===typeof s&&c(s)}}function we(e,t){if(t){var n=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,1];return(e-n[0])*(t[1]-t[0])/(n[1]-n[0])+t[0]}(t,[e.min,e.max]);return Math.min(e.max,Math.max(e.min,n))}}function xe(e){var t=e.constraintKey,n=e.settingsKey,r=e.convertedSetting,i=e.capabilities,a=e.settings;e.cameraType,a[n];if(!Array.isArray(i[t])||!r||i[t].includes(r))return r}function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ee=["autoFocus","flashMode","exposureCompensation","colorTemperature","iso","brightness","contrast","saturation","sharpness","focusDistance","whiteBalance","zoom"];function Ce(e,t,n,r){var i=r.onCameraReady,a=r.onMountError,c=m.useRef(!1),s=m.useRef([]),u=m.useRef({autoFocus:"continuous",flashMode:"off",whiteBalance:"continuous",zoom:1}),l=m.useState(null),d=A()(l,2),f=d[0],p=d[1],v=m.useMemo((function(){return f?f.getTracks()[0].getSettings():null}),[f]),y=m.useMemo((function(){if(!v)return null;var e=v.facingMode;return ue[void 0===e?"user":e]}),[v]),b=m.useCallback(o()((function*(){try{return yield function(e,t,n){return ve.apply(this,arguments)}(t)}catch(e){return a&&a({nativeEvent:e}),null}})),[t,a]),g=m.useCallback(o()((function*(){var e=yield b();return function(e,t){if(!e||!t)return!1;var n=e.getTracks()[0].getSettings(),r=t.getTracks()[0].getSettings();return n.deviceId===r.deviceId}(e,f)||(s.current.some((function(t){return t.id===(null==e?void 0:e.id)}))||s.current.push(e),p(e),i&&i()),!1})),[b,p,i,f,s.current]);return m.useEffect((function(){c.current||(c.current=!0,g().then((function(e){c.current=e})).catch((function(){c.current=!1})))}),[t]),m.useEffect((function(){var e={};for(var r of Object.keys(n))if(Ee.includes(r)){var i=n[r];i!==u.current[r]&&(e[r]=i)}var a=!!Object.keys(e).length,o=Se(Se({},u.current),e);a&&be(t,f,e),u.current=o}),[n.autoFocus,n.flashMode,n.exposureCompensation,n.colorTemperature,n.iso,n.brightness,n.contrast,n.saturation,n.sharpness,n.focusDistance,n.whiteBalance,n.zoom]),m.useEffect((function(){e.current&&Pe(e.current,f)}),[e.current,f]),m.useEffect((function(){return function(){for(var t of s.current)je(t);e.current&&Pe(e.current,f)}}),[]),function(e,t){m.useEffect((function(){e&&e.addEventListener("loadedmetadata",(function(){requestAnimationFrame((function(){t()}))}))}),[e])}(e.current,(function(){be(t,f,u.current)})),{type:y,mediaTrackSettings:v}}var Me=n(2760);var De=["type","pictureSize","poster"];function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Te=m.forwardRef((function(e,t){var n,r,i=e.type,a=(e.pictureSize,e.poster),c=h()(e,De),s=m.useRef(null),u=Ce(s,i,c,{onCameraReady:function(){c.onCameraReady&&c.onCameraReady()},onMountError:c.onMountError}),l=m.useMemo((function(){var e,t;return!(null==(e=c.barCodeScannerSettings)||null==(t=e.barCodeTypes)||!t.includes("qr")||!c.onBarCodeScanned)}),[null==(n=c.barCodeScannerSettings)?void 0:n.barCodeTypes,c.onBarCodeScanned]);!function(e,t){var n=t.isEnabled,r=t.captureOptions,i=t.interval,a=t.onScanned,c=t.onError,s=m.useRef(!1),u=m.useRef(void 0);function l(){return d.apply(this,arguments)}function d(){return(d=o()((function*(){if(s.current&&a)try{var t=le(e.current,r),n=yield Object(Me.scanImageData)(t),o=A()(n,1)[0];o&&a({nativeEvent:{type:o.typeName,data:o.decode(),cornerPoints:o.points}})}catch(p){c&&c({nativeEvent:p})}finally{if(0===i)return void f();var d=!i||i<0?16:i;u.current=setTimeout((function(){l()}),d)}else f()}))).apply(this,arguments)}function f(){s.current=!1,clearTimeout(u.current)}m.useEffect((function(){n?(s.current=!0,l()):f()}),[n]),m.useEffect((function(){return function(){f()}}),[])}(s,{interval:null==(r=c.barCodeScannerSettings)?void 0:r.interval,isEnabled:l,captureOptions:{scale:1,isImageMirror:u.type===w.CameraType.front},onScanned:function(e){c.onBarCodeScanned&&c.onBarCodeScanned(e)}}),m.useImperativeHandle(t,(function(){return{getAvailablePictureSizes:function(){var e=o()((function*(e){return ae}));return function(t){return e.apply(this,arguments)}}(),takePicture:function(){var e=o()((function*(e){var t,n;if(!s.current||(null==(t=s.current)?void 0:t.readyState)!==(null==(n=s.current)?void 0:n.HAVE_ENOUGH_DATA))throw new y.CodedError("ERR_CAMERA_NOT_READY","HTMLVideoElement does not have enough camera data to construct an image yet.");var r=u.mediaTrackSettings;if(!r)throw new y.CodedError("ERR_CAMERA_NOT_READY","MediaStream is not ready yet.");return function(e,t,n){var r=fe(e,n),i={uri:r,base64:r,width:0,height:0};if(t){var a=t.width,o=void 0===a?0:a,c=t.height,s=void 0===c?0:c;i.width=o,i.height=s,i.exif=t}return n.onPictureSaved&&n.onPictureSaved(i),i}(s.current,r,Re(Re({},e),{},{onPictureSaved:function(t){e.onPictureSaved&&e.onPictureSaved(t),c.onPictureSaved&&c.onPictureSaved({nativeEvent:{data:t,id:-1}})}}))}));return function(t){return e.apply(this,arguments)}}(),resumePreview:function(){var e=o()((function*(){s.current&&s.current.play()}));return function(){return e.apply(this,arguments)}}(),pausePreview:function(){var e=o()((function*(){s.current&&s.current.pause()}));return function(){return e.apply(this,arguments)}}()}}),[u.mediaTrackSettings,c.onPictureSaved]);var d=m.useMemo((function(){var e=u.type===$.Type.front;return[O.default.absoluteFill,Ne.video,{transform:e?[{scaleX:-1}]:void 0}]}),[u.type]);return m.createElement(j.default,{pointerEvents:"box-none",style:[Ne.videoWrapper,c.style]},m.createElement(ke,{autoPlay:!0,playsInline:!0,muted:!0,poster:a,pointerEvents:c.pointerEvents,ref:s,style:d}),c.children)})),ke=m.forwardRef((function(e,t){return Object(P.default)("video",Re(Re({},e),{},{ref:t}))})),Ne=O.default.create({videoWrapper:{flex:1,alignItems:"stretch"},video:{width:"100%",height:"100%",objectFit:"cover"}}),Be={type:$.Type,flashMode:$.FlashMode,autoFocus:$.AutoFocus,whiteBalance:$.WhiteBalance};function Ie(e){var t=function(e){if(!e||"object"!==typeof e)return{};var t={};for(var n of Object.entries(e)){var r=A()(n,2),i=r[0],a=r[1];t[i]="string"===typeof a&&Be[i]?Be[i][a]:a}return t}(e);return t.onBarCodeScanned&&(t.barCodeScannerEnabled=!0),t.onFacesDetected&&(t.faceDetectorEnabled=!0),"android"!==y.Platform.OS&&(delete t.ratio,delete t.useCamera2Api),"web"!==y.Platform.OS&&delete t.poster,t}function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var ze={},Ve=1;function Le(e){var t=e.nativeEvent,n=t.id,r=t.data,i=ze[n];i&&(i(r),delete ze[n])}var We=function(e){l()(n,e);var t=qe(n);function n(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r)))._lastEvents={},e._lastEventsTimes={},e._onCameraReady=function(){e.props.onCameraReady&&e.props.onCameraReady()},e._onMountError=function(t){var n=t.nativeEvent;e.props.onMountError&&e.props.onMountError(n)},e._onObjectDetected=function(t){return function(n){var r=n.nativeEvent,i=r.type;e._lastEvents[i]&&e._lastEventsTimes[i]&&JSON.stringify(r)===e._lastEvents[i]&&(new Date).getTime()-e._lastEventsTimes[i].getTime()<500||t&&(t(r),e._lastEventsTimes[i]=new Date,e._lastEvents[i]=JSON.stringify(r))}},e._setReference=function(t){t?(e._cameraRef=t,"web"===y.Platform.OS?e._cameraHandle=t:e._cameraHandle=Object(b.default)(t)):(e._cameraRef=null,e._cameraHandle=null)},e}n.isAvailableAsync=function(){var e=o()((function*(){if(!$.isAvailableAsync)throw new y.UnavailabilityError("expo-camera","isAvailableAsync");return yield $.isAvailableAsync()}));return function(){return e.apply(this,arguments)}}(),n.getAvailableCameraTypesAsync=function(){var e=o()((function*(){if(!$.getAvailableCameraTypesAsync)throw new y.UnavailabilityError("expo-camera","getAvailableCameraTypesAsync");return yield $.getAvailableCameraTypesAsync()}));return function(){return e.apply(this,arguments)}}(),n.getAvailableVideoCodecsAsync=function(){var e=o()((function*(){if(!$.getAvailableVideoCodecsAsync)throw new y.UnavailabilityError("Camera","getAvailableVideoCodecsAsync");return yield $.getAvailableVideoCodecsAsync()}));return function(){return e.apply(this,arguments)}}(),n.getPermissionsAsync=function(){var e=o()((function*(){return $.getPermissionsAsync()}));return function(){return e.apply(this,arguments)}}(),n.requestPermissionsAsync=function(){var e=o()((function*(){return $.requestPermissionsAsync()}));return function(){return e.apply(this,arguments)}}(),n.getCameraPermissionsAsync=function(){var e=o()((function*(){return $.getCameraPermissionsAsync()}));return function(){return e.apply(this,arguments)}}(),n.requestCameraPermissionsAsync=function(){var e=o()((function*(){return $.requestCameraPermissionsAsync()}));return function(){return e.apply(this,arguments)}}(),n.getMicrophonePermissionsAsync=function(){var e=o()((function*(){return $.getMicrophonePermissionsAsync()}));return function(){return e.apply(this,arguments)}}(),n.requestMicrophonePermissionsAsync=function(){var e=o()((function*(){return $.requestMicrophonePermissionsAsync()}));return function(){return e.apply(this,arguments)}}();var r=n.prototype;return r.takePictureAsync=function(){var e=o()((function*(e){var t=function(e){var t=e&&"object"===typeof e?e:{};if(t.quality||(t.quality=1),t.onPictureSaved){var n=Ve++;ze[n]=t.onPictureSaved,t.id=n,t.fastMode=!0}return t}(e);return yield $.takePicture(t,this._cameraHandle)}));return function(t){return e.apply(this,arguments)}}(),r.getSupportedRatiosAsync=function(){var e=o()((function*(){if(!$.getSupportedRatios)throw new y.UnavailabilityError("Camera","getSupportedRatiosAsync");return yield $.getSupportedRatios(this._cameraHandle)}));return function(){return e.apply(this,arguments)}}(),r.getAvailablePictureSizesAsync=function(){var e=o()((function*(e){if(!$.getAvailablePictureSizes)throw new y.UnavailabilityError("Camera","getAvailablePictureSizesAsync");return yield $.getAvailablePictureSizes(e,this._cameraHandle)}));return function(t){return e.apply(this,arguments)}}(),r.recordAsync=function(){var e=o()((function*(e){if(!$.record)throw new y.UnavailabilityError("Camera","recordAsync");var t=function(e){var t=e||{};return t&&"object"===typeof t?"string"===typeof t.quality&&(t.quality=We.Constants.VideoQuality[t.quality]):t={},t}(e);return yield $.record(t,this._cameraHandle)}));return function(t){return e.apply(this,arguments)}}(),r.stopRecording=function(){if(!$.stopRecording)throw new y.UnavailabilityError("Camera","stopRecording");$.stopRecording(this._cameraHandle)},r.pausePreview=function(){if(!$.pausePreview)throw new y.UnavailabilityError("Camera","pausePreview");$.pausePreview(this._cameraHandle)},r.resumePreview=function(){if(!$.resumePreview)throw new y.UnavailabilityError("Camera","resumePreview");$.resumePreview(this._cameraHandle)},r.render=function(){var e=Ie(this.props),t=this.props.onBarCodeScanned?this._onObjectDetected(this.props.onBarCodeScanned):void 0,n=this._onObjectDetected(this.props.onFacesDetected);return m.createElement(Te,Fe(Fe({},e),{},{ref:this._setReference,onCameraReady:this._onCameraReady,onMountError:this._onMountError,onBarCodeScanned:t,onFacesDetected:n,onPictureSaved:Le}))},s()(n)}(m.Component);We.Constants={Type:$.Type,FlashMode:$.FlashMode,AutoFocus:$.AutoFocus,WhiteBalance:$.WhiteBalance,VideoQuality:$.VideoQuality,VideoStabilization:$.VideoStabilization||{},VideoCodec:$.VideoCodec},We.ConversionTables=Be,We.defaultProps={zoom:0,ratio:"4:3",focusDepth:0,faceDetectorSettings:{},type:$.Type.back,autoFocus:$.AutoFocus.on,flashMode:$.FlashMode.off,whiteBalance:$.WhiteBalance.auto},We.useCameraPermissions=Object(y.createPermissionHook)({getMethod:We.getCameraPermissionsAsync,requestMethod:We.requestCameraPermissionsAsync}),We.useMicrophonePermissions=Object(y.createPermissionHook)({getMethod:We.getMicrophonePermissionsAsync,requestMethod:We.requestMicrophonePermissionsAsync});var He=We.Constants,Ge=We.getPermissionsAsync,Qe=We.requestPermissionsAsync,Je=We.getCameraPermissionsAsync,Ke=We.requestCameraPermissionsAsync,Ye=We.getMicrophonePermissionsAsync,Xe=We.requestMicrophonePermissionsAsync}}]);