(this.webpackJsonp=this.webpackJsonp||[]).push([[84],{4321:function(e,t,a){"use strict";a.r(t),a.d(t,"useAddressBook",(function(){return B}));var n=a(57),r=a(262),s=a(51),d=a(201),o=a(82),c=a(236),i=a(89),u=a(12),l=a(27),f=a(48),b=a(299),j=a(1),m=a(44),O=a(88),p=a(235),h=a(25),g=a(16),_=a(1066),v=a(3),x=a.n(v),w=a(15),y=a.n(w),k=a(17),A=a(1074),C=a(190),M=a(0),S=["contact"];function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var P=function(e){var t=e.contact,a=y()(e,S),n=Object(O.default)(),r=t.name,s=t.address,d=t.networkId,o=t.id,c=Object(m.useNavigation)(),i=Object(j.useCallback)((function(){c.navigate(g.RootRoutes.Modal,{screen:g.ModalRoutes.AddressBook,params:{screen:_.AddressBookRoutes.EditAddressRoute,params:{uuid:o,defaultValues:{name:r,address:s,networkId:d}}}})}),[c,r,s,d,o]),u=Object(j.useCallback)((function(){setTimeout((function(){Object(p.copyToClipboard)(s),f.default.show({title:n.formatMessage({id:"msg__address_copied"})})}),200)}),[n,s]),l=Object(j.useCallback)((function(){k.default.dispatch(Object(A.remove)({uuid:o})),f.default.show({title:n.formatMessage({id:"msg__address_deleted"})})}),[o,n]),b=Object(j.useMemo)((function(){return[{id:"action__edit",onPress:i,icon:"PencilMini"},{id:"action__copy_address",onPress:u,icon:"Square2StackOutline"},{id:"action__delete",onPress:l,icon:"TrashMini",variant:"desctructive"}]}),[u,l,i]);return Object(M.jsx)(C.default,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){x()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({w:190,options:b},a))},R=function(e){var t=e.networkId,a=e.onNew,n=e.onSelected,g=Object(O.default)(),_=Object(h.useAppSelector)((function(e){return e.contacts.contacts})),v=Object(b.default)().bottom,x=Object(j.useMemo)((function(){var e=Object.values(_);if(e=e.sort((function(e,t){return e.createAt,t.createAt,-1})),t){var a=t.split("--")[0];e=e.filter((function(e){return e.badge.toUpperCase()===a.toUpperCase()}))}return e}),[_,t]),w=Object(j.useCallback)((function(e){Object(p.copyToClipboard)(e),f.default.show({title:g.formatMessage({id:"msg__address_copied"})})}),[g]),y=Object(m.useNavigation)(),k=Object(j.useCallback)((function(e){n&&(null==n||n({address:e.address,name:e.name}),y.goBack())}),[n,y]),A=Object(j.useCallback)((function(e){var t=e.item,a=t.name,n=t.badge,r=t.address;return Object(M.jsxs)(i.default,{onLongPress:function(){w(r)},onPress:function(){return k(t)},children:[Object(M.jsx)(i.default.Column,{children:Object(M.jsx)(u.default,{w:"40px",h:"40px",borderRadius:"full",bg:"decorative-surface-one",justifyContent:"center",alignItems:"center",children:Object(M.jsx)(l.default.Body2,{color:"decorative-icon-one",children:a.toUpperCase()[0]})})}),Object(M.jsx)(i.default.Column,{flex:1,text:{label:Object(M.jsxs)(u.default,{flexDirection:"row",alignItems:"center",children:[Object(M.jsx)(l.default.Body1Strong,{mr:"8px",isTruncated:!0,children:a}),Object(M.jsx)(c.default,{size:"sm",title:n.toUpperCase()})]}),description:Object(M.jsx)(l.default.Body2,{color:"text-subdued",children:r})}}),Object(M.jsx)(i.default.Column,{children:Object(M.jsx)(P,{contact:t,children:Object(M.jsx)(o.default,{name:"EllipsisVerticalMini",circle:!0,type:"plain"})})})]})}),[w,k]);return 0===x.length?Object(M.jsx)(s.default,{w:"full",h:"full",children:Object(M.jsx)(d.default,{title:g.formatMessage({id:"title__no_cantact"}),subTitle:g.formatMessage({id:"title__no_cantact_desc"}),actionTitle:g.formatMessage({id:"action__add_new_address"}),actionProps:{leftIconName:"PlusMini"},handleAction:a,emoji:"\ud83d\udcc7"})}):Object(M.jsx)(r.default,{data:x,renderItem:A,keyExtractor:function(e){return String(e.id)},ListFooterComponent:v>0?Object(M.jsx)(u.default,{h:v+"px"}):null})};function B(){var e=Object(m.useNavigation)();return{showAddressBookModal:Object(j.useCallback)((function(t){e.navigate(g.RootRoutes.Modal,{screen:g.ModalRoutes.AddressBook,params:{screen:_.AddressBookRoutes.NewPickAddressRoute,params:t}})}),[e])}}t.default=function(){var e,t=Object(O.default)(),a=null!=(e=Object(m.useRoute)().params)?e:{},r=a.networkId,s=a.onSelected,d=Object(m.useNavigation)(),c=Object(j.useCallback)((function(){d.navigate(_.AddressBookRoutes.NewAddressRoute)}),[d]);return Object(M.jsx)(n.default,{rightContent:Object(M.jsx)(o.default,{onPress:c,name:"PlusCircleOutline",type:"plain",size:"lg",circle:!0}),header:t.formatMessage({id:"title__contacts"}),hideSecondaryAction:!0,footer:null,height:"480px",children:Object(M.jsx)(R,{networkId:r,onSelected:s,onNew:c})})}},5303:function(e,t,a){"use strict";a.r(t);var n=a(50),r=a(48),s=a(1),d=a(44),o=a(88),c=a(17),i=a(45),u=a(1074),l=a(3),f=a.n(l),b=a(57),j=a(12),m=a(47),O=a(2),p=a.n(O),h=a(126),g=a(15),_=a.n(g),v=a(794),x=a(1088),w=a(1151),y=a(25),k=a(0),A=["defaultValues","header","showAlert","onSubmit","editing"];function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var M=function(e){var t=e.defaultValues,a=e.header,r=(e.showAlert,e.onSubmit),d=e.editing,i=_()(e,A),u=Object(o.default)(),l=Object(s.useRef)(),O=Object(y.useAppSelector)((function(e){return e.contacts.contacts})),g=Object(s.useMemo)((function(){return new Map(Object.values(O).map((function(e){return[e.address.toLowerCase(),e]})))}),[O]),M=Object(h.default)({defaultValues:t,mode:"onChange"}),S=M.control,I=M.handleSubmit,P=M.setValue,R=M.watch,B=M.trigger,N=M.formState.isValid,E=R("name"),T=R("address"),D=R("networkId"),V=Object(n.default)(),L=Object(v.useNameServiceStatus)(),q=L.onChange,U=L.disableSubmitBtn,z=L.address,H=L.name,W=Object(y.useDebounce)(T,300),J=z||W;Object(s.useEffect)((function(){function e(){return(e=p()((function*(){if(J&&D)try{yield c.default.validator.validateAddress(D,J.trim()),l.current=!1,B("address")}catch(e){l.current=!0,B("address")}}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[J,D,B,u]),Object(s.useEffect)((function(){E.length>24&&P("name",E.slice(0,24)),H&&!E&&P("name",H)}),[E,P,H]),Object(s.useEffect)((function(){T.length>103&&P("address",T.slice(0,103))}),[T,P]);var F=Object(s.useCallback)((function(e){q(e),B("address")}),[B,q]),G=Object(s.useCallback)((function(e){return Object(k.jsx)(v.default,{name:e,onChange:F,disableBTC:!1,networkId:D})}),[F,D]);return Object(k.jsx)(b.default,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){f()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({header:a,hideSecondaryAction:!0,primaryActionProps:{isDisabled:!N||U,onPress:function(){return I((function(e){return!U&&z&&(e.address=z),r(e)}))()}},scrollViewProps:{children:Object(k.jsx)(j.default,{w:"full",h:"full",children:Object(k.jsxs)(m.default,{children:[Object(k.jsx)(w.default,{hideHelpText:!0,control:S,name:"networkId"}),Object(k.jsx)(m.default.Item,{control:S,name:"name",label:u.formatMessage({id:"form__contact_name"}),rules:{required:{value:!0,message:u.formatMessage({id:"form__field_is_required"})}},children:Object(k.jsx)(m.default.Input,{size:V?"xl":"default"})}),Object(k.jsx)(m.default.Item,{control:S,name:"address",label:u.formatMessage({id:"form__address"}),helpText:G,rules:{required:{value:!0,message:u.formatMessage({id:"form__field_is_required"})},validate:function(e){var a=(null==z?void 0:z.toLowerCase())||(null==e?void 0:e.toLowerCase()),n=t.address.toLowerCase();if(a)return!d&&g.get(a)||d&&g.get(a)&&a!==n?u.formatMessage({id:"msg__this_address_already_exists"}):l.current?u.formatMessage({id:"form__address_invalid"}):void 0}},children:Object(k.jsx)(x.default,{})})]})})}},i))},S=function(){var e=Object(o.default)(),t=Object(d.useNavigation)(),a=Object(d.useRoute)(),n=Object(i.useNetworks)(),l=a.params,f=l.defaultValues,b=l.uuid,j=Object(s.useCallback)((function(a){var s=n.find((function(e){return e.id===a.networkId}));s&&(c.default.dispatch(Object(u.update)({uuid:b,contact:{name:a.name,address:a.address,badge:s.impl,networkId:s.id}})),c.default.serviceCloudBackup.requestBackup(),r.default.show({title:e.formatMessage({id:"msg__address_changed"})}),t.goBack())}),[n,t,b,e]);return Object(k.jsx)(M,{defaultValues:{address:f.address,name:f.name,networkId:f.networkId},onSubmit:j,header:e.formatMessage({id:"title__edit_address"}),primaryActionTranslationId:"action__save",editing:!0})},I=function(){var e,t=Object(o.default)(),a=Object(d.useNavigation)(),n=null!=(e=Object(d.useRoute)().params)?e:{},i=n.onSelected,u=n.networkId,l=n.defaultAddress,f=Object(h.default)({defaultValues:{address:null!=l?l:""},mode:"onChange"}),j=f.control,O=f.watch,g=f.trigger,_=f.setError,v=f.setValue,w=f.handleSubmit,A=f.formState.isValid,C=Object(y.useDebounce)(O("address"),300);Object(s.useEffect)((function(){function e(){return(e=p()((function*(){if(C&&u)try{yield c.default.validator.validateAddress(u,C.trim()),g("address")}catch(e){_("address",{message:t.formatMessage({id:"form__address_invalid"})})}}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[C,u,g,_,t]);var M=Object(s.useCallback)(function(){var e=p()((function*(e){if(u)try{yield c.default.validator.validateAddress(u,e.address.trim())}catch(n){return void r.default.show({title:t.formatMessage({id:"form__address_invalid"})})}null==i||i({address:e.address.trim(),name:e.name}),a.goBack()}));return function(t){return e.apply(this,arguments)}}(),[a,i,t,u]);return Object(k.jsx)(b.default,{header:t.formatMessage({id:"form__enter_address"}),hideSecondaryAction:!0,primaryActionTranslationId:"action__confirm",primaryActionProps:{isDisabled:!A,onPress:function(){return w(M)()}},children:Object(k.jsx)(m.default.Item,{control:j,name:"address",rules:{required:{value:!0,message:t.formatMessage({id:"form__field_is_required"})}},children:Object(k.jsx)(x.default,{networkId:u,onChangeAddressName:function(e){return v("name",e)},plugins:["contact","paste","scan"]})})})},P=a(4321),R=function(){var e=Object(o.default)(),t=Object(d.useNavigation)(),a=(Object(d.useRoute)().params||{}).address,n=void 0===a?"":a,l=Object(i.useNetworks)(),f=Object(s.useCallback)(function(){var a=p()((function*(a){var n=l.find((function(e){return e.id===a.networkId}));if(a.networkId)try{yield c.default.validator.validateAddress(a.networkId,a.address)}catch(s){return void r.default.show({title:e.formatMessage({id:"form__address_invalid"})})}n&&(c.default.dispatch(Object(u.create)({name:a.name,address:a.address,badge:n.impl,networkId:n.id})),c.default.serviceCloudBackup.requestBackup(),r.default.show({title:e.formatMessage({id:"msg__address_added"})},{}),t.goBack())}));return function(e){return a.apply(this,arguments)}}(),[l,t,e]);return Object(k.jsx)(M,{defaultValues:{address:n,name:""},onSubmit:f,header:e.formatMessage({id:"action__add_new_address"}),showAlert:!0,primaryActionTranslationId:"action__add"})},B=a(411),N=a(567),E=a(13),T=a.n(E),D=a(4),V=a.n(D),L=a(471),q=a(51),U=a(201),z=a(64),H=a(236),W=a(27),J=a(100),F=a(108),G=a(80),K=a(163),Q=a(473),X=a(1066),Y=function(){return Object(k.jsx)(j.default,{mx:{base:4,md:6},children:Object(k.jsx)(J.default,{})})},Z=function(){var e,t=Object(o.default)(),a=Object(d.useNavigation)(),n=null!=(e=Object(d.useRoute)().params)?e:{},r=n.networkId,c=n.onSelected,i=Object(y.useAppSelector)((function(e){return e.contacts.contacts})),u=Object(s.useMemo)((function(){var e=Object.values(i);if(e=e.sort((function(e,t){return e.createAt,t.createAt,-1})),r){var t=r.split("--")[0];e=e.filter((function(e){return e.badge.toUpperCase()===t.toUpperCase()}))}return e}),[i,r]),l=Object(s.useCallback)((function(e){null==c||c({address:e.address,name:e.name}),a.goBack()}),[c,a]),f=Object(s.useCallback)((function(e){var t=e.item,a=e.index;return Object(k.jsxs)(z.default,{py:"4",px:"4",mx:{base:4,md:6},flexDirection:"row",alignItems:"center",bg:"surface-default",borderTopRadius:0===a?"12":void 0,borderBottomRadius:a===u.length-1?"12":void 0,onPress:function(){return l(t)},children:[Object(k.jsx)(j.default,{w:"8",h:"8",borderRadius:"full",bg:"decorative-surface-one",justifyContent:"center",alignItems:"center",children:Object(k.jsx)(W.default.DisplaySmall,{color:"decorative-icon-one",children:t.name.toUpperCase()[0]})}),Object(k.jsxs)(j.default,{flex:"1",ml:"4",children:[Object(k.jsxs)(j.default,{flexDirection:"row",children:[Object(k.jsx)(W.default.Body1Strong,{mr:"2",numberOfLines:1,maxWidth:"80%",children:t.name}),Object(k.jsx)(H.default,{size:"sm",title:t.badge.toUpperCase()})]}),Object(k.jsx)(j.default,{children:Object(k.jsx)(W.default.Body2,{color:"text-subdued",numberOfLines:2,children:t.address})})]})]})}),[u,l]),b=Object(s.useMemo)((function(){return Object(k.jsx)(q.default,{w:"full",h:"full",children:Object(k.jsx)(U.default,{title:t.formatMessage({id:"title__no_cantact"}),subTitle:t.formatMessage({id:"title__no_cantact_desc"}),emoji:"\ud83d\udcc7"})})}),[t]);return Object(k.jsx)(L.default,{ListEmptyComponent:b,data:u,ItemSeparatorComponent:Y,renderItem:f,keyExtractor:function(e){return e.address}})},$=function(){var e,t=Object(o.default)(),a=Object(i.useRuntime)().wallets,n=Object(d.useNavigation)(),r=null!=(e=Object(d.useRoute)().params)?e:{},u=r.networkId,l=r.onSelected,f=Object(s.useState)([]),b=V()(f,2),m=b[0],O=b[1];Object(s.useEffect)((function(){function e(){return(e=p()((function*(){for(var e=function*(){var e=a[t],n=yield c.default.engine.getAccounts(e.accounts,u);n&&n.length>0&&O((function(t){return[].concat(T()(t),[{wallet:e,data:n,key:e.id}])}))},t=0;t<a.length;t+=1)yield*e()}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var h=Object(s.useCallback)((function(e){null==l||l({address:e.address,name:e.name}),n.goBack()}),[l,n]),g=Object(s.useCallback)((function(e){return"external"===e.type?t.formatMessage({id:"content__external_account"}):"imported"===e.type?t.formatMessage({id:"wallet__imported_accounts"}):"watching"===e.type?t.formatMessage({id:"wallet__watched_accounts"}):e.name}),[t]);return Object(k.jsx)(N.default,{stickySectionHeadersEnabled:!1,sections:m,contentContainerStyle:{flexGrow:1},keyExtractor:function(e,t){return""+e.address+t},renderItem:function(e){var t=e.item,a=e.section,n=e.index;return Object(k.jsxs)(z.default,{flexDirection:"row",p:"4",bg:"surface-default",mx:{base:4,md:6},borderTopLeftRadius:0===n?"12":void 0,borderTopRightRadius:0===n?"12":void 0,borderBottomLeftRadius:n===a.data.length-1?"12":void 0,borderBottomRightRadius:n===a.data.length-1?"12":void 0,onPress:function(){return h({address:t.address,name:t.name})},alignItems:"center",children:[Object(k.jsx)(j.default,{mr:"3",children:Object(k.jsx)(Q.default,{avatar:a.wallet.avatar,walletImage:a.wallet.type,hwWalletType:a.wallet.deviceType||Object(G.getDeviceTypeByDeviceId)(a.wallet.associatedDevice),isPassphrase:Object(K.isPassphraseWallet)(a.wallet),size:"sm"})},t.address),Object(k.jsxs)(j.default,{flex:"1",children:[Object(k.jsx)(W.default.Body1Strong,{color:"text-default",numberOfLines:1,children:t.name}),Object(k.jsx)(W.default.Body2,{color:"text-subdued",children:Object(F.shortenAddress)(t.address)})]})]})},ItemSeparatorComponent:Y,renderSectionHeader:function(e){var t=e.section;return Object(k.jsx)(W.default.Subheading,{my:"2",mx:{base:4,md:6},children:g(t.wallet)})}})},ee=function(){var e,t=Object(o.default)(),a=Object(d.useRoute)(),n=Object(s.useState)(0),r=V()(n,2),c=r[0],i=r[1],u=Object(d.useNavigation)(),l=Object(s.useCallback)((function(){u.navigate(X.AddressBookRoutes.NewAddressRoute)}),[u]),f=Object(s.useMemo)((function(){return Object(k.jsx)($,{})}),[]),m=Object(s.useMemo)((function(){return Object(k.jsx)(Z,{})}),[]);return Object(k.jsxs)(b.default,{header:t.formatMessage({id:"title__select_contact"}),hideSecondaryAction:!0,footer:0===c?void 0:null,primaryActionTranslationId:"action__add_new_address",primaryActionProps:{leftIconName:"PlusMini",type:"basic",onPress:l},maxHeight:"560px",hidePrimaryAction:0!==c,staticChildrenProps:{flex:1,py:6},children:[Object(k.jsx)(j.default,{mb:"6",px:{base:4,md:6},children:null!=(e=a.params)&&e.contactExcludeWalletAccount?null:Object(k.jsx)(B.default,{values:[t.formatMessage({id:"title__address_book"}),t.formatMessage({id:"form__my_wallet"})],selectedIndex:c,onChange:i})}),Object(k.jsx)(j.default,{flex:"1",children:0===c?m:f})]})},te=a(234),ae=Object(te.default)(),ne=[{name:X.AddressBookRoutes.NewAddressRoute,component:R},{name:X.AddressBookRoutes.PickAddressRoute,component:ee},{name:X.AddressBookRoutes.EditAddressRoute,component:S},{name:X.AddressBookRoutes.EnterAddressRoute,component:I},{name:X.AddressBookRoutes.NewPickAddressRoute,component:P.default}];t.default=function(){var e=Object(n.default)();return Object(k.jsx)(ae.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:ne.map((function(e){return Object(k.jsx)(ae.Screen,{name:e.name,component:e.component},e.name)}))})}}}]);