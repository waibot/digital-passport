(this.webpackJsonp=this.webpackJsonp||[]).push([[5],{3943:function(e,t,n){"use strict";n.r(t),n.d(t,"useTokenSearch",(function(){return m})),n.d(t,"useCachedBalances",(function(){return h})),n.d(t,"useTokenBalanceSimple",(function(){return y})),n.d(t,"useTokenBalance",(function(){return b})),n.d(t,"useTokenPrice",(function(){return O}));var r=n(2),o=n.n(r),i=n(4),a=n.n(i),u=n(1),c=n(130),s=n(136),d=n(17),l=n(25),f=n(203),p=n(185);function v(e,t){if(t)return{combined:!1,symbol:"",networkName:""};var n=e.split(" ").filter((function(e){return Boolean(e)}));return 2===n.length?{combined:!0,symbol:n[0],networkName:n[1]}:{combined:!1,symbol:"",networkName:""}}var m=function(e,t){var n=Object(u.useState)(!1),r=a()(n,2),i=r[0],c=r[1],s=Object(u.useState)(),l=a()(s,2),f=l[0],m=l[1],h=Object(u.useRef)({keyword:"",count:0});return Object(u.useEffect)((function(){function n(){return(n=o()((function*(t,n){if(0!==t.length){c(!0),m([]);var r=[];try{h.current.count+=1;var o=v(t,n);if(o.combined){r=yield d.default.serviceSwap.searchTokens({keyword:o.symbol});var i=Object(p.appSelector)((function(e){return e.runtime.networks})).filter((function(e){return e.name.toLowerCase().includes(o.networkName.toLowerCase())})).map((function(e){return e.id})),a=new Set(i);r=r.filter((function(e){return a.has(e.networkId)})),t===h.current.keyword&&n===h.current.networkId&&m(r)}else r=yield d.default.serviceSwap.searchTokens({networkId:null!=n?n:void 0,keyword:e}),t===h.current.keyword&&n===h.current.networkId&&m(r)}finally{h.current.count-=1,0===h.current.count&&c(!1)}}else m(void 0)}))).apply(this,arguments)}h.current.keyword=e,h.current.networkId=t,function(e,t){n.apply(this,arguments)}(e,t)}),[e,t]),{loading:i,result:f}},h=function(e,t){var n=Object(l.useAccountTokensBalance)(e,t);return Object(l.useThrottle)(n,2e3)},y=function(e,t){var n=h(null==e?void 0:e.networkId,t);return Object(u.useMemo)((function(){if(e)return n[Object(s.getBalanceKey)(e)]}),[n,e])},b=function(e,t){var n=h(null==e?void 0:e.networkId,t);return Object(u.useEffect)((function(){e&&t&&Object(c.isAccountCompatibleWithNetwork)(t,e.networkId)&&d.default.serviceToken.getAccountTokenBalance({accountId:t,networkId:e.networkId,tokenIds:e.tokenIdOnNetwork?[e.tokenIdOnNetwork]:[]})}),[e,t]),Object(u.useMemo)((function(){var t;if(e)return null==(t=n[Object(s.getBalanceKey)(e)])?void 0:t.balance}),[n,e])},O=function(e){var t=Object(f.useSimpleTokenPriceValue)({networkId:null==e?void 0:e.networkId,contractAdress:null==e?void 0:e.tokenIdOnNetwork});return Object(u.useMemo)((function(){if(e)return t}),[t,e])}},3984:function(e,t,n){"use strict";n.r(t),n.d(t,"useTokenAmount",(function(){return m})),n.d(t,"useSwapState",(function(){return h})),n.d(t,"useSwapRecipient",(function(){return y})),n.d(t,"useSwapQuoteRequestParams",(function(){return b})),n.d(t,"useDerivedSwapState",(function(){return O})),n.d(t,"useSwapInputAmount",(function(){return g})),n.d(t,"useCheckInputBalance",(function(){return w})),n.d(t,"useSwapError",(function(){return k})),n.d(t,"useInputLimitsError",(function(){return j}));var r=n(6),o=n.n(r),i=n(1),a=n(21),u=n.n(a),c=n(88),s=n(25),d=n(946),l=n(188),f=n(3943),p=n(4019),v=function(){function e(e,t){this.token=e,this.typedValue=t,this.base=new u.a(10),this.value=new u.a(t),this.decimals=new u.a(e.decimals),this.amount=this.base.exponentiatedBy(this.decimals).multipliedBy(this.value)}var t=e.prototype;return t.toNumber=function(){return this.amount},t.toFormat=function(){return this.toNumber().toFixed(0)},o()(e)}();function m(e,t){return Object(i.useMemo)((function(){if(e&&t){var n=Object(l.getTokenAmountValue)(e,t);return new v(e,n.toFixed())}}),[e,t])}function h(){return Object(s.useAppSelector)((function(e){return e.swap}))}function y(){var e=Object(s.useAppSelector)((function(e){return e.swap.inputToken})),t=Object(s.useAppSelector)((function(e){return e.swap.outputToken})),n=Object(s.useAppSelector)((function(e){return e.swap.recipient})),r=Object(s.useAppSelector)((function(e){return e.swap.sendingAccount})),o=Object(s.useAppSelector)((function(e){return e.swap.allowAnotherRecipientAddress}));return Object(i.useMemo)((function(){if(e&&t&&(Object(l.recipientMustBeSendingAccount)(e,t,o)&&r))return{accountId:r.id,address:r.address,name:r.name,networkId:e.networkId,networkImpl:e.impl};return n}),[n,r,o,e,t])}function b(){var e=Object(p.useSwapSlippage)().value,t=Object(s.useAppSelector)((function(e){return e.swap.inputToken})),n=Object(s.useAppSelector)((function(e){return e.swap.outputToken})),r=Object(s.useAppSelector)((function(e){return e.swap.independentField})),o=Object(s.useAppSelector)((function(e){return e.swap.typedValue})),a=Object(s.useAppSelector)((function(e){return e.swap.inputTokenNetwork})),c=Object(s.useAppSelector)((function(e){return e.swap.outputTokenNetwork})),d=Object(s.useAppSelector)((function(e){return e.swap.sendingAccount})),l=y(),f=null==l?void 0:l.address,v=Object(i.useMemo)((function(){if(t&&n&&o&&a&&c&&d&&f&&!new u.a(o).lte(0))return{typedValue:o,independentField:r,networkOut:c,networkIn:a,tokenOut:n,tokenIn:t,slippagePercentage:e,activeAccount:d,receivingAddress:f}}),[o,r,t,n,a,c,e,d,f]);return Object(s.useDebounce)(v,500)}function O(){var e=Object(s.useAppSelector)((function(e){return e.swap.independentField})),t=Object(s.useAppSelector)((function(e){return e.swap.typedValue})),n=Object(s.useAppSelector)((function(e){return e.swap.inputToken})),r=Object(s.useAppSelector)((function(e){return e.swap.outputToken})),o=Object(s.useAppSelector)((function(e){return e.swap.quote})),a=m(n,Object(l.greaterThanZeroOrUndefined)(null==o?void 0:o.sellAmount)),u=m(r,Object(l.greaterThanZeroOrUndefined)(null==o?void 0:o.buyAmount)),c=null!=o&&o.wrapperTxInfo?18:void 0,d=Object(i.useMemo)((function(){var n,r="INPUT"===e?"OUTPUT":"INPUT";return(n={})[e]=t,n[r]="INPUT"===r?Object(l.formatAmount)(null==a?void 0:a.value,c):Object(l.formatAmount)(null==u?void 0:u.value,c),n}),[e,a,u,t,c]);return{inputAmount:a,outputAmount:u,formattedAmounts:d}}function g(){var e=Object(s.useAppSelector)((function(e){return e.swap.inputToken})),t=Object(s.useAppSelector)((function(e){return e.swap.typedValue}));return Object(i.useMemo)((function(){if(e&&t)return Object(l.getTokenAmountString)(e,t)}),[e,t])}var w=function(){var e=Object(s.useAppSelector)((function(e){return e.swap.inputToken})),t=Object(s.useAppSelector)((function(e){return e.swap.sendingAccount})),n=g(),r=Object(f.useTokenBalance)(n?e:void 0,null==t?void 0:t.id);return Object(i.useMemo)((function(){if(e&&r&&n)return{insufficient:new v(e,r).toNumber().lt(n),token:e}}),[e,r,n])},k=function(){var e=Object(s.useAppSelector)((function(e){return e.swap.error})),t=w();return Object(i.useMemo)((function(){return e||(t&&t.insufficient?d.SwapError.InsufficientBalance:void 0)}),[e,t])};function j(){var e=Object(c.default)(),t=Object(s.useAppSelector)((function(e){return e.swap.inputToken})),n=Object(s.useAppSelector)((function(e){return e.swap.quoteLimited})),r=O().inputAmount,o=m(t,null==n?void 0:n.max),a=m(t,null==n?void 0:n.min);return Object(i.useMemo)((function(){var n,i;if(r&&t&&(o||a)){if(a){var u=a.typedValue;a.amount.gt(r.amount)&&(n=e.formatMessage({id:"msg__str_minimum_amount"},{0:u+" "+t.symbol}),i=u)}if(o){var c=o.typedValue;o.amount.lt(r.amount)&&(n=e.formatMessage({id:"msg__str_maximum_amount"},{0:c+" "+t.symbol}),i=c)}}if(n&&i)return{message:n,value:i}}),[r,t,o,a,e])}},3986:function(e,t,n){"use strict";n.r(t);var r=n(12),o=n(3),i=n.n(o),a=(n(51),n(54),n(2)),u=n.n(a),c=n(15),s=n.n(c),d=n(1),l=(n(24),n(17)),f=(n(683),n(0)),p=Object(d.forwardRef)((function(e,t){var n=e.src,r=void 0===n?"":n,o=Object(d.useRef)(null),i=Object(d.useRef)({reload:function(){o.current&&(o.current.src="about:blank",setTimeout((function(){o.current&&(o.current.src=r)}),150))},loadURL:function(){}});return Object(d.useImperativeHandle)(t,(function(){return i.current})),Object(f.jsx)("iframe",{ref:o,title:"iframe-web",src:r,frameBorder:"0",style:{height:"100%",width:"100%"}})}));p.displayName="InpageProviderWebView";var v=p,m=["src","openUrlInExt","allowpopups","onWebViewRef","customReceiveHandler","containerProps"];function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.default=function(e){var t=e.src,n=void 0===t?"":t,o=(e.openUrlInExt,e.allowpopups),i=void 0!==o&&o,a=e.onWebViewRef,c=void 0===a?function(){}:a,p=e.customReceiveHandler,h=e.containerProps,b=s()(e,m),O=Object(d.useCallback)(function(){var e=u()((function*(e,t){var n=yield l.default.bridgeReceiveHandler(e);return yield null==p?void 0:p(e,t),n}));return function(t,n){return e.apply(this,arguments)}}(),[p]);return Object(f.jsx)(r.default,y(y({flex:1,bg:"background-default"},h),{},{children:Object(f.jsx)(v,y({ref:c,src:n,allowpopups:i,receiveHandler:O},b))}))}},4e3:function(e,t,n){"use strict";n.r(t),n.d(t,"SwapQuoter",(function(){return H}));var r=n(3),o=n.n(r),i=n(2),a=n.n(i),u=n(6),c=n.n(u),s=n(107),d=n.n(s),l=n(21),f=n.n(l),p=n(69),v=n(52),m=n(11),h=n(19),y=n(17),b=n(188),O=n(36),g=n(568),w=n(946);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(){function e(){this.type=w.QuoterType.zeroX,this.client=d.a.create({timeout:1e4})}var t=e.prototype;return t.getBaseUrl=function(){var e=a()((function*(e){var t,n=yield y.default.serviceSwap.getServerEndPoint();return((t={})[O.OnekeyNetwork.eth]=n+"/0x/quote?chainID=ethereum",t[O.OnekeyNetwork.bsc]=n+"/0x/quote?chainID=bsc",t[O.OnekeyNetwork.polygon]=n+"/0x/quote?chainID=polygon",t[O.OnekeyNetwork.fantom]=n+"/0x/quote?chainID=fantom",t[O.OnekeyNetwork.avalanche]=n+"/0x/quote?chainID=avalanche",t[O.OnekeyNetwork.celo]=n+"/0x/quote?chainID=celo",t[O.OnekeyNetwork.optimism]=n+"/0x/quote?chainID=optimism",t[O.OnekeyNetwork.arbitrum]=n+"/0x/quote?chainID=arbitrum",t)[e]}));return function(t){return e.apply(this,arguments)}}(),t.isSupported=function(e,t){return e.id===t.id&&g.zeroXenabledNetworkIds.includes(e.id)},t.getProviderLogo=function(e){return"https://common.onekey-asset.com/logo/"+e+".png"},t.fetch0xQuote=function(){var e=a()((function*(e,t){var n=this,r=(yield this.client.get(e,{params:t})).data.data;return{providers:(null==r?void 0:r.sources.filter((function(e){return Number(e.proportion)>0}))).map((function(e){return{name:e.name.split("_").join(" "),logoUrl:n.getProviderLogo(e.name)}})),data:r}}));return function(t,n){return e.apply(this,arguments)}}(),t.fetchQuote=function(){var e=a()((function*(e){var t,n=e.networkIn,r=e.networkOut,o=e.tokenIn,i=e.tokenOut,a=e.slippagePercentage,u=e.independentField,c=e.typedValue,s=e.activeAccount,d=e.receivingAddress;if(this.isSupported(n,r)&&d===s.address){var l=+a/100,f={sellToken:o.tokenIdOnNetwork||b.nativeTokenAddress,buyToken:i.tokenIdOnNetwork||b.nativeTokenAddress,slippagePercentage:Number.isNaN(l)?"0.03":String(l),feeRecipient:b.feeRecipient,affiliateAddress:b.affiliateAddress};"INPUT"===u?f.sellAmount=new b.TokenAmount(o,c).toFormat():f.buyAmount=new b.TokenAmount(i,c).toFormat();var p=yield this.getBaseUrl(o.networkId);if(p){var v=yield this.fetch0xQuote(p,f),m=v.providers,h=v.data,y={type:this.type,instantRate:h.price,allowanceTarget:h.allowanceTarget,buyAmount:h.buyAmount,buyTokenAddress:h.buyTokenAddress,sellAmount:h.sellAmount,sellTokenAddress:h.sellTokenAddress,arrivalTime:null!=(t=g.estimatedTime[n.id])?t:30,percentageFee:h.percentageFee,providers:m};return h.data&&(y.txData={from:s.address,to:h.to,data:h.data,value:h.value}),y.instantRate="INPUT"===u?h.price:Object(b.div)(1,h.price),{data:y}}}}));return function(t){return e.apply(this,arguments)}}(),t.buildTransaction=function(){var e=a()((function*(e){var t=e.networkIn,n=e.networkOut,r=e.tokenIn,o=e.tokenOut,i=e.slippagePercentage,a=e.independentField,u=e.typedValue,c=e.activeAccount,s=e.txData,d=e.receivingAddress;if(this.isSupported(t,n)&&d===c.address){if(s)return{data:s};var l=+i/100,f={sellToken:r.tokenIdOnNetwork||b.nativeTokenAddress,buyToken:o.tokenIdOnNetwork||b.nativeTokenAddress,slippagePercentage:Number.isNaN(l)?"0.03":String(l),feeRecipient:b.feeRecipient,affiliateAddress:b.affiliateAddress,takerAddress:c.address};"INPUT"===a?f.sellAmount=new b.TokenAmount(r,u).toFormat():f.buyAmount=new b.TokenAmount(o,u).toFormat();var p=yield this.getBaseUrl(r.networkId);if(p)return{data:j(j({},(yield this.fetch0xQuote(p,f)).data),{},{from:c.address})}}}));return function(t){return e.apply(this,arguments)}}(),t.queryTransactionProgress=function(){var e=a()((function*(e){var t=e.networkId,n=e.accountId,r=e.nonce;if(void 0!==r)return{status:yield y.default.serviceHistory.queryTransactionNonceStatus({networkId:t,accountId:n,nonce:r})};var o=yield y.default.serviceNetwork.rpcCall(t,{method:"eth_getTransactionReceipt",params:[e.hash]});return o?{status:1===Number(o.status)?"sucesss":"failed"}:Date.now()-e.addedTime>864e5?{status:"failed"}:void 0}));return function(t){return e.apply(this,arguments)}}(),c()(e)}();function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e){return e.tokenIdOnNetwork?e.tokenIdOnNetwork:"So11111111111111111111111111111111111111112"}var x=function(){function e(){this.type=w.QuoterType.jupiter,this.client=d.a.create({timeout:6e4})}var t=e.prototype;return t.getBaseURL=function(){var e=a()((function*(){return(yield y.default.serviceSwap.getServerEndPoint())+"/jupiter"}));return function(){return e.apply(this,arguments)}}(),t.isSupported=function(e,t){return e.id===t.id&&"sol"===e.impl},t.fetchPrice=function(){var e=a()((function*(e,t){var n=(yield this.getBaseURL())+"/v1/price",r=yield this.client.get(n,{params:{id:S(e),vsToken:S(t)}});if(r.data)return r.data.data}));return function(t,n){return e.apply(this,arguments)}}(),t.buildSwapTransaction=function(){var e=a()((function*(e,t,n){var r=(yield this.getBaseURL())+"/v1/swap",o=(yield this.client.post(r,{route:e,userPublicKey:t,outputMint:n})).data;if(!(null!=o&&o.cleanupTransaction||null!=o&&o.setupTransaction))return null==o?void 0:o.swapTransaction}));return function(t,n,r){return e.apply(this,arguments)}}(),t.findBestTransaction=function(){var e=a()((function*(e,t,n){for(var r=0;r<e.length;r+=1){var o=e[r],i=yield this.buildSwapTransaction(o,t,n);if(i)return{transaction:i,route:o}}}));return function(t,n,r){return e.apply(this,arguments)}}(),t.doQuote=function(){var e=a()((function*(e,t){var n,r=(yield this.getBaseURL())+"/v1/quote",o=yield this.client.get(r,{params:e});if(o.data){var i=o.data.data,a=yield this.findBestTransaction(i,t,e.outputMint);if(a)return A(A({},a),{},{percentageFee:null==o||null==(n=o.data)?void 0:n.percentageFee})}}));return function(t,n){return e.apply(this,arguments)}}(),t.refreshRecentBlockBash=function(){var e=a()((function*(e,t){return y.default.engine.solanaRefreshRecentBlockBash({transaction:t,accountId:e,networkId:O.OnekeyNetwork.sol})}));return function(t,n){return e.apply(this,arguments)}}(),t.findRouteAndTransaction=function(){var e=a()((function*(e){var t=e.tokenIn,n=e.tokenOut,r=e.typedValue,o=e.independentField,i=e.activeAccount,a={inputMint:S(t),outputMint:S(n),amount:Object(b.getTokenAmountString)("OUTPUT"===o?n:t,r),swapMode:"ExactIn",slippage:e.slippagePercentage,onlyDirectRoutes:!0};"OUTPUT"===o&&(a.swapMode="ExactOut");var u=yield this.doQuote(a,i.address);return u||(a.onlyDirectRoutes=!1,yield this.doQuote(a,i.address))}));return function(t){return e.apply(this,arguments)}}(),t.fetchRawQuote=function(){var e=a()((function*(e){var t=e.tokenIn,n=e.tokenOut,r=yield this.findRouteAndTransaction(e);if(r){var o=r.route,i=r.transaction,a=r.percentageFee;if(o)return{data:{type:this.type,instantRate:Object(b.calculateRate)(t.decimals,n.decimals,o.inAmount,o.outAmount),sellTokenAddress:S(t),buyTokenAddress:S(n),providers:[{name:"Jupiter",logoUrl:"https://common.onekey-asset.com/logo/Jupiter.png"}],arrivalTime:30,sellAmount:String(o.inAmount),buyAmount:String(o.outAmount),percentageFee:a,txData:i}}}}));return function(t){return e.apply(this,arguments)}}(),t.fetchAdjustedQuote=function(){var e=a()((function*(e){var t=e.tokenIn,n=e.tokenOut,r=e.typedValue;if("OUTPUT"===e.independentField){var o=yield this.fetchPrice(t,n);if(o){var i=Object(b.div)(r,o.price),a=A({},e);a.independentField="INPUT",a.typedValue=i;var u=yield this.findRouteAndTransaction(a);if(u){var c=u.route,s=u.transaction,d=new f.a(Object(b.getTokenAmountString)(n,r)),l=new f.a(c.outAmount).isGreaterThan(d.multipliedBy(.95));if(c&&l)return{data:{type:this.type,instantRate:Object(b.calculateRate)(t.decimals,n.decimals,c.inAmount,c.outAmount),sellTokenAddress:S(t),buyTokenAddress:S(n),providers:[{name:"Jupiter",logoUrl:"https://common.onekey-asset.com/logo/Jupiter.png"}],arrivalTime:30,sellAmount:String(c.inAmount),buyAmount:String(Object(b.getTokenAmountString)(n,r)),txData:s}}}}}}));return function(t){return e.apply(this,arguments)}}(),t.fetchQuote=function(){var e=a()((function*(e){if(e.activeAccount.address===e.receivingAddress){var t=yield this.fetchRawQuote(e);return t||this.fetchAdjustedQuote(e)}}));return function(t){return e.apply(this,arguments)}}(),t.buildTransaction=function(){var e=a()((function*(e){if(e.activeAccount.address===e.receivingAddress){var t=e.activeAccount;if(e.txData)if("string"===typeof e.txData)return{data:yield this.refreshRecentBlockBash(t.id,e.txData)};var n=yield this.findRouteAndTransaction(e);if(n){var r=n.transaction;return{data:yield this.refreshRecentBlockBash(r,t.id)}}}}));return function(t){return e.apply(this,arguments)}}(),t.queryTransactionProgress=function(){var e=a()((function*(e){var t=e.networkId,n=e.accountId,r=e.hash;return{status:yield y.default.serviceHistory.queryTransactionByTxid({networkId:t,accountId:n,txid:r})}}));return function(t){return e.apply(this,arguments)}}(),c()(e)}();function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=function(){function e(){this.type=w.QuoterType.mdex,this.client=d.a.create({timeout:1e4})}var t=e.prototype;return t.isSupported=function(e,t){return e.id===t.id&&!!g.quoterServerEndpoints[e.id]},t.fetchQuote=function(){var e=a()((function*(e){var t,n=e.networkIn,r=e.networkOut,o=e.tokenIn,i=e.tokenOut,a=e.slippagePercentage,u=e.independentField,c=e.typedValue,s=e.activeAccount,d=e.receivingAddress;if(this.isSupported(n,r)&&d===s.address){var l=+a/100,f={sellToken:o.tokenIdOnNetwork||b.nativeTokenAddress,buyToken:i.tokenIdOnNetwork||b.nativeTokenAddress,slippagePercentage:Number.isNaN(l)?"0.03":String(l),feeRecipient:b.feeRecipient,affiliateAddress:b.affiliateAddress};"INPUT"===u?f.sellAmount=new b.TokenAmount(o,c).toFormat():f.buyAmount=new b.TokenAmount(i,c).toFormat();var p=g.quoterServerEndpoints[o.networkId];if(p){var v=(yield this.client.get(p,{params:f})).data,m={type:this.type,instantRate:v.price,allowanceTarget:v.allowanceTarget,buyAmount:v.buyAmount,buyTokenAddress:v.buyTokenAddress,sellAmount:v.sellAmount,sellTokenAddress:v.sellTokenAddress,providers:null!=(t=g.networkProviderInfos[o.networkId])?t:[{name:"OneKey Swap"}],arrivalTime:15};return v.data&&(m.txData={from:s.address,to:v.to,data:v.data,value:v.value}),m.instantRate="INPUT"===u?v.price:Object(b.div)(1,v.price),{data:m}}}}));return function(t){return e.apply(this,arguments)}}(),t.buildTransaction=function(){var e=a()((function*(e){var t=e.networkIn,n=e.networkOut,r=e.tokenIn,o=e.tokenOut,i=e.slippagePercentage,a=e.independentField,u=e.typedValue,c=e.activeAccount,s=e.txData,d=e.receivingAddress;if(this.isSupported(t,n)&&d===c.address){if(s)return{data:s};var l=+i/100,f={sellToken:r.tokenIdOnNetwork||b.nativeTokenAddress,buyToken:o.tokenIdOnNetwork||b.nativeTokenAddress,slippagePercentage:Number.isNaN(l)?"0.03":String(l),feeRecipient:b.feeRecipient,affiliateAddress:b.affiliateAddress,takerAddress:c.address};"INPUT"===a?f.sellAmount=new b.TokenAmount(r,u).toFormat():f.buyAmount=new b.TokenAmount(o,u).toFormat();var p=g.quoterServerEndpoints[r.networkId];if(p)return{data:R(R({},(yield this.client.get(p,{params:f})).data),{},{from:c.address})}}}));return function(t){return e.apply(this,arguments)}}(),t.queryTransactionProgress=function(){var e=a()((function*(e){var t=e.networkId,n=e.accountId,r=e.nonce;if(void 0!==r)return{status:yield y.default.serviceHistory.queryTransactionNonceStatus({networkId:t,accountId:n,nonce:r})};var o=yield y.default.serviceNetwork.rpcCall(t,{method:"eth_getTransactionReceipt",params:[e.hash]});return o?{status:1===Number(o.status)?"sucesss":"failed"}:Date.now()-e.addedTime>36e5?{status:"failed"}:void 0}));return function(t){return e.apply(this,arguments)}}(),c()(e)}();function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D,E=function(){function e(){this.type=w.QuoterType.socket,this.client=d.a.create({timeout:3e4})}var t=e.prototype;return t.prepare=function(){this.refreshSupportedChains()},t.getBaseURL=function(){var e=a()((function*(){return(yield y.default.serviceSwap.getServerEndPoint())+"/socketBridge"}));return function(){return e.apply(this,arguments)}}(),t.fetchTokenPrice=function(){var e=a()((function*(e){var t,n=(yield this.getBaseURL())+"/token-price",r=yield this.client.get(n,{params:{tokenAddress:Object(b.getEvmTokenAddress)(e),chainId:Object(b.getChainIdFromNetworkId)(e.networkId)}});return null==r||null==(t=r.data)?void 0:t.result}));return function(t){return e.apply(this,arguments)}}(),t.fetchInstantTokenRate=function(){var e=a()((function*(e,t){var n=yield this.fetchTokenPrice(e),r=yield this.fetchTokenPrice(t);if(n&&r)return new f.a(r.tokenPrice).div(n.tokenPrice).toNumber()}));return function(t,n){return e.apply(this,arguments)}}(),t.fetchInstantTokenRateFromChain=function(){var e=a()((function*(e,t,n){var r,o,i,a,u=(yield this.getBaseURL())+"/quote",c={fromChainId:Object(b.getChainIdFromNetworkId)(e.networkId),fromTokenAddress:Object(b.getEvmTokenAddress)(e),toChainId:Object(b.getChainIdFromNetworkId)(t.networkId),toTokenAddress:Object(b.getEvmTokenAddress)(t),fromAmount:Object(b.getTokenAmountString)(e,"1"),userAddress:n,sort:"output",singleTxOnly:!0},s=yield this.client.get(u,{params:c}),d=null==(r=s)||null==(o=r.data)?void 0:o.result;if(d){if(d.routes.length>0){var l=d.routes[0],f=Object(b.calculateRate)(e.decimals,t.decimals,l.fromAmount,l.toAmount);return Number(f)}if(d.bridgeRouteErrors){var p=Object.values(d.bridgeRouteErrors).find((function(e){return e.maxAmount||e.minAmount}));if(p){var v=(null==p?void 0:p.maxAmount)||(null==p?void 0:p.minAmount);if(v&&(c.fromAmount=v,(d=null==(i=s=yield this.client.get(u,{params:c}))||null==(a=i.data)?void 0:a.result)&&d.routes.length>0)){var m=d.routes[0],h=Object(b.calculateRate)(e.decimals,t.decimals,m.fromAmount,m.toAmount);return Number(h)}}}}}));return function(t,n,r){return e.apply(this,arguments)}}(),t.refreshSupportedChains=function(){var e=a()((function*(){var e=yield this.fetchSupportedChains(),t=e.filter((function(e){return e.sendingEnabled})).map((function(e){return String(e.chainId)})),n=e.filter((function(e){return e.receivingEnabled})).map((function(e){return String(e.chainId)}));t.length>0&&(this.supportedSendingChainIds=t),n.length>0&&(this.supportedReceivingChainIds=n)}));return function(){return e.apply(this,arguments)}}(),t.fetchSupportedChains=function(){var e=a()((function*(){var e,t=yield this.getBaseURL(),n=yield this.client.get(t+"/supported/chains");return null==n||null==(e=n.data)?void 0:e.result}));return function(){return e.apply(this,arguments)}}(),t.getBridgeInfo=function(){var e=a()((function*(e){this.supportedBridges||(this.supportedBridges=yield this.fetchSupportedBridges());var t=this.supportedBridges.filter((function(t){return t.name===e||t.bridgeName===e}))[0];return{icon:null==t?void 0:t.icon,displayName:null==t?void 0:t.displayName}}));return function(t){return e.apply(this,arguments)}}(),t.fetchSupportedBridges=function(){var e=a()((function*(){var e,t=yield this.getBaseURL(),n=yield this.client.get(t+"/supported/bridges");return null==n||null==(e=n.data)?void 0:e.result}));return function(){return e.apply(this,arguments)}}(),t.isSupported=function(e,t){var n="evm"===e.impl&&"evm"===t.impl;if(!n)return!1;if(!this.supportedReceivingChainIds||!this.supportedSendingChainIds)return n;var r=Object(b.getChainIdFromNetwork)(e),o=Object(b.getChainIdFromNetwork)(t);return n&&this.supportedSendingChainIds.includes(r)&&this.supportedReceivingChainIds.includes(o)},t.fetchTransactionData=function(){var e=a()((function*(e){var t=yield this.getBaseURL();return(yield this.client.post(t+"/build-tx",{route:e})).data.result}));return function(t){return e.apply(this,arguments)}}(),t.fetchSimpleQuoteFromInput=function(){var e=a()((function*(e){var t,n,r=(yield this.getBaseURL())+"/quote";if(e.networkIn.id===e.networkOut.id&&"OUTPUT"!==e.independentField){var o;try{o=yield this.client.get(r,{params:{fromChainId:Object(b.getChainIdFromNetworkId)(e.networkIn.id),fromTokenAddress:Object(b.getEvmTokenAddress)(e.tokenIn),toChainId:Object(b.getChainIdFromNetworkId)(e.networkOut.id),toTokenAddress:Object(b.getEvmTokenAddress)(e.tokenOut),fromAmount:Object(b.getTokenAmountString)(e.tokenIn,e.typedValue),userAddress:e.activeAccount.address,recipient:e.receivingAddress,sort:"output",singleTxOnly:!0}})}catch(h){return}var i=null==(t=o)||null==(n=t.data)?void 0:n.result;if(i&&i.routes.length>0){var a=i.routes.find((function(e){return!!e.isOnlySwapRoute}));if(a){var u,c,s=a.fromAmount,d=Object(b.getEvmTokenAddress)(e.tokenIn),l=a.toAmount,f=Object(b.getEvmTokenAddress)(e.tokenOut),p=Object(b.calculateRate)(e.tokenIn.decimals,e.tokenOut.decimals,s,l),v=yield this.fetchTransactionData(a);v&&v.approvalData&&v.approvalData.allowanceTarget&&(u=v.approvalData.allowanceTarget),v&&(c={from:e.activeAccount.address,value:v.value,to:v.txTarget,data:v.txData});var m=[];if(a.userTxs)m=a.userTxs.filter((function(e){return e.protocol})).map((function(e){return e.protocol})).map((function(e){return{name:e.displayName,logoUrl:e.icon}}));return{data:{type:this.type,sellAmount:s,sellTokenAddress:d,buyAmount:l,buyTokenAddress:f,instantRate:p,allowanceTarget:u,txData:c,arrivalTime:30,providers:m}}}}}}));return function(t){return e.apply(this,arguments)}}(),t.fetchSimpleQuote=function(){var e=a()((function*(e){if("INPUT"===e.independentField)return this.fetchSimpleQuoteFromInput(e);var t=e.tokenIn,n=e.tokenOut,r=e.typedValue,o=yield this.fetchInstantTokenRateFromChain(t,n,e.activeAccount.address);if(o){var i=Object(b.div)(r,o),a=B({},e);a.independentField="INPUT",a.typedValue=i;var u=yield this.fetchSimpleQuoteFromInput(a);if(null==u||!u.data)return u;var c=new f.a(u.data.buyAmount),s=new f.a(Object(b.getTokenAmountString)(n,r));if(c.isGreaterThan(s.multipliedBy(.95))){var d=u.data;return d.buyAmount=Object(b.getTokenAmountString)(n,r),{data:d}}}}));return function(t){return e.apply(this,arguments)}}(),t.fetchMultichainQuoteFromInput=function(){var e=a()((function*(e){var t,n,r=this,o=(yield this.getBaseURL())+"/quote";if("OUTPUT"!==e.independentField){var i;try{i=yield this.client.get(o,{params:{fromChainId:Object(b.getChainIdFromNetworkId)(e.networkIn.id),fromTokenAddress:Object(b.getEvmTokenAddress)(e.tokenIn),toChainId:Object(b.getChainIdFromNetworkId)(e.networkOut.id),toTokenAddress:Object(b.getEvmTokenAddress)(e.tokenOut),fromAmount:Object(b.getTokenAmountString)(e.tokenIn,e.typedValue),userAddress:e.activeAccount.address,recipient:e.receivingAddress,sort:"output",singleTxOnly:!0}})}catch(w){return}var a=null==(t=i)||null==(n=t.data)?void 0:n.result;if(a&&a.routes.length>0){var u,c,s=a.routes[0],d=s.fromAmount,l=Object(b.getEvmTokenAddress)(e.tokenIn),f=s.toAmount,p=Object(b.getEvmTokenAddress)(e.tokenOut),v=Object(b.calculateRate)(e.tokenIn.decimals,e.tokenOut.decimals,d,f),m=yield this.fetchTransactionData(s);m&&m.approvalData&&m.approvalData.allowanceTarget&&(u=m.approvalData.allowanceTarget),m&&(c={from:e.activeAccount.address,value:m.value,to:m.txTarget,data:m.txData});var h=yield Promise.all(s.usedBridgeNames.map((function(e){return r.getBridgeInfo(e)}))),y=s.usedBridgeNames.map((function(e,t){var n,r;return{name:null==(n=h[t])?void 0:n.displayName,logoUrl:null==(r=h[t])?void 0:r.icon}}));return{data:{type:this.type,sellAmount:d,sellTokenAddress:l,buyAmount:f,buyTokenAddress:p,instantRate:v,allowanceTarget:u,txData:c,arrivalTime:s.serviceTime,providers:y,additionalParams:{socketUsedBridgeNames:s.usedBridgeNames}}}}var O=null==a?void 0:a.bridgeRouteErrors;if(O){var g=Object.values(O).filter((function(e){return e.maxAmount||e.minAmount})).map((function(e){return{max:e.maxAmount,min:e.minAmount}}));if(g.length>0)return{limited:Object(b.calculateRange)(g)}}}}));return function(t){return e.apply(this,arguments)}}(),t.fetchMultichainQuote=function(){var e=a()((function*(e){if("INPUT"===e.independentField)return this.fetchMultichainQuoteFromInput(e);var t=e.tokenIn,n=e.tokenOut,r=e.typedValue,o=yield this.fetchInstantTokenRateFromChain(t,n,e.activeAccount.address);if(o){var i=Object(b.div)(r,o),a=B({},e);a.independentField="INPUT",a.typedValue=i;var u=yield this.fetchMultichainQuoteFromInput(a);if(null==u||!u.data)return u;var c=new f.a(u.data.buyAmount),s=new f.a(Object(b.getTokenAmountString)(n,r));if(c.isGreaterThan(s.multipliedBy(.95))){var d=u.data;return d.buyAmount=Object(b.getTokenAmountString)(n,r),{data:d}}}}));return function(t){return e.apply(this,arguments)}}(),t.fetchQuote=function(){var e=a()((function*(e){if(this.isSupported(e.networkIn,e.networkOut))return e.networkIn.id===e.networkOut.id?this.fetchSimpleQuote(e):this.fetchMultichainQuote(e)}));return function(t){return e.apply(this,arguments)}}(),t.buildTransaction=function(){var e=a()((function*(e){var t=e.txData,n=e.additionalParams;if(t)return{data:t,attachment:{socketUsedBridgeNames:null==n?void 0:n.socketUsedBridgeNames}};var r,o,i=yield this.fetchQuote(e);if(null!=i&&i.data&&(null!=i&&null!=(r=i.data)&&r.txData))return{data:null==i?void 0:i.data.txData,attachment:{socketUsedBridgeNames:null==(o=i.data.additionalParams)?void 0:o.socketUsedBridgeNames}}}));return function(t){return e.apply(this,arguments)}}(),t.querySocketBridgeStatus=function(){var e=a()((function*(e){var t,n;try{var r=yield this.getBaseURL();n=yield this.client.get(r+"/bridge-status",{params:e})}catch(a){return}var o,i=n.data.result;return"COMPLETED"===i.sourceTxStatus&&"COMPLETED"===i.destinationTxStatus||"COMPLETED"===(null==(t=i.refuel)?void 0:t.status)?{status:"sucesss",destinationTransactionHash:i.destinationTransactionHash||(null==(o=i.refuel)?void 0:o.destinationTransactionHash)}:"FAILED"===i.destinationTxStatus||"FAILED"===i.sourceTxStatus?{status:"failed"}:void 0}));return function(t){return e.apply(this,arguments)}}(),t.queryCrosschainTransactionProgress=function(){var e=a()((function*(e){var t=e.nonce,n=e.networkId,r=e.accountId,o=e.tokens,i=e.attachment;if(void 0!==t&&o)for(var a=o.from,u=o.to,c=Object(b.getChainIdFromNetworkId)(a.networkId),s=Object(b.getChainIdFromNetworkId)(u.networkId),d=yield y.default.serviceHistory.getTransactionsWithNonce({nonce:t,networkId:n,accountId:r}),l=0;l<d.length;l+=1){var f,p=d[l].decodedTx.txid,v=yield this.querySocketBridgeStatus({fromChainId:c,toChainId:s,transactionHash:p,bridgeName:null==i||null==(f=i.socketUsedBridgeNames)?void 0:f[0]});if("sucesss"===(null==v?void 0:v.status))return{status:v.status,destinationTransactionHash:v.destinationTransactionHash};if("failed"===(null==v?void 0:v.status))return{status:v.status};if(null!=v&&v.destinationTransactionHash)return{destinationTransactionHash:v.destinationTransactionHash}}if(Date.now()-e.addedTime>864e5)return{status:"failed"}}));return function(t){return e.apply(this,arguments)}}(),t.querySimpleTransactionProgress=function(){var e=a()((function*(e){var t=e.networkId,n=e.accountId,r=e.nonce;if(void 0!==r)return{status:yield y.default.serviceHistory.queryTransactionNonceStatus({networkId:t,accountId:n,nonce:r})};var o=yield y.default.serviceNetwork.rpcCall(t,{method:"eth_getTransactionReceipt",params:[e.hash]});return o?{status:1===Number(o.status)?"sucesss":"failed"}:Date.now()-e.addedTime>864e5?{status:"failed"}:void 0}));return function(t){return e.apply(this,arguments)}}(),t.queryTransactionProgress=function(){var e=a()((function*(e){var t=e.tokens;if(t){var n=t.from,r=t.to;return n.networkId===r.networkId?this.querySimpleTransactionProgress(e):this.queryCrosschainTransactionProgress(e)}}));return function(t){return e.apply(this,arguments)}}(),c()(e)}(),F=((D={})[O.OnekeyNetwork.btc]="BTC",D[O.OnekeyNetwork.eth]="ETH",D[O.OnekeyNetwork.bsc]="BSC",D[O.OnekeyNetwork.heco]="HECO",D[O.OnekeyNetwork.polygon]="POLYGON",D[O.OnekeyNetwork.avalanche]="AVAXC",D[O.OnekeyNetwork.okt]="OKExChain",D[O.OnekeyNetwork.fantom]="FTM",D[O.OnekeyNetwork.arbitrum]="ARB",D[O.OnekeyNetwork.celo]="CELO",D[O.OnekeyNetwork.optimism]="Optimism",D[O.OnekeyNetwork.sol]="SOL",D[O.OnekeyNetwork.trx]="TRX",D[O.OnekeyNetwork.near]="NEAR",D[O.OnekeyNetwork.etc]="ETC",D[O.OnekeyNetwork.ethw]="ETHW",D[O.OnekeyNetwork.etf]="ETHF",D[O.OnekeyNetwork.doge]="DOGE",D[O.OnekeyNetwork.ltc]="LTC",D[O.OnekeyNetwork.bch]="BCH",D[O.OnekeyNetwork.apt]="APT",D[O.OnekeyNetwork.algo]="ALGO",D),M={};function L(e){var t;return null!=(t=F[e.id])?t:""}var U=function(){var e=t.prototype;function t(){this.type=w.QuoterType.swftc,this.coinsLastUpdate=0,this.coinCodeRecords={},this.coinCodeRecordsLastUpdate=0,this.networkAddrRecords={},this.networkAddrRecordsLastUpdate=0,this.client=d.a.create({timeout:6e4})}return e.getBaseUrl=function(){var e=a()((function*(){return(yield y.default.serviceSwap.getServerEndPoint())+"/swft"}));return function(){return e.apply(this,arguments)}}(),e.prepare=function(){this.getCoins()},e.isSupported=function(e,t){return!0},e.modifyTxId=function(){var e=a()((function*(e,t){var n=(yield this.getBaseUrl())+"/modifyTxId";return(yield this.client.post(n,{orderId:e,depositTxid:t})).data.data}));return function(t,n){return e.apply(this,arguments)}}(),e.getGroupedCoins=function(){var e=a()((function*(){var e=yield this.getCoins();return this.groupCoinsByChainId(e)}));return function(){return e.apply(this,arguments)}}(),e.getCoin=function(){var e=a()((function*(e,t){var n,r=L(e);return null==(n=(yield this.getNetworkAddrRecords())[r])?void 0:n[t]}));return function(t,n){return e.apply(this,arguments)}}(),e.getLocalCoins=function(){var e=a()((function*(){var e=y.default.serviceSwap;return this.coins?this.coins:yield e.getSwftcCoins()}));return function(){return e.apply(this,arguments)}}(),e.saveLocalCoins=function(){var e=a()((function*(e){var t=y.default.serviceSwap;yield t.setSwftcCoins(e),this.coins=e,this.coinsLastUpdate=Date.now()}));return function(t){return e.apply(this,arguments)}}(),e.getRemoteCoins=function(){var e=a()((function*(){var e=(yield this.getBaseUrl())+"/queryCoinList";return(yield this.client.post(e)).data.data}));return function(){return e.apply(this,arguments)}}(),e.updateCoins=function(){var e=a()((function*(){var e=yield this.getRemoteCoins();this.saveLocalCoins(e)}));return function(){return e.apply(this,arguments)}}(),e.getCoins=function(){var e=a()((function*(){var e=this,t=yield this.getLocalCoins();return t||(t=yield this.getRemoteCoins(),yield this.saveLocalCoins(t)),Date.now()-this.coinsLastUpdate>36e5&&setTimeout((function(){return e.updateCoins()}),10),t}));return function(){return e.apply(this,arguments)}}(),e.getNetworkAddrRecords=function(){var e=a()((function*(){if(this.networkAddrRecords&&Date.now()-this.networkAddrRecordsLastUpdate<36e5)return this.networkAddrRecords;var e=yield this.getCoins(),t={};return e.forEach((function(e){t[e.mainNetwork]||(t[e.mainNetwork]={});var n=e.contact||b.nativeTokenAddress;t[e.mainNetwork][n]=e})),this.networkAddrRecords=t,this.networkAddrRecordsLastUpdate=Date.now(),this.networkAddrRecords}));return function(){return e.apply(this,arguments)}}(),e.groupCoinsByChainId=function(e){var t={};return e.forEach((function(e){var n=function(e){if(M[e])return M[e];for(var t=Object.keys(F),n=0;n<t.length;n+=1){var r=t[n],o=F[r];if(o&&(M[o]=r,o===e))return r}}(e.mainNetwork);if(n){t[n]||(t[n]=[]);var r=e.contact||b.nativeTokenAddress;t[n].push(r)}})),t},e.fetchSwftcQuote=function(){var e=a()((function*(e){var t=e.networkIn,n=e.networkOut,r=e.tokenOut,o=e.tokenIn;if(this.isSupported(t,n)){var i=yield this.getNetworkAddrRecords(),a=L(t),u=L(n),c=Object(b.getEvmTokenAddress)(o),s=Object(b.getEvmTokenAddress)(r);if(a&&u){var d,l,f,p,v=null==(d=i[a])||null==(l=d[c])?void 0:l.coinCode,m=null==(f=i[u])||null==(p=f[s])?void 0:p.coinCode,h=(yield this.getBaseUrl())+"/getBaseInfo";if(v&&m)return{depositCoinCode:v,receiveCoinCode:m,rate:(yield this.client.post(h,{depositCoinCode:v,receiveCoinCode:m})).data.data}}}}));return function(t){return e.apply(this,arguments)}}(),e.fetchQuote=function(){var e=a()((function*(e){var t=e.independentField,n=e.tokenIn,r=e.typedValue,o=e.tokenOut,i=yield this.fetchSwftcQuote(e);if(i){var a={type:this.type,instantRate:i.rate.instantRate,sellTokenAddress:Object(b.getEvmTokenAddress)(n),buyTokenAddress:Object(b.getEvmTokenAddress)(o),providers:[{name:"SwftBridge",logoUrl:"https://common.onekey-asset.com/logo/SwftBridge.png"}],arrivalTime:300,sellAmount:"",buyAmount:"",percentageFee:i.rate.percentageFee};"INPUT"===t?(a.sellAmount=Object(b.getTokenAmountString)(n,r),a.buyAmount=Object(b.getTokenAmountString)(o,function(e,t,n,r){var o=new f.a(e),i=new f.a(t),a=new f.a(n),u=new f.a(r);return o.minus(o.multipliedBy(i)).multipliedBy(a).minus(u).toFixed()}(r,Object(b.plus)(i.rate.depositCoinFeeRate,"0"),i.rate.instantRate,i.rate.chainFee))):(a.buyAmount=Object(b.getTokenAmountString)(o,r),a.sellAmount=Object(b.getTokenAmountString)(n,function(e,t,n,r){var o=new f.a(e),i=new f.a(t),a=new f.a(n),u=new f.a(r);return o.plus(u).div(a).div(new f.a(1).minus(i)).toFixed()}(r,Object(b.plus)(i.rate.depositCoinFeeRate,"0"),i.rate.instantRate,i.rate.chainFee)));var u=new b.TokenAmount(n,i.rate.depositMax).toNumber(),c=new b.TokenAmount(n,i.rate.depositMin).toNumber();return{data:a,limited:{max:u.toFixed(),min:c.toFixed()}}}}));return function(t){return e.apply(this,arguments)}}(),e.buildTransaction=function(){var e=a()((function*(e){var t=e.typedValue,n=e.independentField,r=e.activeAccount,o=e.tokenIn,i=e.networkIn,a=e.receivingAddress,u=yield this.fetchSwftcQuote(e);if(u&&r){var c=u.depositCoinCode,s=u.receiveCoinCode,d=u.rate,l="",p="";"INPUT"===n?(l=t,p=Object(b.multiply)(t,d.instantRate)):(p=t,l=Object(b.div)(t,d.instantRate));var v=r.address,m=null!=a?a:r.address,h=r.address,O=yield this.createOrder(c,s,new f.a(l).toFixed(8,f.a.ROUND_DOWN),new f.a(p).toFixed(8,f.a.ROUND_DOWN),v,m,h);return O&&O.data?o.tokenIdOnNetwork?{data:yield y.default.engine.buildEncodedTxFromTransfer({networkId:i.id,accountId:r.id,transferInfo:{from:r.address,to:O.data.platformAddr,amount:l,token:o.tokenIdOnNetwork}}),attachment:{swftcOrderId:O.data.orderId}}:{data:yield y.default.engine.buildEncodedTxFromTransfer({networkId:i.id,accountId:r.id,transferInfo:{from:r.address,to:O.data.platformAddr,amount:l}}),attachment:{swftcOrderId:O.data.orderId}}:{error:{code:O.resCode,msg:O.resMsg}}}}));return function(t){return e.apply(this,arguments)}}(),e.createOrder=function(){var e=a()((function*(e,t,n,r,o,i,a){var u={equipmentNo:o,destinationAddr:i,refundAddr:a,depositCoinAmt:n,receiveCoinAmt:r,depositCoinCode:e,receiveCoinCode:t,sourceType:"H5",sourceFlag:"ONEKEY"},c=(yield this.getBaseUrl())+"/accountExchange";return(yield this.client.post(c,u)).data}));return function(t,n,r,o,i,a,u){return e.apply(this,arguments)}}(),e.getTxOrderInfo=function(){var e=a()((function*(e){var t,n,r=null!=(t=null==(n=e.attachment)?void 0:n.swftcOrderId)?t:e.thirdPartyOrderId;if(r){var o=(yield this.getBaseUrl())+"/queryOrderState";return(yield d.a.post(o,{equipmentNo:e.from,sourceType:"H5",orderId:r})).data.data}}));return function(t){return e.apply(this,arguments)}}(),e.queryTransactionProgress=function(){var e=a()((function*(e){var t,n,r=null!=(t=null==(n=e.attachment)?void 0:n.swftcOrderId)?t:e.thirdPartyOrderId;if(r){var o=(yield this.getBaseUrl())+"/queryOrderState",i=(yield d.a.post(o,{equipmentNo:e.from,sourceType:"H5",orderId:r})).data.data;if("complete"===i.tradeState)return{status:"sucesss",destinationTransactionHash:i.transactionId};if(i.transactionId)return{destinationTransactionHash:i.transactionId}}var a=e.networkId,u=e.accountId,c=e.nonce,s=e.hash;if("evm"===Object(p.getNetworkImpl)(a)&&void 0!==c){var l=yield y.default.serviceHistory.queryTransactionNonceStatus({networkId:a,accountId:u,nonce:c});if("canceled"===l||"failed"===l)return{status:l}}else if("evm"!==Object(p.getNetworkImpl)(a)){var f=yield y.default.serviceHistory.queryTransactionByTxid({networkId:a,accountId:u,txid:s});if("canceled"===f||"failed"===f)return{status:f}}if(Date.now()-e.addedTime>864e5)return{status:"failed"}}));return function(t){return e.apply(this,arguments)}}(),c()(t)}();function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=function(){function e(){this.httpClient=d.a.create({timeout:6e4}),this.jupiter=new x,this.swftc=new U,this.simple=new T,this.socket=new E,this.mdex=new N,this.quoters=[this.mdex,this.simple,this.socket,this.jupiter,this.swftc],this.transactionReceipts={},this.solTransactionReceipts={}}var t=e.prototype;return t.prepare=function(){this.quoters.forEach((function(e){null==e.prepare||e.prepare()}))},t.convertOrderToTransaction=function(){var e=a()((function*(e,t){var n=e.tokenIn,r=e.networkIn,o=e.activeAccount,i=e.sellAmount;if(i&&n){if(!t.platformAddr)throw new Error("failed to build transaction due to invalid platformAddr");var a=new f.a(i).shiftedBy(-n.decimals).toFixed();return n.tokenIdOnNetwork?yield y.default.engine.buildEncodedTxFromTransfer({networkId:r.id,accountId:o.id,transferInfo:{from:o.address,to:t.platformAddr,amount:a,token:n.tokenIdOnNetwork}}):yield y.default.engine.buildEncodedTxFromTransfer({networkId:r.id,accountId:o.id,transferInfo:{from:o.address,to:t.platformAddr,amount:a}})}}));return function(t,n){return e.apply(this,arguments)}}(),t.fetchLimitOrderQuote=function(){var e=a()((function*(e){var t,n,r=Object(b.convertLimitOrderParams)(e);if(r){r.quoterType="0x";var o=(yield y.default.serviceSwap.getServerEndPoint())+"/exchange/quote",i=null==(t=(yield this.httpClient.get(o,{params:r})).data)?void 0:t.data;if(i&&null!=(n=i.result)&&n.instantRate)return{instantRate:Object(b.formatAmountExact)(i.result.instantRate)}}}));return function(t){return e.apply(this,arguments)}}(),t.buildQuote=function(){var e=a()((function*(e){var t=e.responses,n=e.params;if(t&&0!==t.length){var r,o=t.filter((function(e){var t;return null==(t=e.result)?void 0:t.allowanceTarget})).map((function(e){return e.result.allowanceTarget})),i=yield y.default.engine.batchTokensAllowance({networkId:n.tokenIn.networkId,accountId:n.activeAccount.id,tokenIdOnNetwork:n.tokenIn.tokenIdOnNetwork,spenders:o});return i&&i.length===o.length&&o.forEach((function(e,t){var n=i[t];r||(r={}),r[e]=n})),t.map((function(e){var t,n=e.result,o=0;"swft"===n.quoter&&(o=.002);var i,a=o+Number(null!=(t=n.percentageFee)?t:0),u={type:n.quoter,quoterlogo:n.quoterLogo,instantRate:n.instantRate,sellAmount:n.sellAmount,sellTokenAddress:n.sellTokenAddress,buyAmount:n.buyAmount,buyTokenAddress:n.buyTokenAddress,providers:n.sources,percentageFee:n.percentageFee,allowanceTarget:n.allowanceTarget,arrivalTime:n.arrivalTime,needApproved:!1,estimatedBuyAmount:Object(b.multiply)(n.buyAmount,1-a),minAmountOut:n.minAmountOut,protocolFees:n.protocolFees,estimatedPriceImpact:n.estimatedPriceImpact};if(u.allowanceTarget&&r){var c=r[u.allowanceTarget];void 0!==c&&n.sellAmount&&(u.needApproved=Number(n.sellAmount)>c)}return e.limit&&(i={max:e.limit.max,min:e.limit.min}),{data:u,limited:i}}))}}));return function(t){return e.apply(this,arguments)}}(),t.fetchQuote=function(){var e=a()((function*(e){var t,n=Object(b.convertParams)(e);if(n){var r=yield y.default.serviceSwap.getCurrentUserSelectedQuoter();r&&(n.quoterType=r);var o=(yield y.default.serviceSwap.getServerEndPoint())+"/exchange/quote",i=null==(t=(yield this.httpClient.get(o,{params:n})).data)?void 0:t.data;if(i){var a=yield this.buildQuote({responses:[i],params:e});return null==a?void 0:a[0]}}}));return function(t){return e.apply(this,arguments)}}(),t.fetchQuotes=function(){var e=a()((function*(e){var t,n=Object(b.convertParams)(e);if(n){var r=(yield y.default.serviceSwap.getServerEndPoint())+"/exchange/quote_all",o=null==(t=(yield this.httpClient.get(r,{params:n})).data)?void 0:t.data;if(o){var i=yield this.buildQuote({responses:o,params:e});if(i)return i.filter((function(e){return Boolean(e)}))}}}));return function(t){return e.apply(this,arguments)}}(),t.parseRequestId=function(e){try{var t=e.config.headers,n=null==t?void 0:t["x-onekey-request-id"];if(!n){var r=null==t?void 0:t["X-Request-By"];if("string"===typeof r)n=JSON.parse(r)["x-onekey-request-id"]}return n}catch(o){h.default.common.error("Failed to get request id with reason",o.message)}},t.buildTransaction=function(){var e=a()((function*(e,t){var n,r=Object(b.convertBuildParams)(t);if(r){r.quoterType=e,r.disableValidate=Boolean(t.disableValidate);var o=(yield y.default.serviceSwap.getServerEndPoint())+"/exchange/build_tx",i=yield this.httpClient.post(o,r),a=this.parseRequestId(i),u=i.data;if(u.errMsg)throw new Error(u.errMsg);if(null!=u&&u.transaction)return"object"===typeof u.transaction?t.networkIn.impl===m.IMPL_APTOS?{data:_(_({},u.transaction),{},{sender:t.activeAccount.address}),result:u.result,requestId:a}:{data:_(_({},u.transaction),{},{from:t.activeAccount.address}),result:u.result,requestId:a}:{data:u.transaction,result:u.result,requestId:a};if(u.order&&null!=(n=u.result)&&n.instantRate)return{data:yield this.convertOrderToTransaction(t,u.order),result:u.result,attachment:{swftcOrderId:u.order.orderId,swftcPlatformAddr:u.order.platformAddr,swftcDepositCoinAmt:u.order.depositCoinAmt,swftcDepositCoinCode:u.order.depositCoinCode,swftcReceiveCoinAmt:u.order.receiveCoinAmt,swftcReceiveCoinCode:u.order.receiveCoinCode},requestId:a}}}));return function(t,n){return e.apply(this,arguments)}}(),t.fetchQuoteLegacy=function(){var e=a()((function*(e){for(var t=0;t<this.quoters.length;t+=1){var n=this.quoters[t];if(n.isSupported(e.networkOut,e.networkIn)){var r=yield n.fetchQuote(e);if(null!=r&&r.data)return r}}}));return function(t){return e.apply(this,arguments)}}(),t.buildTransactionLegacy=function(){var e=a()((function*(e,t){for(var n=0;n<this.quoters.length;n+=1){var r=this.quoters[n];if(r.type===e&&r.isSupported(t.networkOut,t.networkIn)){var o=yield r.buildTransaction(t);if(o)return o}}}));return function(t,n){return e.apply(this,arguments)}}(),t.queryTransactionProgress=function(){var e=a()((function*(e){if(Object(b.isSimpleTx)(e))return this.simple.queryTransactionProgress(e);for(var t=Object(b.getQuoteType)(e),n=0;n<this.quoters.length;n+=1){var r=this.quoters[n];if(r.type===t)return r.queryTransactionProgress(e)}}));return function(t){return e.apply(this,arguments)}}(),t.getHistoryTx=function(){var e=a()((function*(e){var t=y.default.serviceHistory,n=e.accountId,r=e.networkId,o=e.nonce;if(Object(p.getNetworkImpl)(e.networkId)!==m.IMPL_EVM||void 0===o)return(yield t.getLocalHistory({accountId:n,networkId:r})).find((function(t){return t.decodedTx.txid===e.hash}));var i=(yield t.getTransactionsWithNonce({accountId:n,networkId:r,nonce:o})).find((function(e){return e.decodedTx.status===v.IDecodedTxStatus.Confirmed}));return i||void 0}));return function(t){return e.apply(this,arguments)}}(),t.getTransactionReceipt=function(){var e=a()((function*(e,t){var n,r;if(this.transactionReceipts[e]||(this.transactionReceipts[e]={}),null!=(n=this.transactionReceipts[e])&&n[t])return null==(r=this.transactionReceipts[e])?void 0:r[t];var o=yield y.default.serviceNetwork.rpcCall(e,{method:"eth_getTransactionReceipt",params:[t]});return o?(this.transactionReceipts[e][t]=o,o):void 0}));return function(t,n){return e.apply(this,arguments)}}(),t.getSOLTransactionReceipt=function(){var e=a()((function*(e,t){var n,r;if(this.solTransactionReceipts[e]||(this.solTransactionReceipts[e]={}),null!=(n=this.solTransactionReceipts[e])&&n[t])return null==(r=this.solTransactionReceipts[e])?void 0:r[t];var o=yield y.default.serviceNetwork.rpcCall(e,{method:"getTransaction",params:[t,{encoding:"jsonParsed",maxSupportedTransactionVersion:0}]});return o?(this.solTransactionReceipts[e][t]=o,o):void 0}));return function(t,n){return e.apply(this,arguments)}}(),t.doQueryReceivedToken=function(){var e=a()((function*(e,t,n){if(Object(b.isEvmNetworkId)(t.networkId)){var r=yield this.getTransactionReceipt(t.networkId,e);if(r){var o,i=function(e){return"0x"+e.slice(2).replace(/^0+/,"").padStart(40,"0")};if(t.tokenIdOnNetwork){var a,u=null==(a=r.logs)?void 0:a.find((function(e){return i(e.address.toLowerCase())===t.tokenIdOnNetwork.toLowerCase()&&3===e.topics.length&&e.topics[2]&&i(e.topics[2])===n.toLowerCase()}));return null==u?void 0:u.data}var c=null==(o=r.logs)?void 0:o.find((function(e){if(2===e.topics.length){var t=e.topics[0];if("0x7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65"===i(t).toLowerCase())return!0}return!1}));return null==c?void 0:c.data}}else if(Object(b.isSolNetworkId)(t.networkId)){var s=yield this.getSOLTransactionReceipt(t.networkId,e);if(s){var d=function(e){var r=t.tokenIdOnNetwork;return e.owner.toLowerCase()===n.toLowerCase()&&e.mint.toLowerCase()===r.toLowerCase()},l=s.meta.preTokenBalances.find(d),f=s.meta.postTokenBalances.find(d);if(l&&f)return Object(b.minus)(f.uiTokenAmount.amount,l.uiTokenAmount.amount)}}}));return function(t,n,r){return e.apply(this,arguments)}}(),t.getActualReceived=function(){var e=a()((function*(e){if(e.tokens){var t=e.receivingAddress,n=e.tokens,r=n.from,o=n.to;if("swftc"===(null==e?void 0:e.quoterType)){var i=yield this.swftc.getTxOrderInfo(e);if(i)return i.receiveCoinAmt}else{var a=yield this.getHistoryTx(e),u=(null==a?void 0:a.decodedTx.txid)||e.hash;if(Object(b.isEvmNetworkId)(r.networkId)&&Object(b.isEvmNetworkId)(o.networkId)&&t){if(u&&r.networkId===o.networkId){var c=yield this.doQueryReceivedToken(u,o.token,t);if(c)return Object(b.getTokenAmountValue)(e.tokens.to.token,c).toFixed()}else if(e.destinationTransactionHash){var s=yield this.doQueryReceivedToken(e.destinationTransactionHash,o.token,t);if(s)return Object(b.getTokenAmountValue)(e.tokens.to.token,s).toFixed()}}else if(Object(b.isSolNetworkId)(r.networkId)&&Object(b.isSolNetworkId)(o.networkId)&&t){var d=yield this.doQueryReceivedToken(e.hash,o.token,t);if(d)return Object(b.getTokenAmountValue)(e.tokens.to.token,d).toFixed()}}}}));return function(t){return e.apply(this,arguments)}}(),t.getTxCompletedTime=function(){var e=a()((function*(e){if(e.tokens){var t=e.tokens.to;if(Object(b.isEvmNetworkId)(t.networkId)){var n=e.hash,r=yield this.getHistoryTx(e);null!=r&&r.decodedTx.txid&&(n=null==r?void 0:r.decodedTx.txid),e.destinationTransactionHash&&(n=e.destinationTransactionHash);var o=yield this.getTransactionReceipt(t.networkId,n);if(null!=o&&o.blockHash){var i=yield y.default.serviceNetwork.rpcCall(t.networkId,{method:"eth_getBlockByHash",params:[o.blockHash,!0]});if(null!=i&&i.timestamp)return new f.a(i.timestamp).multipliedBy(1e3).toFixed()}}}}));return function(t){return e.apply(this,arguments)}}(),t.getTxActualNetworkFee=function(){var e=a()((function*(e){if(e.tokens){var t=e.tokens.from;if(Object(b.isEvmNetworkId)(t.networkId)){var n=yield this.getHistoryTx(e),r=(null==n?void 0:n.decodedTx.txid)||e.hash,o=yield this.getTransactionReceipt(t.networkId,r);if(o&&o.gasUsed&&o.effectiveGasPrice){var i=yield y.default.engine.getNetwork(e.networkId);return Object(b.calculateNetworkFee)({limit:o.gasUsed,price:Object(b.div)(o.effectiveGasPrice,10**9)},i)}}}}));return function(t){return e.apply(this,arguments)}}(),t.swftModifyTxId=function(){var e=a()((function*(e,t){return this.swftc.modifyTxId(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),c()(e)}();H.client=new H},4019:function(e,t,n){"use strict";n.r(t),n.d(t,"useSummaryTx",(function(){return l})),n.d(t,"usePriceImpact",(function(){return f})),n.d(t,"useSlippageLevels",(function(){return p})),n.d(t,"useSwapSlippageAuto",(function(){return v})),n.d(t,"useSwapSlippage",(function(){return m})),n.d(t,"useSwapMinimumReceivedAmount",(function(){return h})),n.d(t,"useSwapChartMode",(function(){return y}));var r=n(50),o=n(1),i=n(21),a=n.n(i),u=n(88),c=n(25),s=n(188),d=n(3943);function l(){var e=Object(u.default)();return Object(o.useCallback)((function(t){var n;if("approve"===t.type)return t.approval?e.formatMessage({id:"title__approve"})+" "+(null==(n=t.approval)?void 0:n.token.symbol):""+e.formatMessage({id:"title__approve"});if("swap"===t.type&&t.tokens){var r=t.tokens,o=r.from,i=r.to;return Object(s.formatAmount)(o.amount,4)+" "+o.token.symbol+" \u2192 "+(Object(s.formatAmount)(i.amount,4)+" "+i.token.symbol)}return""}),[e])}function f(){var e=Object(c.useAppSelector)((function(e){return e.swap.inputToken})),t=Object(c.useAppSelector)((function(e){return e.swap.outputToken})),n=Object(d.useTokenPrice)(e),r=Object(d.useTokenPrice)(t),o=Object(c.useAppSelector)((function(e){var t;return null==(t=e.swap.quote)?void 0:t.instantRate}));if(r&&n&&o){var i=Object(s.div)(n,r);if(Object(s.lte)(o,i)){var a=Object(s.multiply)(Object(s.div)(Object(s.minus)(i,o),i),100);return Number(a)}}}function p(){var e=Object(c.useAppSelector)((function(e){return e.swapTransactions.recommendedSlippage}));return Object(o.useMemo)((function(){var t,n,r;return{stable:null!=(t=null==e?void 0:e.stable)?t:"0.1",popular:null!=(n=null==e?void 0:e.popular)?n:"0.5",others:null!=(r=null==e?void 0:e.others)?r:"1"}}),[e])}function v(){var e=Object(c.useAppSelector)((function(e){return e.swap.inputToken})),t=Object(c.useAppSelector)((function(e){return e.swap.outputToken})),n=Object(c.useAppSelector)((function(e){return e.swapTransactions.slippage})),r=Object(c.useAppSelector)((function(e){return e.swapTransactions.coingeckoIds})),i=p(),a=Object(o.useCallback)((function(e){if(r&&e){var t=r.popular,n=r.stable;return n&&n.includes(e)?{type:"stable",value:i.stable}:t&&t.includes(e)?{type:"popular",value:i.popular}:{type:"others",value:i.others}}}),[r,i]);return Object(o.useMemo)((function(){if((!n||"auto"===n.mode)&&e&&t){var r=a(e.coingeckoId),o=a(t.coingeckoId);return Number(null==r?void 0:r.value)>Number(null==o?void 0:o.value)?r:o}}),[n,e,t,a])}function m(){var e=Object(c.useAppSelector)((function(e){return e.swapTransactions.slippage})),t=v(),n=Object(o.useMemo)((function(){var n,r;return t?{mode:"auto",value:null!=(r=t.value)?r:"1"}:{mode:null==e?void 0:e.mode,value:null!=(n=null==e?void 0:e.value)?n:"1"}}),[t,e]);return Object(c.useDebounce)(n,500)}var h=function(){var e=Object(c.useAppSelector)((function(e){return e.swap.quote})),t=m().value;return Object(o.useMemo)((function(){if(e){var n=e.minAmountOut,r=e.estimatedBuyAmount,o=e.buyAmount;if(n)return Number(n);var i=r||o;if(i){var u=new a.a(i);if(!u.isNaN())return u.minus(u.multipliedBy(Number(t)/100)).toFixed()}}}),[e,t])},y=function(){var e=Object(c.useAppSelector)((function(e){return e.swapTransactions.swapChartMode}));return Object(r.default)()?"simple":null!=e?e:"chart"}},4020:function(e,t,n){"use strict";n.r(t),n.d(t,"isTransactionRecent",(function(){return d})),n.d(t,"useAllTransactions",(function(){return l})),n.d(t,"useWalletsAccounts",(function(){return f})),n.d(t,"useWalletsSwapTransactions",(function(){return p})),n.d(t,"useTransactionsAccount",(function(){return v}));var r=n(4),o=n.n(r),i=n(13),a=n.n(i),u=n(1),c=n(17),s=n(45);function d(e){return Date.now()-e.addedTime<864e5}function l(){var e=Object(s.useAppSelector)((function(e){return e.swapTransactions.transactions}));return Object(u.useMemo)((function(){var t=Object.values(e).reduce((function(e,t){return e.concat.apply(e,a()(Object.values(t)))}),[]);return a()(t).sort((function(e,t){return e.addedTime>t.addedTime?-1:1}))}),[e])}function f(){var e=Object(s.useAppSelector)((function(e){return e.runtime.wallets}));return Object(u.useMemo)((function(){return e.reduce((function(e,t){return e.concat(t.accounts.map((function(e){return{accountId:e,walletId:t.id}})))}),[])}),[e])}function p(){var e=function(){var e=l();return Object(u.useMemo)((function(){return e.filter((function(e){return"swap"===e.type}))}),[e])}(),t=f(),n=Object(s.useAppSelector)((function(e){return e.runtime.networks})),r=Object(u.useMemo)((function(){return n.map((function(e){return e.id}))}),[n]),o=Object(u.useMemo)((function(){return t.map((function(e){return e.accountId}))}),[t]);return e.filter((function(e){return o.includes(e.accountId)&&r.includes(e.networkId)}))}function v(e,t){var n=f(),r=Object(u.useState)((function(){return n.find((function(t){return t.accountId===e}))?void 0:null})),i=o()(r,2),a=i[0],s=i[1];return Object(u.useEffect)((function(){var r=n.find((function(t){return t.accountId===e}));r&&c.default.engine.getAccounts([r.accountId],t).then((function(e){var t=o()(e,1)[0];t&&s(t)}))}),[n,e,t]),a}},4023:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return w}));var r=n(3),o=n.n(r),i=n(15),a=n.n(i),u=n(64),c=n(41),s=n(27),d=n(51),l=n(747),f=n(40),p=n(1),v=n(4326),m=n(0),h=["buttons","selectedIndex","onButtonPress","size","bg","maxTextWidth"];function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=function(e){var t=e.text,n=e.leftIcon,r=e.leftImage,o=e.leftComponentRender,i=e.rightIcon,a=e.rightImage,v=e.rightComponentRender,h=e.isCurrent,y=e.onPress,b=e.leftIconSize,O=e.onLayout,g=e.size,w=e.maxTextWidth,k=e.leftIconSelectedColor,j=e.rightIconSelectedColor,T="sm"===g,I=b||(T?"16px":"20px"),A=k||"icon-hovered",S=j||"icon-hovered",x=Object(p.useMemo)((function(){var e="0px";return t.length>0&&(e=T?"4px":"8px"),e}),[T,t.length]);return Object(m.jsx)(u.default,{mr:"8px",onPress:y,onLayout:O,children:function(e){var u=e.isHovered,p=e.isPressed;return Object(m.jsxs)(c.default,{alignItems:"center",h:T?"32px":"36px",px:T?"8px":"12px",py:T?"6px":"8px",borderRadius:"9999px",bg:h?"surface-selected":p?"surface-pressed":u?"surface-hovered":"transparent",children:[(!!n||!!r)&&Object(m.jsxs)(d.default,{borderRadius:"9999px",w:I,h:I,mr:x,children:[!!n&&Object(m.jsx)(f.default,{name:n,color:h?A:"icon-default"}),!!r&&Object(m.jsx)(l.default,{height:I,width:I,src:r})]}),null==o?void 0:o(),t.length>0?Object(m.jsx)(s.default.Body2Strong,{maxW:w,isTruncated:!0,color:h?"text-default":"text-subdued",children:t}):null,(!!i||!!a)&&Object(m.jsxs)(d.default,{borderRadius:"9999px",w:I,h:I,mr:x,children:[!!i&&Object(m.jsx)(f.default,{name:i,color:h?S:"icon-default"}),!!a&&Object(m.jsx)(l.default,{height:I,width:I,src:a})]}),null==v?void 0:v()]})}})},g=function(e){var t=e.buttons,n=e.selectedIndex,r=e.onButtonPress,o=e.size,i=void 0===o?"sm":o,u=e.bg,c=void 0===u?"surface-default":u,s=e.maxTextWidth,d=a()(e,h);return Object(m.jsx)(v.default,b(b({bg:c,overflow:"hidden",w:"full",flexDirection:"row",alignItems:"center",position:"relative",selectedIndex:n},d),{},{children:t.map((function(e,t){return Object(m.jsx)(O,b(b({isCurrent:n===t},e),{},{size:i,maxTextWidth:s,onPress:function(){r(t)}}),t)}))}))};g.displayName="ToggleButtonGroup";var w=g},4033:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"HistoryRequestRoutes",(function(){return r})),function(e){e.HistoryRequestModal="HistoryRequestModal",e.TicketDetailModal="TicketDetailModal",e.ReplyTicketModel="ReplyTicketModel",e.SubmitRequestModal="SubmitRequestModal"}(r||(r={}))},4036:function(e,t,n){"use strict";n.r(t),n.d(t,"useSwapSend",(function(){return m})),n.d(t,"useSwapSignMessage",(function(){return h}));var r=n(2),o=n.n(r),i=n(1),a=n(130),u=n(19),c=n(17),s=n(111),d=n(137),l=n(16),f=n(80),p=n(95),v=n(188);function m(){var e=Object(s.default)(),t=Object(d.useAppSelector)((function(e){return e.settings.validationSetting}));return Object(i.useCallback)(function(){var n=o()((function*(n){var r=n.encodedTx,o=n.accountId,i=n.networkId,s=n.payloadInfo,d=n.onFail,m=n.onSuccess,h=n.onDetail,y=n.gasEstimateFallback,b=n.showSendFeedbackReceipt,O=Object(v.createLoggerTimer)(),g=Object(a.getWalletIdFromAccountId)(o),w=yield c.default.engine.getWallet(g),k=(yield c.default.servicePassword.getPassword())&&!(null!=t&&t.Payment);if("hw"===w.type||"external"!==w.type&&k)try{O.start(v.LoggerTimerTags.sendTransaction);var j=yield c.default.serviceSwap.sendTransaction({accountId:o,networkId:i,encodedTx:r,payload:s,autoFallback:y}),T=j.result,I=j.decodedTx;O.end(v.LoggerTimerTags.sendTransaction),yield null==m?void 0:m({result:T,decodedTx:I}),b&&setTimeout((function(){e.navigate(l.RootRoutes.Modal,{screen:l.ModalRoutes.Send,params:{screen:p.SendModalRoutes.SendFeedbackReceipt,params:{networkId:i,accountId:o,txid:T.txid,type:"Send"}}})}),10)}catch(x){var A,S=(null==x||null==(A=x.data)?void 0:A.message)||x.message;u.default.swap.error("swap send failed with message "+S),f.deviceUtils.showErrorToast(x,S),null==d||d(x)}else e.navigate(l.RootRoutes.Modal,{screen:l.ModalRoutes.Send,params:{screen:p.SendModalRoutes.SendConfirm,params:{accountId:o,networkId:i,payloadInfo:s,feeInfoEditable:!0,feeInfoUseFeeInTx:!1,encodedTx:r,hideSendFeedbackReceipt:!b,onDetail:h,onSuccess:function(e,t){var n;null==m||m({result:e,decodedTx:null!=(n=null==t?void 0:t.decodedTx)?n:void 0})}}}})}));return function(e){return n.apply(this,arguments)}}(),[t,e])}function h(){var e=Object(s.default)(),t=Object(d.useAppSelector)((function(e){return e.settings.validationSetting}));return Object(i.useCallback)(function(){var n=o()((function*(n){var r=n.accountId,o=n.networkId,i=n.unsignedMessage,u=n.onSuccess,s=n.onFail,d=Object(v.createLoggerTimer)(),m=Object(a.getWalletIdFromAccountId)(r),h=yield c.default.engine.getWallet(m),y=(yield c.default.servicePassword.getPassword())&&!(null!=t&&t.Payment);if("hw"===h.type||"external"!==h.type&&y)try{d.start(v.LoggerTimerTags.signMessage);var b=yield c.default.serviceTransaction.signMessage({accountId:r,networkId:o,unsignedMessage:i});d.end(v.LoggerTimerTags.signMessage),yield null==u?void 0:u(b)}catch(g){var O;f.deviceUtils.showErrorToast(g,(null==g||null==(O=g.data)?void 0:O.message)||g.message),null==s||s(g)}else e.navigate(l.RootRoutes.Modal,{screen:l.ModalRoutes.Send,params:{screen:p.SendModalRoutes.SignMessageConfirm,params:{accountId:r,networkId:o,unsignedMessage:i,onSuccess:u}}})}));return function(e){return n.apply(this,arguments)}}(),[e,t])}},4078:function(e,t,n){"use strict";n.r(t),n.d(t,"useLimitOrderParams",(function(){return h})),n.d(t,"useLimitOrderOutput",(function(){return y})),n.d(t,"useLimitOrders",(function(){return b})),n.d(t,"useAllLimitOrders",(function(){return O})),n.d(t,"useCheckLimitOrderInputBalance",(function(){return g})),n.d(t,"useCancelLimitOrderCallback",(function(){return w}));var r=n(48),o=n(2),i=n.n(o),a=n(13),u=n.n(a),c=n(1),s=n(88),d=n(17),l=n(25),f=n(259),p=n(188),v=n(4036),m=n(3943);function h(){var e=Object(l.useAppSelector)((function(e){return e.limitOrder.tokenIn})),t=Object(l.useAppSelector)((function(e){return e.limitOrder.tokenOut})),n=Object(l.useAppSelector)((function(e){return e.limitOrder.typedValue})),r=Object(l.useAppSelector)((function(e){return e.limitOrder.activeAccount})),o=Object(c.useMemo)((function(){if(e&&t&&n&&Object(p.gt)(n,0)&&r)return{tokenIn:e,tokenOut:t,tokenInValue:n,activeAccount:r}}),[e,t,n,r]);return Object(l.useDebounce)(o,500)}function y(){var e=Object(l.useAppSelector)((function(e){return e.limitOrder.instantRate})),t=Object(l.useAppSelector)((function(e){return e.limitOrder.typedValue}));return Object(c.useMemo)((function(){return e&&t?Object(p.multiply)(t,e):"0"}),[e,t])}function b(e,t){var n=Object(l.useAppSelector)((function(e){return e.swapTransactions.limitOrderDetails}));return Object(c.useMemo)((function(){if(!n||!e)return[];var r;if(e&&t)return null==(r=n[e])?void 0:r[t];var o=n[e];return o?Object.values(o).reduce((function(e,t){return e.concat(t)}),[]).sort((function(e,t){return t.createdAt-e.createdAt})):[]}),[n,e,t])}function O(){var e=Object(l.useAppSelector)((function(e){return e.swapTransactions.limitOrderDetails}));return Object(c.useMemo)((function(){return e?Object.values(e).reduce((function(e,t){return e.concat.apply(e,u()(Object.values(t)))}),[]).sort((function(e,t){return t.createdAt-e.createdAt})):[]}),[e])}var g=function(){var e=Object(l.useAppSelector)((function(e){return e.limitOrder.tokenIn})),t=Object(l.useAppSelector)((function(e){return e.limitOrder.activeAccount})),n=Object(l.useAppSelector)((function(e){return e.limitOrder.typedValue})),r=Object(m.useTokenBalance)(Object(p.gt)(n,0)?e:void 0,null==t?void 0:t.id);return Object(c.useMemo)((function(){if(e&&r&&n)return{insufficient:Object(p.lt)(r,n),token:e}}),[e,r,n])},w=function(){var e=Object(s.default)(),t=Object(v.useSwapSend)();return Object(c.useCallback)(function(){var n=i()((function*(n){var o=n.activeAccount,a=n.details;if(yield d.default.serviceSwap.checkAccountInWallets(o.id)){var u=a.limitOrder;if(!u)u=(yield d.default.serviceLimitOrder.fetchOrderState({networkId:a.networkId,orderHash:a.orderHash})).order;if(u){var c=yield d.default.serviceLimitOrder.buildCancelLimitOrderTx(u);yield t({accountId:a.accountId,networkId:a.networkId,encodedTx:{from:o.address,to:c.to,data:c.data,value:"0x00"},onSuccess:function(){var t=i()((function*(){d.default.dispatch(Object(f.updateLimitOrderTransaction)({networkId:a.networkId,accountId:a.accountId,orderHash:a.orderHash,details:{canceled:!0}})),r.default.show({title:e.formatMessage({id:"msg__success"})})}));return function(){return t.apply(this,arguments)}}()})}}else r.default.show({title:e.formatMessage({id:"msg__account_deleted"},{0:o.name})},{type:"error"})}));return function(e){return n.apply(this,arguments)}}(),[e,t])}},4145:function(e,t,n){"use strict";n.r(t);var r=n(64),o=n(40),i=n(20),a=n(4),u=n.n(a),c=n(1),s=n(21),d=n.n(s),l=n(188),f=n(0),p=function(e){var t=Object(l.formatAmount)(e,8),n=new d.a(t);return n.isZero()?Object(l.formatAmount)(e,16):n.isGreaterThan(1*10**9)?Object(l.formatAmount)(e,0):t};t.default=function(e){var t=e.tokenA,n=e.tokenB,a=e.rate,s=e.typography,d=void 0===s?"Body2":s,l=e.color,v=void 0===l?"text-default":l,m=e.hideIcon,h=Object(c.useState)(!1),y=u()(h,2),b=y[0],O=y[1];if(!t||!n||!a)return Object(f.jsx)(i.default,{typography:d,color:v,children:"---"});var g=t.symbol,w=n.symbol,k="";return k=b?"1 "+w+" \u2248 "+p(1/Number(a))+" "+g:"1 "+g+" \u2248 "+p(a)+" "+w,Object(f.jsxs)(r.default,{flexDirection:"row",alignItems:"center",onPress:function(){return O((function(e){return!e}))},children:[Object(f.jsx)(i.default,{typography:d,color:v,textAlign:"right",mr:"1",selectable:!1,children:k}),m?null:Object(f.jsx)(o.default,{size:16,name:"ArrowsRightLeftMini",color:"icon-subdued"})]})}},4146:function(e,t,n){"use strict";n.r(t),n.d(t,"OneKeyLogo",(function(){return s})),n.d(t,"SwappingViaLogos",(function(){return d}));var r=n(20),o=n(51),i=n(12),a=n(106),u=n(0);function c(e){return"https://node.onekey.so/proxyimg?base="+e}var s=function(e){var t=e.size||4;return Object(u.jsx)(i.default,{borderRadius:"full",w:t,h:t,overflow:"hidden",bgColor:"surface-neutral-default",children:Object(u.jsx)(a.default,{size:t,source:n(4298)})})},d=function(e){var t=e.sources,n=e.size||4;if(!t||0===t.length)return Object(u.jsx)(s,{});if(1===t.length)return Object(u.jsx)(i.default,{borderRadius:"full",w:n,h:n,overflow:"hidden",bgColor:"surface-neutral-default",children:Object(u.jsx)(a.default,{size:n,src:c(t[0]),testID:t[0]})},t[0]);var r=function(e,t){return e<=0?0:-t/2};return Object(u.jsx)(i.default,{flexDirection:"row",alignItems:"center",children:t.map((function(e,t){return Object(u.jsx)(o.default,{ml:r(t,n),borderRadius:"full",h:n,w:n,overflow:"hidden",bgColor:"surface-neutral-default",children:Object(u.jsx)(a.default,{size:n,src:c(e)})},e)}))})};t.default=function(e){var t=e.providers,n=e.typography,o=void 0===n?"Caption":n,a=e.color,c=void 0===a?"text-subdued":a,s=e.fontWeight,l=void 0===s?400:s;if(!t)return Object(u.jsx)(i.default,{flexDirection:"row",flexGrow:1,children:Object(u.jsx)(r.default,{typography:o,color:c,isTruncated:!0,children:"OneKey Swap"})});if(1===t.length)return Object(u.jsxs)(i.default,{flexDirection:"row",alignItems:"center",flexGrow:1,children:[t[0].logoUrl?Object(u.jsx)(d,{sources:[t[0].logoUrl]}):null,Object(u.jsx)(r.default,{ml:2,typography:o,color:c,fontWeight:l,isTruncated:!0,children:t[0].name})]});if(t.length>1){var f=t.map((function(e){return e.logoUrl})).filter(Boolean);return Object(u.jsxs)(i.default,{alignItems:"center",flexDirection:"row",flexGrow:1,children:[f.length>0?Object(u.jsx)(d,{sources:f}):null,Object(u.jsxs)(r.default,{ml:"2",typography:o,color:c,fontWeight:l,isTruncated:!0,children:[t.length," Exchanges"]})]})}return Object(u.jsx)(i.default,{alignItems:"center",flexDirection:"row",flexGrow:1,children:Object(u.jsx)(r.default,{typography:o,color:c,children:"OneKey Swap"})})}},4298:function(e,t,n){e.exports=n.p+"static/media/logo.b0cff82f.png"},4326:function(e,t,n){"use strict";n.r(t);var r=n(12),o=n(51),i=n(3),a=n.n(i),u=n(82),c=n(15),s=n.n(c),d=n(1),l=n(171),f=n(2259),p=n(207),v=n(902),m=n(365),h=n(0),y=["children","renderLeftArrow","renderRightArrow","bg","selectedIndex","leftButtonProps","rightButtonProps"];function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g={code:"function anonymous({contentOffset:contentOffset,contentSize:contentSize}){const{currentOffsetX,showLeftArrow,showRightArrow,containerWidth}=this._closure;currentOffsetX.value=contentOffset.x;showLeftArrow.value=currentOffsetX.value>0;showRightArrow.value=Math.floor(contentSize.width-currentOffsetX.value)>containerWidth.value;}",location:"/home/runner/work/digital-passport/digital-passport/packages/components/src/ScrollableButtonGroup/ScrollableButtonGroup.tsx"},w={code:"function anonymous(){const{withTiming,showLeftArrow}=this._closure;return{opacity:withTiming(showLeftArrow.value?1:0,{duration:300}),scale:withTiming(showLeftArrow.value?1:0,{duration:300}),zIndex:withTiming(showLeftArrow.value?1:-1,{duration:300})};}",location:"/home/runner/work/digital-passport/digital-passport/packages/components/src/ScrollableButtonGroup/ScrollableButtonGroup.tsx"},k={code:"function anonymous(){const{withTiming,showRightArrow}=this._closure;return{opacity:withTiming(showRightArrow.value?1:0,{duration:300}),scale:withTiming(showRightArrow.value?1:0,{duration:300}),zIndex:withTiming(showRightArrow.value?1:-1,{duration:300})};}",location:"/home/runner/work/digital-passport/digital-passport/packages/components/src/ScrollableButtonGroup/ScrollableButtonGroup.tsx"},j=Object(d.forwardRef)((function(e,t){var n=e.children,i=e.renderLeftArrow,a=e.renderRightArrow,c=e.bg,b=void 0===c?"surface-default":c,j=e.selectedIndex,T=e.leftButtonProps,I=e.rightButtonProps,A=s()(e,y),S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(d.useRef)(t);return Object(d.useEffect)((function(){e&&("function"===typeof e?e(n.current):e.current=n.current)}),[e]),n}(t),x=Object(l.useSharedValue)(!1),P=Object(l.useSharedValue)(!1),R=Object(l.useSharedValue)(0),N=Object(l.useSharedValue)(0),C=Object(l.useSharedValue)(0),B=Object(d.useCallback)((function(e){C.value=e,N.value&&(P.value=Math.floor(C.value-R.value)>N.value)}),[]),D=Object(f.useAnimatedScrollHandler)(function(){var e=function(e){var t=e.contentOffset,n=e.contentSize;R.value=t.x,x.value=R.value>0,P.value=Math.floor(n.width-R.value)>N.value};return e._closure={currentOffsetX:R,showLeftArrow:x,showRightArrow:P,containerWidth:N},e.__initData=g,e.__workletHash=0xa0ebe17979e,e}(),[]),E=Object(d.useRef)([]),F=Object(d.useRef)(0),M=Object(d.useRef)(),L=Object(d.useCallback)((function(e){if(S.current){var t=E.current[e];if(t&&F.current){var n=t.x+t.width/2-F.current/2;return M.current=void 0,S.current.scrollTo({x:n,animated:!0})}}M.current=e}),[S]),U=d.Children.count(n);Object(d.useEffect)((function(){E.current=[],M.current=void 0}),[U]),Object(d.useEffect)((function(){void 0!==j&&L(j)}),[L,j]);var q=Object(d.useCallback)((function(){var e;null==(e=S.current)||e.scrollTo({x:R.value-N.value||0,animated:!0})}),[]),_=Object(d.useCallback)((function(){var e;null==(e=S.current)||e.scrollTo({x:R.value+N.value,animated:!0})}),[]),H=Object(d.useCallback)((function(e){var t=e.nativeEvent.layout.width;N.value=t,P.value=Math.floor(C.value-R.value)>N.value}),[]);return Object(h.jsxs)(r.default,O(O({bg:b},A),{},{onLayout:H,children:[Object(h.jsx)(p.default.View,{style:[{position:"absolute"},Object(v.useAnimatedStyle)(function(){var e=function(){return{opacity:Object(m.withTiming)(x.value?1:0,{duration:300}),scale:Object(m.withTiming)(x.value?1:0,{duration:300}),zIndex:Object(m.withTiming)(x.value?1:-1,{duration:300})}};return e._closure={withTiming:m.withTiming,showLeftArrow:x},e.__initData=w,e.__workletHash=0xeb84360e287,e}(),[])],children:Object(h.jsx)(o.default,{bg:b,children:i?i({onPress:q}):Object(h.jsx)(u.default,O({type:"plain",circle:!0,name:"ChevronLeftMini",size:"sm",onPress:q},T))})}),Object(h.jsx)(p.default.ScrollView,{ref:S,onLayout:function(e){var t=e.nativeEvent.layout.width;F.current=t,M.current&&L(M.current)},style:{flex:1},horizontal:!0,onScroll:D,scrollEventThrottle:16,showsHorizontalScrollIndicator:!1,onContentSizeChange:B,children:d.Children.map(n,(function(e,t){return Object(d.cloneElement)(e,O(O({},e.props),{},{onPress:function(){L(t),null==e.props.onPress||e.props.onPress()},onLayout:function(e){var n=e.nativeEvent.layout,r=n.width,o=n.x;E.current[t]={x:o,width:r}}}))}))}),Object(h.jsx)(p.default.View,{style:[{position:"absolute",right:0},Object(v.useAnimatedStyle)(function(){var e=function(){return{opacity:Object(m.withTiming)(P.value?1:0,{duration:300}),scale:Object(m.withTiming)(P.value?1:0,{duration:300}),zIndex:Object(m.withTiming)(P.value?1:-1,{duration:300})}};return e._closure={withTiming:m.withTiming,showRightArrow:P},e.__initData=k,e.__workletHash=3239759055399,e}(),[])],children:Object(h.jsx)(o.default,{bg:b,children:a?a({onPress:_}):Object(h.jsx)(u.default,O({type:"plain",circle:!0,name:"ChevronRightMini",size:"sm",onPress:_},I))})})]}))}));j.displayName="ScrollableButtonGroup";t.default=j},4518:function(e,t,n){"use strict";n.r(t),n.d(t,"ArrivalTime",(function(){return u}));var r=n(20),o=n(1),i=n(88),a=n(0),u=function(e){var t=e.value,n=e.typography,u=void 0===n?"Caption":n,c=e.color,s=void 0===c?"text-subdued":c,d=Object(i.default)(),l=Object(o.useMemo)((function(){if(!t)return d.formatMessage({id:"content__str_mins"},{content__str_mins:1});if(t<60)return d.formatMessage({id:"content__str_seconds"},{content__str_seconds:t});var e=Math.ceil(t/60);return d.formatMessage({id:"content__str_mins"},{content__str_mins:e})}),[t,d]);return Object(a.jsxs)(r.default,{typography:u,color:s,children:["<",l]})}},4519:function(e,t,n){"use strict";n.r(t),n.d(t,"Scheduler",(function(){return v}));var r=n(3),o=n.n(r),i=n(2),a=n.n(i),u=n(6),c=n.n(u),s=n(1),d=n(17),l=n(259),f=n(4e3);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var v=function(){function e(e){this.tx=e}var t=e.prototype;return t.run=function(){var e=this;this.runTask();var t=this.getMs();t?this.timer=setTimeout((function(){e.run()}),t):this.stop()},t.stop=function(){this.timer&&(clearTimeout(this.timer),this.timer=void 0)},t.getMs=function(){var e=this.tx,t=e.addedTime,n=e.tokens,r=(null==n?void 0:n.from.networkId)===(null==n?void 0:n.to.networkId)?5e3:3e4;return Date.now()-t<=36e5?r:3e5},t.runTask=function(){var e=a()((function*(){var e=this.tx,t=yield f.SwapQuoter.client.queryTransactionProgress(e);if(t){var n=t.status;if(n&&"pending"!==n&&(this.stop(),d.default.dispatch(Object(l.updateTransaction)({accountId:e.accountId,networkId:e.networkId,hash:e.hash,transaction:{confirmedTime:Date.now(),status:n}})),e.tokens)){var r=e.tokens.from,i=r.token.tokenIdOnNetwork?[r.token.tokenIdOnNetwork]:[];if(d.default.serviceToken.getAccountTokenBalance({accountId:e.accountId,networkId:r.networkId,tokenIds:i}),e.receivingAddress){var a=yield d.default.serviceAccount.getAccountByAddress({address:e.receivingAddress}),u=e.tokens.to;if(a){var c=u.token.tokenIdOnNetwork?[u.token.tokenIdOnNetwork]:[];d.default.serviceToken.getAccountTokenBalance({accountId:a.id,networkId:u.networkId,tokenIds:c})}}}var s=t.destinationTransactionHash;if(t.destinationTransactionHash&&d.default.dispatch(Object(l.updateTransaction)({accountId:e.accountId,networkId:e.networkId,hash:e.hash,transaction:{destinationTransactionHash:t.destinationTransactionHash}})),"sucesss"===n){var v=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);v.destinationTransactionHash=s;var m=yield f.SwapQuoter.client.getActualReceived(v);d.default.dispatch(Object(l.updateTransaction)({accountId:e.accountId,networkId:e.networkId,hash:e.hash,transaction:{actualReceived:m}}));var h=yield f.SwapQuoter.client.getTxCompletedTime(e);h&&d.default.dispatch(Object(l.updateTransaction)({accountId:e.accountId,networkId:e.networkId,hash:e.hash,transaction:{confirmedTime:Number(h)}}));var y=yield f.SwapQuoter.client.getTxActualNetworkFee(e);y&&d.default.dispatch(Object(l.updateTransaction)({accountId:e.accountId,networkId:e.networkId,hash:e.hash,transaction:{networkFee:y}}))}}}));return function(){return e.apply(this,arguments)}}(),c()(e)}();t.default=function(e){var t=e.tx;return Object(s.useEffect)((function(){var e=new v(t);return e.run(),function(){e.stop()}}),[]),null}},4520:function(e,t,n){"use strict";n.r(t);var r=n(12),o=n(20),i=n(21),a=n.n(i),u=n(88),c=n(946),s=n(0);function d(e){if(!e)return"0";var t=new a.a(e);return(t=t.multipliedBy(100)).isNaN()?"0":t.toFixed()}function l(e){return!!e&&[c.QuoterType.mdex].includes(e)}t.default=function(e){var t=e.type,n=e.percentageFee,i=e.typography,a=void 0===i?"Caption":i,c=e.color,f=void 0===c?"text-subdued":c,p=Object(u.default)();return Object(s.jsx)(r.default,{children:l(t)||n&&0===Number(n)?Object(s.jsxs)(r.default,{flexDirection:"column",alignItems:"flex-end",children:[Object(s.jsx)(o.default,{typography:a,color:f,strikeThrough:!0,children:"0.3%"}),Object(s.jsx)(o.default,{typography:a,color:f,children:p.formatMessage({id:"form__free_limited_time"})})]}):Object(s.jsx)(o.default,{typography:a,color:f,children:n?d(n)+"%":" 0.3%"})})}}}]);