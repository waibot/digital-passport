/*! For license information please see 27.f306e3c1.chunk.js.LICENSE.txt */
(this.webpackJsonp=this.webpackJsonp||[]).push([[27],{3911:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(4790),i=r(4791),s=r(3971),o=r(3932),u=r(3970),a=r(4792),c=r(2684);t.OPS=r(4210);const f=r(4793),p=t.OPS.OP_RESERVED;function h(e){return s.Buffer(e)||function(e){return s.Number(e)&&(e===t.OPS.OP_0||e>=t.OPS.OP_1&&e<=t.OPS.OP_16||e===t.OPS.OP_1NEGATE)}(e)}function d(e){return s.Array(e)&&e.every(h)}function l(e){return 0===e.length?t.OPS.OP_0:1===e.length?e[0]>=1&&e[0]<=16?p+e[0]:129===e[0]?t.OPS.OP_1NEGATE:void 0:void 0}function w(t){return e.isBuffer(t)}function _(t){return e.isBuffer(t)}function y(t){if(w(t))return t;c(s.Array,t);const r=t.reduce((e,t)=>_(t)?1===t.length&&void 0!==l(t)?e+1:e+a.encodingLength(t.length)+t.length:e+1,0),n=e.allocUnsafe(r);let i=0;if(t.forEach(e=>{if(_(e)){const t=l(e);if(void 0!==t)return n.writeUInt8(t,i),void(i+=1);i+=a.encode(n,e.length,i),e.copy(n,i),i+=e.length}else n.writeUInt8(e,i),i+=1}),i!==n.length)throw new Error("Could not decode chunks");return n}function b(e){if(r=e,s.Array(r))return e;var r;c(s.Buffer,e);const n=[];let i=0;for(;i<e.length;){const r=e[i];if(r>t.OPS.OP_0&&r<=t.OPS.OP_PUSHDATA4){const t=a.decode(e,i);if(null===t)return null;if(i+=t.size,i+t.number>e.length)return null;const r=e.slice(i,i+t.number);i+=t.number;const s=l(r);void 0!==s?n.push(s):n.push(r)}else n.push(r),i+=1}return n}function E(e){const t=-193&e;return t>0&&t<4}t.isPushOnly=d,t.compile=y,t.decompile=b,t.toASM=function(e){return w(e)&&(e=b(e)),e.map(e=>{if(_(e)){const t=l(e);if(void 0===t)return e.toString("hex");e=t}return f[e]}).join(" ")},t.fromASM=function(r){return c(s.String,r),y(r.split(" ").map(r=>void 0!==t.OPS[r]?t.OPS[r]:(c(s.Hex,r),e.from(r,"hex"))))},t.toStack=function(r){return r=b(r),c(d,r),r.map(r=>_(r)?r:r===t.OPS.OP_0?e.allocUnsafe(0):n.encode(r-p))},t.isCanonicalPubKey=function(e){return u.isPoint(e)},t.isDefinedHashType=E,t.isCanonicalScriptSignature=function(t){return!!e.isBuffer(t)&&(!!E(t[t.length-1])&&o.check(t.slice(0,-1)))},t.number=n,t.signature=i}).call(this,r(26).Buffer)},3925:function(e){e.exports=JSON.parse('{"COMPRESSED_TYPE_INVALID":"compressed should be a boolean","EC_PRIVATE_KEY_TYPE_INVALID":"private key should be a Buffer","EC_PRIVATE_KEY_LENGTH_INVALID":"private key length is invalid","EC_PRIVATE_KEY_RANGE_INVALID":"private key range is invalid","EC_PRIVATE_KEY_TWEAK_ADD_FAIL":"tweak out of range or resulting private key is invalid","EC_PRIVATE_KEY_TWEAK_MUL_FAIL":"tweak out of range","EC_PRIVATE_KEY_EXPORT_DER_FAIL":"couldn\'t export to DER format","EC_PRIVATE_KEY_IMPORT_DER_FAIL":"couldn\'t import from DER format","EC_PUBLIC_KEYS_TYPE_INVALID":"public keys should be an Array","EC_PUBLIC_KEYS_LENGTH_INVALID":"public keys Array should have at least 1 element","EC_PUBLIC_KEY_TYPE_INVALID":"public key should be a Buffer","EC_PUBLIC_KEY_LENGTH_INVALID":"public key length is invalid","EC_PUBLIC_KEY_PARSE_FAIL":"the public key could not be parsed or is invalid","EC_PUBLIC_KEY_CREATE_FAIL":"private was invalid, try again","EC_PUBLIC_KEY_TWEAK_ADD_FAIL":"tweak out of range or resulting public key is invalid","EC_PUBLIC_KEY_TWEAK_MUL_FAIL":"tweak out of range","EC_PUBLIC_KEY_COMBINE_FAIL":"the sum of the public keys is not valid","ECDH_FAIL":"scalar was invalid (zero or overflow)","ECDSA_SIGNATURE_TYPE_INVALID":"signature should be a Buffer","ECDSA_SIGNATURE_LENGTH_INVALID":"signature length is invalid","ECDSA_SIGNATURE_PARSE_FAIL":"couldn\'t parse signature","ECDSA_SIGNATURE_PARSE_DER_FAIL":"couldn\'t parse DER signature","ECDSA_SIGNATURE_SERIALIZE_DER_FAIL":"couldn\'t serialize signature to DER format","ECDSA_SIGN_FAIL":"nonce generation function failed or private key is invalid","ECDSA_RECOVER_FAIL":"couldn\'t recover public key from signature","MSG32_TYPE_INVALID":"message should be a Buffer","MSG32_LENGTH_INVALID":"message length is invalid","OPTIONS_TYPE_INVALID":"options should be an Object","OPTIONS_DATA_TYPE_INVALID":"options.data should be a Buffer","OPTIONS_DATA_LENGTH_INVALID":"options.data length is invalid","OPTIONS_NONCEFN_TYPE_INVALID":"options.noncefn should be a Function","RECOVERY_ID_TYPE_INVALID":"recovery should be a Number","RECOVERY_ID_VALUE_INVALID":"recovery should have value between -1 and 4","TWEAK_TYPE_INVALID":"tweak should be a Buffer","TWEAK_LENGTH_INVALID":"tweak length is invalid"}')},3926:function(e,t,r){(function(t){var n=r(1346);function i(e,t){if(void 0!==t&&e[0]!==t)throw new Error("Invalid network version");if(33===e.length)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(34!==e.length)throw new Error("Invalid WIF length");if(1!==e[33])throw new Error("Invalid compression flag");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}function s(e,r,n){var i=new t(n?34:33);return i.writeUInt8(e,0),r.copy(i,1),n&&(i[33]=1),i}e.exports={decode:function(e,t){return i(n.decode(e),t)},decodeRaw:i,encode:function(e,t,r){return"number"===typeof e?n.encode(s(e,t,r)):n.encode(s(e.version,e.privateKey,e.compressed))},encodeRaw:s}}).call(this,r(26).Buffer)},3932:function(e,t,r){var n=r(313).Buffer;e.exports={check:function(e){if(e.length<8)return!1;if(e.length>72)return!1;if(48!==e[0])return!1;if(e[1]!==e.length-2)return!1;if(2!==e[2])return!1;var t=e[3];if(0===t)return!1;if(5+t>=e.length)return!1;if(2!==e[4+t])return!1;var r=e[5+t];return 0!==r&&(6+t+r===e.length&&(!(128&e[4])&&(!(t>1&&0===e[4]&&!(128&e[5]))&&(!(128&e[t+6])&&!(r>1&&0===e[t+6]&&!(128&e[t+7]))))))},decode:function(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(48!==e[0])throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(2!==e[2])throw new Error("Expected DER integer");var t=e[3];if(0===t)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(2!==e[4+t])throw new Error("Expected DER integer (2)");var r=e[5+t];if(0===r)throw new Error("S length is zero");if(6+t+r!==e.length)throw new Error("S length is invalid");if(128&e[4])throw new Error("R value is negative");if(t>1&&0===e[4]&&!(128&e[5]))throw new Error("R value excessively padded");if(128&e[t+6])throw new Error("S value is negative");if(r>1&&0===e[t+6]&&!(128&e[t+7]))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}},encode:function(e,t){var r=e.length,i=t.length;if(0===r)throw new Error("R length is zero");if(0===i)throw new Error("S length is zero");if(r>33)throw new Error("R length is too long");if(i>33)throw new Error("S length is too long");if(128&e[0])throw new Error("R value is negative");if(128&t[0])throw new Error("S value is negative");if(r>1&&0===e[0]&&!(128&e[1]))throw new Error("R value excessively padded");if(i>1&&0===t[0]&&!(128&t[1]))throw new Error("S value excessively padded");var s=n.allocUnsafe(6+r+i);return s[0]=48,s[1]=s.length-2,s[2]=2,s[3]=e.length,e.copy(s,4),s[4+r]=2,s[5+r]=t.length,t.copy(s,6+r),s}}},3936:function(e,t,r){"use strict";e.exports=r(3937)(r(3940))},3937:function(e,t,r){"use strict";var n=r(3938),i=r(3939),s=r(3925);function o(e,t){return void 0===e?t:(n.isBoolean(e,s.COMPRESSED_TYPE_INVALID),e)}e.exports=function(e){return{privateKeyVerify:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),32===t.length&&e.privateKeyVerify(t)},privateKeyExport:function(t,r){n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0);var u=e.privateKeyExport(t,r);return i.privateKeyExport(t,u,r)},privateKeyImport:function(t){if(n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),(t=i.privateKeyImport(t))&&32===t.length&&e.privateKeyVerify(t))return t;throw new Error(s.EC_PRIVATE_KEY_IMPORT_DER_FAIL)},privateKeyNegate:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyNegate(t)},privateKeyModInverse:function(t){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyModInverse(t)},privateKeyTweakAdd:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakAdd(t,r)},privateKeyTweakMul:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),e.privateKeyTweakMul(t,r)},publicKeyCreate:function(t,r){return n.isBuffer(t,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyCreate(t,r)},publicKeyConvert:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyConvert(t,r)},publicKeyVerify:function(t){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),e.publicKeyVerify(t)},publicKeyTweakAdd:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakAdd(t,r,i)},publicKeyTweakMul:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,s.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakMul(t,r,i)},publicKeyCombine:function(t,r){n.isArray(t,s.EC_PUBLIC_KEYS_TYPE_INVALID),n.isLengthGTZero(t,s.EC_PUBLIC_KEYS_LENGTH_INVALID);for(var i=0;i<t.length;++i)n.isBuffer(t[i],s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t[i],33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID);return r=o(r,!0),e.publicKeyCombine(t,r)},signatureNormalize:function(t){return n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),e.signatureNormalize(t)},signatureExport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=e.signatureExport(t);return i.signatureExport(r)},signatureImport:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImport(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},signatureImportLax:function(t){n.isBuffer(t,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,s.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImportLax(t);if(r)return e.signatureImport(r);throw new Error(s.ECDSA_SIGNATURE_PARSE_DER_FAIL)},sign:function(t,r,i){n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID);var o=null,u=null;return void 0!==i&&(n.isObject(i,s.OPTIONS_TYPE_INVALID),void 0!==i.data&&(n.isBuffer(i.data,s.OPTIONS_DATA_TYPE_INVALID),n.isBufferLength(i.data,32,s.OPTIONS_DATA_LENGTH_INVALID),o=i.data),void 0!==i.noncefn&&(n.isFunction(i.noncefn,s.OPTIONS_NONCEFN_TYPE_INVALID),u=i.noncefn)),e.sign(t,r,u,o)},verify:function(t,r,i){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isBuffer(i,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(i,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),e.verify(t,r,i)},recover:function(t,r,i,u){return n.isBuffer(t,s.MSG32_TYPE_INVALID),n.isBufferLength(t,32,s.MSG32_LENGTH_INVALID),n.isBuffer(r,s.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,s.ECDSA_SIGNATURE_LENGTH_INVALID),n.isNumber(i,s.RECOVERY_ID_TYPE_INVALID),n.isNumberInInterval(i,-1,4,s.RECOVERY_ID_VALUE_INVALID),u=o(u,!0),e.recover(t,r,i,u)},ecdh:function(t,r){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),e.ecdh(t,r)},ecdhUnsafe:function(t,r,i){return n.isBuffer(t,s.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,s.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,s.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,s.EC_PRIVATE_KEY_LENGTH_INVALID),i=o(i,!0),e.ecdhUnsafe(t,r,i)}}}},3938:function(e,t,r){"use strict";(function(e){var r=Object.prototype.toString;t.isArray=function(e,t){if(!Array.isArray(e))throw TypeError(t)},t.isBoolean=function(e,t){if("[object Boolean]"!==r.call(e))throw TypeError(t)},t.isBuffer=function(t,r){if(!e.isBuffer(t))throw TypeError(r)},t.isFunction=function(e,t){if("[object Function]"!==r.call(e))throw TypeError(t)},t.isNumber=function(e,t){if("[object Number]"!==r.call(e))throw TypeError(t)},t.isObject=function(e,t){if("[object Object]"!==r.call(e))throw TypeError(t)},t.isBufferLength=function(e,t,r){if(e.length!==t)throw RangeError(r)},t.isBufferLength2=function(e,t,r,n){if(e.length!==t&&e.length!==r)throw RangeError(n)},t.isLengthGTZero=function(e,t){if(0===e.length)throw RangeError(t)},t.isNumberInInterval=function(e,t,r,n){if(e<=t||e>=r)throw RangeError(n)}}).call(this,r(26).Buffer)},3939:function(e,t,r){"use strict";var n=r(313).Buffer,i=r(3932),s=n.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),o=n.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);t.privateKeyExport=function(e,t,r){var i=n.from(r?s:o);return e.copy(i,r?8:9),t.copy(i,r?181:214),i},t.privateKeyImport=function(e){var t=e.length,r=0;if(!(t<r+1||48!==e[r])&&!(t<(r+=1)+1)&&128&e[r]){var n=127&e[r];if(r+=1,!(n<1||n>2)&&!(t<r+n)){var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);if(!(t<(r+=n)+i)&&!(t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2])&&!(t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]))return e.slice(r+2,r+2+e[r+1])}}},t.signatureExport=function(e){for(var t=n.concat([n.from([0]),e.r]),r=33,s=0;r>1&&0===t[s]&&!(128&t[s+1]);--r,++s);for(var o=n.concat([n.from([0]),e.s]),u=33,a=0;u>1&&0===o[a]&&!(128&o[a+1]);--u,++a);return i.encode(t.slice(s),o.slice(a))},t.signatureImport=function(e){var t=n.alloc(32,0),r=n.alloc(32,0);try{var s=i.decode(e);if(33===s.r.length&&0===s.r[0]&&(s.r=s.r.slice(1)),s.r.length>32)throw new Error("R length is too long");if(33===s.s.length&&0===s.s[0]&&(s.s=s.s.slice(1)),s.s.length>32)throw new Error("S length is too long")}catch(o){return}return s.r.copy(t,32-s.r.length),s.s.copy(r,32-s.s.length),{r:t,s:r}},t.signatureImportLax=function(e){var t=n.alloc(32,0),r=n.alloc(32,0),i=e.length,s=0;if(48===e[s++]){var o=e[s++];if(!(128&o&&(s+=o-128)>i)&&2===e[s++]){var u=e[s++];if(128&u){if(s+(o=u-128)>i)return;for(;o>0&&0===e[s];s+=1,o-=1);for(u=0;o>0;s+=1,o-=1)u=(u<<8)+e[s]}if(!(u>i-s)){var a=s;if(s+=u,2===e[s++]){var c=e[s++];if(128&c){if(s+(o=c-128)>i)return;for(;o>0&&0===e[s];s+=1,o-=1);for(c=0;o>0;s+=1,o-=1)c=(c<<8)+e[s]}if(!(c>i-s)){var f=s;for(s+=c;u>0&&0===e[a];u-=1,a+=1);if(!(u>32)){var p=e.slice(a,a+u);for(p.copy(t,32-p.length);c>0&&0===e[f];c-=1,f+=1);if(!(c>32)){var h=e.slice(f,f+c);return h.copy(r,32-h.length),{r:t,s:r}}}}}}}}}},3940:function(e,t,r){"use strict";var n=r(313).Buffer,i=r(746),s=r(166),o=r(521).ec,u=r(3925),a=new o("secp256k1"),c=a.curve;function f(e){var t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){var r=new s(t);if(r.cmp(c.p)>=0)return null;var n=(r=r.toRed(c.red)).redSqr().redIMul(r).redIAdd(c.b).redSqrt();return 3===e!==n.isOdd()&&(n=n.redNeg()),a.keyPair({pub:{x:r,y:n}})}(t,e.slice(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,r){var n=new s(t),i=new s(r);if(n.cmp(c.p)>=0||i.cmp(c.p)>=0)return null;if(n=n.toRed(c.red),i=i.toRed(c.red),(6===e||7===e)&&i.isOdd()!==(7===e))return null;var o=n.redSqr().redIMul(n);return i.redSqr().redISub(o.redIAdd(c.b)).isZero()?a.keyPair({pub:{x:n,y:i}}):null}(t,e.slice(1,33),e.slice(33,65));default:return null}}t.privateKeyVerify=function(e){var t=new s(e);return t.cmp(c.n)<0&&!t.isZero()},t.privateKeyExport=function(e,t){var r=new s(e);if(r.cmp(c.n)>=0||r.isZero())throw new Error(u.EC_PRIVATE_KEY_EXPORT_DER_FAIL);return n.from(a.keyFromPrivate(e).getPublic(t,!0))},t.privateKeyNegate=function(e){var t=new s(e);return t.isZero()?n.alloc(32):c.n.sub(t).umod(c.n).toArrayLike(n,"be",32)},t.privateKeyModInverse=function(e){var t=new s(e);if(t.cmp(c.n)>=0||t.isZero())throw new Error(u.EC_PRIVATE_KEY_RANGE_INVALID);return t.invm(c.n).toArrayLike(n,"be",32)},t.privateKeyTweakAdd=function(e,t){var r=new s(t);if(r.cmp(c.n)>=0)throw new Error(u.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);if(r.iadd(new s(e)),r.cmp(c.n)>=0&&r.isub(c.n),r.isZero())throw new Error(u.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);return r.toArrayLike(n,"be",32)},t.privateKeyTweakMul=function(e,t){var r=new s(t);if(r.cmp(c.n)>=0||r.isZero())throw new Error(u.EC_PRIVATE_KEY_TWEAK_MUL_FAIL);return r.imul(new s(e)),r.cmp(c.n)&&(r=r.umod(c.n)),r.toArrayLike(n,"be",32)},t.publicKeyCreate=function(e,t){var r=new s(e);if(r.cmp(c.n)>=0||r.isZero())throw new Error(u.EC_PUBLIC_KEY_CREATE_FAIL);return n.from(a.keyFromPrivate(e).getPublic(t,!0))},t.publicKeyConvert=function(e,t){var r=f(e);if(null===r)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);return n.from(r.getPublic(t,!0))},t.publicKeyVerify=function(e){return null!==f(e)},t.publicKeyTweakAdd=function(e,t,r){var i=f(e);if(null===i)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(c.n)>=0)throw new Error(u.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);var o=c.g.mul(t).add(i.pub);if(o.isInfinity())throw new Error(u.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);return n.from(o.encode(!0,r))},t.publicKeyTweakMul=function(e,t,r){var i=f(e);if(null===i)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new s(t)).cmp(c.n)>=0||t.isZero())throw new Error(u.EC_PUBLIC_KEY_TWEAK_MUL_FAIL);return n.from(i.pub.mul(t).encode(!0,r))},t.publicKeyCombine=function(e,t){for(var r=new Array(e.length),i=0;i<e.length;++i)if(r[i]=f(e[i]),null===r[i])throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);for(var s=r[0].pub,o=1;o<r.length;++o)s=s.add(r[o].pub);if(s.isInfinity())throw new Error(u.EC_PUBLIC_KEY_COMBINE_FAIL);return n.from(s.encode(!0,t))},t.signatureNormalize=function(e){var t=new s(e.slice(0,32)),r=new s(e.slice(32,64));if(t.cmp(c.n)>=0||r.cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);var i=n.from(e);return 1===r.cmp(a.nh)&&c.n.sub(r).toArrayLike(n,"be",32).copy(i,32),i},t.signatureExport=function(e){var t=e.slice(0,32),r=e.slice(32,64);if(new s(t).cmp(c.n)>=0||new s(r).cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);return{r:t,s:r}},t.signatureImport=function(e){var t=new s(e.r);t.cmp(c.n)>=0&&(t=new s(0));var r=new s(e.s);return r.cmp(c.n)>=0&&(r=new s(0)),n.concat([t.toArrayLike(n,"be",32),r.toArrayLike(n,"be",32)])},t.sign=function(e,t,r,i){if("function"===typeof r){var o=r;r=function(r){var a=o(e,t,null,i,r);if(!n.isBuffer(a)||32!==a.length)throw new Error(u.ECDSA_SIGN_FAIL);return new s(a)}}var f=new s(t);if(f.cmp(c.n)>=0||f.isZero())throw new Error(u.ECDSA_SIGN_FAIL);var p=a.sign(e,t,{canonical:!0,k:r,pers:i});return{signature:n.concat([p.r.toArrayLike(n,"be",32),p.s.toArrayLike(n,"be",32)]),recovery:p.recoveryParam}},t.verify=function(e,t,r){var n={r:t.slice(0,32),s:t.slice(32,64)},i=new s(n.r),o=new s(n.s);if(i.cmp(c.n)>=0||o.cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);if(1===o.cmp(a.nh)||i.isZero()||o.isZero())return!1;var p=f(r);if(null===p)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);return a.verify(e,n,{x:p.pub.x,y:p.pub.y})},t.recover=function(e,t,r,i){var o={r:t.slice(0,32),s:t.slice(32,64)},f=new s(o.r),p=new s(o.s);if(f.cmp(c.n)>=0||p.cmp(c.n)>=0)throw new Error(u.ECDSA_SIGNATURE_PARSE_FAIL);try{if(f.isZero()||p.isZero())throw new Error;var h=a.recoverPubKey(e,o,r);return n.from(h.encode(!0,i))}catch(d){throw new Error(u.ECDSA_RECOVER_FAIL)}},t.ecdh=function(e,r){var n=t.ecdhUnsafe(e,r,!0);return i("sha256").update(n).digest()},t.ecdhUnsafe=function(e,t,r){var i=f(e);if(null===i)throw new Error(u.EC_PUBLIC_KEY_PARSE_FAIL);var o=new s(t);if(o.cmp(c.n)>=0||o.isZero())throw new Error(u.ECDH_FAIL);return n.from(i.pub.mul(o).encode(!0,r))}},3947:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.BIP32Factory=void 0;const n=r(3948),i=r(3949),s=r(821),o=r(300),u=r(2684),a=r(3926),c=(0,s.base58check)(o.sha256),f=e=>c.encode(Uint8Array.from(e)),p=t=>e.from(c.decode(t));t.BIP32Factory=function(t){(0,i.testEcc)(t);const r=u.BufferN(32),s=u.compile({wif:u.UInt8,bip32:{public:u.UInt32,private:u.UInt32}}),o={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},c=Math.pow(2,31)-1;function h(e){return u.String(e)&&null!==e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}function d(e){return u.UInt32(e)&&e<=c}class l{constructor(e,t){this.__D=e,this.__Q=t,this.lowR=!1}get publicKey(){return void 0===this.__Q&&(this.__Q=e.from(t.pointFromScalar(this.__D,!0))),this.__Q}get privateKey(){return this.__D}sign(r,n){if(!this.privateKey)throw new Error("Missing private key");if(void 0===n&&(n=this.lowR),!1===n)return e.from(t.sign(r,this.privateKey));{let n=e.from(t.sign(r,this.privateKey));const i=e.alloc(32,0);let s=0;for(;n[0]>127;)s++,i.writeUIntLE(s,0,6),n=e.from(t.sign(r,this.privateKey,i));return n}}signSchnorr(r){if(!this.privateKey)throw new Error("Missing private key");if(!t.signSchnorr)throw new Error("signSchnorr not supported by ecc library");return e.from(t.signSchnorr(r,this.privateKey))}verify(e,r){return t.verify(e,this.publicKey,r)}verifySchnorr(e,r){if(!t.verifySchnorr)throw new Error("verifySchnorr not supported by ecc library");return t.verifySchnorr(e,this.publicKey.subarray(1,33),r)}}class w extends l{constructor(e,t,r,n,i=0,o=0,a=0){super(e,t),this.chainCode=r,this.network=n,this.__DEPTH=i,this.__INDEX=o,this.__PARENT_FINGERPRINT=a,u(s,n)}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get identifier(){return n.hash160(this.publicKey)}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return void 0===this.__D}neutered(){return b(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){const t=this.network,r=this.isNeutered()?t.bip32.public:t.bip32.private,n=e.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),f(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return a.encode(this.network.wif,this.privateKey,!0)}derive(r){u(u.UInt32,r);const i=r>=2147483648,s=e.allocUnsafe(37);if(i){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");s[0]=0,this.privateKey.copy(s,1),s.writeUInt32BE(r,33)}else this.publicKey.copy(s,0),s.writeUInt32BE(r,33);const o=n.hmacSHA512(this.chainCode,s),a=o.slice(0,32),c=o.slice(32);if(!t.isPrivate(a))return this.derive(r+1);let f;if(this.isNeutered()){const n=e.from(t.pointAddScalar(this.publicKey,a,!0));if(null===n)return this.derive(r+1);f=b(n,c,this.network,this.depth+1,r,this.fingerprint.readUInt32BE(0))}else{const n=e.from(t.privateAdd(this.privateKey,a));if(null==n)return this.derive(r+1);f=y(n,c,this.network,this.depth+1,r,this.fingerprint.readUInt32BE(0))}return f}deriveHardened(e){return u(d,e),this.derive(e+2147483648)}derivePath(e){u(h,e);let t=e.split("/");if("m"===t[0]){if(this.parentFingerprint)throw new TypeError("Expected master, got child");t=t.slice(1)}return t.reduce((e,t)=>{let r;return"'"===t.slice(-1)?(r=parseInt(t.slice(0,-1),10),e.deriveHardened(r)):(r=parseInt(t,10),e.derive(r))},this)}tweak(e){return this.privateKey?this.tweakFromPrivateKey(e):this.tweakFromPublicKey(e)}tweakFromPublicKey(r){const n=32===(i=this.publicKey).length?i:i.slice(1,33);var i;if(!t.xOnlyPointAddTweak)throw new Error("xOnlyPointAddTweak not supported by ecc library");const s=t.xOnlyPointAddTweak(n,r);if(!s||null===s.xOnlyPubkey)throw new Error("Cannot tweak public key!");const o=e.from([0===s.parity?2:3]),u=e.concat([o,s.xOnlyPubkey]);return new l(void 0,u)}tweakFromPrivateKey(r){const n=3===this.publicKey[0]||4===this.publicKey[0]&&1===(1&this.publicKey[64]),i=(()=>{if(n){if(t.privateNegate)return t.privateNegate(this.privateKey);throw new Error("privateNegate not supported by ecc library")}return this.privateKey})(),s=t.privateAdd(i,r);if(!s)throw new Error("Invalid tweaked private key!");return new l(e.from(s),void 0)}}function _(e,t,r){return y(e,t,r)}function y(e,n,i,s,a,c){if(u({privateKey:r,chainCode:r},{privateKey:e,chainCode:n}),i=i||o,!t.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return new w(e,void 0,n,i,s,a,c)}function b(e,n,i,s,a,c){if(u({publicKey:u.BufferN(33),chainCode:r},{publicKey:e,chainCode:n}),i=i||o,!t.isPoint(e))throw new TypeError("Point is not on the curve");return new w(void 0,e,n,i,s,a,c)}return{fromSeed:function(t,r){if(u(u.Buffer,t),t.length<16)throw new TypeError("Seed should be at least 128 bits");if(t.length>64)throw new TypeError("Seed should be at most 512 bits");r=r||o;const i=n.hmacSHA512(e.from("Bitcoin seed","utf8"),t);return _(i.slice(0,32),i.slice(32),r)},fromBase58:function(e,t){const r=p(e);if(78!==r.length)throw new TypeError("Invalid buffer length");t=t||o;const n=r.readUInt32BE(0);if(n!==t.bip32.private&&n!==t.bip32.public)throw new TypeError("Invalid network version");const i=r[4],s=r.readUInt32BE(5);if(0===i&&0!==s)throw new TypeError("Invalid parent fingerprint");const u=r.readUInt32BE(9);if(0===i&&0!==u)throw new TypeError("Invalid index");const a=r.slice(13,45);let c;if(n===t.bip32.private){if(0!==r.readUInt8(45))throw new TypeError("Invalid private key");c=y(r.slice(46,78),a,t,i,u,s)}else{c=b(r.slice(45,78),a,t,i,u,s)}return c},fromPublicKey:function(e,t,r){return b(e,t,r)},fromPrivateKey:_}}}).call(this,r(26).Buffer)},3948:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.hmacSHA512=t.hash160=void 0;const n=r(432),i=r(1591),s=r(300),o=r(370);t.hash160=function(t){const r=(0,s.sha256)(Uint8Array.from(t));return e.from((0,i.ripemd160)(r))},t.hmacSHA512=function(t,r){return e.from((0,n.hmac)(o.sha512,t,r))}}).call(this,r(26).Buffer)},3949:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.testEcc=void 0;const r=t=>e.from(t,"hex");function n(e){if(!e)throw new Error("ecc library invalid")}t.testEcc=function(t){if(n(t.isPoint(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(!t.isPoint(r("030000000000000000000000000000000000000000000000000000000000000005"))),n(t.isPrivate(r("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),n(!t.isPrivate(r("0000000000000000000000000000000000000000000000000000000000000000"))),n(!t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),n(!t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),n(e.from(t.pointFromScalar(r("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(r("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),t.xOnlyPointAddTweak){n(null===t.xOnlyPointAddTweak(r("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140")));let i=t.xOnlyPointAddTweak(r("1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b"),r("a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac"));n(e.from(i.xOnlyPubkey).equals(r("e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"))&&1===i.parity),i=t.xOnlyPointAddTweak(r("2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"),r("823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47"))}n(e.from(t.pointAddScalar(r("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),r("0000000000000000000000000000000000000000000000000000000000000003"))).equals(r("02c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5"))),n(e.from(t.privateAdd(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"),r("0000000000000000000000000000000000000000000000000000000000000002"))).equals(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),t.privateNegate&&(n(e.from(t.privateNegate(r("0000000000000000000000000000000000000000000000000000000000000001"))).equals(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),n(e.from(t.privateNegate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"))).equals(r("0000000000000000000000000000000000000000000000000000000000000003"))),n(e.from(t.privateNegate(r("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(r("4eede1bf775995d70a494f0a7bb6bc11e0b8cccd41cce8009ab1132c8b0a3792")))),n(e.from(t.sign(r("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))).equals(r("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),n(t.verify(r("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),r("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),r("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),t.signSchnorr&&n(e.from(t.signSchnorr(r("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),r("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),r("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"))).equals(r("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),t.verifySchnorr&&n(t.verifySchnorr(r("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),r("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),r("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}}).call(this,r(26).Buffer)},3958:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bitcoingold={messagePrefix:"\x18Bitcoin Gold Signed Message:\n",bech32:"btg",bip32:{public:76067358,private:76066276},pubKeyHash:38,scriptHash:23,wif:128},t.bitcoin={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},t.regtest={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bcrt",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239},t.testnet={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},3960:function(e,t,r){"use strict";for(var n="qpzry9x8gf2tvdw0s3jn54khce6mua7l",i={},s=0;s<n.length;s++){var o=n.charAt(s);if(void 0!==i[o])throw new TypeError(o+" is ambiguous");i[o]=s}function u(e){var t=e>>25;return(33554431&e)<<5^996825010&-(t>>0&1)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function a(e){for(var t=1,r=0;r<e.length;++r){var n=e.charCodeAt(r);if(n<33||n>126)return"Invalid prefix ("+e+")";t=u(t)^n>>5}for(t=u(t),r=0;r<e.length;++r){var i=e.charCodeAt(r);t=u(t)^31&i}return t}function c(e,t){if(t=t||90,e.length<8)return e+" too short";if(e.length>t)return"Exceeds length limit";var r=e.toLowerCase(),n=e.toUpperCase();if(e!==r&&e!==n)return"Mixed-case string "+e;var s=(e=r).lastIndexOf("1");if(-1===s)return"No separator character for "+e;if(0===s)return"Missing prefix for "+e;var o=e.slice(0,s),c=e.slice(s+1);if(c.length<6)return"Data too short";var f=a(o);if("string"===typeof f)return f;for(var p=[],h=0;h<c.length;++h){var d=c.charAt(h),l=i[d];if(void 0===l)return"Unknown character "+d;f=u(f)^l,h+6>=c.length||p.push(l)}return 1!==f?"Invalid checksum for "+e:{prefix:o,words:p}}function f(e,t,r,n){for(var i=0,s=0,o=(1<<r)-1,u=[],a=0;a<e.length;++a)for(i=i<<t|e[a],s+=t;s>=r;)s-=r,u.push(i>>s&o);if(n)s>0&&u.push(i<<r-s&o);else{if(s>=t)return"Excess padding";if(i<<r-s&o)return"Non-zero padding"}return u}e.exports={decodeUnsafe:function(){var e=c.apply(null,arguments);if("object"===typeof e)return e},decode:function(e){var t=c.apply(null,arguments);if("object"===typeof t)return t;throw new Error(t)},encode:function(e,t,r){if(r=r||90,e.length+7+t.length>r)throw new TypeError("Exceeds length limit");var i=a(e=e.toLowerCase());if("string"===typeof i)throw new Error(i);for(var s=e+"1",o=0;o<t.length;++o){var c=t[o];if(c>>5!==0)throw new Error("Non 5-bit word");i=u(i)^c,s+=n.charAt(c)}for(o=0;o<6;++o)i=u(i);for(i^=1,o=0;o<6;++o){s+=n.charAt(i>>5*(5-o)&31)}return s},toWordsUnsafe:function(e){var t=f(e,8,5,!0);if(Array.isArray(t))return t},toWords:function(e){var t=f(e,8,5,!0);if(Array.isArray(t))return t;throw new Error(t)},fromWordsUnsafe:function(e){var t=f(e,5,8,!1);if(Array.isArray(t))return t},fromWords:function(e){var t=f(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}}},3961:function(e,t,r){"use strict";(function(t){e.exports=function(e,r){if(!t.isBuffer(e)||!t.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(e===r)return!0;if("function"===typeof e.equals)return e.equals(r);if(e.length!==r.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==r[n])return!1;return!0}}).call(this,r(26).Buffer)},3962:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.ECPairFactory=t.networks=void 0;const n=r(3963);t.networks=n;const i=r(3964),s=r(1589),o=r(3926),u=r(3965),a=i.typeforce.maybe(i.typeforce.compile({compressed:i.maybe(i.Boolean),network:i.maybe(i.Network)}));t.ECPairFactory=function(t){function r(e,r){if(i.typeforce(i.Buffer256bit,e),!t.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return i.typeforce(a,r),new c(e,void 0,r)}(0,u.testEcc)(t);class c{constructor(r,i,s){this.__D=r,this.__Q=i,this.lowR=!1,void 0===s&&(s={}),this.compressed=void 0===s.compressed||s.compressed,this.network=s.network||n.bitcoin,void 0!==i&&(this.__Q=e.from(t.pointCompress(i,this.compressed)))}get privateKey(){return this.__D}get publicKey(){if(!this.__Q){const r=t.pointFromScalar(this.__D,this.compressed);this.__Q=e.from(r)}return this.__Q}toWIF(){if(!this.__D)throw new Error("Missing private key");return o.encode(this.network.wif,this.__D,this.compressed)}sign(r,n){if(!this.__D)throw new Error("Missing private key");if(void 0===n&&(n=this.lowR),!1===n)return e.from(t.sign(r,this.__D));{let n=t.sign(r,this.__D);const i=e.alloc(32,0);let s=0;for(;n[0]>127;)s++,i.writeUIntLE(s,0,6),n=t.sign(r,this.__D,i);return e.from(n)}}signSchnorr(r){if(!this.privateKey)throw new Error("Missing private key");if(!t.signSchnorr)throw new Error("signSchnorr not supported by ecc library");return e.from(t.signSchnorr(r,this.privateKey))}verify(e,r){return t.verify(e,this.publicKey,r)}verifySchnorr(e,r){if(!t.verifySchnorr)throw new Error("verifySchnorr not supported by ecc library");return t.verifySchnorr(e,this.publicKey.subarray(1,33),r)}}return{isPoint:function(e){return t.isPoint(e)},fromPrivateKey:r,fromPublicKey:function(e,r){return i.typeforce(t.isPoint,e),i.typeforce(a,r),new c(void 0,e,r)},fromWIF:function(e,t){const s=o.decode(e),u=s.version;if(i.Array(t)){if(!(t=t.filter(e=>u===e.wif).pop()))throw new Error("Unknown network version")}else if(t=t||n.bitcoin,u!==t.wif)throw new Error("Invalid network version");return r(s.privateKey,{compressed:s.compressed,network:t})},makeRandom:function(e){i.typeforce(a,e),void 0===e&&(e={});const n=e.rng||s;let o;do{o=n(32),i.typeforce(i.Buffer256bit,o)}while(!t.isPrivate(o));return r(o,e)}}}}).call(this,r(26).Buffer)},3963:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testnet=t.bitcoin=void 0,t.bitcoin={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},t.testnet={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},3964:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maybe=t.Boolean=t.Array=t.Buffer256bit=t.Network=t.typeforce=void 0,t.typeforce=r(2684),t.Network=t.typeforce.compile({messagePrefix:t.typeforce.oneOf(t.typeforce.Buffer,t.typeforce.String),bip32:{public:t.typeforce.UInt32,private:t.typeforce.UInt32},pubKeyHash:t.typeforce.UInt8,scriptHash:t.typeforce.UInt8,wif:t.typeforce.UInt8}),t.Buffer256bit=t.typeforce.BufferN(32),t.Array=t.typeforce.Array,t.Boolean=t.typeforce.Boolean,t.maybe=t.typeforce.maybe},3965:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.testEcc=void 0;const r=t=>e.from(t,"hex");function n(e){if(!e)throw new Error("ecc library invalid")}t.testEcc=function(t){n(t.isPoint(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(!t.isPoint(r("030000000000000000000000000000000000000000000000000000000000000005"))),n(t.isPrivate(r("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),n(!t.isPrivate(r("0000000000000000000000000000000000000000000000000000000000000000"))),n(!t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),n(!t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),n(e.from(t.pointCompress(r("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!0)).equals(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(e.from(t.pointCompress(r("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!1)).equals(r("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),n(e.from(t.pointCompress(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!0)).equals(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(e.from(t.pointCompress(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!1)).equals(r("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),n(e.from(t.pointFromScalar(r("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(r("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),n(e.from(t.sign(r("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))).equals(r("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),n(t.verify(r("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),r("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),r("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),t.signSchnorr&&n(e.from(t.signSchnorr(r("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),r("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),r("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"))).equals(r("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),t.verifySchnorr&&n(t.verifySchnorr(r("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),r("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),r("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}}).call(this,r(26).Buffer)},3970:function(e,t,r){(function(t){const n=r(166),i=new(0,r(521).ec)("secp256k1"),s=r(4207),o=t.alloc(32,0),u=t.from("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141","hex"),a=t.from("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f","hex"),c=i.curve.n,f=c.shrn(1),p=i.curve.g;function h(e){return t.isBuffer(e)&&32===e.length}function d(e){return!!h(e)&&e.compare(u)<0}function l(e){if(!t.isBuffer(e))return!1;if(e.length<33)return!1;const r=e[0],n=e.slice(1,33);if(0===n.compare(o))return!1;if(n.compare(a)>=0)return!1;if((2===r||3===r)&&33===e.length){try{g(e)}catch(s){return!1}return!0}const i=e.slice(33);return 0!==i.compare(o)&&(!(i.compare(a)>=0)&&(4===r&&65===e.length))}function w(e){return 4!==e[0]}function _(e){return!!h(e)&&(e.compare(o)>0&&e.compare(u)<0)}function y(e,t){return void 0===e&&void 0!==t?w(t):void 0===e||e}function b(e){return new n(e)}function E(e){return e.toArrayLike(t,"be",32)}function g(e){return i.curve.decodePoint(e)}function v(e,r){return t.from(e._encode(r))}function m(e,r,n){if(!h(e))throw new TypeError("Expected Hash");if(!_(r))throw new TypeError("Expected Private");if(void 0!==n&&!h(n))throw new TypeError("Expected Extra Data (32 bytes)");const i=b(r),o=b(e);let u,a;s(e,r,(function(e){const t=b(e),r=p.mul(t);return!r.isInfinity()&&(u=r.x.umod(c),0!==u.isZero()&&(a=t.invm(c).mul(o.add(i.mul(u))).umod(c),0!==a.isZero()))}),_,n),a.cmp(f)>0&&(a=c.sub(a));const d=t.allocUnsafe(64);return E(u).copy(d,0),E(a).copy(d,32),d}e.exports={isPoint:l,isPointCompressed:function(e){return!!l(e)&&w(e)},isPrivate:_,pointAdd:function(e,t,r){if(!l(e))throw new TypeError("Expected Point");if(!l(t))throw new TypeError("Expected Point");const n=g(e),i=g(t),s=n.add(i);return s.isInfinity()?null:v(s,y(r,e))},pointAddScalar:function(e,t,r){if(!l(e))throw new TypeError("Expected Point");if(!d(t))throw new TypeError("Expected Tweak");const n=y(r,e),i=g(e);if(0===t.compare(o))return v(i,n);const s=b(t),u=p.mul(s),a=i.add(u);return a.isInfinity()?null:v(a,n)},pointCompress:function(e,t){if(!l(e))throw new TypeError("Expected Point");const r=g(e);if(r.isInfinity())throw new TypeError("Expected Point");return v(r,y(t,e))},pointFromScalar:function(e,t){if(!_(e))throw new TypeError("Expected Private");const r=b(e),n=p.mul(r);return n.isInfinity()?null:v(n,y(t))},pointMultiply:function(e,t,r){if(!l(e))throw new TypeError("Expected Point");if(!d(t))throw new TypeError("Expected Tweak");const n=y(r,e),i=g(e),s=b(t),o=i.mul(s);return o.isInfinity()?null:v(o,n)},privateAdd:function(e,t){if(!_(e))throw new TypeError("Expected Private");if(!d(t))throw new TypeError("Expected Tweak");const r=b(e),n=b(t),i=E(r.add(n).umod(c));return _(i)?i:null},privateSub:function(e,t){if(!_(e))throw new TypeError("Expected Private");if(!d(t))throw new TypeError("Expected Tweak");const r=b(e),n=b(t),i=E(r.sub(n).umod(c));return _(i)?i:null},sign:function(e,t){return m(e,t)},signWithEntropy:function(e,t,r){return m(e,t,r)},verify:function(e,r,n,i){if(!h(e))throw new TypeError("Expected Hash");if(!l(r))throw new TypeError("Expected Point");if(!function(e){const r=e.slice(0,32),n=e.slice(32,64);return t.isBuffer(e)&&64===e.length&&r.compare(u)<0&&n.compare(u)<0}(n))throw new TypeError("Expected Signature");const s=g(r),o=b(n.slice(0,32)),a=b(n.slice(32,64));if(i&&a.cmp(f)>0)return!1;if(o.gtn(0)<=0)return!1;if(a.gtn(0)<=0)return!1;const d=b(e),w=a.invm(c),_=d.mul(w).umod(c),y=o.mul(w).umod(c),E=p.mulAdd(_,s,y);return!E.isInfinity()&&E.x.umod(c).eq(o)}}}).call(this,r(26).Buffer)},3971:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2684),i=Math.pow(2,31)-1;function s(e){return n.String(e)&&!!e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}t.UInt31=function(e){return n.UInt32(e)&&e<=i},t.BIP32Path=s,s.toJSON=()=>"BIP32 derivation path",t.Signer=function(e){return(n.Buffer(e.publicKey)||"function"===typeof e.getPublicKey)&&"function"===typeof e.sign};t.Satoshi=function(e){return n.UInt53(e)&&e<=21e14},t.ECPoint=n.quacksLike("Point"),t.Network=n.compile({messagePrefix:n.oneOf(n.Buffer,n.String),bip32:{public:n.UInt32,private:n.UInt32},pubKeyHash:n.UInt8,scriptHash:n.UInt8,wif:n.UInt8}),t.Buffer256bit=n.BufferN(32),t.Hash160bit=n.BufferN(20),t.Hash256bit=n.BufferN(32),t.Number=n.Number,t.Array=n.Array,t.Boolean=n.Boolean,t.String=n.String,t.Buffer=n.Buffer,t.Hex=n.Hex,t.maybe=n.maybe,t.tuple=n.tuple,t.UInt8=n.UInt8,t.UInt32=n.UInt32,t.UInt53=n.UInt53,t.Function=n.Function,t.BufferN=n.BufferN,t.Null=n.Null,t.oneOf=n.oneOf},3978:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BIP32Factory=t.default=void 0;var n=r(3947);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.BIP32Factory}}),Object.defineProperty(t,"BIP32Factory",{enumerable:!0,get:function(){return n.BIP32Factory}})},3979:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.networks=t.ECPairFactory=t.default=void 0;var n=r(3962);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.ECPairFactory}}),Object.defineProperty(t,"ECPairFactory",{enumerable:!0,get:function(){return n.ECPairFactory}}),Object.defineProperty(t,"networks",{enumerable:!0,get:function(){return n.networks}})},3980:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(746);function i(e){try{return n("rmd160").update(e).digest()}catch(t){return n("ripemd160").update(e).digest()}}function s(e){return n("sha256").update(e).digest()}t.ripemd160=i,t.sha1=function(e){return n("sha1").update(e).digest()},t.sha256=s,t.hash160=function(e){return i(s(e))},t.hash256=function(e){return s(s(e))}},4004:function(e,t,r){(function(t){const n=r(1346),i=r(3960),s=r(3961),o=r(746),u=r(3936),a=r(2685),c="p2wpkh",f="p2sh(p2wpkh)";function p(e){return o("sha256").update(e).digest()}function h(e){return o("ripemd160").update(p(e)).digest()}function d(e,r,n,i){return void 0!==i?(r+=8,i===c&&(r+=4)):n&&(r+=4),t.concat([t.alloc(1,r+27),e])}function l(e,r){r=r||"\x18Bitcoin Signed Message:\n",t.isBuffer(r)||(r=t.from(r,"utf8")),t.isBuffer(e)||(e=t.from(e,"utf8"));const n=a.encodingLength(e.length),i=t.allocUnsafe(r.length+n+e.length);return r.copy(i,0),a.encode(e.length,i,r.length),e.copy(i,r.length+n),function(e){return p(p(e))}(i)}function w(e,t){"object"===typeof e&&void 0===t&&(t=e,e=void 0);let{segwitType:r,extraEntropy:n}=t||{};if(r&&("string"===typeof r||r instanceof String)&&(r=r.toLowerCase()),r&&r!==f&&r!==c)throw new Error('Unrecognized segwitType: use "'+f+'" or "'+c+'"');return{messagePrefixArg:e,segwitType:r,extraEntropy:n}}function _(e){return e&&"function"===typeof e.sign}function y(e){return h(t.concat([t.from("0014","hex"),e]))}function b(e){const r=i.decode(e),n=i.fromWords(r.words.slice(1));return t.from(n)}e.exports={magicHash:l,sign:function(e,t,r,n,i){const{messagePrefixArg:s,segwitType:o,extraEntropy:a}=w(n,i),c=l(e,s),f=_(t)?t.sign(c,a):u.sign(c,t,{data:a});return d(f.signature,f.recovery,r,o)},signAsync:function(e,t,r,n,i){let s,o,a;return Promise.resolve().then(()=>{({messagePrefixArg:s,segwitType:o,extraEntropy:a}=w(n,i));const r=l(e,s);return _(t)?t.sign(r,a):u.sign(r,t,{data:a})}).then(e=>d(e.signature,e.recovery,r,o))},verify:function(e,r,i,o,a){t.isBuffer(i)||(i=t.from(i,"base64"));const p=function(e){if(65!==e.length)throw new Error("Invalid signature length");const t=e.readUInt8(0)-27;if(t>15||t<0)throw new Error("Invalid signature parameter");return{compressed:!!(12&t),segwitType:8&t?4&t?c:f:null,recovery:3&t,signature:e.slice(1)}}(i);if(a&&!p.compressed)throw new Error("checkSegwitAlways can only be used with a compressed pubkey signature flagbyte");const d=l(e,o),w=h(u.recover(d,p.signature,p.recovery,p.compressed));let _,E;if(p.segwitType)p.segwitType===f?(_=y(w),E=n.decode(r).slice(1)):(_=w,E=b(r));else if(a)try{return E=b(r),s(w,E)}catch(g){const e=y(w);return E=n.decode(r).slice(1),s(w,E)||s(e,E)}else _=w,E=n.decode(r).slice(1);return s(_,E)}}}).call(this,r(26).Buffer)},4008:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prop=function(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){const e=r.call(this);return this[t]=e,e},set(e){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:e,writable:!0})}})},t.value=function(e){let t;return()=>(void 0!==t||(t=e()),t)}},4060:function(e,t,r){"use strict";var n=r(281),i=r(4206),s=r(2690),o=r(313).Buffer,u=r(2697),a=r(1361),c=r(1619),f=o.alloc(128);function p(e,t){s.call(this,"digest"),"string"===typeof t&&(t=o.from(t));var r="sha512"===e||"sha384"===e?128:64;(this._alg=e,this._key=t,t.length>r)?t=("rmd160"===e?new a:c(e)).update(t).digest():t.length<r&&(t=o.concat([t,f],r));for(var n=this._ipad=o.allocUnsafe(r),i=this._opad=o.allocUnsafe(r),u=0;u<r;u++)n[u]=54^t[u],i[u]=92^t[u];this._hash="rmd160"===e?new a:c(e),this._hash.update(n)}n(p,s),p.prototype._update=function(e){this._hash.update(e)},p.prototype._final=function(){var e=this._hash.digest();return("rmd160"===this._alg?new a:c(this._alg)).update(this._opad).update(e).digest()},e.exports=function(e,t){return"rmd160"===(e=e.toLowerCase())||"ripemd160"===e?new p("rmd160",t):"md5"===e?new i(u,t):new p(e,t)}},4103:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4789);t.embed=n.p2data;const i=r(4794);t.p2ms=i.p2ms;const s=r(4795);t.p2pk=s.p2pk;const o=r(4796);t.p2pkh=o.p2pkh;const u=r(4797);t.p2sh=u.p2sh;const a=r(4798);t.p2wpkh=a.p2wpkh;const c=r(4799);t.p2wsh=c.p2wsh},4104:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3971),i=r(2684),s=r(2685);function o(e,t){if("number"!==typeof e)throw new Error("cannot write a non-number as a number");if(e<0)throw new Error("specified a negative value for writing an unsigned value");if(e>t)throw new Error("RangeError: value out of range");if(Math.floor(e)!==e)throw new Error("value has a fractional component")}function u(e,t){const r=e.readUInt32LE(t);let n=e.readUInt32LE(t+4);return n*=4294967296,o(n+r,9007199254740991),n+r}function a(e,t,r){return o(t,9007199254740991),e.writeInt32LE(-1&t,r),e.writeUInt32LE(Math.floor(t/4294967296),r+4),r+8}t.readUInt64LE=u,t.writeUInt64LE=a,t.reverseBuffer=function(e){if(e.length<1)return e;let t=e.length-1,r=0;for(let n=0;n<e.length/2;n++)r=e[n],e[n]=e[t],e[t]=r,t--;return e},t.cloneBuffer=function(t){const r=e.allocUnsafe(t.length);return t.copy(r),r};t.BufferWriter=class{constructor(e,t=0){this.buffer=e,this.offset=t,i(n.tuple(n.Buffer,n.UInt32),[e,t])}writeUInt8(e){this.offset=this.buffer.writeUInt8(e,this.offset)}writeInt32(e){this.offset=this.buffer.writeInt32LE(e,this.offset)}writeUInt32(e){this.offset=this.buffer.writeUInt32LE(e,this.offset)}writeUInt64(e){this.offset=a(this.buffer,e,this.offset)}writeVarInt(e){s.encode(e,this.buffer,this.offset),this.offset+=s.encode.bytes}writeSlice(e){if(this.buffer.length<this.offset+e.length)throw new Error("Cannot write slice out of bounds");this.offset+=e.copy(this.buffer,this.offset)}writeVarSlice(e){this.writeVarInt(e.length),this.writeSlice(e)}writeVector(e){this.writeVarInt(e.length),e.forEach(e=>this.writeVarSlice(e))}};t.BufferReader=class{constructor(e,t=0){this.buffer=e,this.offset=t,i(n.tuple(n.Buffer,n.UInt32),[e,t])}readUInt8(){const e=this.buffer.readUInt8(this.offset);return this.offset++,e}readInt32(){const e=this.buffer.readInt32LE(this.offset);return this.offset+=4,e}readUInt32(){const e=this.buffer.readUInt32LE(this.offset);return this.offset+=4,e}readUInt64(){const e=u(this.buffer,this.offset);return this.offset+=8,e}readVarInt(){const e=s.decode(this.buffer,this.offset);return this.offset+=s.decode.bytes,e}readSlice(e){if(this.buffer.length<this.offset+e)throw new Error("Cannot read slice out of bounds");const t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){const e=this.readVarInt(),t=[];for(let r=0;r<e;r++)t.push(this.readVarSlice());return t}}}).call(this,r(26).Buffer)},4105:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(4104),i=r(3980),s=r(3911),o=r(3911),u=r(3971),a=r(2684),c=r(2685);function f(e){const t=e.length;return c.encodingLength(t)+t}const p=e.allocUnsafe(0),h=[],d=e.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),l=e.from("0000000000000000000000000000000000000000000000000000000000000001","hex"),w=e.from("ffffffffffffffff","hex"),_={script:p,valueBuffer:w};class y{constructor(){this.version=1,this.locktime=0,this.ins=[],this.outs=[]}static fromBuffer(e,t){const r=new n.BufferReader(e),i=new y;i.version=r.readInt32();const s=r.readUInt8(),o=r.readUInt8();let u=!1;s===y.ADVANCED_TRANSACTION_MARKER&&o===y.ADVANCED_TRANSACTION_FLAG?u=!0:r.offset-=2;const a=r.readVarInt();for(let n=0;n<a;++n)i.ins.push({hash:r.readSlice(32),index:r.readUInt32(),script:r.readVarSlice(),sequence:r.readUInt32(),witness:h});const c=r.readVarInt();for(let n=0;n<c;++n)i.outs.push({value:r.readUInt64(),script:r.readVarSlice()});if(u){for(let e=0;e<a;++e)i.ins[e].witness=r.readVector();if(!i.hasWitnesses())throw new Error("Transaction has superfluous witness data")}if(i.locktime=r.readUInt32(),t)return i;if(r.offset!==e.length)throw new Error("Transaction has unexpected data");return i}static fromHex(t){return y.fromBuffer(e.from(t,"hex"),!1)}static isCoinbaseHash(e){a(u.Hash256bit,e);for(let t=0;t<32;++t)if(0!==e[t])return!1;return!0}isCoinbase(){return 1===this.ins.length&&y.isCoinbaseHash(this.ins[0].hash)}addInput(e,t,r,n){return a(u.tuple(u.Hash256bit,u.UInt32,u.maybe(u.UInt32),u.maybe(u.Buffer)),arguments),u.Null(r)&&(r=y.DEFAULT_SEQUENCE),this.ins.push({hash:e,index:t,script:n||p,sequence:r,witness:h})-1}addOutput(e,t){return a(u.tuple(u.Buffer,u.Satoshi),arguments),this.outs.push({script:e,value:t})-1}hasWitnesses(){return this.ins.some(e=>0!==e.witness.length)}weight(){return 3*this.byteLength(!1)+this.byteLength(!0)}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(e=!0){const t=e&&this.hasWitnesses();return(t?10:8)+c.encodingLength(this.ins.length)+c.encodingLength(this.outs.length)+this.ins.reduce((e,t)=>e+40+f(t.script),0)+this.outs.reduce((e,t)=>e+8+f(t.script),0)+(t?this.ins.reduce((e,t)=>e+function(e){const t=e.length;return c.encodingLength(t)+e.reduce((e,t)=>e+f(t),0)}(t.witness),0):0)}clone(){const e=new y;return e.version=this.version,e.locktime=this.locktime,e.ins=this.ins.map(e=>({hash:e.hash,index:e.index,script:e.script,sequence:e.sequence,witness:e.witness})),e.outs=this.outs.map(e=>({script:e.script,value:e.value})),e}hashForSignature(t,r,n){if(a(u.tuple(u.UInt32,u.Buffer,u.Number),arguments),t>=this.ins.length)return l;const c=s.compile(s.decompile(r).filter(e=>e!==o.OPS.OP_CODESEPARATOR)),f=this.clone();if((31&n)===y.SIGHASH_NONE)f.outs=[],f.ins.forEach((e,r)=>{r!==t&&(e.sequence=0)});else if((31&n)===y.SIGHASH_SINGLE){if(t>=this.outs.length)return l;f.outs.length=t+1;for(let e=0;e<t;e++)f.outs[e]=_;f.ins.forEach((e,r)=>{r!==t&&(e.sequence=0)})}n&y.SIGHASH_ANYONECANPAY?(f.ins=[f.ins[t]],f.ins[0].script=c):(f.ins.forEach(e=>{e.script=p}),f.ins[t].script=c);const h=e.allocUnsafe(f.byteLength(!1)+4);return h.writeInt32LE(n,h.length-4),f.__toBuffer(h,0,!1),i.hash256(h)}hashForWitnessV0(t,r,s,o){a(u.tuple(u.UInt32,u.Buffer,u.Satoshi,u.UInt32),arguments);let c,p=e.from([]),h=d,l=d,w=d;if(o&y.SIGHASH_ANYONECANPAY||(p=e.allocUnsafe(36*this.ins.length),c=new n.BufferWriter(p,0),this.ins.forEach(e=>{c.writeSlice(e.hash),c.writeUInt32(e.index)}),l=i.hash256(p)),o&y.SIGHASH_ANYONECANPAY||(31&o)===y.SIGHASH_SINGLE||(31&o)===y.SIGHASH_NONE||(p=e.allocUnsafe(4*this.ins.length),c=new n.BufferWriter(p,0),this.ins.forEach(e=>{c.writeUInt32(e.sequence)}),w=i.hash256(p)),(31&o)!==y.SIGHASH_SINGLE&&(31&o)!==y.SIGHASH_NONE){const t=this.outs.reduce((e,t)=>e+8+f(t.script),0);p=e.allocUnsafe(t),c=new n.BufferWriter(p,0),this.outs.forEach(e=>{c.writeUInt64(e.value),c.writeVarSlice(e.script)}),h=i.hash256(p)}else if((31&o)===y.SIGHASH_SINGLE&&t<this.outs.length){const r=this.outs[t];p=e.allocUnsafe(8+f(r.script)),c=new n.BufferWriter(p,0),c.writeUInt64(r.value),c.writeVarSlice(r.script),h=i.hash256(p)}p=e.allocUnsafe(156+f(r)),c=new n.BufferWriter(p,0);const _=this.ins[t];return c.writeUInt32(this.version),c.writeSlice(l),c.writeSlice(w),c.writeSlice(_.hash),c.writeUInt32(_.index),c.writeVarSlice(r),c.writeUInt64(s),c.writeUInt32(_.sequence),c.writeSlice(h),c.writeUInt32(this.locktime),c.writeUInt32(o),i.hash256(p)}hashForCashSignature(e,t,r,n){if(a(u.tuple(u.UInt32,u.Buffer,u.Number,u.maybe(u.UInt53)),arguments),n&y.SIGHASH_BITCOINCASHBIP143){if(u.Null(r))throw new Error("Bitcoin Cash sighash requires value of input to be signed.");return this.hashForWitnessV0(e,t,r,n)}return this.hashForSignature(e,t,n)}hashForGoldSignature(e,t,r,n,i){a(u.tuple(u.UInt32,u.Buffer,u.Number,u.maybe(u.UInt53)),arguments);let s=n;const o=(n&y.SIGHASH_BITCOINCASHBIP143)>0;if(o&&(s|=y.FORKID_BTG<<8),i||o){if(u.Null(r))throw new Error("Bitcoin Cash sighash requires value of input to be signed.");return this.hashForWitnessV0(e,t,r,s)}return this.hashForSignature(e,t,s)}getHash(t){return t&&this.isCoinbase()?e.alloc(32,0):i.hash256(this.__toBuffer(void 0,void 0,t))}getId(){return n.reverseBuffer(this.getHash(!1)).toString("hex")}toBuffer(e,t){return this.__toBuffer(e,t,!0)}toHex(){return this.toBuffer(void 0,void 0).toString("hex")}setInputScript(e,t){a(u.tuple(u.Number,u.Buffer),arguments),this.ins[e].script=t}setWitness(e,t){a(u.tuple(u.Number,[u.Buffer]),arguments),this.ins[e].witness=t}__toBuffer(t,r,i=!1){t||(t=e.allocUnsafe(this.byteLength(i)));const s=new n.BufferWriter(t,r||0);s.writeInt32(this.version);const o=i&&this.hasWitnesses();return o&&(s.writeUInt8(y.ADVANCED_TRANSACTION_MARKER),s.writeUInt8(y.ADVANCED_TRANSACTION_FLAG)),s.writeVarInt(this.ins.length),this.ins.forEach(e=>{s.writeSlice(e.hash),s.writeUInt32(e.index),s.writeVarSlice(e.script),s.writeUInt32(e.sequence)}),s.writeVarInt(this.outs.length),this.outs.forEach(e=>{void 0!==e.value?s.writeUInt64(e.value):s.writeSlice(e.valueBuffer),s.writeVarSlice(e.script)}),o&&this.ins.forEach(e=>{s.writeVector(e.witness)}),s.writeUInt32(this.locktime),void 0!==r?t.slice(r,s.offset):t}}y.DEFAULT_SEQUENCE=4294967295,y.SIGHASH_ALL=1,y.SIGHASH_NONE=2,y.SIGHASH_SINGLE=3,y.SIGHASH_ANYONECANPAY=128,y.SIGHASH_BITCOINCASHBIP143=64,y.ADVANCED_TRANSACTION_MARKER=0,y.ADVANCED_TRANSACTION_FLAG=1,y.FORKID_BTG=79,y.FORKID_BCH=0,t.Transaction=y}).call(this,r(26).Buffer)},4205:function(e,t,r){"use strict";function n(e){var t=new Error;this.name=t.name="ValidationError",this.message=t.message=e,this.stack=t.stack}n.prototype=Object.create(Error.prototype),e.exports={ValidationError:n,validate:function(e,t){if(!e)throw new n(t)}}},4206:function(e,t,r){"use strict";var n=r(281),i=r(313).Buffer,s=r(2690),o=i.alloc(128);function u(e,t){s.call(this,"digest"),"string"===typeof t&&(t=i.from(t)),this._alg=e,this._key=t,t.length>64?t=e(t):t.length<64&&(t=i.concat([t,o],64));for(var r=this._ipad=i.allocUnsafe(64),n=this._opad=i.allocUnsafe(64),u=0;u<64;u++)r[u]=54^t[u],n[u]=92^t[u];this._hash=[r]}n(u,s),u.prototype._update=function(e){this._hash.push(e)},u.prototype._final=function(){var e=this._alg(i.concat(this._hash));return this._alg(i.concat([this._opad,e]))},e.exports=u},4207:function(e,t,r){(function(t){const n=r(4060),i=t.alloc(1,1),s=t.alloc(1,0);e.exports=function(e,r,o,u,a){let c=t.alloc(32,0),f=t.alloc(32,1);c=n("sha256",c).update(f).update(s).update(r).update(e).update(a||"").digest(),f=n("sha256",c).update(f).digest(),c=n("sha256",c).update(f).update(i).update(r).update(e).update(a||"").digest(),f=n("sha256",c).update(f).digest(),f=n("sha256",c).update(f).digest();let p=f;for(;!u(p)||!o(p);)c=n("sha256",c).update(f).update(s).digest(),f=n("sha256",c).update(f).digest(),f=n("sha256",c).update(f).digest(),p=f;return p}}).call(this,r(26).Buffer)},4208:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(4786),i=r(3958),s=r(4103),o=r(3911),u=r(3971),a=r(4211),c=r(1346),f=r(2684);function p(t){if(n.VALID_PREFIXES.indexOf(t.split(":")[0])>-1){const r=n.decode(t);let s,o;switch(r.prefix){case"bitcoincash":s=i.bitcoin;break;case"bchtest":s=i.testnet;break;case"bchreg":s=i.regtest}switch(r.type){case"P2PKH":o=s.pubKeyHash;break;case"P2SH":o=s.scriptHash}if(r.hash.length<20)throw new TypeError(t+" is too short");if(r.hash.length>20)throw new TypeError(t+" is too long");return{version:o,hash:e.from(r.hash)}}{const e=c.decode(t);if(e.length<21)throw new TypeError(t+" is too short");if(e.length>21)throw new TypeError(t+" is too long");return{version:e.readUInt8(0),hash:e.slice(1)}}}function h(t){const r=a.decode(t),n=a.fromWords(r.words.slice(1));return{version:r.words[0],prefix:r.prefix,data:e.from(n)}}t.fromBase58Check=p,t.fromBech32=h,t.toBase58Check=function(t,r){f(u.tuple(u.Hash160bit,u.UInt8),arguments);const n=e.allocUnsafe(21);return n.writeUInt8(r,0),t.copy(n,1),c.encode(n)},t.toBech32=function(e,t,r){const n=a.toWords(e);return n.unshift(t),a.encode(r,n)},t.fromOutputScript=function(e,t){t=t||i.bitcoin;try{return s.p2pkh({output:e,network:t}).address}catch(r){}try{return s.p2sh({output:e,network:t}).address}catch(r){}try{return s.p2wpkh({output:e,network:t}).address}catch(r){}try{return s.p2wsh({output:e,network:t}).address}catch(r){}throw new Error(o.toASM(e)+" has no matching Address")},t.toOutputScript=function(e,t){let r,n;t=t||i.bitcoin;try{r=p(e)}catch(o){}if(r){if(r.version===t.pubKeyHash)return s.p2pkh({hash:r.hash}).output;if(r.version===t.scriptHash)return s.p2sh({hash:r.hash}).output}else{try{n=h(e)}catch(o){}if(n){if(n.prefix!==t.bech32)throw new Error(e+" has an invalid prefix");if(0===n.version){if(20===n.data.length)return s.p2wpkh({hash:n.data}).output;if(32===n.data.length)return s.p2wsh({hash:n.data}).output}}}throw new Error(e+" has no matching Script")}}).call(this,r(26).Buffer)},4209:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){super(e),this.name="ValidationError",Object.setPrototypeOf(this,n.prototype)}}t.ValidationError=n,t.validate=function(e,t){if(!e)throw new n(t)}},4210:function(e){e.exports=JSON.parse('{"OP_FALSE":0,"OP_0":0,"OP_PUSHDATA1":76,"OP_PUSHDATA2":77,"OP_PUSHDATA4":78,"OP_1NEGATE":79,"OP_RESERVED":80,"OP_TRUE":81,"OP_1":81,"OP_2":82,"OP_3":83,"OP_4":84,"OP_5":85,"OP_6":86,"OP_7":87,"OP_8":88,"OP_9":89,"OP_10":90,"OP_11":91,"OP_12":92,"OP_13":93,"OP_14":94,"OP_15":95,"OP_16":96,"OP_NOP":97,"OP_VER":98,"OP_IF":99,"OP_NOTIF":100,"OP_VERIF":101,"OP_VERNOTIF":102,"OP_ELSE":103,"OP_ENDIF":104,"OP_VERIFY":105,"OP_RETURN":106,"OP_TOALTSTACK":107,"OP_FROMALTSTACK":108,"OP_2DROP":109,"OP_2DUP":110,"OP_3DUP":111,"OP_2OVER":112,"OP_2ROT":113,"OP_2SWAP":114,"OP_IFDUP":115,"OP_DEPTH":116,"OP_DROP":117,"OP_DUP":118,"OP_NIP":119,"OP_OVER":120,"OP_PICK":121,"OP_ROLL":122,"OP_ROT":123,"OP_SWAP":124,"OP_TUCK":125,"OP_CAT":126,"OP_SUBSTR":127,"OP_LEFT":128,"OP_RIGHT":129,"OP_SIZE":130,"OP_INVERT":131,"OP_AND":132,"OP_OR":133,"OP_XOR":134,"OP_EQUAL":135,"OP_EQUALVERIFY":136,"OP_RESERVED1":137,"OP_RESERVED2":138,"OP_1ADD":139,"OP_1SUB":140,"OP_2MUL":141,"OP_2DIV":142,"OP_NEGATE":143,"OP_ABS":144,"OP_NOT":145,"OP_0NOTEQUAL":146,"OP_ADD":147,"OP_SUB":148,"OP_MUL":149,"OP_DIV":150,"OP_MOD":151,"OP_LSHIFT":152,"OP_RSHIFT":153,"OP_BOOLAND":154,"OP_BOOLOR":155,"OP_NUMEQUAL":156,"OP_NUMEQUALVERIFY":157,"OP_NUMNOTEQUAL":158,"OP_LESSTHAN":159,"OP_GREATERTHAN":160,"OP_LESSTHANOREQUAL":161,"OP_GREATERTHANOREQUAL":162,"OP_MIN":163,"OP_MAX":164,"OP_WITHIN":165,"OP_RIPEMD160":166,"OP_SHA1":167,"OP_SHA256":168,"OP_HASH160":169,"OP_HASH256":170,"OP_CODESEPARATOR":171,"OP_CHECKSIG":172,"OP_CHECKSIGVERIFY":173,"OP_CHECKMULTISIG":174,"OP_CHECKMULTISIGVERIFY":175,"OP_NOP1":176,"OP_NOP2":177,"OP_CHECKLOCKTIMEVERIFY":177,"OP_NOP3":178,"OP_CHECKSEQUENCEVERIFY":178,"OP_NOP4":179,"OP_NOP5":180,"OP_NOP6":181,"OP_NOP7":182,"OP_NOP8":183,"OP_NOP9":184,"OP_NOP10":185,"OP_PUBKEYHASH":253,"OP_PUBKEY":254,"OP_INVALIDOPCODE":255}')},4211:function(e,t,r){"use strict";for(var n="qpzry9x8gf2tvdw0s3jn54khce6mua7l",i={},s=0;s<n.length;s++){var o=n.charAt(s);if(void 0!==i[o])throw new TypeError(o+" is ambiguous");i[o]=s}function u(e){var t=e>>25;return(33554431&e)<<5^996825010&-(t>>0&1)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function a(e){for(var t=1,r=0;r<e.length;++r){var n=e.charCodeAt(r);if(n<33||n>126)return"Invalid prefix ("+e+")";t=u(t)^n>>5}for(t=u(t),r=0;r<e.length;++r){var i=e.charCodeAt(r);t=u(t)^31&i}return t}function c(e,t){if(t=t||90,e.length<8)return e+" too short";if(e.length>t)return"Exceeds length limit";var r=e.toLowerCase(),n=e.toUpperCase();if(e!==r&&e!==n)return"Mixed-case string "+e;var s=(e=r).lastIndexOf("1");if(-1===s)return"No separator character for "+e;if(0===s)return"Missing prefix for "+e;var o=e.slice(0,s),c=e.slice(s+1);if(c.length<6)return"Data too short";var f=a(o);if("string"===typeof f)return f;for(var p=[],h=0;h<c.length;++h){var d=c.charAt(h),l=i[d];if(void 0===l)return"Unknown character "+d;f=u(f)^l,h+6>=c.length||p.push(l)}return 1!==f?"Invalid checksum for "+e:{prefix:o,words:p}}function f(e,t,r,n){for(var i=0,s=0,o=(1<<r)-1,u=[],a=0;a<e.length;++a)for(i=i<<t|e[a],s+=t;s>=r;)s-=r,u.push(i>>s&o);if(n)s>0&&u.push(i<<r-s&o);else{if(s>=t)return"Excess padding";if(i<<r-s&o)return"Non-zero padding"}return u}e.exports={decodeUnsafe:function(){var e=c.apply(null,arguments);if("object"===typeof e)return e},decode:function(e){var t=c.apply(null,arguments);if("object"===typeof t)return t;throw new Error(t)},encode:function(e,t,r){if(r=r||90,e.length+7+t.length>r)throw new TypeError("Exceeds length limit");var i=a(e=e.toLowerCase());if("string"===typeof i)throw new Error(i);for(var s=e+"1",o=0;o<t.length;++o){var c=t[o];if(c>>5!==0)throw new Error("Non 5-bit word");i=u(i)^c,s+=n.charAt(c)}for(o=0;o<6;++o)i=u(i);for(i^=1,o=0;o<6;++o){s+=n.charAt(i>>5*(5-o)&31)}return s},toWordsUnsafe:function(e){var t=f(e,8,5,!0);if(Array.isArray(t))return t},toWords:function(e){var t=f(e,8,5,!0);if(Array.isArray(t))return t;throw new Error(t)},fromWordsUnsafe:function(e){var t=f(e,5,8,!1);if(Array.isArray(t))return t},fromWords:function(e){var t=f(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}}},4212:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3958),i=r(3971),s=r(3970),o=r(1589),u=r(2684),a=r(3926),c=u.maybe(u.compile({compressed:i.maybe(i.Boolean),network:i.maybe(i.Network)}));class f{constructor(e,t,r){this.__D=e,this.__Q=t,this.lowR=!1,void 0===r&&(r={}),this.compressed=void 0===r.compressed||r.compressed,this.network=r.network||n.bitcoin,void 0!==t&&(this.__Q=s.pointCompress(t,this.compressed))}get privateKey(){return this.__D}get publicKey(){return this.__Q||(this.__Q=s.pointFromScalar(this.__D,this.compressed)),this.__Q}toWIF(){if(!this.__D)throw new Error("Missing private key");return a.encode(this.network.wif,this.__D,this.compressed)}sign(t,r){if(!this.__D)throw new Error("Missing private key");if(void 0===r&&(r=this.lowR),!1===r)return s.sign(t,this.__D);{let r=s.sign(t,this.__D);const n=e.alloc(32,0);let i=0;for(;r[0]>127;)i++,n.writeUIntLE(i,0,6),r=s.signWithEntropy(t,this.__D,n);return r}}verify(e,t){return s.verify(e,this.publicKey,t)}}function p(e,t){if(u(i.Buffer256bit,e),!s.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return u(c,t),new f(e,void 0,t)}t.fromPrivateKey=p,t.fromPublicKey=function(e,t){return u(s.isPoint,e),u(c,t),new f(void 0,e,t)},t.fromWIF=function(e,t){const r=a.decode(e),s=r.version;if(i.Array(t)){if(!(t=t.filter(e=>s===e.wif).pop()))throw new Error("Unknown network version")}else if(t=t||n.bitcoin,s!==t.wif)throw new Error("Invalid network version");return p(r.privateKey,{compressed:r.compressed,network:t})},t.makeRandom=function(e){u(c,e),void 0===e&&(e={});const t=e.rng||o;let r;do{r=t(32),u(i.Buffer256bit,r)}while(!s.isPrivate(r));return p(r,e)}}).call(this,r(26).Buffer)},4213:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4805);t.input=n;const i=r(4806);t.output=i},4214:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4808);t.input=n;const i=r(4809);t.output=i},4215:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4810);t.input=n;const i=r(4811);t.output=i},4412:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=r(3911);function s(e){const t=n.compile(e);return 22===t.length&&t[0]===i.OPS.OP_0&&20===t[1]}t.check=s,s.toJSON=()=>"Witness pubKeyHash output"},4413:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=r(3911);function s(e){const t=n.compile(e);return 34===t.length&&t[0]===i.OPS.OP_0&&32===t[1]}t.check=s,s.toJSON=()=>"Witness scriptHash output"},4778:function(e,t,r){var n=r(1346),i=r(4779),s=r(26).Buffer,o={Legacy:"legacy",Bitpay:"bitpay",Cashaddr:"cashaddr"},u={Mainnet:"mainnet",Testnet:"testnet"},a={};function c(e){return d(e).format}function f(e){return d(e).network}function p(e){return d(e).type}a.P2PKH="p2pkh",a.P2SH="p2sh";var h={};function d(e){try{return function(e){try{var t=n.decode(e);if(21!==t.length)throw new w;var r=t[0],i=Array.prototype.slice.call(t,1);switch(r){case h[o.Legacy][u.Mainnet][a.P2PKH]:return{hash:i,format:o.Legacy,network:u.Mainnet,type:a.P2PKH};case h[o.Legacy][u.Mainnet][a.P2SH]:return{hash:i,format:o.Legacy,network:u.Mainnet,type:a.P2SH};case h[o.Legacy][u.Testnet][a.P2PKH]:return{hash:i,format:o.Legacy,network:u.Testnet,type:a.P2PKH};case h[o.Legacy][u.Testnet][a.P2SH]:return{hash:i,format:o.Legacy,network:u.Testnet,type:a.P2SH};case h[o.Bitpay][u.Mainnet][a.P2PKH]:return{hash:i,format:o.Bitpay,network:u.Mainnet,type:a.P2PKH};case h[o.Bitpay][u.Mainnet][a.P2SH]:return{hash:i,format:o.Bitpay,network:u.Mainnet,type:a.P2SH}}}catch(s){}throw new w}(e)}catch(t){}try{return function(e){if(-1!==e.indexOf(":"))try{return l(e)}catch(t){}else for(var r=["bitcoincash","bchtest","bchreg"],n=0;n<r.length;++n)try{return l(r[n]+":"+e)}catch(t){}throw new w}(e)}catch(t){}throw new w}h[o.Legacy]={},h[o.Legacy][u.Mainnet]={},h[o.Legacy][u.Mainnet][a.P2PKH]=0,h[o.Legacy][u.Mainnet][a.P2SH]=5,h[o.Legacy][u.Testnet]={},h[o.Legacy][u.Testnet][a.P2PKH]=111,h[o.Legacy][u.Testnet][a.P2SH]=196,h[o.Bitpay]={},h[o.Bitpay][u.Mainnet]={},h[o.Bitpay][u.Mainnet][a.P2PKH]=28,h[o.Bitpay][u.Mainnet][a.P2SH]=40,h[o.Bitpay][u.Testnet]={},h[o.Bitpay][u.Testnet][a.P2PKH]=111,h[o.Bitpay][u.Testnet][a.P2SH]=196;function l(e){try{var t=i.decode(e),r=Array.prototype.slice.call(t.hash,0),n="P2PKH"===t.type?a.P2PKH:a.P2SH;switch(t.prefix){case"bitcoincash":return{hash:r,format:o.Cashaddr,network:u.Mainnet,type:n};case"bchtest":case"bchreg":return{hash:r,format:o.Cashaddr,network:u.Testnet,type:n}}}catch(s){}throw new w}function w(){var e=new Error;this.name=e.name="InvalidAddressError",this.message=e.message="Received an invalid Bitcoin Cash address as input.",this.stack=e.stack}w.prototype=Object.create(Error.prototype),e.exports={Format:o,Network:u,Type:a,isValidAddress:function(e){try{return d(e),!0}catch(t){return!1}},detectAddressFormat:c,detectAddressNetwork:f,detectAddressType:p,toLegacyAddress:function(e){var t=d(e);return t.format===o.Legacy?e:function(e){var t=h[o.Legacy][e.network][e.type],r=s.alloc(1+e.hash.length);return r[0]=t,r.set(e.hash,1),n.encode(r)}(t)},toBitpayAddress:function(e){var t=d(e);return t.format===o.Bitpay?e:function(e){var t=h[o.Bitpay][e.network][e.type],r=s.alloc(1+e.hash.length);return r[0]=t,r.set(e.hash,1),n.encode(r)}(t)},toCashAddress:function(e){return function(e){var t=e.network===u.Mainnet?"bitcoincash":"bchtest",r=e.type===a.P2PKH?"P2PKH":"P2SH",n=new Uint8Array(e.hash);return i.encode(t,r,n)}(d(e))},isLegacyAddress:function(e){return c(e)===o.Legacy},isBitpayAddress:function(e){return c(e)===o.Bitpay},isCashAddress:function(e){return c(e)===o.Cashaddr},isMainnetAddress:function(e){return f(e)===u.Mainnet},isTestnetAddress:function(e){return f(e)===u.Testnet},isP2PKHAddress:function(e){return p(e)===a.P2PKH},isP2SHAddress:function(e){return p(e)===a.P2SH},InvalidAddressError:w}},4779:function(e,t,r){"use strict";var n=r(4780),i=r(2686),s=r(4781),o=r(4205),u=o.validate;var a=o.ValidationError,c=["bitcoincash","bchtest","bchreg"];function f(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;++r)t[r]=31&e[r].charCodeAt(0);return t}function p(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function h(e){for(var t=[656907472481,522768456162,0xf33e5fb3c4,748107326120,130178868336],r=i(1),n=0;n<e.length;++n){var s=e[n],o=r.shiftRight(35);r=r.and(34359738367).shiftLeft(5).xor(s);for(var u=0;u<t.length;++u)o.shiftRight(u).and(1).equals(1)&&(r=r.xor(t[u]))}return r.xor(1)}function d(e){return e===e.toLowerCase()||e===e.toUpperCase()}e.exports={encode:function(e,t,r){u("string"===typeof e&&function(e){return d(e)&&-1!==c.indexOf(e.toLowerCase())}(e),"Invalid prefix: "+e+"."),u("string"===typeof t,"Invalid type: "+t+"."),u(r instanceof Uint8Array,"Invalid hash: "+r+".");var i,o=p(f(e),new Uint8Array(1)),l=function(e){switch(e){case"P2PKH":return 0;case"P2SH":return 8;default:throw new a("Invalid type: "+e+".")}}(t)+function(e){switch(8*e.length){case 160:return 0;case 192:return 1;case 224:return 2;case 256:return 3;case 320:return 4;case 384:return 5;case 448:return 6;case 512:return 7;default:throw new a("Invalid hash size: "+e.length+".")}}(r),w=(i=p(new Uint8Array([l]),r),s(i,8,5)),_=p(p(o,w),new Uint8Array(8)),y=p(w,function(e){for(var t=new Uint8Array(8),r=0;r<8;++r)t[7-r]=e.and(31).toJSNumber(),e=e.shiftRight(5);return t}(h(_)));return e+":"+n.encode(y)},decode:function(e){u("string"===typeof e&&d(e),"Invalid address: "+e+".");var t=e.toLowerCase().split(":");u(2===t.length,"Missing prefix: "+e+".");var r=t[0],i=n.decode(t[1]);u(function(e,t){var r=p(f(e),new Uint8Array(1));return h(p(r,t)).equals(0)}(r,i),"Invalid checksum: "+e+".");var o,c=(o=i.subarray(0,-8),s(o,5,8,!0)),l=c[0],w=c.subarray(1);return u(function(e){switch(7&e){case 0:return 160;case 1:return 192;case 2:return 224;case 3:return 256;case 4:return 320;case 5:return 384;case 6:return 448;case 7:return 512}}(l)===8*w.length,"Invalid hash size: "+e+"."),{prefix:r,type:function(e){switch(120&e){case 0:return"P2PKH";case 8:return"P2SH";default:throw new a("Invalid address type in version byte: "+e+".")}}(l),hash:w}},ValidationError:a}},4780:function(e,t,r){"use strict";var n=r(4205).validate,i={q:0,p:1,z:2,r:3,y:4,9:5,x:6,8:7,g:8,f:9,2:10,t:11,v:12,d:13,w:14,0:15,s:16,3:17,j:18,n:19,5:20,4:21,k:22,h:23,c:24,e:25,6:26,m:27,u:28,a:29,7:30,l:31};e.exports={encode:function(e){n(e instanceof Uint8Array,"Invalid data: "+e+".");for(var t="",r=0;r<e.length;++r){var i=e[r];n(0<=i&&i<32,"Invalid value: "+i+"."),t+="qpzry9x8gf2tvdw0s3jn54khce6mua7l"[i]}return t},decode:function(e){n("string"===typeof e,"Invalid base32-encoded string: "+e+".");for(var t=new Uint8Array(e.length),r=0;r<e.length;++r){var s=e[r];n(s in i,"Invalid value: "+s+"."),t[r]=i[s]}return t}}},4781:function(e,t,r){"use strict";var n=r(4205).validate;e.exports=function(e,t,r,i){for(var s=i?Math.floor(e.length*t/r):Math.ceil(e.length*t/r),o=(1<<r)-1,u=new Uint8Array(s),a=0,c=0,f=0,p=0;p<e.length;++p){var h=e[p];for(n(0<=h&&h>>t===0,"Invalid value: "+h+"."),c=c<<t|h,f+=t;f>=r;)f-=r,u[a]=c>>f&o,++a}return i?n(f<t&&0===(c<<r-f&o),"Input cannot be converted to "+r+" bits without padding, but strict mode was used."):f>0&&(u[a]=c<<r-f&o,++a),u}},4782:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4783);t.bip32=n;const i=r(4208);t.address=i;const s=r(3980);t.crypto=s;const o=r(4212);t.ECPair=o;const u=r(3958);t.networks=u;const a=r(4103);t.payments=a;const c=r(3911);t.script=c;var f=r(4800);t.Block=f.Block;var p=r(4802);t.Psbt=p.Psbt;var h=r(3911);t.opcodes=h.OPS;var d=r(4105);t.Transaction=d.Transaction;var l=r(4803);t.TransactionBuilder=l.TransactionBuilder},4783:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4784);t.fromSeed=n.fromSeed,t.fromBase58=n.fromBase58,t.fromPublicKey=n.fromPublicKey,t.fromPrivateKey=n.fromPrivateKey},4784:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(4785),i=r(1346),s=r(3970),o=r(2684),u=r(3926),a=o.BufferN(32),c=o.compile({wif:o.UInt8,bip32:{public:o.UInt32,private:o.UInt32}}),f={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},p=Math.pow(2,31)-1;function h(e){return o.String(e)&&null!==e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}function d(e){return o.UInt32(e)&&e<=p}class l{constructor(e,t,r,n,i=0,s=0,u=0){this.__D=e,this.__Q=t,this.chainCode=r,this.network=n,this.__DEPTH=i,this.__INDEX=s,this.__PARENT_FINGERPRINT=u,o(c,n),this.lowR=!1}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get publicKey(){return void 0===this.__Q&&(this.__Q=s.pointFromScalar(this.__D,!0)),this.__Q}get privateKey(){return this.__D}get identifier(){return n.hash160(this.publicKey)}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return void 0===this.__D}neutered(){return y(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){const t=this.network,r=this.isNeutered()?t.bip32.public:t.bip32.private,n=e.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),i.encode(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return u.encode(this.network.wif,this.privateKey,!0)}derive(t){o(o.UInt32,t);const r=t>=2147483648,i=e.allocUnsafe(37);if(r){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");i[0]=0,this.privateKey.copy(i,1),i.writeUInt32BE(t,33)}else this.publicKey.copy(i,0),i.writeUInt32BE(t,33);const u=n.hmacSHA512(this.chainCode,i),a=u.slice(0,32),c=u.slice(32);if(!s.isPrivate(a))return this.derive(t+1);let f;if(this.isNeutered()){const e=s.pointAddScalar(this.publicKey,a,!0);if(null===e)return this.derive(t+1);f=y(e,c,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}else{const e=s.privateAdd(this.privateKey,a);if(null==e)return this.derive(t+1);f=_(e,c,this.network,this.depth+1,t,this.fingerprint.readUInt32BE(0))}return f}deriveHardened(e){return o(d,e),this.derive(e+2147483648)}derivePath(e){o(h,e);let t=e.split("/");if("m"===t[0]){if(this.parentFingerprint)throw new TypeError("Expected master, got child");t=t.slice(1)}return t.reduce((e,t)=>{let r;return"'"===t.slice(-1)?(r=parseInt(t.slice(0,-1),10),e.deriveHardened(r)):(r=parseInt(t,10),e.derive(r))},this)}sign(t,r){if(!this.privateKey)throw new Error("Missing private key");if(void 0===r&&(r=this.lowR),!1===r)return s.sign(t,this.privateKey);{let r=s.sign(t,this.privateKey);const n=e.alloc(32,0);let i=0;for(;r[0]>127;)i++,n.writeUIntLE(i,0,6),r=s.signWithEntropy(t,this.privateKey,n);return r}}verify(e,t){return s.verify(e,this.publicKey,t)}}function w(e,t,r){return _(e,t,r)}function _(e,t,r,n,i,u){if(o({privateKey:a,chainCode:a},{privateKey:e,chainCode:t}),r=r||f,!s.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return new l(e,void 0,t,r,n,i,u)}function y(e,t,r,n,i,u){if(o({publicKey:o.BufferN(33),chainCode:a},{publicKey:e,chainCode:t}),r=r||f,!s.isPoint(e))throw new TypeError("Point is not on the curve");return new l(void 0,e,t,r,n,i,u)}t.fromBase58=function(e,t){const r=i.decode(e);if(78!==r.length)throw new TypeError("Invalid buffer length");t=t||f;const n=r.readUInt32BE(0);if(n!==t.bip32.private&&n!==t.bip32.public)throw new TypeError("Invalid network version");const s=r[4],o=r.readUInt32BE(5);if(0===s&&0!==o)throw new TypeError("Invalid parent fingerprint");const u=r.readUInt32BE(9);if(0===s&&0!==u)throw new TypeError("Invalid index");const a=r.slice(13,45);let c;if(n===t.bip32.private){if(0!==r.readUInt8(45))throw new TypeError("Invalid private key");c=_(r.slice(46,78),a,t,s,u,o)}else{c=y(r.slice(45,78),a,t,s,u,o)}return c},t.fromPrivateKey=w,t.fromPublicKey=function(e,t,r){return y(e,t,r)},t.fromSeed=function(t,r){if(o(o.Buffer,t),t.length<16)throw new TypeError("Seed should be at least 128 bits");if(t.length>64)throw new TypeError("Seed should be at most 512 bits");r=r||f;const i=n.hmacSHA512(e.from("Bitcoin seed","utf8"),t);return w(i.slice(0,32),i.slice(32),r)}}).call(this,r(26).Buffer)},4785:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(746),i=r(4060);t.hash160=function(e){const t=n("sha256").update(e).digest();try{return n("rmd160").update(t).digest()}catch(r){return n("ripemd160").update(t).digest()}},t.hmacSHA512=function(e,t){return i("sha512",e).update(t).digest()}},4786:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2686),i=r(4787),s=r(4788),o=r(4209),u=o.validate;function a(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t[r]=31&e[r].charCodeAt(0);return t}function c(e,t){const r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function f(e){const t=[656907472481,522768456162,0xf33e5fb3c4,748107326120,130178868336];let r=n(1);for(const n of e){const e=r.shiftRight(35);r=r.and(34359738367).shiftLeft(5).xor(n);for(let n=0;n<t.length;++n)e.shiftRight(n).and(1).equals(1)&&(r=r.xor(t[n]))}return r.xor(1)}function p(e){return e===e.toLowerCase()||e===e.toUpperCase()}t.encode=function(e,r,n){u("string"===typeof e&&function(e){return p(e)&&-1!==t.VALID_PREFIXES.indexOf(e.toLowerCase())}(e),"Invalid prefix: "+e+"."),u("string"===typeof r,"Invalid type: "+r+"."),u(n instanceof Uint8Array,"Invalid hash: "+n+".");const o=c(a(e),new Uint8Array(1)),h=function(e){switch(e){case"P2PKH":return 0;case"P2SH":return 8;default:throw new t.ValidationError("Invalid type: "+e+".")}}(r)+function(e){switch(8*e.length){case 160:return 0;case 192:return 1;case 224:return 2;case 256:return 3;case 320:return 4;case 384:return 5;case 448:return 6;case 512:return 7;default:throw new t.ValidationError("Invalid hash size: "+e.length+".")}}(n),d=(l=c(new Uint8Array([h]),n),s.convertBits(l,8,5));var l;const w=c(c(o,d),new Uint8Array(8)),_=c(d,function(e){const t=new Uint8Array(8);for(let r=0;r<8;++r)t[7-r]=e.and(31).toJSNumber(),e=e.shiftRight(5);return t}(f(w)));return e+":"+i.encode(_)},t.decode=function(e){u("string"===typeof e&&p(e),"Invalid address: "+e+".");const r=e.toLowerCase().split(":");u(2===r.length,"Missing prefix: "+e+".");const n=r[0],o=i.decode(r[1]);u(function(e,t){const r=c(a(e),new Uint8Array(1));return f(c(r,t)).equals(0)}(n,o),"Invalid checksum: "+e+".");const h=(d=o.subarray(0,-8),s.convertBits(d,5,8,!0));var d;const l=h[0],w=h.subarray(1);return u(function(e){switch(7&e){case 0:return 160;case 1:return 192;case 2:return 224;case 3:return 256;case 4:return 320;case 5:return 384;case 6:return 448;case 7:return 512;default:throw new t.ValidationError("Invalid versionByte: "+(7&e)+".")}}(l)===8*w.length,"Invalid hash size: "+e+"."),{prefix:n,type:function(e){switch(120&e){case 0:return"P2PKH";case 8:return"P2SH";default:throw new t.ValidationError("Invalid address type in version byte: "+e+".")}}(l),hash:w}},t.ValidationError=o.ValidationError,t.VALID_PREFIXES=["bitcoincash","bchtest","bchreg"]},4787:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4209),i={q:0,p:1,z:2,r:3,y:4,9:5,x:6,8:7,g:8,f:9,2:10,t:11,v:12,d:13,w:14,0:15,s:16,3:17,j:18,n:19,5:20,4:21,k:22,h:23,c:24,e:25,6:26,m:27,u:28,a:29,7:30,l:31};t.encode=function(e){n.validate(e instanceof Uint8Array,"Invalid data: "+e+".");let t="";for(const r of e)n.validate(0<=r&&r<32,"Invalid value: "+r+"."),t+="qpzry9x8gf2tvdw0s3jn54khce6mua7l"[r];return t},t.decode=function(e){n.validate("string"===typeof e,"Invalid base32-encoded string: "+e+".");const t=new Uint8Array(e.length);for(let r=0;r<e.length;++r){const s=e[r];n.validate(s in i,"Invalid value: "+s+"."),t[r]=i[s]}return t}},4788:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4209);t.convertBits=function(e,t,r,i){const s=i?Math.floor(e.length*t/r):Math.ceil(e.length*t/r),o=(1<<r)-1,u=new Uint8Array(s);let a=0,c=0,f=0;for(const p of e)for(n.validate(0<=p&&p>>t===0,"Invalid value: "+p+"."),c=c<<t|p,f+=t;f>=r;)f-=r,u[a]=c>>f&o,++a;return i?n.validate(f<t&&0===(c<<r-f&o),"Input cannot be converted to "+r+" bits without padding, but strict mode was used."):f>0&&(u[a]=c<<r-f&o,++a),u}},4789:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3958),i=r(3911),s=r(4008),o=r(2684),u=i.OPS;t.p2data=function(e,t){if(!e.data&&!e.output)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),o({network:o.maybe(o.Object),output:o.maybe(o.Buffer),data:o.maybe(o.arrayOf(o.Buffer))},e);const r={name:"embed",network:e.network||n.bitcoin};if(s.prop(r,"output",()=>{if(e.data)return i.compile([u.OP_RETURN].concat(e.data))}),s.prop(r,"data",()=>{if(e.output)return i.decompile(e.output).slice(1)}),t.validate&&e.output){const t=i.decompile(e.output);if(t[0]!==u.OP_RETURN)throw new TypeError("Output is invalid");if(!t.slice(1).every(o.Buffer))throw new TypeError("Output is invalid");if(e.data&&!function(e,t){return e.length===t.length&&e.every((e,r)=>e.equals(t[r]))}(e.data,r.data))throw new TypeError("Data mismatch")}return Object.assign(r,e)}},4790:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.decode=function(e,t,r){t=t||4,r=void 0===r||r;const n=e.length;if(0===n)return 0;if(n>t)throw new TypeError("Script number overflow");if(r&&0===(127&e[n-1])&&(n<=1||0===(128&e[n-2])))throw new Error("Non-minimally encoded script number");if(5===n){const t=e.readUInt32LE(0),r=e.readUInt8(4);return 128&r?-(4294967296*(-129&r)+t):4294967296*r+t}let i=0;for(let s=0;s<n;++s)i|=e[s]<<8*s;return 128&e[n-1]?-(i&~(128<<8*(n-1))):i},t.encode=function(t){let r=Math.abs(t);const n=(i=r)>2147483647?5:i>8388607?4:i>32767?3:i>127?2:i>0?1:0;var i;const s=e.allocUnsafe(n),o=t<0;for(let e=0;e<n;++e)s.writeUInt8(255&r,e),r>>=8;return 128&s[n-1]?s.writeUInt8(o?128:0,n-1):o&&(s[n-1]|=128),s}}).call(this,r(26).Buffer)},4791:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3971),i=r(3932),s=r(2684),o=e.alloc(1,0);function u(t){let r=0;for(;0===t[r];)++r;return r===t.length?o:128&(t=t.slice(r))[0]?e.concat([o,t],1+t.length):t}function a(t){0===t[0]&&(t=t.slice(1));const r=e.alloc(32,0),n=Math.max(0,32-t.length);return t.copy(r,n),r}t.decode=function(t){const r=t.readUInt8(t.length-1),n=-193&r;if(n<=0||n>=4)throw new Error("Invalid hashType "+r);const s=i.decode(t.slice(0,-1)),o=a(s.r),u=a(s.s);return{signature:e.concat([o,u],64),hashType:r}},t.encode=function(t,r){s({signature:n.BufferN(64),hashType:n.UInt8},{signature:t,hashType:r});const o=-193&r;if(o<=0||o>=4)throw new Error("Invalid hashType "+r);const a=e.allocUnsafe(1);a.writeUInt8(r,0);const c=u(t.slice(0,32)),f=u(t.slice(32,64));return e.concat([i.encode(c,f),a])}}).call(this,r(26).Buffer)},4792:function(e,t,r){var n=r(4210);function i(e){return e<n.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}e.exports={encodingLength:i,encode:function(e,t,r){var s=i(t);return 1===s?e.writeUInt8(t,r):2===s?(e.writeUInt8(n.OP_PUSHDATA1,r),e.writeUInt8(t,r+1)):3===s?(e.writeUInt8(n.OP_PUSHDATA2,r),e.writeUInt16LE(t,r+1)):(e.writeUInt8(n.OP_PUSHDATA4,r),e.writeUInt32LE(t,r+1)),s},decode:function(e,t){var r,i,s=e.readUInt8(t);if(s<n.OP_PUSHDATA1)r=s,i=1;else if(s===n.OP_PUSHDATA1){if(t+2>e.length)return null;r=e.readUInt8(t+1),i=2}else if(s===n.OP_PUSHDATA2){if(t+3>e.length)return null;r=e.readUInt16LE(t+1),i=3}else{if(t+5>e.length)return null;if(s!==n.OP_PUSHDATA4)throw new Error("Unexpected opcode");r=e.readUInt32LE(t+1),i=5}return{opcode:s,number:r,size:i}}}},4793:function(e,t,r){var n=r(4210),i={};for(var s in n){i[n[s]]=s}e.exports=i},4794:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3958),i=r(3911),s=r(4008),o=i.OPS,u=r(2684),a=r(3970),c=o.OP_RESERVED;function f(e,t){return e.length===t.length&&e.every((e,r)=>e.equals(t[r]))}t.p2ms=function(e,t){if(!e.input&&!e.output&&(!e.pubkeys||void 0===e.m)&&!e.signatures)throw new TypeError("Not enough data");function r(e){return i.isCanonicalScriptSignature(e)||void 0!==(t.allowIncomplete&&e===o.OP_0)}t=Object.assign({validate:!0},t||{}),u({network:u.maybe(u.Object),m:u.maybe(u.Number),n:u.maybe(u.Number),output:u.maybe(u.Buffer),pubkeys:u.maybe(u.arrayOf(a.isPoint)),signatures:u.maybe(u.arrayOf(r)),input:u.maybe(u.Buffer)},e);const p={network:e.network||n.bitcoin};let h=[],d=!1;function l(e){d||(d=!0,h=i.decompile(e),p.m=h[0]-c,p.n=h[h.length-2]-c,p.pubkeys=h.slice(1,-2))}if(s.prop(p,"output",()=>{if(e.m&&p.n&&e.pubkeys)return i.compile([].concat(c+e.m,e.pubkeys,c+p.n,o.OP_CHECKMULTISIG))}),s.prop(p,"m",()=>{if(p.output)return l(p.output),p.m}),s.prop(p,"n",()=>{if(p.pubkeys)return p.pubkeys.length}),s.prop(p,"pubkeys",()=>{if(e.output)return l(e.output),p.pubkeys}),s.prop(p,"signatures",()=>{if(e.input)return i.decompile(e.input).slice(1)}),s.prop(p,"input",()=>{if(e.signatures)return i.compile([o.OP_0].concat(e.signatures))}),s.prop(p,"witness",()=>{if(p.input)return[]}),s.prop(p,"name",()=>{if(p.m&&p.n)return`p2ms(${p.m} of ${p.n})`}),t.validate){if(e.output){if(l(e.output),!u.Number(h[0]))throw new TypeError("Output is invalid");if(!u.Number(h[h.length-2]))throw new TypeError("Output is invalid");if(h[h.length-1]!==o.OP_CHECKMULTISIG)throw new TypeError("Output is invalid");if(p.m<=0||p.n>16||p.m>p.n||p.n!==h.length-3)throw new TypeError("Output is invalid");if(!p.pubkeys.every(e=>a.isPoint(e)))throw new TypeError("Output is invalid");if(void 0!==e.m&&e.m!==p.m)throw new TypeError("m mismatch");if(void 0!==e.n&&e.n!==p.n)throw new TypeError("n mismatch");if(e.pubkeys&&!f(e.pubkeys,p.pubkeys))throw new TypeError("Pubkeys mismatch")}if(e.pubkeys){if(void 0!==e.n&&e.n!==e.pubkeys.length)throw new TypeError("Pubkey count mismatch");if(p.n=e.pubkeys.length,p.n<p.m)throw new TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<p.m)throw new TypeError("Not enough signatures provided");if(e.signatures.length>p.m)throw new TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==o.OP_0)throw new TypeError("Input is invalid");if(0===p.signatures.length||!p.signatures.every(r))throw new TypeError("Input has invalid signature(s)");if(e.signatures&&!f(e.signatures,p.signatures))throw new TypeError("Signature mismatch");if(void 0!==e.m&&e.m!==e.signatures.length)throw new TypeError("Signature count mismatch")}}return Object.assign(p,e)}},4795:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3958),i=r(3911),s=r(4008),o=r(2684),u=i.OPS,a=r(3970);t.p2pk=function(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw new TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),o({network:o.maybe(o.Object),output:o.maybe(o.Buffer),pubkey:o.maybe(a.isPoint),signature:o.maybe(i.isCanonicalScriptSignature),input:o.maybe(o.Buffer)},e);const r=s.value(()=>i.decompile(e.input)),c={name:"p2pk",network:e.network||n.bitcoin};if(s.prop(c,"output",()=>{if(e.pubkey)return i.compile([e.pubkey,u.OP_CHECKSIG])}),s.prop(c,"pubkey",()=>{if(e.output)return e.output.slice(1,-1)}),s.prop(c,"signature",()=>{if(e.input)return r()[0]}),s.prop(c,"input",()=>{if(e.signature)return i.compile([e.signature])}),s.prop(c,"witness",()=>{if(c.input)return[]}),t.validate){if(e.output){if(e.output[e.output.length-1]!==u.OP_CHECKSIG)throw new TypeError("Output is invalid");if(!a.isPoint(c.pubkey))throw new TypeError("Output pubkey is invalid");if(e.pubkey&&!e.pubkey.equals(c.pubkey))throw new TypeError("Pubkey mismatch")}if(e.signature&&e.input&&!e.input.equals(c.input))throw new TypeError("Signature mismatch");if(e.input){if(1!==r().length)throw new TypeError("Input is invalid");if(!i.isCanonicalScriptSignature(c.signature))throw new TypeError("Input has invalid signature")}}return Object.assign(c,e)}},4796:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3980),i=r(3958),s=r(3911),o=r(4008),u=r(2684),a=s.OPS,c=r(3970),f=r(1346);t.p2pkh=function(t,r){if(!t.address&&!t.hash&&!t.output&&!t.pubkey&&!t.input)throw new TypeError("Not enough data");r=Object.assign({validate:!0},r||{}),u({network:u.maybe(u.Object),address:u.maybe(u.String),hash:u.maybe(u.BufferN(20)),output:u.maybe(u.BufferN(25)),pubkey:u.maybe(c.isPoint),signature:u.maybe(s.isCanonicalScriptSignature),input:u.maybe(u.Buffer)},t);const p=o.value(()=>{const e=f.decode(t.address);return{version:e.readUInt8(0),hash:e.slice(1)}}),h=o.value(()=>s.decompile(t.input)),d=t.network||i.bitcoin,l={name:"p2pkh",network:d};if(o.prop(l,"address",()=>{if(!l.hash)return;const t=e.allocUnsafe(21);return t.writeUInt8(d.pubKeyHash,0),l.hash.copy(t,1),f.encode(t)}),o.prop(l,"hash",()=>t.output?t.output.slice(3,23):t.address?p().hash:t.pubkey||l.pubkey?n.hash160(t.pubkey||l.pubkey):void 0),o.prop(l,"output",()=>{if(l.hash)return s.compile([a.OP_DUP,a.OP_HASH160,l.hash,a.OP_EQUALVERIFY,a.OP_CHECKSIG])}),o.prop(l,"pubkey",()=>{if(t.input)return h()[1]}),o.prop(l,"signature",()=>{if(t.input)return h()[0]}),o.prop(l,"input",()=>{if(t.pubkey&&t.signature)return s.compile([t.signature,t.pubkey])}),o.prop(l,"witness",()=>{if(l.input)return[]}),r.validate){let r=e.from([]);if(t.address){if(p().version!==d.pubKeyHash)throw new TypeError("Invalid version or Network mismatch");if(20!==p().hash.length)throw new TypeError("Invalid address");r=p().hash}if(t.hash){if(r.length>0&&!r.equals(t.hash))throw new TypeError("Hash mismatch");r=t.hash}if(t.output){if(25!==t.output.length||t.output[0]!==a.OP_DUP||t.output[1]!==a.OP_HASH160||20!==t.output[2]||t.output[23]!==a.OP_EQUALVERIFY||t.output[24]!==a.OP_CHECKSIG)throw new TypeError("Output is invalid");const e=t.output.slice(3,23);if(r.length>0&&!r.equals(e))throw new TypeError("Hash mismatch");r=e}if(t.pubkey){const e=n.hash160(t.pubkey);if(r.length>0&&!r.equals(e))throw new TypeError("Hash mismatch");r=e}if(t.input){const e=h();if(2!==e.length)throw new TypeError("Input is invalid");if(!s.isCanonicalScriptSignature(e[0]))throw new TypeError("Input has invalid signature");if(!c.isPoint(e[1]))throw new TypeError("Input has invalid pubkey");if(t.signature&&!t.signature.equals(e[0]))throw new TypeError("Signature mismatch");if(t.pubkey&&!t.pubkey.equals(e[1]))throw new TypeError("Pubkey mismatch");const i=n.hash160(e[1]);if(r.length>0&&!r.equals(i))throw new TypeError("Hash mismatch")}}return Object.assign(l,t)}}).call(this,r(26).Buffer)},4797:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3980),i=r(3958),s=r(3911),o=r(4008),u=r(2684),a=s.OPS,c=r(1346);t.p2sh=function(t,r){if(!t.address&&!t.hash&&!t.output&&!t.redeem&&!t.input)throw new TypeError("Not enough data");r=Object.assign({validate:!0},r||{}),u({network:u.maybe(u.Object),address:u.maybe(u.String),hash:u.maybe(u.BufferN(20)),output:u.maybe(u.BufferN(23)),redeem:u.maybe({network:u.maybe(u.Object),output:u.maybe(u.Buffer),input:u.maybe(u.Buffer),witness:u.maybe(u.arrayOf(u.Buffer))}),input:u.maybe(u.Buffer),witness:u.maybe(u.arrayOf(u.Buffer))},t);let f=t.network;f||(f=t.redeem&&t.redeem.network||i.bitcoin);const p={network:f},h=o.value(()=>{const e=c.decode(t.address);return{version:e.readUInt8(0),hash:e.slice(1)}}),d=o.value(()=>s.decompile(t.input)),l=o.value(()=>{const e=d();return{network:f,output:e[e.length-1],input:s.compile(e.slice(0,-1)),witness:t.witness||[]}});if(o.prop(p,"address",()=>{if(!p.hash)return;const t=e.allocUnsafe(21);return t.writeUInt8(p.network.scriptHash,0),p.hash.copy(t,1),c.encode(t)}),o.prop(p,"hash",()=>t.output?t.output.slice(2,22):t.address?h().hash:p.redeem&&p.redeem.output?n.hash160(p.redeem.output):void 0),o.prop(p,"output",()=>{if(p.hash)return s.compile([a.OP_HASH160,p.hash,a.OP_EQUAL])}),o.prop(p,"redeem",()=>{if(t.input)return l()}),o.prop(p,"input",()=>{if(t.redeem&&t.redeem.input&&t.redeem.output)return s.compile([].concat(s.decompile(t.redeem.input),t.redeem.output))}),o.prop(p,"witness",()=>p.redeem&&p.redeem.witness?p.redeem.witness:p.input?[]:void 0),o.prop(p,"name",()=>{const e=["p2sh"];return void 0!==p.redeem&&e.push(p.redeem.name),e.join("-")}),r.validate){let r=e.from([]);if(t.address){if(h().version!==f.scriptHash)throw new TypeError("Invalid version or Network mismatch");if(20!==h().hash.length)throw new TypeError("Invalid address");r=h().hash}if(t.hash){if(r.length>0&&!r.equals(t.hash))throw new TypeError("Hash mismatch");r=t.hash}if(t.output){if(23!==t.output.length||t.output[0]!==a.OP_HASH160||20!==t.output[1]||t.output[22]!==a.OP_EQUAL)throw new TypeError("Output is invalid");const e=t.output.slice(2,22);if(r.length>0&&!r.equals(e))throw new TypeError("Hash mismatch");r=e}const i=e=>{if(e.output){const t=s.decompile(e.output);if(!t||t.length<1)throw new TypeError("Redeem.output too short");const i=n.hash160(e.output);if(r.length>0&&!r.equals(i))throw new TypeError("Hash mismatch");r=i}if(e.input){const t=e.input.length>0,r=e.witness&&e.witness.length>0;if(!t&&!r)throw new TypeError("Empty input");if(t&&r)throw new TypeError("Input and witness provided");if(t){const t=s.decompile(e.input);if(!s.isPushOnly(t))throw new TypeError("Non push-only scriptSig")}}};if(t.input){const t=d();if(!t||t.length<1)throw new TypeError("Input too short");if(!e.isBuffer(l().output))throw new TypeError("Input is invalid");i(l())}if(t.redeem){if(t.redeem.network&&t.redeem.network!==f)throw new TypeError("Network mismatch");if(t.input){const e=l();if(t.redeem.output&&!t.redeem.output.equals(e.output))throw new TypeError("Redeem.output mismatch");if(t.redeem.input&&!t.redeem.input.equals(e.input))throw new TypeError("Redeem.input mismatch")}i(t.redeem)}if(t.witness&&t.redeem&&t.redeem.witness&&!function(e,t){return e.length===t.length&&e.every((e,r)=>e.equals(t[r]))}(t.redeem.witness,t.witness))throw new TypeError("Witness and redeem.witness mismatch")}return Object.assign(p,t)}}).call(this,r(26).Buffer)},4798:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3980),i=r(3958),s=r(3911),o=r(4008),u=r(2684),a=s.OPS,c=r(3970),f=r(4211),p=e.alloc(0);t.p2wpkh=function(t,r){if(!t.address&&!t.hash&&!t.output&&!t.pubkey&&!t.witness)throw new TypeError("Not enough data");r=Object.assign({validate:!0},r||{}),u({address:u.maybe(u.String),hash:u.maybe(u.BufferN(20)),input:u.maybe(u.BufferN(0)),network:u.maybe(u.Object),output:u.maybe(u.BufferN(22)),pubkey:u.maybe(c.isPoint),signature:u.maybe(s.isCanonicalScriptSignature),witness:u.maybe(u.arrayOf(u.Buffer))},t);const h=o.value(()=>{const r=f.decode(t.address),n=r.words.shift(),i=f.fromWords(r.words);return{version:n,prefix:r.prefix,data:e.from(i)}}),d=t.network||i.bitcoin,l={name:"p2wpkh",network:d};if(o.prop(l,"address",()=>{if(!l.hash)return;const e=f.toWords(l.hash);return e.unshift(0),f.encode(d.bech32,e)}),o.prop(l,"hash",()=>t.output?t.output.slice(2,22):t.address?h().data:t.pubkey||l.pubkey?n.hash160(t.pubkey||l.pubkey):void 0),o.prop(l,"output",()=>{if(l.hash)return s.compile([a.OP_0,l.hash])}),o.prop(l,"pubkey",()=>t.pubkey?t.pubkey:t.witness?t.witness[1]:void 0),o.prop(l,"signature",()=>{if(t.witness)return t.witness[0]}),o.prop(l,"input",()=>{if(l.witness)return p}),o.prop(l,"witness",()=>{if(t.pubkey&&t.signature)return[t.signature,t.pubkey]}),r.validate){let r=e.from([]);if(t.address){if(d&&d.bech32!==h().prefix)throw new TypeError("Invalid prefix or Network mismatch");if(0!==h().version)throw new TypeError("Invalid address version");if(20!==h().data.length)throw new TypeError("Invalid address data");r=h().data}if(t.hash){if(r.length>0&&!r.equals(t.hash))throw new TypeError("Hash mismatch");r=t.hash}if(t.output){if(22!==t.output.length||t.output[0]!==a.OP_0||20!==t.output[1])throw new TypeError("Output is invalid");if(r.length>0&&!r.equals(t.output.slice(2)))throw new TypeError("Hash mismatch");r=t.output.slice(2)}if(t.pubkey){const e=n.hash160(t.pubkey);if(r.length>0&&!r.equals(e))throw new TypeError("Hash mismatch");if(r=e,!c.isPoint(t.pubkey)||33!==t.pubkey.length)throw new TypeError("Invalid pubkey for p2wpkh")}if(t.witness){if(2!==t.witness.length)throw new TypeError("Witness is invalid");if(!s.isCanonicalScriptSignature(t.witness[0]))throw new TypeError("Witness has invalid signature");if(!c.isPoint(t.witness[1])||33!==t.witness[1].length)throw new TypeError("Witness has invalid pubkey");if(t.signature&&!t.signature.equals(t.witness[0]))throw new TypeError("Signature mismatch");if(t.pubkey&&!t.pubkey.equals(t.witness[1]))throw new TypeError("Pubkey mismatch");const e=n.hash160(t.witness[1]);if(r.length>0&&!r.equals(e))throw new TypeError("Hash mismatch")}}return Object.assign(l,t)}}).call(this,r(26).Buffer)},4799:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3980),i=r(3958),s=r(3911),o=r(4008),u=r(2684),a=s.OPS,c=r(3970),f=r(4211),p=e.alloc(0);function h(t){return!(!e.isBuffer(t)||65!==t.length||4!==t[0]||!c.isPoint(t))}t.p2wsh=function(t,r){if(!t.address&&!t.hash&&!t.output&&!t.redeem&&!t.witness)throw new TypeError("Not enough data");r=Object.assign({validate:!0},r||{}),u({network:u.maybe(u.Object),address:u.maybe(u.String),hash:u.maybe(u.BufferN(32)),output:u.maybe(u.BufferN(34)),redeem:u.maybe({input:u.maybe(u.Buffer),network:u.maybe(u.Object),output:u.maybe(u.Buffer),witness:u.maybe(u.arrayOf(u.Buffer))}),input:u.maybe(u.BufferN(0)),witness:u.maybe(u.arrayOf(u.Buffer))},t);const c=o.value(()=>{const r=f.decode(t.address),n=r.words.shift(),i=f.fromWords(r.words);return{version:n,prefix:r.prefix,data:e.from(i)}}),d=o.value(()=>s.decompile(t.redeem.input));let l=t.network;l||(l=t.redeem&&t.redeem.network||i.bitcoin);const w={network:l};if(o.prop(w,"address",()=>{if(!w.hash)return;const e=f.toWords(w.hash);return e.unshift(0),f.encode(l.bech32,e)}),o.prop(w,"hash",()=>t.output?t.output.slice(2):t.address?c().data:w.redeem&&w.redeem.output?n.sha256(w.redeem.output):void 0),o.prop(w,"output",()=>{if(w.hash)return s.compile([a.OP_0,w.hash])}),o.prop(w,"redeem",()=>{if(t.witness)return{output:t.witness[t.witness.length-1],input:p,witness:t.witness.slice(0,-1)}}),o.prop(w,"input",()=>{if(w.witness)return p}),o.prop(w,"witness",()=>{if(t.redeem&&t.redeem.input&&t.redeem.input.length>0&&t.redeem.output&&t.redeem.output.length>0){const e=s.toStack(d());return w.redeem=Object.assign({witness:e},t.redeem),w.redeem.input=p,[].concat(e,t.redeem.output)}if(t.redeem&&t.redeem.output&&t.redeem.witness)return[].concat(t.redeem.witness,t.redeem.output)}),o.prop(w,"name",()=>{const e=["p2wsh"];return void 0!==w.redeem&&e.push(w.redeem.name),e.join("-")}),r.validate){let r=e.from([]);if(t.address){if(c().prefix!==l.bech32)throw new TypeError("Invalid prefix or Network mismatch");if(0!==c().version)throw new TypeError("Invalid address version");if(32!==c().data.length)throw new TypeError("Invalid address data");r=c().data}if(t.hash){if(r.length>0&&!r.equals(t.hash))throw new TypeError("Hash mismatch");r=t.hash}if(t.output){if(34!==t.output.length||t.output[0]!==a.OP_0||32!==t.output[1])throw new TypeError("Output is invalid");const e=t.output.slice(2);if(r.length>0&&!r.equals(e))throw new TypeError("Hash mismatch");r=e}if(t.redeem){if(t.redeem.network&&t.redeem.network!==l)throw new TypeError("Network mismatch");if(t.redeem.input&&t.redeem.input.length>0&&t.redeem.witness&&t.redeem.witness.length>0)throw new TypeError("Ambiguous witness source");if(t.redeem.output){if(0===s.decompile(t.redeem.output).length)throw new TypeError("Redeem.output is invalid");const e=n.sha256(t.redeem.output);if(r.length>0&&!r.equals(e))throw new TypeError("Hash mismatch");r=e}if(t.redeem.input&&!s.isPushOnly(d()))throw new TypeError("Non push-only scriptSig");if(t.witness&&t.redeem.witness&&!function(e,t){return e.length===t.length&&e.every((e,r)=>e.equals(t[r]))}(t.witness,t.redeem.witness))throw new TypeError("Witness and redeem.witness mismatch");if(t.redeem.input&&d().some(h)||t.redeem.output&&(s.decompile(t.redeem.output)||[]).some(h))throw new TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(t.witness&&t.witness.length>0){const e=t.witness[t.witness.length-1];if(t.redeem&&t.redeem.output&&!t.redeem.output.equals(e))throw new TypeError("Witness and redeem.output mismatch");if(t.witness.some(h)||(s.decompile(e)||[]).some(h))throw new TypeError("Witness contains uncompressed pubkey")}}return Object.assign(w,t)}}).call(this,r(26).Buffer)},4800:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(4104),i=r(3980),s=r(4105),o=r(3971),u=r(4801),a=r(2684),c=r(2685),f=new TypeError("Cannot compute merkle root for zero transactions"),p=new TypeError("Cannot compute witness commit for non-segwit block");class h{constructor(){this.version=1,this.prevHash=void 0,this.merkleRoot=void 0,this.timestamp=0,this.witnessCommit=void 0,this.bits=0,this.nonce=0,this.transactions=void 0}static fromBuffer(e){if(e.length<80)throw new Error("Buffer too small (< 80 bytes)");const t=new n.BufferReader(e),r=new h;if(r.version=t.readInt32(),r.prevHash=t.readSlice(32),r.merkleRoot=t.readSlice(32),r.timestamp=t.readUInt32(),r.bits=t.readUInt32(),r.nonce=t.readUInt32(),80===e.length)return r;const i=()=>{const e=s.Transaction.fromBuffer(t.buffer.slice(t.offset),!0);return t.offset+=e.byteLength(),e},o=t.readVarInt();r.transactions=[];for(let n=0;n<o;++n){const e=i();r.transactions.push(e)}const u=r.getWitnessCommit();return u&&(r.witnessCommit=u),r}static fromHex(t){return h.fromBuffer(e.from(t,"hex"))}static calculateTarget(t){const r=((4278190080&t)>>24)-3,n=8388607&t,i=e.alloc(32,0);return i.writeUIntBE(n,29-r,3),i}static calculateMerkleRoot(t,r){if(a([{getHash:o.Function}],t),0===t.length)throw f;if(r&&!d(t))throw p;const n=t.map(e=>e.getHash(r)),s=u(n,i.hash256);return r?i.hash256(e.concat([s,t[0].ins[0].witness[0]])):s}getWitnessCommit(){if(!d(this.transactions))return null;const t=this.transactions[0].outs.filter(t=>t.script.slice(0,6).equals(e.from("6a24aa21a9ed","hex"))).map(e=>e.script.slice(6,38));if(0===t.length)return null;const r=t[t.length-1];return r instanceof e&&32===r.length?r:null}hasWitnessCommit(){return this.witnessCommit instanceof e&&32===this.witnessCommit.length||null!==this.getWitnessCommit()}hasWitness(){return(e=this.transactions)instanceof Array&&e.some(e=>"object"===typeof e&&e.ins instanceof Array&&e.ins.some(e=>"object"===typeof e&&e.witness instanceof Array&&e.witness.length>0));var e}weight(){return 3*this.byteLength(!1,!1)+this.byteLength(!1,!0)}byteLength(e,t=!0){return e||!this.transactions?80:80+c.encodingLength(this.transactions.length)+this.transactions.reduce((e,r)=>e+r.byteLength(t),0)}getHash(){return i.hash256(this.toBuffer(!0))}getId(){return n.reverseBuffer(this.getHash()).toString("hex")}getUTCDate(){const e=new Date(0);return e.setUTCSeconds(this.timestamp),e}toBuffer(t){const r=e.allocUnsafe(this.byteLength(t)),i=new n.BufferWriter(r);return i.writeInt32(this.version),i.writeSlice(this.prevHash),i.writeSlice(this.merkleRoot),i.writeUInt32(this.timestamp),i.writeUInt32(this.bits),i.writeUInt32(this.nonce),t||!this.transactions||(c.encode(this.transactions.length,r,i.offset),i.offset+=c.encode.bytes,this.transactions.forEach(e=>{const t=e.byteLength();e.toBuffer(r,i.offset),i.offset+=t})),r}toHex(e){return this.toBuffer(e).toString("hex")}checkTxRoots(){const e=this.hasWitnessCommit();return!(!e&&this.hasWitness())&&(this.__checkMerkleRoot()&&(!e||this.__checkWitnessCommit()))}checkProofOfWork(){const e=n.reverseBuffer(this.getHash()),t=h.calculateTarget(this.bits);return e.compare(t)<=0}__checkMerkleRoot(){if(!this.transactions)throw f;const e=h.calculateMerkleRoot(this.transactions);return 0===this.merkleRoot.compare(e)}__checkWitnessCommit(){if(!this.transactions)throw f;if(!this.hasWitnessCommit())throw p;const e=h.calculateMerkleRoot(this.transactions,!0);return 0===this.witnessCommit.compare(e)}}function d(e){return e instanceof Array&&e[0]&&e[0].ins&&e[0].ins instanceof Array&&e[0].ins[0]&&e[0].ins[0].witness&&e[0].ins[0].witness instanceof Array&&e[0].ins[0].witness.length>0}t.Block=h}).call(this,r(26).Buffer)},4801:function(e,t,r){(function(t){e.exports=function(e,r){if(!Array.isArray(e))throw TypeError("Expected values Array");if("function"!==typeof r)throw TypeError("Expected digest Function");for(var n=e.length,i=e.concat();n>1;){for(var s=0,o=0;o<n;o+=2,++s){var u=i[o],a=o+1===n?u:i[o+1],c=t.concat([u,a]);i[s]=r(c)}n=s}return i[0]}}).call(this,r(26).Buffer)},4802:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(2732),i=r(750),s=r(1644),o=r(4208),u=r(4104),a=r(3980),c=r(4212),f=r(3958),p=r(4103),h=r(3911),d=r(4105),l=d.Transaction.SIGHASH_ALL|d.Transaction.SIGHASH_BITCOINCASHBIP143,w=d.Transaction.SIGHASH_ALL|d.Transaction.SIGHASH_BITCOINCASHBIP143|d.Transaction.FORKID_BTG<<8,_=[d.Transaction.SIGHASH_ALL,l,w],y={network:f.bitcoin,maximumFeeRate:5e3,forkCoin:"none"};class b{constructor(e={},t=new n.Psbt(new g)){this.data=t,this.opts=Object.assign({},y,e),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},0===this.data.inputs.length&&this.setVersion(2);const r=(e,t,r,n)=>Object.defineProperty(e,t,{enumerable:r,writable:n});r(this,"__CACHE",!1,!0),r(this,"opts",!1,!0)}static fromBase64(t,r={}){const n=e.from(t,"base64");return this.fromBuffer(n,r)}static fromHex(t,r={}){const n=e.from(t,"hex");return this.fromBuffer(n,r)}static fromBuffer(e,t={}){const r=n.Psbt.fromBuffer(e,E),i=new b(t,r);var s,o;return s=i.__CACHE.__TX,o=i.__CACHE,s.ins.forEach(e=>{U(o,e)}),i}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(e){this.setVersion(e)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(e){this.setLocktime(e)}get txInputs(){return this.__CACHE.__TX.ins.map(e=>({hash:u.cloneBuffer(e.hash),index:e.index,sequence:e.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(e=>{let t;try{t=o.fromOutputScript(e.script,this.opts.network)}catch(r){}return{script:u.cloneBuffer(e.script),value:e.value,address:t}})}combine(...e){return this.data.combine(...e.map(e=>e.data)),this}clone(){const e=b.fromBuffer(this.data.toBuffer());return e.opts=JSON.parse(JSON.stringify(this.opts)),e}setMaximumFeeRate(e){H(e),this.opts.maximumFeeRate=e}setVersion(e){H(e),B(this.data.inputs,"setVersion");const t=this.__CACHE;return t.__TX.version=e,t.__EXTRACTED_TX=void 0,this}setLocktime(e){H(e),B(this.data.inputs,"setLocktime");const t=this.__CACHE;return t.__TX.locktime=e,t.__EXTRACTED_TX=void 0,this}setInputSequence(e,t){H(t),B(this.data.inputs,"setInputSequence");const r=this.__CACHE;if(r.__TX.ins.length<=e)throw new Error("Input index too high");return r.__TX.ins[e].sequence=t,r.__EXTRACTED_TX=void 0,this}addInputs(e){return e.forEach(e=>this.addInput(e)),this}addInput(e){if(arguments.length>1||!e||void 0===e.hash||void 0===e.index)throw new Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");B(this.data.inputs,"addInput"),e.witnessScript&&J(e.witnessScript);const t=this.__CACHE;this.data.addInput(e);U(t,t.__TX.ins[t.__TX.ins.length-1]);const r=this.data.inputs.length-1,n=this.data.inputs[r];return n.nonWitnessUtxo&&q(this.__CACHE,n,r),t.__FEE=void 0,t.__FEE_RATE=void 0,t.__EXTRACTED_TX=void 0,this}addOutputs(e){return e.forEach(e=>this.addOutput(e)),this}addOutput(e){if(arguments.length>1||!e||void 0===e.value||void 0===e.address&&void 0===e.script)throw new Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");B(this.data.inputs,"addOutput");const{address:t}=e;if("string"===typeof t){const{network:r}=this.opts,n=o.toOutputScript(t,r);e=Object.assign(e,{script:n})}const r=this.__CACHE;return this.data.addOutput(e),r.__FEE=void 0,r.__FEE_RATE=void 0,r.__EXTRACTED_TX=void 0,this}extractTransaction(e){if(!this.data.inputs.every(I))throw new Error("Not finalized");const t=this.__CACHE;if(e||function(e,t,r){const n=t.__FEE_RATE||e.getFeeRate(),i=t.__EXTRACTED_TX.virtualSize(),s=n*i;if(n>=r.maximumFeeRate)throw new Error(`Warning: You are paying around ${(s/1e8).toFixed(8)} in fees, which is ${n} satoshi per byte for a transaction with a VSize of ${i} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}(this,t,this.opts),t.__EXTRACTED_TX)return t.__EXTRACTED_TX;const r=t.__TX.clone();return j(this.data.inputs,r,t,!0),r}getFeeRate(){return x("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return x("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return s.checkForInput(this.data.inputs,0),te(this.data.inputs.length).forEach(e=>this.finalizeInput(e)),this}finalizeInput(e,t=V){const r=s.checkForInput(this.data.inputs,e),{script:n,isP2SH:i,isP2WSH:o,isSegwit:u}=function(e,t,r){const n=r.__TX,i={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(i.isP2SH=!!t.redeemScript,i.isP2WSH=!!t.witnessScript,t.witnessScript)i.script=t.witnessScript;else if(t.redeemScript)i.script=t.redeemScript;else if(t.nonWitnessUtxo){const s=X(r,t,e),o=n.ins[e].index;i.script=s.outs[o].script}else t.witnessUtxo&&(i.script=t.witnessUtxo.script);(t.witnessScript||O(i.script))&&(i.isSegwit=!0);return i}(e,r,this.__CACHE);if(!n)throw new Error("No script found for input #"+e);!function(e){if(!e.sighashType||!e.partialSig)return;const{partialSig:t,sighashType:r}=e;t.forEach(e=>{const{hashType:t}=h.signature.decode(e.signature);if((255&r)!==t)throw new Error("Signature sighash does not match input sighash type")})}(r);const{finalScriptSig:a,finalScriptWitness:c}=t(e,r,n,u,i,o);if(a&&this.data.updateInput(e,{finalScriptSig:a}),c&&this.data.updateInput(e,{finalScriptWitness:c}),!a&&!c)throw new Error("Unknown error finalizing input #"+e);return this.data.clearFinalizedInput(e),this}getInputType(t){const r=s.checkForInput(this.data.inputs,t),n=$(z(t,r,this.__CACHE),t,"input",r.redeemScript||function(t){if(!t)return;const r=h.decompile(t);if(!r)return;const n=r[r.length-1];if(!e.isBuffer(n)||Q(n)||(i=n,h.isCanonicalScriptSignature(i)))return;var i;if(!h.decompile(n))return;return n}(r.finalScriptSig),r.witnessScript||function(e){if(!e)return;const t=W(e),r=t[t.length-1];if(Q(r))return;if(!h.decompile(r))return;return r}(r.finalScriptWitness));return("raw"===n.type?"":n.type+"-")+ee(n.meaningfulScript)}inputHasPubkey(e,t){return function(e,t,r,n){const i=z(r,t,n),{meaningfulScript:s}=$(i,r,"input",t.redeemScript,t.witnessScript);return Z(e,s)}(t,s.checkForInput(this.data.inputs,e),e,this.__CACHE)}inputHasHDKey(e,t){const r=s.checkForInput(this.data.inputs,e),n=C(t);return!!r.bip32Derivation&&r.bip32Derivation.some(n)}outputHasPubkey(e,t){return function(e,t,r,n){const i=n.__TX.outs[r].script,{meaningfulScript:s}=$(i,r,"output",t.redeemScript,t.witnessScript);return Z(e,s)}(t,s.checkForOutput(this.data.outputs,e),e,this.__CACHE)}outputHasHDKey(e,t){const r=s.checkForOutput(this.data.outputs,e),n=C(t);return!!r.bip32Derivation&&r.bip32Derivation.some(n)}validateSignaturesOfAllInputs(){s.checkForInput(this.data.inputs,0);return te(this.data.inputs.length).map(e=>this.validateSignaturesOfInput(e)).reduce((e,t)=>!0===t&&e,!0)}validateSignaturesOfInput(e,t){const r=this.data.inputs[e],n=(r||{}).partialSig;if(!r||!n||n.length<1)throw new Error("No signatures to validate");const i=t?n.filter(e=>e.pubkey.equals(t)):n;if(i.length<1)throw new Error("No signatures for this pubkey");const s=[];let o,u,a;for(const f of i){const t=h.signature.decode(f.signature),{hash:n,script:i}=a!==t.hashType?M(e,Object.assign({},r,{sighashType:t.hashType}),this.__CACHE,!0,this.opts.forkCoin):{hash:o,script:u};a=t.hashType,o=n,u=i,L(f.pubkey,i,"verify");const p=c.fromPublicKey(f.pubkey);s.push(p.verify(n,t.signature))}return s.every(e=>!0===e)}signAllInputsHD(e,t=_){if(!e||!e.publicKey||!e.fingerprint)throw new Error("Need HDSigner to sign input");const r=[];for(const i of te(this.data.inputs.length))try{this.signInputHD(i,e,t),r.push(!0)}catch(n){r.push(!1)}if(r.every(e=>!1===e))throw new Error("No inputs were signed");return this}signAllInputsHDAsync(e,t=_){return new Promise((r,n)=>{if(!e||!e.publicKey||!e.fingerprint)return n(new Error("Need HDSigner to sign input"));const i=[],s=[];for(const o of te(this.data.inputs.length))s.push(this.signInputHDAsync(o,e,t).then(()=>{i.push(!0)},()=>{i.push(!1)}));return Promise.all(s).then(()=>{if(i.every(e=>!1===e))return n(new Error("No inputs were signed"));r()})})}signInputHD(e,t,r=_){if(!t||!t.publicKey||!t.fingerprint)throw new Error("Need HDSigner to sign input");return G(e,this.data.inputs,t).forEach(t=>this.signInput(e,t,r)),this}signInputHDAsync(e,t,r=_){return new Promise((n,i)=>{if(!t||!t.publicKey||!t.fingerprint)return i(new Error("Need HDSigner to sign input"));const s=G(e,this.data.inputs,t).map(t=>this.signInputAsync(e,t,r));return Promise.all(s).then(()=>{n()}).catch(i)})}signAllInputs(e,t=_){if(!e||!e.publicKey)throw new Error("Need Signer to sign input");const r=[];for(const i of te(this.data.inputs.length))try{this.signInput(i,e,t),r.push(!0)}catch(n){r.push(!1)}if(r.every(e=>!1===e))throw new Error("No inputs were signed");return this}signAllInputsAsync(e,t=_){return new Promise((r,n)=>{if(!e||!e.publicKey)return n(new Error("Need Signer to sign input"));const i=[],s=[];for(const[o]of this.data.inputs.entries())s.push(this.signInputAsync(o,e,t).then(()=>{i.push(!0)},()=>{i.push(!1)}));return Promise.all(s).then(()=>{if(i.every(e=>!1===e))return n(new Error("No inputs were signed"));r()})})}signInput(e,t,r=_){if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const{hash:n,sighashType:i}=F(this.data.inputs,e,t.publicKey,this.__CACHE,r,this.opts.forkCoin),s=[{pubkey:t.publicKey,signature:h.signature.encode(t.sign(n),255&i)}];return this.data.updateInput(e,{partialSig:s}),this}signInputAsync(e,t,r=_){return Promise.resolve().then(()=>{if(!t||!t.publicKey)throw new Error("Need Signer to sign input");const{hash:n,sighashType:i}=F(this.data.inputs,e,t.publicKey,this.__CACHE,r,this.opts.forkCoin);return Promise.resolve(t.sign(n)).then(r=>{const n=[{pubkey:t.publicKey,signature:h.signature.encode(r,255&i)}];this.data.updateInput(e,{partialSig:n})})})}toBuffer(){return v(this.__CACHE),this.data.toBuffer()}toHex(){return v(this.__CACHE),this.data.toHex()}toBase64(){return v(this.__CACHE),this.data.toBase64()}updateGlobal(e){return this.data.updateGlobal(e),this}updateInput(e,t){return t.witnessScript&&J(t.witnessScript),this.data.updateInput(e,t),t.nonWitnessUtxo&&q(this.__CACHE,this.data.inputs[e],e),this}updateOutput(e,t){return this.data.updateOutput(e,t),this}addUnknownKeyValToGlobal(e){return this.data.addUnknownKeyValToGlobal(e),this}addUnknownKeyValToInput(e,t){return this.data.addUnknownKeyValToInput(e,t),this}addUnknownKeyValToOutput(e,t){return this.data.addUnknownKeyValToOutput(e,t),this}clearFinalizedInput(e){return this.data.clearFinalizedInput(e),this}}t.Psbt=b;const E=e=>new g(e);class g{constructor(t=e.from([2,0,0,0,0,0,0,0,0,0])){this.tx=d.Transaction.fromBuffer(t),function(e){if(!e.ins.every(e=>e.script&&0===e.script.length&&e.witness&&0===e.witness.length))throw new Error("Format Error: Transaction ScriptSigs are not empty")}(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(t){if(void 0===t.hash||void 0===t.index||!e.isBuffer(t.hash)&&"string"!==typeof t.hash||"number"!==typeof t.index)throw new Error("Error adding input.");const r="string"===typeof t.hash?u.reverseBuffer(e.from(t.hash,"hex")):t.hash;this.tx.addInput(r,t.index,t.sequence)}addOutput(t){if(void 0===t.script||void 0===t.value||!e.isBuffer(t.script)||"number"!==typeof t.value)throw new Error("Error adding output.");this.tx.addOutput(t.script,t.value)}toBuffer(){return this.tx.toBuffer()}}function v(e){if(!1!==e.__UNSAFE_SIGN_NONSEGWIT)throw new Error("Not BIP174 compliant, can not export")}function m(e,t,r){if(!t)return!1;let n;if(n=r?r.map(e=>{const r=c.fromPublicKey(e,{compressed:!0}).publicKey;return t.find(e=>e.pubkey.equals(r))}).filter(e=>!!e):t,n.length>e)throw new Error("Too many signatures");return n.length===e}function I(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function S(e){return t=>{try{return e({output:t}),!0}catch(r){return!1}}}const P=S(p.p2ms),T=S(p.p2pk),A=S(p.p2pkh),O=S(p.p2wpkh),k=S(p.p2wsh),N=S(p.p2sh);function C(e){return t=>!!t.masterFingerprint.equals(e.fingerprint)&&!!e.derivePath(t.path).publicKey.equals(t.pubkey)}function H(e){if("number"!==typeof e||e!==Math.floor(e)||e>4294967295||e<0)throw new Error("Invalid 32 bit integer")}function B(t,r){t.forEach(t=>{let n=!1,i=[];if(0===(t.partialSig||[]).length){if(!t.finalScriptSig&&!t.finalScriptWitness)return;i=function(t){const r=t.finalScriptSig&&h.decompile(t.finalScriptSig)||[],n=t.finalScriptWitness&&h.decompile(t.finalScriptWitness)||[];return r.concat(n).filter(t=>e.isBuffer(t)&&h.isCanonicalScriptSignature(t)).map(e=>({signature:e}))}(t)}else i=t.partialSig;if(i.forEach(e=>{const{hashType:t}=h.signature.decode(e.signature),i=[];t&d.Transaction.SIGHASH_ANYONECANPAY&&i.push("addInput");switch(31&t){case d.Transaction.SIGHASH_ALL:break;case d.Transaction.SIGHASH_SINGLE:case d.Transaction.SIGHASH_NONE:i.push("addOutput"),i.push("setInputSequence")}-1===i.indexOf(r)&&(n=!0)}),n)throw new Error("Can not modify transaction, signatures exist.")})}function L(e,t,r){if(!Z(e,t))throw new Error(`Can not ${r} for this input with the key ${e.toString("hex")}`)}function U(t,r){const n=u.reverseBuffer(e.from(r.hash)).toString("hex")+":"+r.index;if(t.__TX_IN_CACHE[n])throw new Error("Duplicate input detected.");t.__TX_IN_CACHE[n]=1}function K(e,t){return(r,n,i,s)=>{const o=e({redeem:{output:i}}).output;if(!n.equals(o))throw new Error(`${t} for ${s} #${r} doesn't match the scriptPubKey in the prevout`)}}const D=K(p.p2sh,"Redeem script"),R=K(p.p2wsh,"Witness script");function x(e,t,r,n){if(!r.every(I))throw new Error("PSBT must be finalized to calculate "+t);if("__FEE_RATE"===e&&n.__FEE_RATE)return n.__FEE_RATE;if("__FEE"===e&&n.__FEE)return n.__FEE;let i,s=!0;return n.__EXTRACTED_TX?(i=n.__EXTRACTED_TX,s=!1):i=n.__TX.clone(),j(r,i,n,s),"__FEE_RATE"===e?n.__FEE_RATE:"__FEE"===e?n.__FEE:void 0}function V(e,t,r,n,i,s){const o=ee(r);if(!function(e,t,r){switch(r){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return m(1,e.partialSig);case"multisig":const r=p.p2ms({output:t});return m(r.m,e.partialSig,r.pubkeys);default:return!1}}(t,r,o))throw new Error("Can not finalize input #"+e);return function(e,t,r,n,i,s){let o,u;const a=function(e,t,r){let n;switch(t){case"multisig":const t=function(e,t){return p.p2ms({output:e}).pubkeys.map(e=>(t.filter(t=>t.pubkey.equals(e))[0]||{}).signature).filter(e=>!!e)}(e,r);n=p.p2ms({output:e,signatures:t});break;case"pubkey":n=p.p2pk({output:e,signature:r[0].signature});break;case"pubkeyhash":n=p.p2pkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature});break;case"witnesspubkeyhash":n=p.p2wpkh({output:e,pubkey:r[0].pubkey,signature:r[0].signature})}return n}(e,t,r),c=s?p.p2wsh({redeem:a}):null,f=i?p.p2sh({redeem:c||a}):null;n?(u=Y(c?c.witness:a.witness),f&&(o=f.input)):o=f?f.input:a.input;return{finalScriptSig:o,finalScriptWitness:u}}(r,o,t.partialSig,n,i,s)}function F(e,t,r,n,i,o){const u=s.checkForInput(e,t),{hash:a,sighashType:c,script:f}=M(t,u,n,!1,o,i);return L(r,f,"sign"),{hash:a,sighashType:c}}function M(e,t,r,n,i,s){const o=r.__TX,u=t.sighashType||function(e){switch(e){case"bch":return l;case"btg":return w;case"none":return d.Transaction.SIGHASH_ALL}}(i);if(s&&s.indexOf(u)<0){const e=function(e){let t=e&d.Transaction.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";e&d.Transaction.SIGHASH_BITCOINCASHBIP143&&(t+="SIGHASH_BITCOINCASHBIP143 | ");e&d.Transaction.FORKID_BTG<<8?t+="FORKID_BTG | ":t+="FORKID_BCH | ";switch(31&e){case d.Transaction.SIGHASH_ALL:t+="SIGHASH_ALL";break;case d.Transaction.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case d.Transaction.SIGHASH_NONE:t+="SIGHASH_NONE"}return t}(u);throw new Error("Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: "+e)}let a,c;const f=(u&d.Transaction.SIGHASH_BITCOINCASHBIP143)>0,h=(u&d.Transaction.FORKID_BTG<<8)>0;if(t.nonWitnessUtxo){const n=X(r,t,e),i=o.ins[e].hash,s=n.getHash();if(!i.equals(s))throw new Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);const u=o.ins[e].index;c=n.outs[u]}else{if(!t.witnessUtxo)throw new Error("Need a Utxo input item for signing");c=t.witnessUtxo}const{meaningfulScript:_,type:y}=$(c.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(y)>=0)a=f&&h?o.hashForGoldSignature(e,_,c.value,u,!0):o.hashForWitnessV0(e,_,c.value,u);else if(O(_)){const t=p.p2pkh({hash:_.slice(2)}).output;a=f&&h?o.hashForGoldSignature(e,t,c.value,u,!0):o.hashForWitnessV0(e,t,c.value,u)}else{if(!f&&void 0===t.nonWitnessUtxo&&!1===r.__UNSAFE_SIGN_NONSEGWIT)throw new Error(`Input #${e} has witnessUtxo but non-segwit script: `+_.toString("hex"));!n&&r.__UNSAFE_SIGN_NONSEGWIT,a=f&&h?o.hashForGoldSignature(e,_,c.value,u,!0):f?o.hashForCashSignature(e,_,c.value,u):o.hashForSignature(e,_,u)}return{script:_,sighashType:u,hash:a}}function G(e,t,r){const n=s.checkForInput(t,e);if(!n.bip32Derivation||0===n.bip32Derivation.length)throw new Error("Need bip32Derivation to sign with HD");const i=n.bip32Derivation.map(e=>e.masterFingerprint.equals(r.fingerprint)?e:void 0).filter(e=>!!e);if(0===i.length)throw new Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return i.map(e=>{const t=r.derivePath(e.path);if(!e.pubkey.equals(t.publicKey))throw new Error("pubkey did not match bip32Derivation");return t})}function W(e){let t=0;function r(){const r=i.decode(e,t);return t+=i.decode.bytes,r}function n(){return n=r(),t+=n,e.slice(t-n,t);var n}return function(){const e=r(),t=[];for(let r=0;r<e;r++)t.push(n());return t}()}function Y(t){let r=e.allocUnsafe(0);function n(t){const n=r.length,s=i.encodingLength(t);r=e.concat([r,e.allocUnsafe(s)]),i.encode(t,r,n)}function s(t){n(t.length),function(t){r=e.concat([r,e.from(t)])}(t)}var o;return n((o=t).length),o.forEach(s),r}function q(e,t,r){e.__NON_WITNESS_UTXO_BUF_CACHE[r]=t.nonWitnessUtxo;const n=d.Transaction.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[r]=n;const i=e,s=r;delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){const e=i.__NON_WITNESS_UTXO_BUF_CACHE[s],t=i.__NON_WITNESS_UTXO_TX_CACHE[s];if(void 0!==e)return e;{const e=t.toBuffer();return i.__NON_WITNESS_UTXO_BUF_CACHE[s]=e,e}},set(e){i.__NON_WITNESS_UTXO_BUF_CACHE[s]=e}})}function j(e,t,r,n){let i=0;e.forEach((e,s)=>{if(n&&e.finalScriptSig&&(t.ins[s].script=e.finalScriptSig),n&&e.finalScriptWitness&&(t.ins[s].witness=W(e.finalScriptWitness)),e.witnessUtxo)i+=e.witnessUtxo.value;else if(e.nonWitnessUtxo){const n=X(r,e,s),o=t.ins[s].index,u=n.outs[o];i+=u.value}});const s=t.outs.reduce((e,t)=>e+t.value,0),o=i-s;if(o<0)throw new Error("Outputs are spending more than Inputs");const u=t.virtualSize();r.__FEE=o,r.__EXTRACTED_TX=t,r.__FEE_RATE=Math.floor(o/u)}function X(e,t,r){const n=e.__NON_WITNESS_UTXO_TX_CACHE;return n[r]||q(e,t,r),n[r]}function z(e,t,r){if(void 0!==t.witnessUtxo)return t.witnessUtxo.script;if(void 0!==t.nonWitnessUtxo){return X(r,t,e).outs[r.__TX.ins[e].index].script}throw new Error("Can't find pubkey in input without Utxo data")}function Q(e){return 33===e.length&&h.isCanonicalPubKey(e)}function $(e,t,r,n,i){const s=N(e),o=s&&n&&k(n),u=k(e);if(s&&void 0===n)throw new Error("scriptPubkey is P2SH but redeemScript missing");if((u||o)&&void 0===i)throw new Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");let a;return o?(a=i,D(t,e,n,r),R(t,n,i,r),J(a)):u?(a=i,R(t,e,i,r),J(a)):s?(a=n,D(t,e,n,r)):a=e,{meaningfulScript:a,type:o?"p2sh-p2wsh":s?"p2sh":u?"p2wsh":"raw"}}function J(e){if(O(e)||N(e))throw new Error("P2WPKH or P2SH can not be contained within P2WSH")}function Z(e,t){const r=a.hash160(e),n=h.decompile(t);if(null===n)throw new Error("Unknown script error");return n.some(t=>"number"!==typeof t&&(t.equals(e)||t.equals(r)))}function ee(e){return O(e)?"witnesspubkeyhash":A(e)?"pubkeyhash":P(e)?"multisig":T(e)?"pubkey":"nonstandard"}function te(e){return[...Array(e).keys()]}}).call(this,r(26).Buffer)},4803:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(4208),i=r(4104),s=r(4804),o=r(3980),u=r(4212),a=r(3958),c=r(4103),f=r(3911),p=r(3911),h=r(4105),d=r(3971),l=r(2684),w=s.types,_=new Set(["p2pkh","p2pk","p2wpkh","p2ms","p2sh-p2pkh","p2sh-p2pk","p2sh-p2wpkh","p2sh-p2ms","p2wsh-p2pkh","p2wsh-p2pk","p2wsh-p2ms","p2sh-p2wsh-p2pkh","p2sh-p2wsh-p2pk","p2sh-p2wsh-p2ms"]);function y(e,t,r){try{l(e,t)}catch(n){throw new Error(r)}}class b{constructor(e=a.bitcoin,t=2500){this.network=e,this.maximumFeeRate=t,this.__PREV_TX_SET={},this.__INPUTS=[],this.__BITCOINCASH=!1,this.__BITCOINGOLD=!1,this.__TX=new h.Transaction,this.__TX.version=2,this.__USE_LOW_R=!1}static fromTransaction(e,t,r){const n=new b(t);return"number"===typeof r&&(r===h.Transaction.FORKID_BTG?n.enableBitcoinGold(!0):r===h.Transaction.FORKID_BCH&&n.enableBitcoinCash(!0)),n.setVersion(e.version),n.setLockTime(e.locktime),e.outs.forEach(e=>{n.addOutput(e.script,e.value)}),e.ins.forEach(e=>{n.__addInputUnsafe(e.hash,e.index,{sequence:e.sequence,script:e.script,witness:e.witness,value:e.value})}),n.__INPUTS.forEach((t,n)=>{!function(e,t,r,n,i){if(e.redeemScriptType!==w.P2MS||!e.redeemScript)return;if(e.pubkeys.length===e.signatures.length)return;const s=e.signatures.concat();e.signatures=e.pubkeys.map(o=>{const a=u.fromPublicKey(o);let c;return s.some((o,u)=>{if(!o)return!1;const p=f.signature.decode(o);let d;switch(i){case h.Transaction.FORKID_BCH:d=t.hashForCashSignature(r,e.redeemScript,n,p.hashType);break;case h.Transaction.FORKID_BTG:d=t.hashForGoldSignature(r,e.redeemScript,n,p.hashType);break;default:d=e.witness?t.hashForWitnessV0(r,e.redeemScript,n,p.hashType):t.hashForSignature(r,e.redeemScript,p.hashType)}return!!a.verify(d,p.signature)&&(s[u]=void 0,c=o,!0)}),c})}(t,e,n,t.value,r)}),n}enableBitcoinCash(e){"undefined"===typeof e&&(e=!0),this.__BITCOINCASH=e}enableBitcoinGold(e){"undefined"===typeof e&&(e=!0),this.__BITCOINGOLD=e}setLowR(e){return l(l.maybe(l.Boolean),e),void 0===e&&(e=!0),this.__USE_LOW_R=e,e}setLockTime(e){if(l(d.UInt32,e),this.__INPUTS.some(e=>!!e.signatures&&e.signatures.some(e=>void 0!==e)))throw new Error("No, this would invalidate signatures");this.__TX.locktime=e}setVersion(e){l(d.UInt32,e),this.__TX.version=e}addInput(t,r,n,s){if(!this.__canModifyInputs())throw new Error("No, this would invalidate signatures");let o;if("string"===typeof(u=t)||u instanceof String)t=i.reverseBuffer(e.from(t,"hex"));else if(function(e){return e instanceof h.Transaction}(t)){const e=t.outs[r];s=e.script,o=e.value,t=t.getHash(!1)}var u;return this.__addInputUnsafe(t,r,{sequence:n,prevOutScript:s,value:o})}addOutput(e,t){if(!this.__canModifyOutputs())throw new Error("No, this would invalidate signatures");return"string"===typeof e&&(e=n.toOutputScript(e,this.network)),this.__TX.addOutput(e,t)}build(){return this.__build(!1)}buildIncomplete(){return this.__build(!0)}sign(e,t,r,n,i,s){!function({input:e,ourPubKey:t,keyPair:r,signatureHash:n,hashType:i,useLowR:s}){let o=!1;for(const[u,a]of e.pubkeys.entries()){if(!t.equals(a))continue;if(e.signatures[u])throw new Error("Signature already exists");if(33!==t.length&&e.hasWitness)throw new Error("BIP143 rejects uncompressed public keys in P2WPKH or P2WSH");const c=r.sign(n,s);e.signatures[u]=f.signature.encode(c,i),o=!0}if(!o)throw new Error("Key pair cannot sign for this input")}(function(e,t,r,n,i,s,o,u,a,p,b,v){let m;if("number"===typeof i)m=i;else{if("object"!==typeof i)throw new TypeError("TransactionBuilder sign first arg must be TxbSignArg or number");!function(e,t){if(!_.has(t.prevOutScriptType))throw new TypeError(`Unknown prevOutScriptType "${t.prevOutScriptType}"`);y(l.Number,t.vin,"sign must include vin parameter as Number (input index)"),y(d.Signer,t.keyPair,"sign must include keyPair parameter as Signer interface"),y(l.maybe(l.Number),t.hashType,"sign hashType parameter must be a number");const r=(e[t.vin]||[]).prevOutType,n=t.prevOutScriptType;switch(n){case"p2pkh":if(r&&"pubkeyhash"!==r)throw new TypeError(`input #${t.vin} is not of type p2pkh: ${r}`);y(l.value(void 0),t.witnessScript,n+" requires NO witnessScript"),y(l.value(void 0),t.redeemScript,n+" requires NO redeemScript"),y(l.value(void 0),t.witnessValue,n+" requires NO witnessValue");break;case"p2pk":if(r&&"pubkey"!==r)throw new TypeError(`input #${t.vin} is not of type p2pk: ${r}`);y(l.value(void 0),t.witnessScript,n+" requires NO witnessScript"),y(l.value(void 0),t.redeemScript,n+" requires NO redeemScript"),y(l.value(void 0),t.witnessValue,n+" requires NO witnessValue");break;case"p2wpkh":if(r&&"witnesspubkeyhash"!==r)throw new TypeError(`input #${t.vin} is not of type p2wpkh: ${r}`);y(l.value(void 0),t.witnessScript,n+" requires NO witnessScript"),y(l.value(void 0),t.redeemScript,n+" requires NO redeemScript"),y(d.Satoshi,t.witnessValue,n+" requires witnessValue");break;case"p2ms":if(r&&"multisig"!==r)throw new TypeError(`input #${t.vin} is not of type p2ms: ${r}`);y(l.value(void 0),t.witnessScript,n+" requires NO witnessScript"),y(l.value(void 0),t.redeemScript,n+" requires NO redeemScript"),y(l.value(void 0),t.witnessValue,n+" requires NO witnessValue");break;case"p2sh-p2wpkh":if(r&&"scripthash"!==r)throw new TypeError(`input #${t.vin} is not of type p2sh-p2wpkh: ${r}`);y(l.value(void 0),t.witnessScript,n+" requires NO witnessScript"),y(l.Buffer,t.redeemScript,n+" requires redeemScript"),y(d.Satoshi,t.witnessValue,n+" requires witnessValue");break;case"p2sh-p2ms":case"p2sh-p2pk":case"p2sh-p2pkh":if(r&&"scripthash"!==r)throw new TypeError(`input #${t.vin} is not of type ${n}: ${r}`);y(l.value(void 0),t.witnessScript,n+" requires NO witnessScript"),y(l.Buffer,t.redeemScript,n+" requires redeemScript"),y(l.value(void 0),t.witnessValue,n+" requires NO witnessValue");break;case"p2wsh-p2ms":case"p2wsh-p2pk":case"p2wsh-p2pkh":if(r&&"witnessscripthash"!==r)throw new TypeError(`input #${t.vin} is not of type ${n}: ${r}`);y(l.Buffer,t.witnessScript,n+" requires witnessScript"),y(l.value(void 0),t.redeemScript,n+" requires NO redeemScript"),y(d.Satoshi,t.witnessValue,n+" requires witnessValue");break;case"p2sh-p2wsh-p2ms":case"p2sh-p2wsh-p2pk":case"p2sh-p2wsh-p2pkh":if(r&&"scripthash"!==r)throw new TypeError(`input #${t.vin} is not of type ${n}: ${r}`);y(l.Buffer,t.witnessScript,n+" requires witnessScript"),y(l.Buffer,t.redeemScript,n+" requires witnessScript"),y(d.Satoshi,t.witnessValue,n+" requires witnessScript")}}(t,i),({vin:m,keyPair:o,redeemScript:u,hashType:a,witnessValue:p,witnessScript:b}=i)}if(void 0===o)throw new Error("sign requires keypair");if(o.network&&o.network!==e)throw new TypeError("Inconsistent network");if(!t[m])throw new Error("No input at index: "+m);if(a=a||h.Transaction.SIGHASH_ALL,r(a))throw new Error("Transaction needs outputs");const I=t[m];if(void 0!==I.redeemScript&&u&&!I.redeemScript.equals(u))throw new Error("Inconsistent redeemScript");const S=o.publicKey||o.getPublicKey&&o.getPublicKey();if(!g(I)){if(void 0!==p){if(void 0!==I.value&&I.value!==p)throw new Error("Input did not match witnessValue");l(d.Satoshi,p),I.value=p}if(!g(I)){const e=function(e,t,r,n){if(r&&n){const i=c.p2wsh({redeem:{output:n}}),s=c.p2wsh({output:r}),o=c.p2sh({redeem:{output:r}}),u=c.p2sh({redeem:i});if(!i.hash.equals(s.hash))throw new Error("Witness script inconsistent with prevOutScript");if(!o.hash.equals(u.hash))throw new Error("Redeem script inconsistent with prevOutScript");const a=E(i.redeem.output,t);if(!a.pubkeys)throw new Error(a.type+" not supported as witnessScript ("+f.toASM(n)+")");e.signatures&&e.signatures.some(e=>void 0!==e)&&(a.signatures=e.signatures);const p=n;if(a.type===w.P2WPKH)throw new Error("P2SH(P2WSH(P2WPKH)) is a consensus failure");return{redeemScript:r,redeemScriptType:w.P2WSH,witnessScript:n,witnessScriptType:a.type,prevOutType:w.P2SH,prevOutScript:o.output,hasWitness:!0,signScript:p,signType:a.type,pubkeys:a.pubkeys,signatures:a.signatures,maxSignatures:a.maxSignatures}}if(r){const n=c.p2sh({redeem:{output:r}});if(e.prevOutScript){let t;try{t=c.p2sh({output:e.prevOutScript})}catch(s){throw new Error("PrevOutScript must be P2SH")}if(!n.hash.equals(t.hash))throw new Error("Redeem script inconsistent with prevOutScript")}const i=E(n.redeem.output,t);if(!i.pubkeys)throw new Error(i.type+" not supported as redeemScript ("+f.toASM(r)+")");e.signatures&&e.signatures.some(e=>void 0!==e)&&(i.signatures=e.signatures);let o=r;return i.type===w.P2WPKH&&(o=c.p2pkh({pubkey:i.pubkeys[0]}).output),{redeemScript:r,redeemScriptType:i.type,prevOutType:w.P2SH,prevOutScript:n.output,hasWitness:i.type===w.P2WPKH,signScript:o,signType:i.type,pubkeys:i.pubkeys,signatures:i.signatures,maxSignatures:i.maxSignatures}}if(n){const r=c.p2wsh({redeem:{output:n}});if(e.prevOutScript){const t=c.p2wsh({output:e.prevOutScript});if(!r.hash.equals(t.hash))throw new Error("Witness script inconsistent with prevOutScript")}const i=E(r.redeem.output,t);if(!i.pubkeys)throw new Error(i.type+" not supported as witnessScript ("+f.toASM(n)+")");e.signatures&&e.signatures.some(e=>void 0!==e)&&(i.signatures=e.signatures);const s=n;if(i.type===w.P2WPKH)throw new Error("P2WSH(P2WPKH) is a consensus failure");return{witnessScript:n,witnessScriptType:i.type,prevOutType:w.P2WSH,prevOutScript:r.output,hasWitness:!0,signScript:s,signType:i.type,pubkeys:i.pubkeys,signatures:i.signatures,maxSignatures:i.maxSignatures}}if(e.prevOutType&&e.prevOutScript){if(e.prevOutType===w.P2SH)throw new Error("PrevOutScript is "+e.prevOutType+", requires redeemScript");if(e.prevOutType===w.P2WSH)throw new Error("PrevOutScript is "+e.prevOutType+", requires witnessScript");if(!e.prevOutScript)throw new Error("PrevOutScript is missing");const r=E(e.prevOutScript,t);if(!r.pubkeys)throw new Error(r.type+" not supported ("+f.toASM(e.prevOutScript)+")");e.signatures&&e.signatures.some(e=>void 0!==e)&&(r.signatures=e.signatures);let n=e.prevOutScript;return r.type===w.P2WPKH&&(n=c.p2pkh({pubkey:r.pubkeys[0]}).output),{prevOutType:r.type,prevOutScript:e.prevOutScript,hasWitness:r.type===w.P2WPKH,signScript:n,signType:r.type,pubkeys:r.pubkeys,signatures:r.signatures,maxSignatures:r.maxSignatures}}const i=c.p2pkh({pubkey:t}).output;return{prevOutType:w.P2PKH,prevOutScript:i,hasWitness:!1,signScript:i,signType:w.P2PKH,pubkeys:[t],signatures:[void 0]}}(I,S,u,b);Object.assign(I,e)}if(!g(I))throw Error(I.prevOutType+" not supported")}let P;P=s.btg?n.hashForGoldSignature(m,I.signScript,I.value,a,!!I.witness):s.bch?n.hashForCashSignature(m,I.signScript,I.value,a):I.hasWitness?n.hashForWitnessV0(m,I.signScript,I.value,a):n.hashForSignature(m,I.signScript,a);return{input:I,ourPubKey:S,keyPair:o,signatureHash:P,hashType:a,useLowR:!!v}}(this.network,this.__INPUTS,this.__needsOutputs.bind(this),this.__TX,e,{btg:this.__BITCOINGOLD,bch:this.__BITCOINCASH},t,r,n,i,s,this.__USE_LOW_R))}__addInputUnsafe(e,t,r){if(h.Transaction.isCoinbaseHash(e))throw new Error("coinbase inputs not supported");const n=e.toString("hex")+":"+t;if(void 0!==this.__PREV_TX_SET[n])throw new Error("Duplicate TxOut: "+n);let i={};if(void 0!==r.script&&(i=function e(t,r,n,i){if(0===t.length&&0===r.length)return{};if(!n){let e=s.input(t,!0),i=s.witness(r,!0);e===w.NONSTANDARD&&(e=void 0),i===w.NONSTANDARD&&(i=void 0),n=e||i}switch(n){case w.P2WPKH:{const{output:e,pubkey:t,signature:n}=c.p2wpkh({witness:r});return{prevOutScript:e,prevOutType:w.P2WPKH,pubkeys:[t],signatures:[n]}}case w.P2PKH:{const{output:e,pubkey:r,signature:n}=c.p2pkh({input:t});return{prevOutScript:e,prevOutType:w.P2PKH,pubkeys:[r],signatures:[n]}}case w.P2PK:{const{signature:e}=c.p2pk({input:t});return{prevOutType:w.P2PK,pubkeys:[void 0],signatures:[e]}}case w.P2MS:{const{m:e,pubkeys:r,signatures:n}=c.p2ms({input:t,output:i},{allowIncomplete:!0});return{prevOutType:w.P2MS,pubkeys:r,signatures:n,maxSignatures:e}}}if(n===w.P2SH){const{output:n,redeem:i}=c.p2sh({input:t,witness:r}),o=s.output(i.output),u=e(i.input,i.witness,o,i.output);return u.prevOutType?{prevOutScript:n,prevOutType:w.P2SH,redeemScript:i.output,redeemScriptType:u.prevOutType,witnessScript:u.witnessScript,witnessScriptType:u.witnessScriptType,pubkeys:u.pubkeys,signatures:u.signatures}:{}}if(n===w.P2WSH){const{output:n,redeem:i}=c.p2wsh({input:t,witness:r}),o=s.output(i.output);let u;return u=o===w.P2WPKH?e(i.input,i.witness,o):e(f.compile(i.witness),[],o,i.output),u.prevOutType?{prevOutScript:n,prevOutType:w.P2WSH,witnessScript:i.output,witnessScriptType:u.prevOutType,pubkeys:u.pubkeys,signatures:u.signatures}:{}}return{prevOutType:w.NONSTANDARD,prevOutScript:t}}(r.script,r.witness||[])),void 0!==r.value&&(i.value=r.value),!i.prevOutScript&&r.prevOutScript){let e;if(!i.pubkeys&&!i.signatures){const t=E(r.prevOutScript);t.pubkeys&&(i.pubkeys=t.pubkeys,i.signatures=t.signatures),e=t.type}i.prevOutScript=r.prevOutScript,i.prevOutType=e||s.output(r.prevOutScript)}const o=this.__TX.addInput(e,t,r.sequence,r.scriptSig);return this.__INPUTS[o]=i,this.__PREV_TX_SET[n]=!0,o}__build(e){if(!e){if(!this.__TX.ins.length)throw new Error("Transaction has no inputs");if(!this.__TX.outs.length)throw new Error("Transaction has no outputs")}const t=this.__TX.clone();if(this.__INPUTS.forEach((r,n)=>{if(!r.prevOutType&&!e)throw new Error("Transaction is not complete");const i=function e(t,r,n){const i=r.pubkeys||[];let s=r.signatures||[];switch(t){case w.P2PKH:if(0===i.length)break;if(0===s.length)break;return c.p2pkh({pubkey:i[0],signature:s[0]});case w.P2WPKH:if(0===i.length)break;if(0===s.length)break;return c.p2wpkh({pubkey:i[0],signature:s[0]});case w.P2PK:if(0===i.length)break;if(0===s.length)break;return c.p2pk({signature:s[0]});case w.P2MS:{const e=r.maxSignatures;s=n?s.map(e=>e||p.OPS.OP_0):s.filter(e=>e);const t=!n||e===s.length;return c.p2ms({m:e,pubkeys:i,signatures:s},{allowIncomplete:n,validate:t})}case w.P2SH:{const t=e(r.redeemScriptType,r,n);if(!t)return;return c.p2sh({redeem:{output:t.output||r.redeemScript,input:t.input,witness:t.witness}})}case w.P2WSH:{const t=e(r.witnessScriptType,r,n);if(!t)return;return c.p2wsh({redeem:{output:r.witnessScript,input:t.input,witness:t.witness}})}}}(r.prevOutType,r,e);if(i)t.setInputScript(n,i.input),t.setWitness(n,i.witness);else{if(!e&&r.prevOutType===w.NONSTANDARD)throw new Error("Unknown input type");if(!e)throw new Error("Not enough information")}}),!e&&this.__overMaximumFees(t.virtualSize()))throw new Error("Transaction has absurd fees");return t}__canModifyInputs(){return this.__INPUTS.every(e=>!e.signatures||e.signatures.every(e=>{if(!e)return!0;return 0!==(v(e)&h.Transaction.SIGHASH_ANYONECANPAY)}))}__needsOutputs(e){return e===h.Transaction.SIGHASH_ALL?0===this.__TX.outs.length:0===this.__TX.outs.length&&this.__INPUTS.some(e=>!!e.signatures&&e.signatures.some(e=>{if(!e)return!1;return!(v(e)&h.Transaction.SIGHASH_NONE)}))}__canModifyOutputs(){const e=this.__TX.ins.length,t=this.__TX.outs.length;return this.__INPUTS.every(r=>void 0===r.signatures||r.signatures.every(r=>{if(!r)return!0;const n=31&v(r);return n===h.Transaction.SIGHASH_NONE||n===h.Transaction.SIGHASH_SINGLE&&e<=t}))}__overMaximumFees(e){return(this.__INPUTS.reduce((e,t)=>e+(t.value>>>0),0)-this.__TX.outs.reduce((e,t)=>e+t.value,0))/e>this.maximumFeeRate}}function E(e,t){l(d.Buffer,e);const r=s.output(e);switch(r){case w.P2PKH:{if(!t)return{type:r};const n=c.p2pkh({output:e}).hash,i=o.hash160(t);return n.equals(i)?{type:r,pubkeys:[t],signatures:[void 0]}:{type:r}}case w.P2WPKH:{if(!t)return{type:r};const n=c.p2wpkh({output:e}).hash,i=o.hash160(t);return n.equals(i)?{type:r,pubkeys:[t],signatures:[void 0]}:{type:r}}case w.P2PK:return{type:r,pubkeys:[c.p2pk({output:e}).pubkey],signatures:[void 0]};case w.P2MS:{const t=c.p2ms({output:e});return{type:r,pubkeys:t.pubkeys,signatures:t.pubkeys.map(()=>{}),maxSignatures:t.m}}}return{type:r}}function g(e){return void 0!==e.signScript&&void 0!==e.signType&&void 0!==e.pubkeys&&void 0!==e.signatures&&e.signatures.length===e.pubkeys.length&&e.pubkeys.length>0&&(!1===e.hasWitness||void 0!==e.value)}function v(e){return e.readUInt8(e.length-1)}t.TransactionBuilder=b}).call(this,r(26).Buffer)},4804:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=r(4213),s=r(4807),o=r(4214),u=r(4215),a=r(4812),c=r(4815),f=r(4817),p=r(4819),h={P2MS:"multisig",NONSTANDARD:"nonstandard",NULLDATA:"nulldata",P2PK:"pubkey",P2PKH:"pubkeyhash",P2SH:"scripthash",P2WPKH:"witnesspubkeyhash",P2WSH:"witnessscripthash",WITNESS_COMMITMENT:"witnesscommitment"};t.types=h,t.output=function(e){if(f.output.check(e))return h.P2WPKH;if(p.output.check(e))return h.P2WSH;if(u.output.check(e))return h.P2PKH;if(a.output.check(e))return h.P2SH;const t=n.decompile(e);if(!t)throw new TypeError("Invalid script");return i.output.check(t)?h.P2MS:o.output.check(t)?h.P2PK:c.output.check(t)?h.WITNESS_COMMITMENT:s.output.check(t)?h.NULLDATA:h.NONSTANDARD},t.input=function(e,t){const r=n.decompile(e);if(!r)throw new TypeError("Invalid script");return u.input.check(r)?h.P2PKH:a.input.check(r,t)?h.P2SH:i.input.check(r,t)?h.P2MS:o.input.check(r)?h.P2PK:h.NONSTANDARD},t.witness=function(e,t){const r=n.decompile(e);if(!r)throw new TypeError("Invalid script");return f.input.check(r)?h.P2WPKH:p.input.check(r,t)?h.P2WSH:h.NONSTANDARD}},4805:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=r(3911);function s(e){return e===i.OPS.OP_0||n.isCanonicalScriptSignature(e)}function o(e,t){const r=n.decompile(e);return!(r.length<2)&&(r[0]===i.OPS.OP_0&&(t?r.slice(1).every(s):r.slice(1).every(n.isCanonicalScriptSignature)))}t.check=o,o.toJSON=()=>"multisig input"},4806:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=r(3911),s=r(3971),o=i.OPS.OP_RESERVED;function u(e,t){const r=n.decompile(e);if(r.length<4)return!1;if(r[r.length-1]!==i.OPS.OP_CHECKMULTISIG)return!1;if(!s.Number(r[0]))return!1;if(!s.Number(r[r.length-2]))return!1;const u=r[0]-o,a=r[r.length-2]-o;if(u<=0)return!1;if(a>16)return!1;if(u>a)return!1;if(a!==r.length-3)return!1;if(t)return!0;return r.slice(1,-2).every(n.isCanonicalPubKey)}t.check=u,u.toJSON=()=>"multi-sig output"},4807:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=n.OPS;function s(e){const t=n.compile(e);return t.length>1&&t[0]===i.OP_RETURN}t.check=s,s.toJSON=()=>"null data output";const o={check:s};t.output=o},4808:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911);function i(e){const t=n.decompile(e);return 1===t.length&&n.isCanonicalScriptSignature(t[0])}t.check=i,i.toJSON=()=>"pubKey input"},4809:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=r(3911);function s(e){const t=n.decompile(e);return 2===t.length&&n.isCanonicalPubKey(t[0])&&t[1]===i.OPS.OP_CHECKSIG}t.check=s,s.toJSON=()=>"pubKey output"},4810:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911);function i(e){const t=n.decompile(e);return 2===t.length&&n.isCanonicalScriptSignature(t[0])&&n.isCanonicalPubKey(t[1])}t.check=i,i.toJSON=()=>"pubKeyHash input"},4811:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=r(3911);function s(e){const t=n.compile(e);return 25===t.length&&t[0]===i.OPS.OP_DUP&&t[1]===i.OPS.OP_HASH160&&20===t[2]&&t[23]===i.OPS.OP_EQUALVERIFY&&t[24]===i.OPS.OP_CHECKSIG}t.check=s,s.toJSON=()=>"pubKeyHash output"},4812:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4813);t.input=n;const i=r(4814);t.output=i},4813:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=r(4213),s=r(4214),o=r(4215),u=r(4412),a=r(4413);function c(t,r){const c=n.decompile(t);if(c.length<1)return!1;const f=c[c.length-1];if(!e.isBuffer(f))return!1;const p=n.decompile(n.compile(c.slice(0,-1))),h=n.decompile(f);return!!h&&(!!n.isPushOnly(p)&&(1===c.length?a.check(h)||u.check(h):!(!o.input.check(p)||!o.output.check(h))||(!(!i.input.check(p,r)||!i.output.check(h))||!(!s.input.check(p)||!s.output.check(h)))))}t.check=c,c.toJSON=()=>"scriptHash input"}).call(this,r(26).Buffer)},4814:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=r(3911);function s(e){const t=n.compile(e);return 23===t.length&&t[0]===i.OPS.OP_HASH160&&20===t[1]&&t[22]===i.OPS.OP_EQUAL}t.check=s,s.toJSON=()=>"scriptHash output"},4815:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4816);t.output=n},4816:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=r(3911),s=r(3971),o=r(2684),u=e.from("aa21a9ed","hex");function a(e){const t=n.compile(e);return t.length>37&&t[0]===i.OPS.OP_RETURN&&36===t[1]&&t.slice(2,6).equals(u)}t.check=a,a.toJSON=()=>"Witness commitment output",t.encode=function(t){o(s.Hash256bit,t);const r=e.allocUnsafe(36);return u.copy(r,0),t.copy(r,4),n.compile([i.OPS.OP_RETURN,r])},t.decode=function(e){return o(a,e),n.decompile(e)[1].slice(4,36)}}).call(this,r(26).Buffer)},4817:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4818);t.input=n;const i=r(4412);t.output=i},4818:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911);function i(e){const t=n.decompile(e);return 2===t.length&&n.isCanonicalScriptSignature(t[0])&&(r=t[1],n.isCanonicalPubKey(r)&&33===r.length);var r}t.check=i,i.toJSON=()=>"witnessPubKeyHash input"},4819:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4820);t.input=n;const i=r(4413);t.output=i},4820:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const n=r(3911),i=r(2684),s=r(4213),o=r(4214),u=r(4215);function a(t,r){if(i(i.Array,t),t.length<1)return!1;const a=t[t.length-1];if(!e.isBuffer(a))return!1;const c=n.decompile(a);if(!c||0===c.length)return!1;const f=n.compile(t.slice(0,-1));return!(!u.input.check(f)||!u.output.check(c))||(!(!s.input.check(f,r)||!s.output.check(c))||!(!o.input.check(f)||!o.output.check(c)))}t.check=a,a.toJSON=()=>"witnessScriptHash input"}).call(this,r(26).Buffer)}}]);