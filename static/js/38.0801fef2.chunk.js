(this.webpackJsonp=this.webpackJsonp||[]).push([[38],{3903:function(e,n,t){"use strict";t.r(n),t.d(n,"KeyringBase",(function(){return h})),t.d(n,"KeyringBaseMock",(function(){return y}));var r=t(2),o=t.n(r),i=t(6),a=t.n(i),u=t(9),c=t.n(u),s=t(14),d=t.n(s),l=t(7),f=t.n(l);function p(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=f()(e);if(n){var o=f()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return d()(this,t)}}var h=function(e){c()(t,e);var n=p(t);function t(e){var t;return(t=n.call(this,e.options)).vault=e,t}return t.prototype.addressFromBase=function(){var e=o()((function*(e){return this.vault.addressFromBase(e)}));return function(n){return e.apply(this,arguments)}}(),a()(t)}(t(1585).VaultContext),y=function(e){c()(t,e);var n=p(t);function t(){return n.apply(this,arguments)}return a()(t)}(h)},3905:function(e,n,t){"use strict";t.r(n),t.d(n,"KeyringSoftwareBase",(function(){return I}));var r=t(4),o=t.n(r),i=t(3),a=t.n(i),u=t(2),c=t.n(u),s=t(6),d=t.n(s),l=t(9),f=t.n(l),p=t(14),h=t.n(p),y=t(7),v=t.n(y),g=t(19),m=t(23);function w(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function b(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?w(Object(t),!0).forEach((function(n){a()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function O(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=v()(e);if(n){var o=v()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return h()(this,t)}}var I=function(e){f()(t,e);var n=O(t);function t(){return n.apply(this,arguments)}var r=t.prototype;return r.signTransaction=function(){var e=c()((function*(e,n){var t=n.password;if("undefined"===typeof t)throw new m.OneKeyInternalError("Software signing requires a password.");var r=yield this.getSigners(t,e.inputs.map((function(e){return e.address})));return g.default.engine.info("signTransaction",this.networkId,e),b(b({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(n,t){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=c()((function*(e,n){var t=this,r=n.password;if("undefined"===typeof r)throw new m.OneKeyInternalError("Software signing requires a password.");var i=yield this.getDbAccount(),a=Object.values(yield this.getSigners(r,[i.address])),u=o()(a,1)[0];return g.default.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return t.engine.providerManager.signMessage(t.networkId,e,u)})))}));return function(n,t){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},d()(t)}(t(3903).KeyringBase)},3912:function(e,n,t){"use strict";t.r(n),function(e){t.d(n,"VaultBaseChainOnly",(function(){return j})),t.d(n,"VaultBase",(function(){return K}));var r=t(202),o=t.n(r),i=t(3),a=t.n(i),u=t(60),c=t.n(u),s=t(2),d=t.n(s),l=t(6),f=t.n(l),p=t(9),h=t.n(p),y=t(14),v=t.n(y),g=t(7),m=t.n(g),w=t(21),b=t.n(w),O=t(167),I=t.n(O),T=t(11),x=t(19),k=t(24),C=t(68),E=t(23),A=t(182),P=t(947),B=t(52),S=t(1585);function N(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function D(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?N(Object(t),!0).forEach((function(n){a()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function M(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=m()(e);if(n){var o=m()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return v()(this,t)}}if(k.default.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var j=function(e){h()(t,e);var n=M(t);function t(){return n.apply(this,arguments)}var r=t.prototype;return r.initProvider=function(){var e=d()((function*(){var e=(yield this.getNetwork()).impl;c()(P.IMPL_MAPPINGS[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(n){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new E.NotImplemented},r.getEthersProvider=function(){var e=d()((function*(){throw new E.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=d()((function*(e){var n=this.createClientFromURL(e),t=performance.now(),r=(yield n.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-t),latestBlock:r}}));return function(n){return e.apply(this,arguments)}}(),r.checkRpcBatchSupport=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(n){return e.apply(this,arguments)}}(),r.getDisplayAddress=function(){var e=d()((function*(e){return Promise.resolve(e)}));return function(n){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=d()((function*(e){var n=yield this.engineProvider.verifyAddress(e),t=n.normalizedAddress;if(!n.isValid||!t)throw new E.InvalidAddress;return Promise.resolve(t)}));return function(n){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=d()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(n){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=d()((function*(e){var n=yield this.engineProvider.verifyTokenAddress(e),t=n.normalizedAddress;if(!n.isValid||"undefined"===typeof t)throw new E.InvalidTokenAddress;return Promise.resolve(t)}));return function(n){return e.apply(this,arguments)}}(),r.validateCanCreateNextAccount=function(){var e=d()((function*(e,n){return Promise.resolve(!0)}));return function(n,t){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=d()((function*(e,n){return Promise.resolve(!0)}));return function(n,t){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=d()((function*(e,n,t){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var n=e.address,t=e.tokenAddress;return{address:n,coin:D({},"string"===typeof t?{tokenAddress:t}:{})}})))}));return function(n,t,r){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=d()((function*(e){return 0}));return function(n){return e.apply(this,arguments)}}(),r.fetchBalanceDetails=function(){var e=d()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password;return Promise.resolve(void 0)}));return function(){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=d()((function*(e){return!1}));return function(n){return e.apply(this,arguments)}}(),r.getAccountNameInfoMap=function(){var e=d()((function*(){var e=yield this.getNetwork();return Object(A.getAccountNameInfoByImpl)(e.impl)}));return function(){return e.apply(this,arguments)}}(),r.canAutoCreateNextAccount=function(){var e=d()((function*(e){return Promise.resolve(!1)}));return function(n){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=d()((function*(e){var n=e.accounts;e.networkId;return Promise.resolve(n)}));return function(n){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(){var e=d()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(n){return e.apply(this,arguments)}}(),r.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=d()((function*(e){return Promise.resolve([])}));return function(n){return e.apply(this,arguments)}}(),r.checkIsUnlimitedAllowance=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(n){return e.apply(this,arguments)}}(),r.checkIsApprovedForAll=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(n){return e.apply(this,arguments)}}(),r.checkIsBatchTransfer=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(n){return e.apply(this,arguments)}}(),r.getFeePricePerUnit=function(){var e=d()((function*(){throw new E.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.fetchRpcChainId=function(){var e=d()((function*(e){return null}));return function(n){return e.apply(this,arguments)}}(),r.getTxWaitingSeconds=function(){var e=d()((function*(){return[]}));return function(){return e.apply(this,arguments)}}(),r.getUserNFTAssets=function(){var e=d()((function*(e){e.serviceData;return Promise.resolve(void 0)}));return function(n){return e.apply(this,arguments)}}(),f()(t)}(S.VaultContext),K=function(n){h()(r,n);var t=M(r);function r(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).uuid=I.a.v4().toString(),e}var i=r.prototype;return i.init=function(){var e=d()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(n){return e.apply(this,arguments)}}(),i.initKeyring=function(){var e=d()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(n){return e.apply(this,arguments)}}(),i.signTransaction=function(){var e=d()((function*(e,n){return this.keyring.signTransaction(e,n)}));return function(n,t){return e.apply(this,arguments)}}(),i.signAndSendTransaction=function(){var e=d()((function*(e,n,t){var r=yield this.signTransaction(e,n);return t?D(D({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(D(D({},r),{},{encodedTx:e.encodedTx}))}));return function(n,t,r){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=d()((function*(e,n){x.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var t=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,n);return x.default.engine.info("broadcastTransaction END:",{txid:t,rawTx:e.rawTx}),D(D({},e),{},{txid:t,encodedTx:e.encodedTx})}));return function(n,t){return e.apply(this,arguments)}}(),i.buildEncodedTxFromBatchTransfer=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(n){return e.apply(this,arguments)}}(),i.buildEncodedTxsFromSetApproveForAll=function(){var e=d()((function*(e,n){throw new E.NotImplemented}));return function(n,t){return e.apply(this,arguments)}}(),i.activateAccount=function(){var e=d()((function*(){throw new E.NotImplemented}));return function(){return e.apply(this,arguments)}}(),i.activateToken=function(){var e=d()((function*(e,n){throw new E.NotImplemented}));return function(n,t){return e.apply(this,arguments)}}(),i.getTokenAllowance=function(){var e=d()((function*(e,n){throw new E.NotImplemented}));return function(n,t){return e.apply(this,arguments)}}(),i.batchTokensAllowance=function(){var e=d()((function*(e,n){throw new E.NotImplemented}));return function(n,t){return e.apply(this,arguments)}}(),i.getOutputAccount=function(){var e=d()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:o()(e,"pub","")}}));return function(){return e.apply(this,arguments)}}(),i.getAccountBalance=function(){var e=d()((function*(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=yield this.getDbAccount(),i=o.address;return this.getBalances((n?[{address:i}]:[]).concat(e.map((function(e){return{address:i,tokenAddress:e}}))),t,r)}));return function(n){return e.apply(this,arguments)}}(),i.updatePendingTxs=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(n){return e.apply(this,arguments)}}(),i.getAccountNonce=function(){var e=d()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),i.fixActionDirection=function(){var e=d()((function*(e){var n,t,r,o,i=e.action,a=e.accountAddress;(i.direction=B.IDecodedTxDirection.OTHER,i.type===B.IDecodedTxActionType.NATIVE_TRANSFER)&&(i.direction=yield this.buildTxActionDirection({from:(null==(n=i.nativeTransfer)?void 0:n.from)||"",to:(null==(t=i.nativeTransfer)?void 0:t.to)||"",address:a}));i.type===B.IDecodedTxActionType.TOKEN_TRANSFER&&(i.direction=yield this.buildTxActionDirection({from:(null==(r=i.tokenTransfer)?void 0:r.from)||"",to:(null==(o=i.tokenTransfer)?void 0:o.to)||"",address:a}));return i}));return function(n){return e.apply(this,arguments)}}(),i.fixDecodedTx=function(){var e=d()((function*(e){var n,t;e.createdAt=null!=(n=e.createdAt)?n:Date.now();var r=null==(t=e.encodedTx)?void 0:t.nonce;e.nonce=c()(r)?e.nonce:new b.a(r).toNumber();for(var o=e.owner,i=0;i<e.actions.length;i+=1){var a=e.actions[i];yield this.fixActionDirection({action:a,accountAddress:o})}if(e.outputActions)for(var u=0;u<e.outputActions.length;u+=1){var s=e.outputActions[u];yield this.fixActionDirection({action:s,accountAddress:o})}return Promise.resolve(e)}));return function(n){return e.apply(this,arguments)}}(),i.fixHistoryTx=function(){var e=d()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),Promise.resolve(e)}));return function(n){return e.apply(this,arguments)}}(),i.buildHistoryTx=function(){var e=d()((function*(e){var n=e.historyTxToMerge,t=(e.encodedTx,e.decodedTx),r=e.signedTx,o=e.isSigner,i=e.isLocalCreated,a=(null==r?void 0:r.txid)||(null==t?void 0:t.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var u=yield this.getAccountAddress();t.txid=a||t.txid,t.owner=u,o&&(t.signer=u),null!=r&&r.txKey&&(t.extraInfo?t.extraInfo.txKey=r.txKey:t.extraInfo={txKey:r.txKey});var c=D(D({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(i)},n),{},{decodedTx:t});return c=yield this.fixHistoryTx(c),Promise.resolve(c)}));return function(n){return e.apply(this,arguments)}}(),i.checkIsScamHistoryTx=function(){var e=d()((function*(e){return!1}));return function(n){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(n){return e.apply(this,arguments)}}(),i.fixAddressCase=function(e){return Promise.resolve(e)},i.buildTxActionDirection=function(){var e=d()((function*(e){var n=e.from,t=e.to,r=e.address;return n=yield this.fixAddressCase(n||""),t=yield this.fixAddressCase(t),r=yield this.fixAddressCase(r),n===t&&n===r?B.IDecodedTxDirection.SELF:n&&n===r?B.IDecodedTxDirection.OUT:t&&t===r?B.IDecodedTxDirection.IN:B.IDecodedTxDirection.OTHER}));return function(n){return e.apply(this,arguments)}}(),i.getNextNonce=function(){var e=d()((function*(e,n){var t,r,o=null!=(t=null==(r=(yield this.engine.providerManager.getAddresses(e,[n.address]))[0])?void 0:r.nonce)?t:0,i=(yield this.engine.getHistory(e,n.id,void 0,!1),yield C.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),a=yield C.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),u=Math.max(c()(i)?0:i+1,o);if(Number.isNaN(u)&&(u=o),u>o)for(var s=o;s<u;s+=1)if(!a.includes(s)){u=s;break}if(u<o&&(u=o),u-o>=T.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new E.PendingQueueTooLong(T.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return u}));return function(n,t){return e.apply(this,arguments)}}(),i.validateSendAmount=function(e,n,t){return Promise.resolve(!0)},i.notifyChainChanged=function(e,n){},i.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},i.getPrivateKeyByCredential=function(n){return Promise.resolve(e.from(n.startsWith("0x")?n.slice(2):n,"hex"))},i.getMinDepositAmount=function(){var e=d()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),i.specialCheckEncodedTx=function(){var e=d()((function*(e){return{success:!0}}));return function(n){return e.apply(this,arguments)}}(),i.getAllUsedAddress=function(){var e=d()((function*(){return Promise.resolve([])}));return function(){return e.apply(this,arguments)}}(),f()(r)}(j)}.call(this,t(26).Buffer)},3913:function(e,n,t){"use strict";t.r(n),function(e){t.d(n,"KeyringHardwareBase",(function(){return v}));var r=t(2),o=t.n(r),i=t(6),a=t.n(i),u=t(9),c=t.n(u),s=t(14),d=t.n(s),l=t(7),f=t.n(l),p=t(431),h=t(163);function y(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=f()(e);if(n){var o=f()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return d()(this,t)}}var v=function(n){c()(r,n);var t=y(r);function r(){return t.apply(this,arguments)}var i=r.prototype;return i.getHardwareInfo=function(){var e=o()((function*(){var e,n,t,r=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==r?void 0:r.mac)?e:"",deviceId:null!=(n=null==r?void 0:r.deviceId)?n:"",deviceType:null!=(t=null==r?void 0:r.deviceType)?t:""}}));return function(){return e.apply(this,arguments)}}(),i.getWalletPassphraseState=function(){var e=o()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(h.isPassphraseWallet)(e)}}));return function(){return e.apply(this,arguments)}}(),i.getHardwareSDKInstance=function(){var n=o()((function*(){var n,t,r,o,i;return null!=(i=yield null==(n=e)||null==(t=n.$backgroundApiProxy)||null==(r=t.backgroundApi)||null==(o=r.serviceHardware)||null==o.getSDKInstance?void 0:o.getSDKInstance())?i:p.HardwareSDK}));return function(){return n.apply(this,arguments)}}(),i.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},a()(r)}(t(3903).KeyringBase)}.call(this,t(58))},3914:function(e,n,t){"use strict";t.r(n),t.d(n,"KeyringHdBase",(function(){return b}));var r=t(3),o=t.n(r),i=t(2),a=t.n(i),u=t(6),c=t.n(u),s=t(9),d=t.n(s),l=t(14),f=t.n(l),p=t(7),h=t.n(p),y=t(610),v=t(23);function g(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function m(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?g(Object(t),!0).forEach((function(n){o()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function w(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=h()(e);if(n){var o=h()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return f()(this,t)}}var b=function(e){d()(t,e);var n=w(t);function t(){return n.apply(this,arguments)}var r=t.prototype;return r.getPrivateKeys=function(){var e=a()((function*(e,n){var t=(yield this.getDbAccount()).path.split("/"),r=n||[t.pop()],o=t.join("/"),i=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof i)throw new v.OneKeyInternalError("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(y.batchGetPrivateKeys)(a,i,e,o,r).reduce((function(e,n){var t;return m(m({},e),{},((t={})[n.path]=n.extendedKey.key,t))}),{})}));return function(n,t){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},c()(t)}(t(3905).KeyringSoftwareBase)},3915:function(e,n,t){"use strict";t.r(n),t.d(n,"KeyringImportedBase",(function(){return y}));var r=t(2),o=t.n(r),i=t(6),a=t.n(i),u=t(9),c=t.n(u),s=t(14),d=t.n(s),l=t(7),f=t.n(l),p=t(23);function h(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=f()(e);if(n){var o=f()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return d()(this,t)}}var y=function(e){c()(t,e);var n=h(t);function t(){return n.apply(this,arguments)}var r=t.prototype;return r.getPrivateKeys=function(){var e=o()((function*(e,n){if("undefined"!==typeof n)throw new p.NotImplemented("Getting private keys from extended private key");var t=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof t)throw new p.OneKeyInternalError("Unable to get credential.");return{"":t}}));return function(n,t){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(t)}(t(3905).KeyringSoftwareBase)},3916:function(e,n,t){"use strict";t.r(n),t.d(n,"KeyringWatchingBase",(function(){return y}));var r=t(2),o=t.n(r),i=t(6),a=t.n(i),u=t(9),c=t.n(u),s=t(14),d=t.n(s),l=t(7),f=t.n(l),p=t(23);function h(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=f()(e);if(n){var o=f()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return d()(this,t)}}var y=function(e){c()(t,e);var n=h(t);function t(){return n.apply(this,arguments)}var r=t.prototype;return r.signTransaction=function(){var e=o()((function*(e,n){throw new p.OneKeyInternalError("signTransaction is not supported for watching accounts")}));return function(n,t){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=o()((function*(e,n){throw new p.OneKeyInternalError("signMessage is not supported for watching accounts")}));return function(n,t){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(t)}(t(3903).KeyringBase)},3918:function(e,n,t){"use strict";t.r(n),t.d(n,"convertDeviceError",(function(){return u}));var r=t(70),o=t(90),i=t(19);t(24);function a(e,n){return"string"!==typeof n?null:e===r.HardwareErrorCode.DeviceInitializeFailed&&n.includes("ECONNABORTED")?new o.ConnectTimeoutError({message:n}):n.includes("Bridge network error")?new o.BridgeNetworkError({message:n}):null}function u(e){var n,t=e||{},u=t.code,c=t.error,s=t.message,d=null!=(n=null!=c?c:s)?n:"Unknown error";if(a(u,d))return a(u,d);switch(i.default.hardwareSDK.info("Device Utils Convert Device Error:",u,d),u){case r.HardwareErrorCode.UnknownError:return new o.UnknownHardwareError(e);case r.HardwareErrorCode.DeviceFwException:return new o.FirmwareVersionTooLow(e);case r.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof d&&-1!==d.indexOf("ui-device_bootloader_mode")?new o.NotInBootLoaderMode(e):new o.UnknownHardwareError(e);case r.HardwareErrorCode.DeviceCheckDeviceIdError:return new o.DeviceNotSame(e);case r.HardwareErrorCode.DeviceNotFound:return new o.DeviceNotFind(e);case r.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new o.NotInBootLoaderMode(e);case r.HardwareErrorCode.DeviceInterruptedFromOutside:case r.HardwareErrorCode.DeviceInterruptedFromUser:return new o.UserCancelFromOutside(e);case r.HardwareErrorCode.DeviceNotSupportPassphrase:return new o.NotSupportPassphraseError(e);case r.HardwareErrorCode.IFrameLoadFail:return new o.InitIframeLoadFail(e);case r.HardwareErrorCode.IframeTimeout:return new o.InitIframeTimeout(e);case r.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new o.FirmwareDownloadFailed(e);case r.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new o.FirmwareUpdateManuallyEnterBoot(e);case r.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new o.FirmwareUpdateAutoEnterBootFailure(e);case r.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new o.FirmwareUpdateLimitOneDevice(e);case r.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new o.FirmwareVersionTooLow(e);case r.HardwareErrorCode.NewFirmwareUnRelease:return new o.NewFirmwareUnRelease(e);case r.HardwareErrorCode.NewFirmwareForceUpdate:return new o.NewFirmwareForceUpdate(e);case r.HardwareErrorCode.NetworkError:return new o.NetworkError(e);case r.HardwareErrorCode.BlePermissionError:return new o.NeedBluetoothTurnedOn(e);case r.HardwareErrorCode.BleLocationError:return new o.NeedBluetoothPermissions({message:d});case r.HardwareErrorCode.BleLocationServicesDisabled:return new o.BleLocationServiceError({message:d});case r.HardwareErrorCode.BleDeviceNotBonded:return new o.DeviceNotBonded(e);case r.HardwareErrorCode.BleDeviceBondError:return new o.DeviceBondError(e);case r.HardwareErrorCode.BleWriteCharacteristicError:return new o.BleWriteCharacteristicError(e);case r.HardwareErrorCode.BleScanError:return new o.BleScanError({message:d});case r.HardwareErrorCode.BleAlreadyConnected:return new o.BleAlreadyConnectedError(e);case r.HardwareErrorCode.RuntimeError:return-1!==d.indexOf("EIP712 blind sign is disabled")?new o.OpenBlindSign(e):-1!==d.indexOf("Unknown message")||-1!==d.indexOf("Failure_UnexpectedMessage")?new o.UnknownMethod(e):new o.UnknownHardwareError(e);case r.HardwareErrorCode.PinInvalid:return new o.InvalidPIN(e);case r.HardwareErrorCode.DeviceCheckPassphraseStateError:return new o.InvalidPassphrase(e);case r.HardwareErrorCode.DeviceOpenedPassphrase:return new o.DeviceOpenedPassphrase(e);case r.HardwareErrorCode.DeviceNotOpenedPassphrase:return new o.DeviceNotOpenedPassphrase(e);case r.HardwareErrorCode.PinCancelled:case r.HardwareErrorCode.ActionCancelled:return new o.UserCancel(e);case r.HardwareErrorCode.BridgeNotInstalled:case o.CustomOneKeyHardwareError.NeedOneKeyBridge:return new o.NeedOneKeyBridge(e);case r.HardwareErrorCode.BridgeNetworkError:return new o.BridgeNetworkError(e);case r.HardwareErrorCode.BridgeTimeoutError:return new o.BridgeTimeoutError(e);case r.HardwareErrorCode.PollingTimeout:return new o.ConnectTimeoutError(e);case r.HardwareErrorCode.PollingStop:return new o.ConnectPollingStopError(e);case r.HardwareErrorCode.BlindSignDisabled:return new o.OpenBlindSign(e);case r.HardwareErrorCode.FileAlreadyExists:return new o.FileAlreadyExistError(e);case r.HardwareErrorCode.CheckDownloadFileError:return new o.IncompleteFileError(e);case r.HardwareErrorCode.NotInSigningMode:return new o.NotInSigningModeError(e);default:return new o.UnknownHardwareError(e)}}},4114:function(e,n,t){"use strict";t.r(n),t.d(n,"pubkeyToBaseAddress",(function(){return u})),t.d(n,"pubkeyToAddress",(function(){return c})),t.d(n,"baseAddressToAddress",(function(){return s})),t.d(n,"isValidAddress",(function(){return d})),t.d(n,"isValidContractAddress",(function(){return l}));var r=t(1591),o=t(300),i=t(73),a=t(445),u=function(e,n){var t="secp256k1"===e?function(e){if(33!==e.length)throw new Error("Invalid Secp256k1 pubkey length (compressed): "+e.length);return Object(r.ripemd160)(Object(o.sha256)(e))}(n):function(e){if(32!==e.length)throw new Error("Invalid Ed25519 pubkey length: "+e.length);return Object(o.sha256)(e).slice(0,20)}(n);return Object(i.bytesToHex)(t)},c=function(e,n,t){var r=u(e,t);return a.bech32.encode(n,a.bech32.toWords(Object(i.hexToBytes)(r)))},s=function(e,n){return a.bech32.encode(e,a.bech32.toWords(Object(i.hexToBytes)(n)))},d=function(e,n){try{var t=a.bech32.decode(e),r=t.prefix,o=t.words;return r===n&&20===a.bech32.fromWords(o).length}catch(i){return!1}},l=function(e,n){try{var t=a.bech32.decode(e),r=t.prefix,o=t.words;if(r!==n)return!1;var i=a.bech32.fromWords(o);return 32===i.length||20===i.length}catch(u){return!1}}},4433:function(e,n,t){"use strict";t.r(n),t.d(n,"MintScanQuery",(function(){return h}));var r,o=t(2),i=t.n(o),a=t(6),u=t.n(a),c=t(107),s=t.n(c),d=t(21),l=t.n(d),f=t(36),p=((r={})[f.OnekeyNetwork.cryptoorgchain]="cryptoorg",r[f.OnekeyNetwork.cosmoshub]="cosmos",r[f.OnekeyNetwork.akash]="akash",r[f.OnekeyNetwork.fetch]="fetchai",r[f.OnekeyNetwork.juno]="juno",r[f.OnekeyNetwork.osmosis]="osmosis",r[f.OnekeyNetwork.secretnetwork]="secret",r),h=function(){function e(){this.axios=s.a.create({baseURL:"https://api.mintscan.io",timeout:3e4})}var n=e.prototype;return n.fetchCw20TokenInfos=function(){var e=i()((function*(e){var n=p[e];if(!n)return[];try{return(yield this.axios.get("/v2/assets/"+n+"/cw20")).data.assets}catch(t){return[]}}));return function(n){return e.apply(this,arguments)}}(),n.queryCw20TokenInfo=function(){var e=i()((function*(e,n){var t=e.networkId,r=yield this.fetchCw20TokenInfos(t),o=n.reduce((function(e,n){return e.has(n)?e:e.add(n)}),new Set);return r.reduce((function(e,n){return o.has(n.contract_address)&&e.push({contractAddress:n.contract_address,name:n.denom,decimals:n.decimal,symbol:n.denom}),e}),[])}));return function(n,t){return e.apply(this,arguments)}}(),n.queryCw20TokenBalance=function(){var e=i()((function*(e,n,t){var r=t.reduce((function(e,n){return e.push({address:n,balance:new l.a("0")}),e}),[]);return Promise.resolve(r)}));return function(n,t,r){return e.apply(this,arguments)}}(),n.fetchAssertInfos=function(){var e=i()((function*(e){var n=p[e];if(!n)return[];try{return(yield this.axios.get("/v2/assets/"+n)).data.assets}catch(t){return[]}}));return function(n){return e.apply(this,arguments)}}(),n.fetchContractsInfo=function(){var e=i()((function*(e,n){try{var t=p[e];if(!t)return;return(yield this.axios.get("/v1/"+t+"/wasm/contracts/"+n)).data.contract}catch(r){}}));return function(n,t){return e.apply(this,arguments)}}(),n.fetchRelayerPaths=function(){var e=i()((function*(e){try{var n=p[e];if(!n)return;return(yield this.axios.get("/v1/relayer/"+n+"/paths")).data.sendable}catch(t){}}));return function(n){return e.apply(this,arguments)}}(),n.fetchAccountTxs=function(){var e=i()((function*(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;try{var o=p[e];if(!o)return;var i=yield this.axios.get("/v1/"+o+"/account/"+n+"/txs?limit="+t+"&from="+r);return i.data}catch(a){}}));return function(n,t){return e.apply(this,arguments)}}(),u()(e)}()},4899:function(e,n,t){"use strict";t.r(n),function(e){t.d(n,"KeyringHardware",(function(){return B}));var r=t(3),o=t.n(r),i=t(2),a=t.n(i),u=t(6),c=t.n(u),s=t(9),d=t.n(s),l=t(14),f=t.n(l),p=t(7),h=t.n(p),y=t(73),v=t(70),g=t(117),m=t(3918),w=t(11),b=t(19),O=t(23),I=t(3913),T=t(303),x=t(4114),k=t(988);function C(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function E(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?C(Object(t),!0).forEach((function(n){o()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function A(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=h()(e);if(n){var o=h()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return f()(this,t)}}var P="m/44'/"+w.COINTYPE_COSMOS+"'",B=function(n){d()(r,n);var t=A(r);function r(){return t.apply(this,arguments)}var o=r.prototype;return o.getChainInfo=function(){var e=a()((function*(){return this.engine.providerManager.getChainInfoByNetworkId(this.networkId)}));return function(){return e.apply(this,arguments)}}(),o.getPublicKey=function(){var e=a()((function*(e,n,t){var r,o,i,a=yield this.getChainInfo(),u=null!=(r=null==a||null==(o=a.implOptions)?void 0:o.curve)?r:"secp256k1",c=yield this.getHardwareSDKInstance(),s=yield this.getWalletPassphraseState();try{i=yield c.cosmosGetPublicKey(e,n,E({bundle:t.map((function(e){return{path:e,curve:u}}))},s))}catch(d){throw b.default.common.error(d),new O.OneKeyHardwareError(d)}if(!i.success)throw b.default.common.error(i.payload),Object(m.convertDeviceError)(i.payload);return i.payload.map((function(e){return e.publicKey})).filter((function(e){return!!e}))}));return function(n,t,r){return e.apply(this,arguments)}}(),o.prepareAccounts=function(){var e=a()((function*(e){var n,t,r,o=e.indexes,i=e.names,a=o.map((function(e){return P+"/0'/0/"+e})),u=yield this.getHardwareSDKInstance(),c=yield this.getHardwareInfo(),s=c.connectId,d=c.deviceId,l=yield this.getWalletPassphraseState(),f=yield this.getChainInfo(),p=null!=(n=null==f||null==(t=f.implOptions)?void 0:t.curve)?n:"secp256k1";if("ed25519"===p)throw new v.HardwareError("ed25519 curve is not supported");try{r=yield u.cosmosGetPublicKey(s,d,E({bundle:a.map((function(e){return{path:e,curve:p,showOnOneKey:!1}}))},l))}catch(N){throw b.default.common.error(N),new O.OneKeyHardwareError(N)}if(!r.success)throw b.default.common.error(r.payload),Object(m.convertDeviceError)(r.payload);var h=[],I=0;for(var T of r.payload){var k=T.path,C=T.publicKey,A=Object(y.hexToBytes)(C),B=Object(x.pubkeyToBaseAddress)(p,A),S=(i||[])[I]||"COSMOS #"+(o[I]+1);h.push({id:this.walletId+"--"+k,name:S,type:g.AccountType.VARIANT,path:k,coinType:w.COINTYPE_COSMOS,pub:C,address:B,addresses:{}}),I+=1}return h}));return function(n){return e.apply(this,arguments)}}(),o.getAddress=function(){var e=a()((function*(e){var n,t,r,o,i=yield this.getHardwareSDKInstance(),a=yield this.getHardwareInfo(),u=a.connectId,c=a.deviceId,s=yield this.getWalletPassphraseState(),d=yield this.getChainInfo(),l=null!=(n=null==d||null==(t=d.implOptions)?void 0:t.curve)?n:"secp256k1",f=null==d||null==(r=d.implOptions)?void 0:r.addressPrefix;if("ed25519"===l)throw new v.HardwareError("ed25519 curve is not supported");var p,h=yield i.cosmosGetAddress(u,c,E({path:e.path,hrp:f,showOnOneKey:e.showOnOneKey},s));if(h.success&&null!=(o=h.payload)&&o.address)return null==(p=h.payload)?void 0:p.address;throw Object(m.convertDeviceError)(h.payload)}));return function(n){return e.apply(this,arguments)}}(),o.batchGetAddress=function(){var e=a()((function*(e){var n,t,r,o=yield this.getHardwareSDKInstance(),i=yield this.getHardwareInfo(),a=i.connectId,u=i.deviceId,c=yield this.getWalletPassphraseState(),s=yield this.getChainInfo(),d=null!=(n=null==s||null==(t=s.implOptions)?void 0:t.curve)?n:"secp256k1",l=null==s||null==(r=s.implOptions)?void 0:r.addressPrefix;if("ed25519"===d)throw new v.HardwareError("ed25519 curve is not supported");var f=yield o.cosmosGetAddress(a,u,E(E({},c),{},{bundle:e.map((function(e){var n=e.path,t=e.showOnOneKey;return{path:n,hrp:l,showOnOneKey:!!t}}))}));if(!f.success)throw Object(m.convertDeviceError)(f.payload);return f.payload.map((function(e){var n,t;return{path:null!=(n=e.path)?n:"",address:null!=(t=e.address)?t:""}}))}));return function(n){return e.apply(this,arguments)}}(),o.signTransaction=function(){var n=a()((function*(n){var t,r;b.default.common.info("signTransaction",n);var o=yield this.getDbAccount(),i=null==(t=n.inputs)||null==(r=t[0])?void 0:r.publicKey;if(!i)throw new O.OneKeyInternalError("Unable to get sender public key.");var a=n.payload.encodedTx,u=Object(k.generateSignBytes)(a),c=Object(y.bytesToHex)(u),s=yield this.getHardwareInfo(),d=s.connectId,l=s.deviceId,f=yield this.getWalletPassphraseState(),p=yield this.getHardwareSDKInstance(),h=yield p.cosmosSignTransaction(d,l,E({path:o.path,rawTx:c},f));if(h.success){var v=h.payload.signature,g=Object(k.serializeSignedTx)({txWrapper:a,signature:{signatures:[Object(y.hexToBytes)(Object(T.stripHexPrefix)(v))]},publicKey:{pubKey:i}});return{txid:"",rawTx:e.from(g).toString("base64")}}throw Object(m.convertDeviceError)(h.payload)}));return function(e){return n.apply(this,arguments)}}(),c()(r)}(I.KeyringHardwareBase)}.call(this,t(26).Buffer)},4900:function(e,n,t){"use strict";t.r(n),function(e){t.d(n,"KeyringHd",(function(){return A}));var r=t(4),o=t.n(r),i=t(2),a=t.n(i),u=t(6),c=t.n(u),s=t(9),d=t.n(s),l=t(14),f=t.n(l),p=t(7),h=t.n(p),y=t(300),v=t(23),g=t(1345),m=t(610),w=t(117),b=t(11),O=t(19),I=t(3914),T=t(4114),x=t(988);function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=h()(e);if(n){var o=h()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return f()(this,t)}}var C="m/44'/"+b.COINTYPE_COSMOS+"'/0'/0",E="m/44'/"+b.COINTYPE_COSMOS+"'/0'/0'",A=function(n){d()(r,n);var t=k(r);function r(){return t.apply(this,arguments)}var i=r.prototype;return i.getChainInfo=function(){var e=a()((function*(){return this.engine.providerManager.getChainInfoByNetworkId(this.networkId)}));return function(){return e.apply(this,arguments)}}(),i.getSigners=function(){var e=a()((function*(e,n){var t,r,o,i=yield this.getDbAccount(),a=i.address;if(1!==n.length)throw new v.OneKeyInternalError("Cosmos signers number should be 1.");if(n[0]!==a)throw new v.OneKeyInternalError("Wrong address required for signing.");var u=(yield this.getPrivateKeys(e))[i.path];if("undefined"===typeof u)throw new v.OneKeyInternalError("Unable to get signer.");var c=yield this.getChainInfo();return(o={})[a]=new g.Signer(u,e,null!=(t=null==c||null==(r=c.implOptions)?void 0:r.curve)?t:"secp256k1"),o}));return function(n,t){return e.apply(this,arguments)}}(),i.prepareAccounts=function(){var e=a()((function*(e){var n,t,r=e.password,o=e.indexes,i=e.names,a=(yield this.engine.dbApi.getCredential(this.walletId,r)).seed,u=yield this.getChainInfo(),c=null!=(n=null==u||null==(t=u.implOptions)?void 0:t.curve)?n:"secp256k1",s=Object(m.batchGetPublicKeys)(c,a,r,"secp256k1"===c?C:E,"secp256k1"===c?o.map((function(e){return e.toString()})):o.map((function(e){return e.toString()+"'"})));if(s.length!==o.length)throw new v.OneKeyInternalError("Unable to get publick key.");var d=[],l=0;for(var f of s){var p=f.path,h=f.extendedKey.key,y=Object(T.pubkeyToBaseAddress)(c,h),g=(i||[])[l]||"COSMOS #"+(o[l]+1);d.push({id:this.walletId+"--"+p,name:g,type:w.AccountType.VARIANT,path:p,coinType:b.COINTYPE_COSMOS,pub:h.toString("hex"),address:y,addresses:{}}),l+=1}return d}));return function(n){return e.apply(this,arguments)}}(),i.signTransaction=function(){var n=a()((function*(n,t){var r,i;O.default.common.info("signTransaction result",n);var a=yield this.getDbAccount();O.default.common.info("signTransaction dbAccount",a);var u=(yield this.getSigners(t.password||"",[a.address]))[a.address],c=null==(r=n.inputs)||null==(i=r[0])?void 0:i.publicKey;if(!c)throw new v.OneKeyInternalError("Unable to get sender public key.");var s=n.payload.encodedTx,d=Object(x.serializeTxForSignature)(s),l=yield u.sign(e.from(Object(y.sha256)(d))),f=o()(l,1)[0],p=Object(x.serializeSignedTx)({txWrapper:s,signature:{signatures:[f]},publicKey:{pubKey:c}});return{txid:"",rawTx:e.from(p).toString("base64")}}));return function(e,t){return n.apply(this,arguments)}}(),c()(r)}(I.KeyringHdBase)}.call(this,t(26).Buffer)},4901:function(e,n,t){"use strict";t.r(n),function(e){t.d(n,"KeyringImported",(function(){return C}));var r=t(4),o=t.n(r),i=t(2),a=t.n(i),u=t(6),c=t.n(u),s=t(9),d=t.n(s),l=t(14),f=t.n(l),p=t(7),h=t.n(p),y=t(300),v=t(23),g=t(1345),m=t(748),w=t(117),b=t(11),O=t(19),I=t(3915),T=t(4114),x=t(988);function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=h()(e);if(n){var o=h()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return f()(this,t)}}var C=function(n){d()(r,n);var t=k(r);function r(){return t.apply(this,arguments)}var i=r.prototype;return i.getChainInfo=function(){var e=a()((function*(){return this.engine.providerManager.getChainInfoByNetworkId(this.networkId)}));return function(){return e.apply(this,arguments)}}(),i.getSigners=function(){var e=a()((function*(e,n){var t,r,o,i=yield this.getDbAccount(),a=i.address;if(1!==n.length)throw new v.OneKeyInternalError("Cosmos signers number should be 1.");if(n[0]!==a)throw new v.OneKeyInternalError("Wrong address required for signing.");var u=(yield this.getPrivateKeys(e))[i.path];if("undefined"===typeof u)throw new v.OneKeyInternalError("Unable to get signer.");var c=yield this.getChainInfo();return(o={})[a]=new g.Signer(u,e,null!=(t=null==c||null==(r=c.implOptions)?void 0:r.curve)?t:"secp256k1"),o}));return function(n,t){return e.apply(this,arguments)}}(),i.getCurve=function(e){switch(e){case"ed25519":return m.ed25519;case"secp256k1":return m.secp256k1;default:throw new v.OneKeyInternalError("Unsupported curve")}},i.prepareAccounts=function(){var e=a()((function*(e){var n,t,r=e.privateKey,o=e.name;if(32!==r.length)throw new v.OneKeyInternalError("Invalid private key.");var i=yield this.getChainInfo(),a=null!=(n=null==i||null==(t=i.implOptions)?void 0:t.curve)?n:"secp256k1",u=this.getCurve(a).publicFromPrivate(r),c=u.toString("hex"),s=Object(T.pubkeyToBaseAddress)(a,u);return Promise.resolve([{id:"imported--"+b.COINTYPE_COSMOS+"--"+c,name:o||"",type:w.AccountType.VARIANT,path:"",coinType:b.COINTYPE_COSMOS,pub:c,address:s,addresses:{}}])}));return function(n){return e.apply(this,arguments)}}(),i.signTransaction=function(){var n=a()((function*(n,t){var r,i;O.default.common.info("signTransaction result",n);var a=yield this.getDbAccount();O.default.common.info("signTransaction dbAccount",a);var u=(yield this.getSigners(t.password||"",[a.address]))[a.address],c=null==(r=n.inputs)||null==(i=r[0])?void 0:i.publicKey;if(!c)throw new v.OneKeyInternalError("Unable to get sender public key.");var s=n.payload.encodedTx,d=Object(x.generateSignBytes)(s),l=yield u.sign(e.from(Object(y.sha256)(d))),f=o()(l,1)[0],p=Object(x.serializeSignedTx)({txWrapper:s,signature:{signatures:[f]},publicKey:{pubKey:c}});return{txid:"",rawTx:e.from(p).toString("base64")}}));return function(e,t){return n.apply(this,arguments)}}(),c()(r)}(I.KeyringImportedBase)}.call(this,t(26).Buffer)},4902:function(e,n,t){"use strict";t.r(n),t.d(n,"KeyringWatching",(function(){return g}));var r=t(2),o=t.n(r),i=t(6),a=t.n(i),u=t(9),c=t.n(u),s=t(14),d=t.n(s),l=t(7),f=t.n(l),p=t(11),h=t(23),y=t(117);function v(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=f()(e);if(n){var o=f()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return d()(this,t)}}var g=function(e){c()(t,e);var n=v(t);function t(){return n.apply(this,arguments)}return t.prototype.prepareAccounts=function(){var e=o()((function*(e){var n,t=e.name,r=e.target,o=e.accountIdPrefix,i=yield this.vault.validateAddress(r);if("undefined"===typeof i)throw new h.InvalidAddress;return Promise.resolve([{id:o+"--"+p.COINTYPE_COSMOS+"--"+r,name:t||"",type:y.AccountType.VARIANT,path:"",coinType:p.COINTYPE_COSMOS,pub:"",address:"",addresses:(n={},n[this.networkId]=i,n)}])}));return function(n){return e.apply(this,arguments)}}(),a()(t)}(t(3916).KeyringWatchingBase)},4903:function(e,n,t){"use strict";t.r(n),t.d(n,"CosmosNodeClient",(function(){return d}));var r=t(2),o=t.n(r),i=t(6),a=t.n(i),u=t(107),c=t.n(u),s=t(23),d=function(){function e(e){this.axios=c.a.create({baseURL:e.endsWith("/")?e.slice(0,-1):e,timeout:3e4})}var n=e.prototype;return n.fetchNodeInfo=function(){var e=o()((function*(){return(yield this.axios.get("/node_info")).data.node_info}));return function(){return e.apply(this,arguments)}}(),n.fetchBlockHeader=function(){var e=o()((function*(){return(yield this.axios.get("/blocks/latest")).data.block.header}));return function(){return e.apply(this,arguments)}}(),n.fetchBlockHeaderV1beta1=function(){var e=o()((function*(){return(yield this.axios.get("/cosmos/base/tendermint/v1beta1/blocks/latest")).data.block.header}));return function(){return e.apply(this,arguments)}}(),n.getAccountInfo=function(){var e=o()((function*(e){var n=yield this.axios.get("/cosmos/auth/v1beta1/accounts/"+e);return 404===n.status?null:n.data.account}));return function(n){return e.apply(this,arguments)}}(),n.getAccountBalances=function(){var e=o()((function*(e){var n;return null!=(n=(yield this.axios.get("/cosmos/bank/v1beta1/balances/"+e)).data.balances)?n:[]}));return function(n){return e.apply(this,arguments)}}(),n.getTransactionInfo=function(){var e=o()((function*(e){return this.axios.get("/cosmos/tx/v1beta1/txs/"+e).then((function(e){return e.data.tx_response})).catch((function(e){var n;throw new s.OneKeyError(null==(n=e.response)?void 0:n.status.toString())}))}));return function(n){return e.apply(this,arguments)}}(),n.broadcastTransaction=function(){var e=o()((function*(e){var n,t,r={mode:"BROADCAST_MODE_SYNC",tx_bytes:e},o=yield this.axios.post("/cosmos/tx/v1beta1/txs",r,{headers:{"Content-Type":"application/json"}}),i=o.data.tx_response.raw_log,a=o.data.tx_response.code;if(null!=a&&0!==a){if(-1!==i.indexOf("account sequence mismatch"))throw new s.OneKeyInternalError(i,"msg__broadcast_tx_sequence_number_error");if(-1!==i.indexOf("insufficient fees"))throw new s.OneKeyInternalError(i,"msg__broadcast_tx_Insufficient_fee");throw new s.OneKeyInternalError(i)}return null!=(n=null==(t=o.data.tx_response)?void 0:t.txhash)?n:null}));return function(n){return e.apply(this,arguments)}}(),n.simulationTransaction=function(){var e=o()((function*(e){var n;return null!=(n=(yield this.axios.post("/cosmos/tx/v1beta1/simulate",e,{headers:{"Content-Type":"application/json"}})).data.gas_info)?n:null}));return function(n){return e.apply(this,arguments)}}(),a()(e)}()},4904:function(e,n,t){"use strict";t.r(n),t.d(n,"TxAminoBuilder",(function(){return a}));var r=t(6),o=t.n(r),i=t(1041),a=function(){function e(){}return e.prototype.makeTxWrapper=function(e,n){return i.TransactionWrapper.fromAminoSignDoc({chain_id:n.chainId,account_number:n.accountNumber,sequence:n.nonce,fee:{amount:[{amount:n.feeAmount,denom:n.mainCoinDenom}],gas:n.gasLimit},msgs:e.aminoMsgs,memo:n.memo},e)},o()(e)}()},4905:function(e,n,t){"use strict";t.r(n),function(e){t.d(n,"CosmwasmQuery",(function(){return l}));var r=t(202),o=t.n(r),i=t(2),a=t.n(i),u=t(6),c=t.n(u),s=t(21),d=t.n(s),l=function(){function n(){}var t=n.prototype;return t.queryContract=function(){var n=a()((function*(n,t,r){var o=e.from(JSON.stringify(r),"utf-8").toString("base64");return n.get("/cosmwasm/wasm/v1/contract/"+t+"/smart/"+o).then((function(e){return e.data.data}))}));return function(e,t,r){return n.apply(this,arguments)}}(),t.queryCw20TokenInfo=function(){var e=a()((function*(e,n){var t=this,r=e.axios;if(!r)throw new Error("axios is not defined");return Promise.all(n.map((function(e){return t.queryContract(r,e,{token_info:{}}).then((function(n){return{contractAddress:e,name:n.name,decimals:n.decimals,symbol:n.symbol}}))})))}));return function(n,t){return e.apply(this,arguments)}}(),t.queryCw20TokenBalance=function(){var e=a()((function*(e,n,t){var r=this,i=e.axios;if(!i)throw new Error("axios is not defined");return Promise.all(t.map((function(e){return r.queryContract(i,n,{balance:{address:e}}).then((function(e){var n;try{n=new d.a(o()(e,"balance","0"))}catch(t){n=new d.a(0)}return{address:e,balance:n}}))})))}));return function(n,t,r){return e.apply(this,arguments)}}(),c()(n)}()}.call(this,t(26).Buffer)},4906:function(e,n,t){"use strict";var r,o,i;t.r(n),t.d(n,"ChannelState",(function(){return r})),t.d(n,"PortID",(function(){return o})),t.d(n,"Type",(function(){return i})),function(e){e.StateClosed="STATE_CLOSED",e.StateOpen="STATE_OPEN",e.StateTryopen="STATE_TRYOPEN"}(r||(r={})),function(e){e.Icahost="icahost",e.Transfer="transfer"}(o||(o={})),function(e){e.Erc20="erc20",e.Native="native",e.Staking="staking",e.Ibc="ibc",e.Bridge="bridge"}(i||(i={}))},4907:function(e,n,t){"use strict";t.r(n),t.d(n,"TxMsgBuilder",(function(){return u}));var r=t(6),o=t.n(r),i=t(4908),a=t(4909),u=function(){function e(){this.aminoMsgBuilder=new i.TxAminoMsgBuilder,this.protoMsgBuilder=new a.TxProtoMsgBuilder}var n=e.prototype;return n.makeProtoMsgsOrWithAminoMsgs=function(e,n){for(var t=arguments.length,r=new Array(t>2?t-2:0),o=2;o<t;o++)r[o-2]=arguments[o];return{aminoMsgs:[e.apply(void 0,r)],protoMsgs:[n.apply(void 0,r)]}},n.makeSendNativeMsg=function(e,n,t,r){return this.makeProtoMsgsOrWithAminoMsgs(this.aminoMsgBuilder.makeSendNativeMsg.bind(this.aminoMsgBuilder),this.protoMsgBuilder.makeSendNativeMsg.bind(this.protoMsgBuilder),e,n,t,r)},n.makeSendCwTokenMsg=function(e,n,t,r){return this.makeProtoMsgsOrWithAminoMsgs(this.aminoMsgBuilder.makeSendCwTokenMsg.bind(this.aminoMsgBuilder),this.protoMsgBuilder.makeSendCwTokenMsg.bind(this.protoMsgBuilder),e,n,t,r)},n.makeExecuteContractMsg=function(e,n,t,r){return this.makeProtoMsgsOrWithAminoMsgs(this.aminoMsgBuilder.makeExecuteContractMsg.bind(this.aminoMsgBuilder),this.protoMsgBuilder.makeExecuteContractMsg.bind(this.protoMsgBuilder),e,n,t,r)},o()(e)}()},4908:function(e,n,t){"use strict";t.r(n),function(e){t.d(n,"decodeTxBody",(function(){return v})),t.d(n,"makeSignBytes",(function(){return g})),t.d(n,"makeMsgSend",(function(){return m})),t.d(n,"makeMsgExecuteContract",(function(){return b})),t.d(n,"makeTerraMsgExecuteContract",(function(){return O})),t.d(n,"makeTxRawBytes",(function(){return I})),t.d(n,"TxAminoMsgBuilder",(function(){return T}));var r=t(6),o=t.n(r),i=t(3),a=t.n(i),u=t(4),c=t.n(u),s=t(999),d=t(198),l=t(1188),f=t(244),p=t(779);function h(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?h(Object(t),!0).forEach((function(n){a()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function v(e){return d.TxBody.decode(e)}function g(e){var n=e.accountNumber,t=e.authInfoBytes,r=e.bodyBytes,o=e.chainId,i=d.SignDoc.fromPartial({authInfoBytes:t,bodyBytes:r,chainId:o,accountNumber:n});return d.SignDoc.encode(i).finish()}function m(e,n,t,r){return{typeUrl:f.MessageType.SEND,value:s.MsgSend.encode(s.MsgSend.fromPartial({fromAddress:e,toAddress:n,amount:[{amount:t,denom:r}]})).finish()}}function w(e){return null!==e&&"object"===typeof e?Object.entries(e).filter((function(e){return null!=c()(e,2)[1]})).reduce((function(e,n){var t,r=c()(n,2),o=r[0],i=r[1];return y(y({},e),{},((t={})[o]=i!==Object(i)||Array.isArray(i)?i:w(i),t))}),{}):e}function b(n,t,r,o){return{typeUrl:f.MessageType.EXECUTE_CONTRACT,value:l.MsgExecuteContract.encode(l.MsgExecuteContract.fromPartial({sender:n,contract:t,msg:e.from(JSON.stringify(w(r))),funds:o})).finish()}}function O(n,t,r,o){return{typeUrl:f.MessageType.TERRA_EXECUTE_CONTRACT,value:l.MsgExecuteContract.encode(l.MsgExecuteContract.fromPartial({sender:n,contract:t,msg:e.from(JSON.stringify(w(r))),funds:o})).finish()}}function I(e,n,t){return d.TxRaw.encode(d.TxRaw.fromPartial({bodyBytes:e,authInfoBytes:n,signatures:t})).finish()}var T=function(){function e(){}var n=e.prototype;return n.makeExecuteContractMsg=function(e,n,t,r){return{type:p.defaultAminoMsgOpts.executeWasm.type,value:{sender:e,contract:n,msg:t,funds:r}}},n.makeSendNativeMsg=function(e,n,t,r){return{type:p.defaultAminoMsgOpts.send.native.type,value:{from_address:e,to_address:n,amount:[{amount:t,denom:r}]}}},n.makeSendCwTokenMsg=function(e,n,t,r){return this.makeExecuteContractMsg(e,n,{transfer:{recipient:t,amount:r}},[])},o()(e)}()}.call(this,t(26).Buffer)},4909:function(e,n,t){"use strict";t.r(n),function(e){t.d(n,"decodeTxBody",(function(){return T})),t.d(n,"makeSignBytes",(function(){return k})),t.d(n,"fastMakeSignDoc",(function(){return C})),t.d(n,"makeMsgSend",(function(){return E})),t.d(n,"makeMsgExecuteContract",(function(){return P})),t.d(n,"makeTerraMsgExecuteContract",(function(){return B})),t.d(n,"TxProtoMsgBuilder",(function(){return S}));var r=t(6),o=t.n(r),i=t(4),a=t.n(i),u=t(13),c=t.n(u),s=t(3),d=t.n(s),l=t(73),f=t(999),p=t(732),h=t(1475),y=t(198),v=t(1188),g=t(435),m=t(791),w=t.n(m),b=t(244);function O(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function I(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?O(Object(t),!0).forEach((function(n){d()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function T(e){return y.TxBody.decode(e)}function x(e,n){return e.map((function(e){var t=e.pubkey,r=e.sequence;return{publicKey:t,modeInfo:{single:{mode:n}},sequence:r}}))}function k(e){var n=e.accountNumber,t=e.authInfoBytes,r=e.bodyBytes,o=e.chainId,i=y.SignDoc.fromPartial({authInfoBytes:t,bodyBytes:r,chainId:o,accountNumber:n});return y.SignDoc.encode(i).finish()}function C(e,n,t,r,o,i,a,u,s){var d;return function(e,n,t,r){return{bodyBytes:e,authInfoBytes:n,chainId:t,accountNumber:r}}((d={messages:e,memo:n},y.TxBody.encode(y.TxBody.fromPartial(I({},d))).finish()),function(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.SignMode.SIGN_MODE_DIRECT,o={signerInfos:x(e,r),fee:{amount:c()(n),gasLimit:t}};return y.AuthInfo.encode(y.AuthInfo.fromPartial(o)).finish()}([{pubkey:function(e){var n=p.PubKey.fromPartial({key:e});return g.Any.fromPartial({typeUrl:"/cosmos.crypto.secp256k1.PubKey",value:Uint8Array.from(p.PubKey.encode(n).finish())})}(o),sequence:w.a.fromString(s)}],[{amount:r,denom:i}],w.a.fromString(t)),a,w.a.fromString(u))}function E(e,n,t,r){return{typeUrl:b.MessageType.SEND,value:f.MsgSend.encode(f.MsgSend.fromPartial({fromAddress:e,toAddress:n,amount:[{amount:t,denom:r}]})).finish()}}function A(e){return null!==e&&"object"===typeof e?Object.entries(e).filter((function(e){return null!=a()(e,2)[1]})).reduce((function(e,n){var t,r=a()(n,2),o=r[0],i=r[1];return I(I({},e),{},((t={})[o]=i!==Object(i)||Array.isArray(i)?i:A(i),t))}),{}):e}function P(n,t,r,o){return{typeUrl:b.MessageType.EXECUTE_CONTRACT,value:v.MsgExecuteContract.encode(v.MsgExecuteContract.fromPartial({sender:n,contract:t,msg:e.from(JSON.stringify(A(r))),funds:o})).finish()}}function B(n,t,r,o){return{typeUrl:b.MessageType.TERRA_EXECUTE_CONTRACT,value:v.MsgExecuteContract.encode(v.MsgExecuteContract.fromPartial({sender:n,contract:t,msg:e.from(JSON.stringify(A(r))),funds:o})).finish()}}var S=function(){function n(){}var t=n.prototype;return t.makeExecuteContractMsg=function(n,t,r,o){var i=v.MsgExecuteContract.encode(v.MsgExecuteContract.fromPartial({sender:n,contract:t,msg:e.from(JSON.stringify(A(r))),funds:o})).finish();return{typeUrl:b.MessageType.EXECUTE_CONTRACT,value:Object(l.bytesToHex)(i)}},t.makeSendNativeMsg=function(e,n,t,r){var o=f.MsgSend.encode(f.MsgSend.fromPartial({fromAddress:e,toAddress:n,amount:[{amount:t,denom:r}]})).finish();return{typeUrl:b.MessageType.SEND,value:Object(l.bytesToHex)(o)}},t.makeSendCwTokenMsg=function(e,n,t,r){return this.makeExecuteContractMsg(e,n,{transfer:{recipient:t,amount:r}},[])},o()(n)}()}.call(this,t(26).Buffer)},5319:function(e,n,t){"use strict";t.r(n),t.d(n,"queryRegistry",(function(){return s}));var r=t(6),o=t.n(r),i=t(36),a=t(4905),u=t(4433),c=function(){function e(){}var n=e.prototype;return n.queryCw20TokenInfo=function(e,n){throw new Error("Not implemented")},n.queryCw20TokenBalance=function(e,n,t){throw new Error("Not implemented")},o()(e)}(),s=new(function(){function e(){this.registryMap=new Map}var n=e.prototype;return n.get=function(e){return this.registryMap.get(e)},n.register=function(e,n){this.registryMap.set(e,n)},o()(e)}()),d=new a.CosmwasmQuery;s.register(i.OnekeyNetwork.juno,d),s.register(i.OnekeyNetwork.osmosis,d),s.register(i.OnekeyNetwork.secretnetwork,new c);var l=new u.MintScanQuery;s.register(i.OnekeyNetwork.cosmoshub,l),s.register(i.OnekeyNetwork.akash,l),s.register(i.OnekeyNetwork.fetch,l)},6082:function(e,n,t){"use strict";t.r(n),function(e){t.d(n,"default",(function(){return fe}));var r,o=t(316),i=t.n(o),a=t(60),u=t.n(a),c=t(202),s=t.n(c),d=t(3),l=t.n(d),f=t(13),p=t.n(f),h=t(4),y=t.n(h),v=t(2),g=t.n(v),m=t(6),w=t.n(m),b=t(9),O=t.n(b),I=t(14),T=t.n(I),x=t(7),k=t.n(x),C=t(73),E=t(21),A=t.n(E),P=t(3728),B=t(23),S=t(69),N=t(112),D=t(367),M=t(74),j=t(52),K=t(196),R=t(303),H=t(3912),F=t(36),_=t(431),U=t(19),W=t(150),L=t(489),V=t(4899),q=t(4900),G=t(4901),Y=t(4902),z=t(4903),Q=t(4114),J=t(4904),X=t(779),$=t(244),Z=t(5319),ee=t(4433),ne=t(4906),te=t(988),re=t(4907),oe=t(558),ie=t(2723),ae=t(1042);function ue(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ce(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ue(Object(t),!0).forEach((function(n){l()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ue(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function se(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,r=k()(e);if(n){var o=k()(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return T()(this,t)}}var de=((r={})[F.OnekeyNetwork.juno]="1.2",r.default="1.3",r),le=["0.01","0.025","0.04"],fe=function(n){O()(r,n);var t=se(r);function r(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).keyringMap={hd:q.KeyringHd,hw:V.KeyringHardware,imported:G.KeyringImported,watching:Y.KeyringWatching,external:Y.KeyringWatching},e.settings=ie.default,e.getClientCache=Object(W.memoizee)((function(n){return e.getNodeClient(n)}),{promise:!0,max:1}),e.msgBuilder=new re.TxMsgBuilder,e.txBuilder=new J.TxAminoBuilder,e}var o=r.prototype;return o.getContractClient=function(){var e=g()((function*(){return Promise.resolve(Z.queryRegistry.get(this.networkId))}));return function(){return e.apply(this,arguments)}}(),o.getNodeClient=function(e){return new z.CosmosNodeClient(e)},o.getClient=function(){var e=g()((function*(){var e=(yield this.engine.getNetwork(this.networkId)).rpcURL;return this.getClientCache(e)}));return function(){return e.apply(this,arguments)}}(),o.getChainInfo=function(){var e=g()((function*(){return yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)}));return function(){return e.apply(this,arguments)}}(),o.getChainImplInfo=function(){var e=g()((function*(){return(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).implOptions}));return function(){return e.apply(this,arguments)}}(),o.getClientEndpointStatus=function(){var e=g()((function*(e){var n=this.getNodeClient(e),t=performance.now(),r=(yield n.fetchBlockHeader()).height,o=parseInt(r);return{responseTime:Math.floor(performance.now()-t),latestBlock:o}}));return function(n){return e.apply(this,arguments)}}(),o._getPublicKey=function(){var e=g()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.prefix,t=void 0===n||n,r=yield this.getDbAccount(),o=r.pub;return t&&(o=Object(R.addHexPrefix)(o)),Promise.resolve(o)}));return function(){return e.apply(this,arguments)}}(),o.getKey=function(){var e=g()((function*(e,n){var t,r,o=yield this.engine.dbApi.getAccount(n),i=yield this.engine.providerManager.getChainInfoByNetworkId(e),a=Object(Q.baseAddressToAddress)(null!=(t=null==(r=i.implOptions)?void 0:r.addressPrefix)?t:"cosmos",o.address),u=yield this.engine.getWalletSafe(this.walletId);return{name:o.name,algo:"secp251k1",pubKey:o.pub,address:o.address,bech32Address:a,isNanoLedger:(null==u?void 0:u.type)===M.WALLET_TYPE_HW}}));return function(n,t){return e.apply(this,arguments)}}(),o.normalIBCAddress=function(e){if(this.isIbcToken(e)){var n=e.split("/"),t=y()(n,2),r=t[0],o=t[1];return r.toLowerCase()+"/"+o.toUpperCase()}},o.validateAddress=function(){var e=g()((function*(e){var n=yield this.getChainInfo();return Object(Q.isValidAddress)(e,n.implOptions.addressPrefix)?Promise.resolve(e):Promise.reject(new B.InvalidAddress)}));return function(n){return e.apply(this,arguments)}}(),o.isIbcToken=function(e){return-1!==e.indexOf("/")&&"ibc"===e.split("/")[0].toLowerCase()},o.validateTokenAddress=function(){var e=g()((function*(e){var n=this,t=yield this.getChainInfo();if(this.isIbcToken(e)){var r,o=null!=(r=this.normalIBCAddress(e))?r:e,i=new ee.MintScanQuery,a=yield i.fetchAssertInfos(this.networkId);return a&&a.find((function(e){return e.type===ne.Type.Ibc&&n.normalIBCAddress(e.denom)===o}))?Promise.resolve(o):Promise.reject(new B.InvalidTokenAddress)}return Object(Q.isValidContractAddress)(e,t.implOptions.addressPrefix)?Promise.resolve(e):Promise.reject(new B.InvalidTokenAddress)}));return function(n){return e.apply(this,arguments)}}(),o.validateWatchingCredential=function(e){return this.settings.watchingAccountEnabled?this.validateAddress(e).then((function(e){return!!e&&e.length>0})).catch((function(){return!1})):Promise.resolve(!1)},o.checkAccountExistence=function(){var e=g()((function*(e){var n=yield this.getClient();return!!(yield n.getAccountInfo(e))}));return function(n){return e.apply(this,arguments)}}(),o.getAccountNonce=function(){var e=g()((function*(){var e,n=yield this.getClient(),t=yield n.getAccountInfo(yield this.getAccountAddress());return new A.a(null!=(e=null==t?void 0:t.sequence)?e:"0").toNumber()}));return function(){return e.apply(this,arguments)}}(),o.getBalances=function(){var e=g()((function*(e){var n=this,t=yield this.getClient(),r=(yield this.getChainInfo()).implOptions,o=yield this.getContractClient();return Promise.all(e.map(function(){var e=g()((function*(e){var i=e.address,a=e.tokenAddress;try{var u,c=null!=(u=null==a?void 0:a.trim())?u:void 0,s=!c,d=c&&n.isIbcToken(c);if(s||d){var l=yield t.getAccountBalances(i);if(s){var f,p=l.find((function(e){return e.denom===r.mainCoinDenom}));return new A.a(null!=(f=null==p?void 0:p.amount)?f:"0")}if(d){var h,y=l.find((function(e){return n.normalIBCAddress(e.denom)===n.normalIBCAddress(c)}));return new A.a(null!=(h=null==y?void 0:y.amount)?h:"0")}}if(!o)throw new Error("Contract client not found");return yield o.queryCw20TokenBalance({networkId:n.networkId,axios:t.axios},c,[i]).then((function(e){return e[0].balance}))}catch(v){}}));return function(n){return e.apply(this,arguments)}}()))}));return function(n){return e.apply(this,arguments)}}(),o.fetchTokenInfos=function(){var e=g()((function*(e){var n=this,t=e.filter((function(e){return n.isIbcToken(e)})).reduce((function(e,t){var r=n.normalIBCAddress(t);return r&&e.add(r),e}),new Set),r=[];if(t.size>0){var o=new ee.MintScanQuery,i=yield o.fetchAssertInfos(this.networkId);if(!i)return Promise.resolve([]);var a=i.reduce((function(e,r){var o,i,a,u=null!=(o=n.normalIBCAddress(r.denom))?o:r.denom;r.type===ne.Type.Ibc&&t.has(u)&&e.push({name:r.dp_denom+"("+(null!=(i=null==(a=r.channel)?void 0:a.toUpperCase())?i:"")+")",symbol:r.dp_denom,decimals:r.decimal});return e}),[]);r.push.apply(r,p()(a))}if(r.length===e.length)return r;try{var u=yield this.getContractClient();if(!u)return r;var c=yield this.getClient(),s=e.filter((function(e){return!n.isIbcToken(e)}));yield u.queryCw20TokenInfo({networkId:this.networkId,axios:c.axios},s).then((function(e){return e.map((function(e){return{name:e.name,symbol:e.symbol,decimals:e.decimals}}))})).then((function(e){r.push.apply(r,p()(e))})).catch((function(){}))}catch(d){}return r}));return function(n){return e.apply(this,arguments)}}(),o.attachFeeInfoToEncodedTx=function(){var e=g()((function*(e){var n,t,r,o=e.feeInfoValue,i=o.price,a=o.limit;if(!i||"string"!==typeof i)throw new B.OneKeyInternalError("Invalid gas price.");if("string"!==typeof a)throw new B.OneKeyInternalError("Invalid fee limit");var u=yield this.getNetwork(),c=Object(K.convertFeeGweiToValue)({value:i,network:u}),s=new A.a(parseFloat(c)*parseFloat(a)).toFixed(0),d=Object(oe.getFee)(e.encodedTx),l=yield this.getChainImplInfo(),f=[];d&&d.amount.length>0?(d.amount[0].denom!==l.mainCoinDenom&&U.default.engine.warn("Cosmos Invalid fee denom:",{network:u,transaction:e.encodedTx}),f=[{denom:l.mainCoinDenom,amount:s}]):f=[{denom:l.mainCoinDenom,amount:s}];var p={amount:f,gas_limit:a,payer:null!=(n=null==d?void 0:d.payer)?n:"",granter:null!=(t=null==d?void 0:d.granter)?t:"",feePayer:null!=(r=null==d?void 0:d.feePayer)?r:""};return Object(oe.setFee)(e.encodedTx,p)}));return function(n){return e.apply(this,arguments)}}(),o.decodedTxToLegacy=function(e){return Promise.resolve({})},o.decodeTx=function(){var e=g()((function*(e,n){var t,r=yield this.engine.getNetwork(this.networkId),o=yield this.getDbAccount(),i=yield this.engine.getNativeTokenInfo(this.networkId),a=yield this.getChainInfo(),u=Object(oe.getMsgs)(e),c=[];for(var s of u){var d,l=null,f=Object(ae.getTransactionTypeByProtoMessage)(s,null==a||null==(d=a.implOptions)?void 0:d.mainCoinDenom);if(f===j.IDecodedTxActionType.NATIVE_TRANSFER||f===j.IDecodedTxActionType.TOKEN_TRANSFER){var p,h="nativeTransfer",y="unpacked"in s?s.unpacked:s.value,v=y.amount,g=y.fromAddress,m=y.toAddress,w=v[0].amount,b=v[0].denom;if(f===j.IDecodedTxActionType.TOKEN_TRANSFER&&(h="tokenTransfer",!(i=yield this.engine.ensureTokenInDB(this.networkId,b))))throw new Error("Invalid token address");var O={tokenInfo:i,to:m,from:g,amount:new A.a(w).shiftedBy(-i.decimals).toFixed(),amountValue:w,extraInfo:null};(p={type:f})[h]=O,l=p}else l={type:j.IDecodedTxActionType.UNKNOWN,direction:j.IDecodedTxDirection.OTHER,unknownAction:{extraInfo:{}}};l&&c.push(l)}var I,T,x=Object(oe.getFee)(e),k=Object(oe.getSequence)(e),C=le[0];null!=x&&x.gas_limit&&(C=new A.a(null!=(I=null==x||null==(T=x.amount[0])?void 0:T.amount)?I:"1").div(null==x?void 0:x.gas_limit).toFixed(6));var E={txid:"",owner:o.address,signer:o.address,nonce:k.toNumber(),actions:c,status:j.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,feeInfo:{price:Object(K.convertFeeValueToGwei)({value:C,network:r}),limit:null!=(t=null==x?void 0:x.gas_limit)?t:void 0},extraInfo:null,encodedTx:e};return Promise.resolve(E)}));return function(n,t){return e.apply(this,arguments)}}(),o.buildEncodedTxFromTransfer=function(){var e=g()((function*(e){var n,t;if(!e.to)throw new Error("Invalid transferInfo.to params");var r=e.to,o=e.amount,i=e.token,a=(yield this.getDbAccount()).address,u=yield this.getChainInfo(),c=Object(S.parseNetworkId)(this.networkId).chainId;if(!c)throw new Error("Invalid networkId");var s,d=null!=(n=e.destinationTag)?n:"";if(!Object(Q.isValidAddress)(r,u.implOptions.addressPrefix)&&r.indexOf("#")>-1){var l=r.split("#"),f=y()(l,2),p=f[0],h=f[1];r=p,d=null!=h?h:"",yield this.validateAddress(p)}if(i&&""!==i){var v=yield this.engine.ensureTokenInDB(this.networkId,i);if("undefined"===typeof v)throw new B.OneKeyInternalError("Failed to get token info.");var g=new A.a(o).shiftedBy(v.decimals).toFixed();s=this.isIbcToken(i)?this.msgBuilder.makeSendNativeMsg(a,r,g,i):this.msgBuilder.makeSendCwTokenMsg(a,i,r,g)}else{var m,w=yield this.getNetwork(),b=new A.a(o).shiftedBy(w.decimals).toFixed();s=this.msgBuilder.makeSendNativeMsg(a,r,b,null==u||null==(m=u.implOptions)?void 0:m.mainCoinDenom)}var O=yield this.getClient(),I=yield O.getAccountInfo(a);if(!I)throw new Error("Invalid account");var T=Object(C.hexToBytes)(Object(R.stripHexPrefix)(yield this._getPublicKey()));return this.txBuilder.makeTxWrapper(s,{memo:d,gasLimit:"0",feeAmount:"1",pubkey:T,mainCoinDenom:null==u||null==(t=u.implOptions)?void 0:t.mainCoinDenom,chainId:c,accountNumber:I.account_number,nonce:I.sequence})}));return function(n){return e.apply(this,arguments)}}(),o.buildEncodedTxFromApprove=function(e){throw new B.NotImplemented},o.updateEncodedTxTokenApprove=function(e,n){throw new B.NotImplemented},o.buildUnsignedTxFromEncodedTx=function(){var e=g()((function*(e){var n=yield this.getDbAccount();return Promise.resolve({inputs:[{address:n.address,value:new A.a(0),publicKey:n.pub}],outputs:[],payload:{encodedTx:e},encodedTx:e})}));return function(n){return e.apply(this,arguments)}}(),o.fetchFeeConfig=function(){var e=g()((function*(){var e=(yield this.getChainInfo()).implOptions.gasPriceStep||{},n=e.low,t=e.normal,r=e.high;return[new A.a(null!=n?n:le[0]),new A.a(null!=t?t:le[1]),new A.a(null!=r?r:le[2])]}));return function(){return e.apply(this,arguments)}}(),o.fixFeeAmount=function(){var e=g()((function*(e){var n,t,r,o=Object(oe.getFee)(e),i=yield this.getChainImplInfo(),a=[];o&&o.amount.length>0?(o.amount[0].denom!==i.mainCoinDenom&&U.default.engine.warn("Cosmos Invalid fee denom:",{network:this.networkId,transaction:e}),a=[{denom:i.mainCoinDenom,amount:o.amount[0].amount}]):a=[{denom:i.mainCoinDenom,amount:"100000"}];var u={amount:a,gas_limit:o.gas_limit,payer:null!=(n=null==o?void 0:o.payer)?n:"",granter:null!=(t=null==o?void 0:o.granter)?t:"",feePayer:null!=(r=null==o?void 0:o.feePayer)?r:""};return Object(oe.setFee)(e,u)}));return function(n){return e.apply(this,arguments)}}(),o.fetchFeeInfo=function(){var n=g()((function*(n){var t=yield Promise.all([this.getNetwork(),this.buildUnsignedTxFromEncodedTx(n)]),r=y()(t,2),o=r[0],i=r[1],a=yield this.fixFeeAmount(i.encodedTx),u=Object(oe.getFee)(a).gas_limit,c=(yield this.fetchFeeConfig()).map((function(e){return Object(K.convertFeeValueToGwei)({value:e.toFixed(),network:o})}));try{var s,d=yield this.getClient(),l=yield this._getPublicKey(),f=Object(te.serializeSignedTx)({txWrapper:a,signature:{signatures:[new Uint8Array(64)]},publicKey:{pubKey:l}});if(!f)throw new Error("Invalid rawTxBytes");var p=yield d.simulationTransaction({tx_bytes:e.from(f).toString("base64")});if(!p)throw new Error("Failed to get tx simulation");u=new A.a(p.gas_used).multipliedBy(null!=(s=de[this.networkId])?s:de.default).toFixed(0)}catch(w){var h=Object(oe.getMsgs)(a).find((function(e){return(null==e?void 0:e.typeUrl)===X.defaultAminoMsgOpts.send.native.type||(null==e?void 0:e.type)===$.MessageType.SEND}));if(h){var v,g=("unpacked"in h?h.unpacked:h.value).amount,m=yield this.getChainInfo();g&&g.length>0&&g[0].denom===(null==m||null==(v=m.implOptions)?void 0:v.mainCoinDenom)&&(u="100000")}if(!u||""===u)throw w}return{nativeSymbol:o.symbol,nativeDecimals:o.decimals,feeSymbol:o.feeSymbol,feeDecimals:o.feeDecimals,limit:u,prices:c,defaultPresetIndex:"1"}}));return function(e){return n.apply(this,arguments)}}(),o.broadcastTransaction=function(){var e=g()((function*(e){var n=yield this.getClient();U.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});try{var t=yield n.broadcastTransaction(e.rawTx);if(U.default.engine.info("broadcastTransaction Done:",{txid:t,rawTx:e.rawTx}),!t)throw new Error("broadcastTransaction failed");return ce(ce({},e),{},{txid:t})}catch(a){if(a instanceof B.OneKeyInternalError)throw a;var r=a||{},o=r.errorCode,i=r.message;throw new B.OneKeyInternalError((null!=o?o:"")+" "+i)}}));return function(n){return e.apply(this,arguments)}}(),o.updateEncodedTx=function(){var e=g()((function*(e,n,t){var r=Object(oe.getMsgs)(e);if(t.type===j.IEncodedTxUpdateType.transfer&&r.length>0&&r[0].typeUrl===X.defaultAminoMsgOpts.send.native.type){var o=yield this.getNetwork();return Promise.resolve(Object(oe.setSendAmount)(e,new A.a(n.amount).shiftedBy(o.decimals).toFixed()))}return Promise.resolve(e)}));return function(n,t,r){return e.apply(this,arguments)}}(),o.getExportedCredential=function(){var e=g()((function*(e){var n=yield this.getDbAccount();if(n.id.startsWith("hd-")||n.id.startsWith("imported")){var t=this.keyring,r=Object.values(yield t.getPrivateKeys(e)),o=y()(r,1)[0];return"0x"+Object(N.decrypt)(e,o).toString("hex")}throw new B.OneKeyInternalError("Only credential of HD or imported accounts can be exported")}));return function(n){return e.apply(this,arguments)}}(),o.fetchOnChainHistory=function(){var e=g()((function*(e){var n,t=this,r=e.localHistory,o=void 0===r?[]:r;if(e.tokenIdOnNetwork)return Promise.resolve([]);var i=(yield Object(_.CoreSDKLoader)()).getTimeStamp,a=yield this.getDbAccount(),u=yield this.getChainInfo(),c=new ee.MintScanQuery,s=(null!=(n=yield c.fetchAccountTxs(this.networkId,a.address))?n:[]).map(function(){var e=g()((function*(e){var n=o.find((function(n){return Object(L.equalsIgnoreCase)(n.decodedTx.txid,e.data.txhash)}));if(n&&n.decodedTx.isFinal)return Promise.resolve(void 0);try{var r,c,s,d,l,f=yield t.engine.getNativeTokenInfo(t.networkId),p=e.data.code,h=j.IDecodedTxStatus.Pending;p?h=j.IDecodedTxStatus.Failed:new A.a(e.data.height).gt(0)&&(h=j.IDecodedTxStatus.Confirmed);var y=e.data.tx.body.messages,v=e.data.tx.auth_info.fee,g=e.data.tx.auth_info.signer_infos[0].sequence,m="",w="",b=[];for(var O of y){var I,T=null,x=Object(ae.getTransactionTypeByMessage)(O,null==u||null==(I=u.implOptions)?void 0:I.mainCoinDenom);if(x===j.IDecodedTxActionType.NATIVE_TRANSFER||x===j.IDecodedTxActionType.TOKEN_TRANSFER){var k,C="nativeTransfer",E=O.amount,B=O.from_address,S=O.to_address;m=B,w=S;var N=E[0].amount,D=E[0].denom;if(x===j.IDecodedTxActionType.TOKEN_TRANSFER&&(C="tokenTransfer",f=yield t.engine.ensureTokenInDB(t.networkId,D)),!f)throw new Error("Invalid token address");var M={tokenInfo:f,to:S,from:B,amount:new A.a(N).shiftedBy(-f.decimals).toFixed(),amountValue:N,extraInfo:null};(k={type:x})[C]=M,T=k}else T={type:j.IDecodedTxActionType.UNKNOWN,direction:j.IDecodedTxDirection.OTHER,unknownAction:{extraInfo:{}}};T&&b.push(T)}var K={from:m,to:w,value:""},R=new A.a(null!=(r=null==v||null==(c=v.amount[0])?void 0:c.amount)?r:"0"),H={txid:e.data.txhash,owner:a.address,signer:m,nonce:parseInt(g),actions:b,status:h,networkId:t.networkId,accountId:t.accountId,encodedTx:K,extraInfo:null,totalFeeInNative:new A.a(R).shiftedBy(-(null!=(s=null==(d=f)?void 0:d.decimals)?s:6)).toFixed()};return H.updatedAt=null!=(l=Object(P.default)(new Date(e.data.timestamp)))?l:i(),H.createdAt=H.updatedAt,H.isFinal=H.status===j.IDecodedTxStatus.Confirmed,yield t.buildHistoryTx({decodedTx:H,historyTxToMerge:n})}catch(F){return}}));return function(n){return e.apply(this,arguments)}}());return(yield Promise.all(s)).filter(Boolean)}));return function(n){return e.apply(this,arguments)}}(),o.getTransactionStatuses=function(){var e=g()((function*(e){var n=yield this.getClient();return Promise.all(e.map(function(){var e=g()((function*(e){try{var t=yield n.getTransactionInfo(e),r=s()(t,"code",void 0),o=D.TransactionStatus.PENDING;return r?o=D.TransactionStatus.CONFIRM_BUT_FAILED:new A.a(t.height).gt(0)&&(o=D.TransactionStatus.CONFIRM_AND_SUCCESS),yield Promise.resolve(o)}catch(r){var i=r.message;if("404"===i||"400"===i)return Promise.resolve(D.TransactionStatus.NOT_FOUND)}}));return function(n){return e.apply(this,arguments)}}()))}));return function(n){return e.apply(this,arguments)}}(),o.addressFromBase=function(){var e=g()((function*(e){var n,t=e,r=null==(n=t.addresses[this.networkId])?void 0:n.trim();if(u()(r)||i()(r)){var o,a,c=yield this.getChainInfo();return Object(Q.baseAddressToAddress)(null!=(o=null==(a=c.implOptions)?void 0:a.addressPrefix)?o:"cosmos",t.address)}return t.addresses[this.networkId]}));return function(n){return e.apply(this,arguments)}}(),w()(r)}(H.VaultBase)}.call(this,t(26).Buffer)}}]);