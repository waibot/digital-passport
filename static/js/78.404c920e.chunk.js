(this.webpackJsonp=this.webpackJsonp||[]).push([[78],{3983:function(e,t,n){"use strict";n.r(t),n.d(t,"ensureModuleIsLoaded",(function(){return S})),n.d(t,"captureRef",(function(){return x})),n.d(t,"releaseCapture",(function(){return L})),n.d(t,"captureScreen",(function(){return E})),n.d(t,"default",(function(){return P}));var r=n(6),o=n.n(r),a=n(18),u=n.n(a),i=n(9),c=n.n(i),s=n(14),l=n.n(s),d=n(7),f=n.n(d),p=n(3),h=n.n(p),m=n(1),b=n(38),v=n(250),y=n(28),j=n(184),O=n(0);function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=v.default.RNViewShot,R=new Promise((function(){})),k=["png","jpg"].concat("android"===y.default.OS?["webm","raw"]:[]),C=["tmpfile","base64","data-uri"].concat("android"===y.default.OS?["zip-base64"]:[]),M={format:"png",quality:1,result:"tmpfile",snapshotContentContainer:!1,handleGLSurfaceViewOnAndroid:!1};function I(e){var t=g(g({},M),e),n=[];return"width"in t&&("number"!==typeof t.width||t.width<=0)&&(n.push("option width should be a positive number"),delete t.width),"height"in t&&("number"!==typeof t.height||t.height<=0)&&(n.push("option height should be a positive number"),delete t.height),("number"!==typeof t.quality||t.quality<0||t.quality>1)&&(n.push("option quality should be a number between 0.0 and 1.0"),t.quality=M.quality),"boolean"!==typeof t.snapshotContentContainer&&n.push("option snapshotContentContainer should be a boolean"),"boolean"!==typeof t.handleGLSurfaceViewOnAndroid&&n.push("option handleGLSurfaceViewOnAndroid should be a boolean"),-1===k.indexOf(t.format)&&(t.format=M.format,n.push("option format '"+t.format+"' is not in valid formats: "+k.join(" | "))),-1===C.indexOf(t.result)&&(t.result=M.result,n.push("option result '"+t.result+"' is not in valid formats: "+C.join(" | "))),{options:t,errors:n}}function S(){if(!A)throw new Error("react-native-view-shot: NativeModules.RNViewShot is undefined. Make sure the library is linked on the native side.")}function x(e,t){if(S(),e&&"object"===typeof e&&"current"in e&&e.current&&!(e=e.current))return Promise.reject(new Error("ref.current is null"));if("number"!==typeof e){var n=Object(j.default)(e);if(!n)return Promise.reject(new Error("findNodeHandle failed to resolve view="+String(e)));e=n}var r=I(t),o=r.options;r.errors;return A.captureRef(e,o)}function L(e){"string"!==typeof e||A.releaseCapture(e)}function E(e){S();var t=I(e),n=t.options;t.errors;return A.captureScreen(n)}var P=function(e){c()(n,e);var t=_(n);function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).firstLayoutPromise=new Promise((function(t){e.resolveFirstLayout=t})),e.capture=function(){return e.firstLayoutPromise.then((function(){var t=u()(e).root;return t?x(t,e.props.options):R})).then((function(t){return e.onCapture(t),t}),(function(t){throw e.onCaptureFailure(t),t}))},e.onCapture=function(t){if(e.root){e.lastCapturedURI&&setTimeout(L,500,e.lastCapturedURI),e.lastCapturedURI=t;var n=e.props.onCapture;n&&n(t)}},e.onCaptureFailure=function(t){if(e.root){var n=e.props.onCaptureFailure;n&&n(t)}},e.syncCaptureLoop=function(t){if(cancelAnimationFrame(e._raf),"continuous"===t){var n="-";e._raf=requestAnimationFrame((function t(){e._raf=requestAnimationFrame(t),n!==e.lastCapturedURI&&(n=e.lastCapturedURI,e.capture())}))}},e.onRef=function(t){e.root=t},e.onLayout=function(t){var n=e.props.onLayout;e.resolveFirstLayout(t.nativeEvent.layout),n&&n(t)},e}var r=n.prototype;return r.componentDidMount=function(){"mount"===this.props.captureMode?this.capture():this.syncCaptureLoop(this.props.captureMode)},r.componentDidUpdate=function(e){void 0!==this.props.captureMode&&this.props.captureMode!==e.captureMode&&this.syncCaptureLoop(this.props.captureMode),"update"===this.props.captureMode&&this.capture()},r.componentWillUnmount=function(){this.syncCaptureLoop(null)},r.render=function(){var e=this.props.children;return Object(O.jsx)(b.default,{ref:this.onRef,collapsable:!1,onLayout:this.onLayout,style:this.props.style,children:e})},o()(n)}(m.Component);P.captureRef=x,P.releaseCapture=L},3996:function(e,t,n){"use strict";n.r(t),n.d(t,"useRevokeAddress",(function(){return j})),n.d(t,"useTokenAllowances",(function(){return O})),n.d(t,"useSpenderAppName",(function(){return _})),n.d(t,"useAccountCanTransaction",(function(){return w})),n.d(t,"useUpdateAllowance",(function(){return g})),n.d(t,"useIsVerticalOrMiddleLayout",(function(){return A}));var r=n(563),o=n(2),a=n.n(o),u=n(4),i=n.n(u),c=n(1),s=n(44),l=n(1071),d=n(108),f=n(245),p=n(74),h=n(151),m=n(17),b=n(25),v=n(16),y=n(1062),j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=Object(c.useState)(""),n=i()(t,2),r=n[0],o=n[1],u=Object(c.useState)(!0),s=i()(u,2),l=s[0],d=s[1],f=Object(c.useCallback)(a()((function*(){d(!0);var t=yield m.default.serviceRevoke.getAddress(e);o(null!=t?t:""),setTimeout((function(){d(!1)}),1e3)})),[e]);return Object(c.useEffect)((function(){f()}),[e,f]),{updateAddress:f,address:r,loading:l}},O=function(e,t,n){var r,o,u,i,s=Object(l.useAsync)(a()((function*(){return m.default.serviceRevoke.fetchTokenAllowance(e,t,n,!1)})),[e,t,n]),d=s.result,f=s.loading,p=s.error,b=s.execute;return Object(c.useEffect)((function(){return h.appUIEventBus.on(h.AppUIEventBusNames.RevokeRefresh,b),function(){h.appUIEventBus.off(h.AppUIEventBusNames.RevokeRefresh,b)}}),[b]),p?{address:"",prices:{},allowances:[],loading:!1,isFromRpc:!1}:{address:null!=(r=null==d?void 0:d.address)?r:"",prices:null!=(o=null==d?void 0:d.prices)?o:{},allowances:null!=(u=null==d?void 0:d.allowance)?u:[],isFromRpc:null!=(i=null==d?void 0:d.isFromRpc)&&i,loading:f,error:p}},_=function(e,t){var n=Object(c.useState)(""),r=i()(n,2),o=r[0],u=r[1],s=Object(c.useCallback)(a()((function*(){var n=yield m.default.serviceRevoke.getSpenderName(e,t);u(n)})),[t,e]);return Object(c.useEffect)((function(){s()}),[s]),o||Object(d.shortenAddress)(t)},w=function(e){var t=Object(b.useActiveWalletAccount)(),n=t.account,r=t.wallet;return Object(c.useMemo)((function(){return n&&n.id&&(null==n?void 0:n.address.toLowerCase())===e.toLowerCase()&&(null==r?void 0:r.type)!==p.WALLET_TYPE_WATCHING}),[n,e,null==r?void 0:r.type])},g=function(e){var t=e.networkId,n=e.spender,r=e.contract,o=Object(s.useNavigation)(),u=Object(b.useActiveWalletAccount)(),i=u.accountId,l=u.accountAddress;return Object(c.useCallback)(function(){var e=a()((function*(e){var a,u=e.amount,c=e.tokenId;a=e.assetType===y.AssetType.tokens?yield m.default.engine.buildEncodedTxFromApprove({amount:u,networkId:t,spender:n,accountId:i,token:r}):"undefined"!==typeof c?yield m.default.serviceRevoke.buildEncodedTxsFromApprove({from:l,to:null!=r?r:"",approve:f.ADDRESS_ZERO,tokenId:c}):yield m.default.serviceRevoke.buildEncodedTxsFromSetApprovalForAll({from:l,to:null!=r?r:"",approved:!1,spender:n}),o.navigate(v.RootRoutes.Modal,{screen:v.ModalRoutes.Send,params:{screen:v.SendModalRoutes.SendConfirm,params:{accountId:i,networkId:t,feeInfoEditable:!0,feeInfoUseFeeInTx:!1,encodedTx:a,onSuccess:function(){h.appUIEventBus.emit(h.AppUIEventBusNames.RevokeRefresh)}}}})}));return function(t){return e.apply(this,arguments)}}(),[i,r,o,t,n,l])},A=function(){var e=Object(r.default)().size;return Object(c.useMemo)((function(){return["SMALL","NORMAL"].includes(e)}),[e])}},5314:function(e,t,n){"use strict";n.r(t);var r=n(50),o=n(57),a=n(63),u=n(27),i=n(47),c=n(121),s=n(126),l=n(1),d=n(44),f=n(88),p=n(3996),h=n(1062),m=n(0),b=n(41),v=n(82),y=n(20),j=n(48),O=n(4),_=n.n(O),w=n(2),g=n.n(w),A=n(3983),R=n(235),k=n(19),C=(n(24),function(){var e=g()((function*(){return null}));return function(){return e.apply(this,arguments)}}()),M=n(234),I=Object(M.default)(),S=[{name:h.RevokeRoutes.ShareModal,component:function(){var e=Object(f.default)(),t=Object(l.useRef)(null),n=Object(l.useState)(0),r=_()(n,2),i=r[0],c=r[1],s=Object(l.useMemo)((function(){return[e.formatMessage({id:"content__share_revoke_1"}),e.formatMessage({id:"content__share_revoke_2"}),e.formatMessage({id:"content__share_revoke_3"}),e.formatMessage({id:"content__share_revoke_4"})][i]}),[e,i]),d=Object(l.useCallback)((function(t){var n=t.close;Object(R.copyToClipboard)(s),j.default.show({title:e.formatMessage({id:"msg__copied"})}),null==n||n()}),[s,e]),p=Object(l.useCallback)(function(){var e=g()((function*(e){var n,r=e.close;if(yield null==(n=t.current)||null==n.capture?void 0:n.capture()){var o=yield C(),a={type:"text/plain",title:"Share",message:s};if(!o)return;yield o.open(a).catch((function(e){k.default.common.error("share revoke error",e),d({close:r})})).finally((function(){null==r||r()}))}}));return function(t){return e.apply(this,arguments)}}(),[s,d]);return Object(m.jsx)(o.default,{header:e.formatMessage({id:"title__share"}),height:"560px",hidePrimaryAction:!0,onPrimaryActionPress:p,onSecondaryActionPress:d,primaryActionTranslationId:"action__share",secondaryActionTranslationId:"action__copy",children:Object(m.jsx)(a.default,{pt:"6",children:Object(m.jsxs)(A.default,{ref:t,children:[Object(m.jsx)(u.default.DisplayLarge,{textAlign:"center",mb:"1",children:e.formatMessage({id:"title__share_with_your_friends"})}),Object(m.jsx)(u.default.Body2,{textAlign:"center",mb:"6",children:e.formatMessage({id:"title__share_with_your_friends_desc"})}),Object(m.jsxs)(b.default,{alignItems:"center",borderWidth:"1",borderRadius:12,borderColor:"border-default",bg:"action-secondary-default",p:3,children:[Object(m.jsx)(y.default,{flex:"1",children:s}),Object(m.jsx)(v.default,{name:"ArrowPathMini",type:"plain",onPress:function(){return c(i>=3?0:i+1)}})]})]})})})}},{name:h.RevokeRoutes.ChangeAllowance,component:function(){var e=Object(f.default)(),t=Object(d.useRoute)().params,n=t.dapp,r=t.balance,b=t.token,v=t.networkId,y=t.allowance,j=Object(p.useUpdateAllowance)({networkId:v,spender:n.spender,contract:b.tokenIdOnNetwork}),O=Object(s.default)({mode:"onChange",defaultValues:{allowance:"unlimited"===y?"0":y,isUnlimited:"unlimited"===y}}),_=O.control,w=O.handleSubmit,g=O.watch,A=r+" "+b.symbol,R=g("isUnlimited"),k=Object(l.useCallback)((function(e){j({amount:e,assetType:h.AssetType.tokens})}),[j]),C=Object(l.useCallback)((function(e){e.isUnlimited?k("unlimited"):k(String(e.allowance))}),[k]);return Object(m.jsx)(o.default,{header:e.formatMessage({id:"action__change_allowance"}),hideSecondaryAction:!0,onPrimaryActionPress:function(e){var t=e.close;null==t||t(),setTimeout((function(){w((function(e){return C(e)}))()}),600)},primaryActionTranslationId:"action__change",children:Object(m.jsxs)(a.default,{children:[Object(m.jsx)(c.default,{token:n,size:5,showInfo:!0}),Object(m.jsxs)(i.default,{mt:"3",children:[Object(m.jsx)(i.default.Item,{name:"isUnlimited",control:_,children:Object(m.jsx)(i.default.Switch,{isFullMode:!0,label:e.formatMessage({id:"form__unlimited_allowance"})})}),R?null:Object(m.jsx)(i.default.Item,{name:"allowance",label:e.formatMessage({id:"form__allowance"}),control:_,rules:{pattern:{value:/^\d+(\.\d+)?$/g,message:e.formatMessage({id:"form__enter_a_number_greater_than_or_equal_to_0"})},required:{value:!0,message:e.formatMessage({id:"form__field_is_required"})}},children:Object(m.jsx)(i.default.Input,{type:"string"})})]}),Object(m.jsx)(u.default.Body2,{mt:"2",children:""+e.formatMessage({id:"content__balance_str"},{0:A})})]})})}}];t.default=function(){var e=Object(r.default)();return Object(m.jsx)(I.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:S.map((function(e){return Object(m.jsx)(I.Screen,{name:e.name,component:e.component},e.name)}))})}}}]);