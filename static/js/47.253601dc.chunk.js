(this.webpackJsonp=this.webpackJsonp||[]).push([[47],{3903:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringBase",(function(){return h})),r.d(t,"KeyringBaseMock",(function(){return y}));var n=r(2),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(14),d=r.n(s),l=r(7),f=r.n(l);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var o=f()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var h=function(e){u()(r,e);var t=p(r);function r(e){var r;return(r=t.call(this,e.options)).vault=e,r}return r.prototype.addressFromBase=function(){var e=o()((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),a()(r)}(r(1585).VaultContext),y=function(e){u()(r,e);var t=p(r);function r(){return t.apply(this,arguments)}return a()(r)}(h)},3905:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringSoftwareBase",(function(){return O}));var n=r(4),o=r.n(n),i=r(3),a=r.n(i),c=r(2),u=r.n(c),s=r(6),d=r.n(s),l=r(9),f=r.n(l),p=r(14),h=r.n(p),y=r(7),v=r.n(y),w=r(19),g=r(23);function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var o=v()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return h()(this,r)}}var O=function(e){f()(r,e);var t=T(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.signTransaction=function(){var e=u()((function*(e,t){var r=t.password;if("undefined"===typeof r)throw new g.OneKeyInternalError("Software signing requires a password.");var n=yield this.getSigners(r,e.inputs.map((function(e){return e.address})));return w.default.engine.info("signTransaction",this.networkId,e),I(I({},yield this.engine.providerManager.signTransaction(this.networkId,e,n)),{},{encodedTx:e.encodedTx})}));return function(t,r){return e.apply(this,arguments)}}(),n.signMessage=function(){var e=u()((function*(e,t){var r=this,n=t.password;if("undefined"===typeof n)throw new g.OneKeyInternalError("Software signing requires a password.");var i=yield this.getDbAccount(),a=Object.values(yield this.getSigners(n,[i.address])),c=o()(a,1)[0];return w.default.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return r.engine.providerManager.signMessage(r.networkId,e,c)})))}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},d()(r)}(r(3903).KeyringBase)},3912:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"VaultBaseChainOnly",(function(){return R})),r.d(t,"VaultBase",(function(){return K}));var n=r(202),o=r.n(n),i=r(3),a=r.n(i),c=r(60),u=r.n(c),s=r(2),d=r.n(s),l=r(6),f=r.n(l),p=r(9),h=r.n(p),y=r(14),v=r.n(y),w=r(7),g=r.n(w),m=r(21),I=r.n(m),T=r(167),O=r.n(T),E=r(11),b=r(19),A=r(24),x=r(68),P=r(23),C=r(182),N=r(947),S=r(52),k=r(1585);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function F(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var o=g()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return v()(this,r)}}if(A.default.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var R=function(e){h()(r,e);var t=F(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.initProvider=function(){var e=d()((function*(){var e=(yield this.getNetwork()).impl;u()(N.IMPL_MAPPINGS[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),n.proxyJsonRPCCall=function(){var e=d()((function*(e){throw new P.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.createClientFromURL=function(e){throw new P.NotImplemented},n.getEthersProvider=function(){var e=d()((function*(){throw new P.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.getClientEndpointStatus=function(){var e=d()((function*(e){var t=this.createClientFromURL(e),r=performance.now(),n=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-r),latestBlock:n}}));return function(t){return e.apply(this,arguments)}}(),n.checkRpcBatchSupport=function(){var e=d()((function*(e){throw new P.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.getDisplayAddress=function(){var e=d()((function*(e){return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),n.validateAddress=function(){var e=d()((function*(e){var t=yield this.engineProvider.verifyAddress(e),r=t.normalizedAddress;if(!t.isValid||!r)throw new P.InvalidAddress;return Promise.resolve(r)}));return function(t){return e.apply(this,arguments)}}(),n.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},n.validateWatchingCredential=function(){var e=d()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),n.validateTokenAddress=function(){var e=d()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),r=t.normalizedAddress;if(!t.isValid||"undefined"===typeof r)throw new P.InvalidTokenAddress;return Promise.resolve(r)}));return function(t){return e.apply(this,arguments)}}(),n.validateCanCreateNextAccount=function(){var e=d()((function*(e,t){return Promise.resolve(!0)}));return function(t,r){return e.apply(this,arguments)}}(),n.checkAccountExistence=function(){var e=d()((function*(e,t){return Promise.resolve(!0)}));return function(t,r){return e.apply(this,arguments)}}(),n.getBalances=function(){var e=d()((function*(e,t,r){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,r=e.tokenAddress;return{address:t,coin:B({},"string"===typeof r?{tokenAddress:r}:{})}})))}));return function(t,r,n){return e.apply(this,arguments)}}(),n.getFrozenBalance=function(){var e=d()((function*(e){return 0}));return function(t){return e.apply(this,arguments)}}(),n.fetchBalanceDetails=function(){var e=d()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password;return Promise.resolve(void 0)}));return function(){return e.apply(this,arguments)}}(),n.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},n.getTransactionFeeInNative=function(e){return Promise.resolve("")},n.isContractAddress=function(){var e=d()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNameInfoMap=function(){var e=d()((function*(){var e=yield this.getNetwork();return Object(C.getAccountNameInfoByImpl)(e.impl)}));return function(){return e.apply(this,arguments)}}(),n.canAutoCreateNextAccount=function(){var e=d()((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),n.filterAccounts=function(){var e=d()((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),n.shouldChangeAccountWhenNetworkChanged=function(){var e=d()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=d()((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),n.checkIsUnlimitedAllowance=function(){var e=d()((function*(e){throw new P.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.checkIsApprovedForAll=function(){var e=d()((function*(e){throw new P.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.checkIsBatchTransfer=function(){var e=d()((function*(e){throw new P.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.getFeePricePerUnit=function(){var e=d()((function*(){throw new P.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.fetchRpcChainId=function(){var e=d()((function*(e){return null}));return function(t){return e.apply(this,arguments)}}(),n.getTxWaitingSeconds=function(){var e=d()((function*(){return[]}));return function(){return e.apply(this,arguments)}}(),n.getUserNFTAssets=function(){var e=d()((function*(e){e.serviceData;return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),f()(r)}(k.VaultContext),K=function(t){h()(n,t);var r=F(n);function n(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).uuid=O.a.v4().toString(),e}var i=n.prototype;return i.init=function(){var e=d()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),i.initKeyring=function(){var e=d()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),i.signTransaction=function(){var e=d()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),i.signAndSendTransaction=function(){var e=d()((function*(e,t,r){var n=yield this.signTransaction(e,t);return r?B(B({},n),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(B(B({},n),{},{encodedTx:e.encodedTx}))}));return function(t,r,n){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=d()((function*(e,t){b.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var r=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return b.default.engine.info("broadcastTransaction END:",{txid:r,rawTx:e.rawTx}),B(B({},e),{},{txid:r,encodedTx:e.encodedTx})}));return function(t,r){return e.apply(this,arguments)}}(),i.buildEncodedTxFromBatchTransfer=function(){var e=d()((function*(e){throw new P.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),i.buildEncodedTxsFromSetApproveForAll=function(){var e=d()((function*(e,t){throw new P.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),i.activateAccount=function(){var e=d()((function*(){throw new P.NotImplemented}));return function(){return e.apply(this,arguments)}}(),i.activateToken=function(){var e=d()((function*(e,t){throw new P.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),i.getTokenAllowance=function(){var e=d()((function*(e,t){throw new P.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),i.batchTokensAllowance=function(){var e=d()((function*(e,t){throw new P.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),i.getOutputAccount=function(){var e=d()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:o()(e,"pub","")}}));return function(){return e.apply(this,arguments)}}(),i.getAccountBalance=function(){var e=d()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=yield this.getDbAccount(),i=o.address;return this.getBalances((t?[{address:i}]:[]).concat(e.map((function(e){return{address:i,tokenAddress:e}}))),r,n)}));return function(t){return e.apply(this,arguments)}}(),i.updatePendingTxs=function(){var e=d()((function*(e){throw new P.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),i.getAccountNonce=function(){var e=d()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),i.fixActionDirection=function(){var e=d()((function*(e){var t,r,n,o,i=e.action,a=e.accountAddress;(i.direction=S.IDecodedTxDirection.OTHER,i.type===S.IDecodedTxActionType.NATIVE_TRANSFER)&&(i.direction=yield this.buildTxActionDirection({from:(null==(t=i.nativeTransfer)?void 0:t.from)||"",to:(null==(r=i.nativeTransfer)?void 0:r.to)||"",address:a}));i.type===S.IDecodedTxActionType.TOKEN_TRANSFER&&(i.direction=yield this.buildTxActionDirection({from:(null==(n=i.tokenTransfer)?void 0:n.from)||"",to:(null==(o=i.tokenTransfer)?void 0:o.to)||"",address:a}));return i}));return function(t){return e.apply(this,arguments)}}(),i.fixDecodedTx=function(){var e=d()((function*(e){var t,r;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var n=null==(r=e.encodedTx)?void 0:r.nonce;e.nonce=u()(n)?e.nonce:new I.a(n).toNumber();for(var o=e.owner,i=0;i<e.actions.length;i+=1){var a=e.actions[i];yield this.fixActionDirection({action:a,accountAddress:o})}if(e.outputActions)for(var c=0;c<e.outputActions.length;c+=1){var s=e.outputActions[c];yield this.fixActionDirection({action:s,accountAddress:o})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.fixHistoryTx=function(){var e=d()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.buildHistoryTx=function(){var e=d()((function*(e){var t=e.historyTxToMerge,r=(e.encodedTx,e.decodedTx),n=e.signedTx,o=e.isSigner,i=e.isLocalCreated,a=(null==n?void 0:n.txid)||(null==r?void 0:r.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var c=yield this.getAccountAddress();r.txid=a||r.txid,r.owner=c,o&&(r.signer=c),null!=n&&n.txKey&&(r.extraInfo?r.extraInfo.txKey=n.txKey:r.extraInfo={txKey:n.txKey});var u=B(B({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(i)},t),{},{decodedTx:r});return u=yield this.fixHistoryTx(u),Promise.resolve(u)}));return function(t){return e.apply(this,arguments)}}(),i.checkIsScamHistoryTx=function(){var e=d()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=d()((function*(e){throw new P.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),i.fixAddressCase=function(e){return Promise.resolve(e)},i.buildTxActionDirection=function(){var e=d()((function*(e){var t=e.from,r=e.to,n=e.address;return t=yield this.fixAddressCase(t||""),r=yield this.fixAddressCase(r),n=yield this.fixAddressCase(n),t===r&&t===n?S.IDecodedTxDirection.SELF:t&&t===n?S.IDecodedTxDirection.OUT:r&&r===n?S.IDecodedTxDirection.IN:S.IDecodedTxDirection.OTHER}));return function(t){return e.apply(this,arguments)}}(),i.getNextNonce=function(){var e=d()((function*(e,t){var r,n,o=null!=(r=null==(n=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:n.nonce)?r:0,i=(yield this.engine.getHistory(e,t.id,void 0,!1),yield x.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),a=yield x.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),c=Math.max(u()(i)?0:i+1,o);if(Number.isNaN(c)&&(c=o),c>o)for(var s=o;s<c;s+=1)if(!a.includes(s)){c=s;break}if(c<o&&(c=o),c-o>=E.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new P.PendingQueueTooLong(E.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return c}));return function(t,r){return e.apply(this,arguments)}}(),i.validateSendAmount=function(e,t,r){return Promise.resolve(!0)},i.notifyChainChanged=function(e,t){},i.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},i.getPrivateKeyByCredential=function(t){return Promise.resolve(e.from(t.startsWith("0x")?t.slice(2):t,"hex"))},i.getMinDepositAmount=function(){var e=d()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),i.specialCheckEncodedTx=function(){var e=d()((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),i.getAllUsedAddress=function(){var e=d()((function*(){return Promise.resolve([])}));return function(){return e.apply(this,arguments)}}(),f()(n)}(R)}.call(this,r(26).Buffer)},3913:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"KeyringHardwareBase",(function(){return v}));var n=r(2),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(14),d=r.n(s),l=r(7),f=r.n(l),p=r(431),h=r(163);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var o=f()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var v=function(t){u()(n,t);var r=y(n);function n(){return r.apply(this,arguments)}var i=n.prototype;return i.getHardwareInfo=function(){var e=o()((function*(){var e,t,r,n=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==n?void 0:n.mac)?e:"",deviceId:null!=(t=null==n?void 0:n.deviceId)?t:"",deviceType:null!=(r=null==n?void 0:n.deviceType)?r:""}}));return function(){return e.apply(this,arguments)}}(),i.getWalletPassphraseState=function(){var e=o()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(h.isPassphraseWallet)(e)}}));return function(){return e.apply(this,arguments)}}(),i.getHardwareSDKInstance=function(){var t=o()((function*(){var t,r,n,o,i;return null!=(i=yield null==(t=e)||null==(r=t.$backgroundApiProxy)||null==(n=r.backgroundApi)||null==(o=n.serviceHardware)||null==o.getSDKInstance?void 0:o.getSDKInstance())?i:p.HardwareSDK}));return function(){return t.apply(this,arguments)}}(),i.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},a()(n)}(r(3903).KeyringBase)}.call(this,r(58))},3914:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringHdBase",(function(){return I}));var n=r(3),o=r.n(n),i=r(2),a=r.n(i),c=r(6),u=r.n(c),s=r(9),d=r.n(s),l=r(14),f=r.n(l),p=r(7),h=r.n(p),y=r(610),v=r(23);function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f()(this,r)}}var I=function(e){d()(r,e);var t=m(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getPrivateKeys=function(){var e=a()((function*(e,t){var r=(yield this.getDbAccount()).path.split("/"),n=t||[r.pop()],o=r.join("/"),i=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof i)throw new v.OneKeyInternalError("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(y.batchGetPrivateKeys)(a,i,e,o,n).reduce((function(e,t){var r;return g(g({},e),{},((r={})[t.path]=t.extendedKey.key,r))}),{})}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},u()(r)}(r(3905).KeyringSoftwareBase)},3915:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringImportedBase",(function(){return y}));var n=r(2),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(14),d=r.n(s),l=r(7),f=r.n(l),p=r(23);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var o=f()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var y=function(e){u()(r,e);var t=h(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getPrivateKeys=function(){var e=o()((function*(e,t){if("undefined"!==typeof t)throw new p.NotImplemented("Getting private keys from extended private key");var r=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof r)throw new p.OneKeyInternalError("Unable to get credential.");return{"":r}}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(r)}(r(3905).KeyringSoftwareBase)},3916:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringWatchingBase",(function(){return y}));var n=r(2),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(14),d=r.n(s),l=r(7),f=r.n(l),p=r(23);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var o=f()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var y=function(e){u()(r,e);var t=h(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.signTransaction=function(){var e=o()((function*(e,t){throw new p.OneKeyInternalError("signTransaction is not supported for watching accounts")}));return function(t,r){return e.apply(this,arguments)}}(),n.signMessage=function(){var e=o()((function*(e,t){throw new p.OneKeyInternalError("signMessage is not supported for watching accounts")}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(r)}(r(3903).KeyringBase)},3918:function(e,t,r){"use strict";r.r(t),r.d(t,"convertDeviceError",(function(){return c}));var n=r(70),o=r(90),i=r(19);r(24);function a(e,t){return"string"!==typeof t?null:e===n.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new o.ConnectTimeoutError({message:t}):t.includes("Bridge network error")?new o.BridgeNetworkError({message:t}):null}function c(e){var t,r=e||{},c=r.code,u=r.error,s=r.message,d=null!=(t=null!=u?u:s)?t:"Unknown error";if(a(c,d))return a(c,d);switch(i.default.hardwareSDK.info("Device Utils Convert Device Error:",c,d),c){case n.HardwareErrorCode.UnknownError:return new o.UnknownHardwareError(e);case n.HardwareErrorCode.DeviceFwException:return new o.FirmwareVersionTooLow(e);case n.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof d&&-1!==d.indexOf("ui-device_bootloader_mode")?new o.NotInBootLoaderMode(e):new o.UnknownHardwareError(e);case n.HardwareErrorCode.DeviceCheckDeviceIdError:return new o.DeviceNotSame(e);case n.HardwareErrorCode.DeviceNotFound:return new o.DeviceNotFind(e);case n.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new o.NotInBootLoaderMode(e);case n.HardwareErrorCode.DeviceInterruptedFromOutside:case n.HardwareErrorCode.DeviceInterruptedFromUser:return new o.UserCancelFromOutside(e);case n.HardwareErrorCode.DeviceNotSupportPassphrase:return new o.NotSupportPassphraseError(e);case n.HardwareErrorCode.IFrameLoadFail:return new o.InitIframeLoadFail(e);case n.HardwareErrorCode.IframeTimeout:return new o.InitIframeTimeout(e);case n.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new o.FirmwareDownloadFailed(e);case n.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new o.FirmwareUpdateManuallyEnterBoot(e);case n.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new o.FirmwareUpdateAutoEnterBootFailure(e);case n.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new o.FirmwareUpdateLimitOneDevice(e);case n.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new o.FirmwareVersionTooLow(e);case n.HardwareErrorCode.NewFirmwareUnRelease:return new o.NewFirmwareUnRelease(e);case n.HardwareErrorCode.NewFirmwareForceUpdate:return new o.NewFirmwareForceUpdate(e);case n.HardwareErrorCode.NetworkError:return new o.NetworkError(e);case n.HardwareErrorCode.BlePermissionError:return new o.NeedBluetoothTurnedOn(e);case n.HardwareErrorCode.BleLocationError:return new o.NeedBluetoothPermissions({message:d});case n.HardwareErrorCode.BleLocationServicesDisabled:return new o.BleLocationServiceError({message:d});case n.HardwareErrorCode.BleDeviceNotBonded:return new o.DeviceNotBonded(e);case n.HardwareErrorCode.BleDeviceBondError:return new o.DeviceBondError(e);case n.HardwareErrorCode.BleWriteCharacteristicError:return new o.BleWriteCharacteristicError(e);case n.HardwareErrorCode.BleScanError:return new o.BleScanError({message:d});case n.HardwareErrorCode.BleAlreadyConnected:return new o.BleAlreadyConnectedError(e);case n.HardwareErrorCode.RuntimeError:return-1!==d.indexOf("EIP712 blind sign is disabled")?new o.OpenBlindSign(e):-1!==d.indexOf("Unknown message")||-1!==d.indexOf("Failure_UnexpectedMessage")?new o.UnknownMethod(e):new o.UnknownHardwareError(e);case n.HardwareErrorCode.PinInvalid:return new o.InvalidPIN(e);case n.HardwareErrorCode.DeviceCheckPassphraseStateError:return new o.InvalidPassphrase(e);case n.HardwareErrorCode.DeviceOpenedPassphrase:return new o.DeviceOpenedPassphrase(e);case n.HardwareErrorCode.DeviceNotOpenedPassphrase:return new o.DeviceNotOpenedPassphrase(e);case n.HardwareErrorCode.PinCancelled:case n.HardwareErrorCode.ActionCancelled:return new o.UserCancel(e);case n.HardwareErrorCode.BridgeNotInstalled:case o.CustomOneKeyHardwareError.NeedOneKeyBridge:return new o.NeedOneKeyBridge(e);case n.HardwareErrorCode.BridgeNetworkError:return new o.BridgeNetworkError(e);case n.HardwareErrorCode.BridgeTimeoutError:return new o.BridgeTimeoutError(e);case n.HardwareErrorCode.PollingTimeout:return new o.ConnectTimeoutError(e);case n.HardwareErrorCode.PollingStop:return new o.ConnectPollingStopError(e);case n.HardwareErrorCode.BlindSignDisabled:return new o.OpenBlindSign(e);case n.HardwareErrorCode.FileAlreadyExists:return new o.FileAlreadyExistError(e);case n.HardwareErrorCode.CheckDownloadFileError:return new o.IncompleteFileError(e);case n.HardwareErrorCode.NotInSigningMode:return new o.NotInSigningModeError(e);default:return new o.UnknownHardwareError(e)}}},4120:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"getCID",(function(){return w})),r.d(t,"getDigest",(function(){return g})),r.d(t,"validateNetworkPrefix",(function(){return m})),r.d(t,"signTransaction",(function(){return I})),r.d(t,"getTxStatus",(function(){return O})),r.d(t,"getDecodedTxStatus",(function(){return E}));var n=r(4),o=r.n(n),i=r(2),a=r.n(i),c=r(4544),u=r(4235),s=r.n(u),d=r(780),l=r.n(d),f=r(367),p=r(23),h=r(52),y=r(4237),v=e.from([1,113,160,228,2,32]);function w(t){var r=l.a.blake2bInit(32);l.a.blake2bUpdate(r,t);var n=e.from(l.a.blake2bFinal(r));return e.concat([v,n])}function g(t){var r=l.a.blake2bInit(32);return l.a.blake2bUpdate(r,w(t)),e.from(l.a.blake2bFinal(r))}var m=function(e){return Object.values(c.NetworkPrefix).includes(e)};function I(e,t){return T.apply(this,arguments)}function T(){return(T=a()((function*(t,r){var n=t.encodedTx,i=e.concat;e.concat=function(t,r){return i(t.map((function(t){return e.from(t)})),r)},c.AddressSecp256k1.fromString=function(t){var r=t[0],n=t[1];if(!m(r))throw new p.OneKeyInternalError("Invalid filecoin network.");if(parseInt(n)!==y.ProtocolIndicator.SECP256K1)throw new p.OneKeyInternalError("Invalid filecoin protocol indicator.");var o=e.from(s()(t.substring(2).toUpperCase(),"RFC4648")),i=o.subarray(0,-4),a=o.subarray(-4),u=new c.AddressSecp256k1(r,i);if(e.from(u.getChecksum()).toString("hex")!==e.from(a).toString("hex"))throw new p.OneKeyInternalError("Invalid filecoin checksum network.");return u};var a=c.Transaction.fromJSON(n),u=g(yield a.serialize()),d=yield r.sign(u),l=o()(d,2),f=l[0],h=l[1],v=e.concat([e.from(f),e.from([h])]);return e.concat=i,Promise.resolve({txid:"",rawTx:JSON.stringify({Message:n,Signature:{Data:v.toString("base64"),Type:y.ProtocolIndicator.SECP256K1}})})}))).apply(this,arguments)}function O(e,t){return t&&"OK"===e?f.TransactionStatus.CONFIRM_AND_SUCCESS:null!=e&&e.toLowerCase().includes("err")?f.TransactionStatus.CONFIRM_BUT_FAILED:f.TransactionStatus.PENDING}function E(e,t){return t&&"OK"===e?h.IDecodedTxStatus.Confirmed:null!=e&&e.toLowerCase().includes("err")?h.IDecodedTxStatus.Failed:h.IDecodedTxStatus.Pending}}.call(this,r(26).Buffer)},4237:function(e,t,r){"use strict";var n,o,i;r.r(t),r.d(t,"ChainId",(function(){return n})),r.d(t,"ProtocolIndicator",(function(){return o})),r.d(t,"TransferMethod",(function(){return i})),r.d(t,"FIL_UNIT_MAP",(function(){return a})),function(e){e.MAIN="314",e.CALIBRATION="314159"}(n||(n={})),function(e){e[e.ID=0]="ID",e[e.SECP256K1=1]="SECP256K1",e[e.ACTOR=2]="ACTOR",e[e.BLS=3]="BLS",e[e.DELEGATED=4]="DELEGATED"}(o||(o={})),function(e){e[e.FIL=0]="FIL",e[e.EVM=3844450837]="EVM"}(i||(i={}));var a={FIL:0,milliFIL:3,microFIL:6,nanoFIL:9,picoFIL:12,femtoFIL:15,attoFIL:18}},4930:function(e,t){},4940:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"KeyringHardware",(function(){return S}));var n=r(3),o=r.n(n),i=r(2),a=r.n(i),c=r(6),u=r.n(c),s=r(9),d=r.n(s),l=r(14),f=r.n(l),p=r(7),h=r.n(p),y=r(4544),v=r(4235),w=r.n(v),g=r(3918),m=r(11),I=r(19),T=r(23),O=r(117),E=r(3913),b=r(4237),A=r(4120);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){o()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f()(this,r)}}var N="m/44'/"+m.COINTYPE_FIL+"'/0'/0",S=function(t){d()(n,t);var r=C(n);function n(){return r.apply(this,arguments)}var o=n.prototype;return o.prepareAccounts=function(){var e=a()((function*(e){var t,r=e.indexes,n=e.names,o=r.map((function(e){return N+"/"+e})),i=yield this.getHardwareSDKInstance(),a=yield this.getHardwareInfo(),c=a.connectId,u=a.deviceId,s=yield this.getWalletPassphraseState(),d=yield this.getNetwork();try{t=yield i.filecoinGetAddress(c,u,P({bundle:o.map((function(e){return{path:e,showOnOneKey:!1,isTestnet:d.isTestnet}}))},s))}catch(E){throw I.default.common.error(E),new T.OneKeyHardwareError(E)}if(!t.success)throw I.default.common.error(t.payload),Object(g.convertDeviceError)(t.payload);var l=[],f=0;for(var p of t.payload){var h=p.address,y=p.path;if(h){var v,w=(n||[])[f]||"FIL #"+(r[f]+1);l.push({id:this.walletId+"--"+y,name:w,type:O.AccountType.VARIANT,path:y,coinType:m.COINTYPE_FIL,pub:"",address:h,addresses:(v={},v[this.networkId]=h,v)}),f+=1}}return l}));return function(t){return e.apply(this,arguments)}}(),o.getAddress=function(){var e=a()((function*(e){var t,r=yield this.getNetwork(),n=yield this.getHardwareSDKInstance(),o=yield this.getHardwareInfo(),i=o.connectId,a=o.deviceId,c=yield this.getWalletPassphraseState(),u=yield n.filecoinGetAddress(i,a,P({path:e.path,showOnOneKey:e.showOnOneKey,isTestnet:r.isTestnet},c));if(u.success&&null!=(t=u.payload)&&t.address)return u.payload.address;throw Object(g.convertDeviceError)(u.payload)}));return function(t){return e.apply(this,arguments)}}(),o.batchGetAddress=function(){var e=a()((function*(e){var t=yield this.getNetwork(),r=yield this.getHardwareSDKInstance(),n=yield this.getHardwareInfo(),o=n.connectId,i=n.deviceId,a=yield this.getWalletPassphraseState(),c=yield r.filecoinGetAddress(o,i,P(P({},a),{},{bundle:e.map((function(e){return{path:e.path,showOnOneKey:!!e.showOnOneKey,isTestnet:t.isTestnet}}))}));if(!c.success)throw Object(g.convertDeviceError)(c.payload);return c.payload.map((function(e){var t,r;return{path:null!=(t=e.path)?t:"",address:null!=(r=e.address)?r:""}}))}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var t=a()((function*(t){var r=yield this.getHardwareSDKInstance(),n=yield this.getNetwork(),o=yield this.getAccountPath(),i=yield this.getHardwareInfo(),a=i.connectId,c=i.deviceId,u=yield this.getWalletPassphraseState(),s=t.encodedTx,d=e.concat;e.concat=function(t,r){return d(t.map((function(t){return e.from(t)})),r)},y.AddressSecp256k1.fromString=function(t){var r=t[0],n=t[1];if(!Object(A.validateNetworkPrefix)(r))throw new T.OneKeyInternalError("Invalid filecoin network.");if(parseInt(n)!==b.ProtocolIndicator.SECP256K1)throw new T.OneKeyInternalError("Invalid filecoin protocol indicator.");var o=e.from(w()(t.substring(2).toUpperCase(),"RFC4648")),i=o.subarray(0,-4),a=o.subarray(-4),c=new y.AddressSecp256k1(r,i);if(e.from(c.getChecksum()).toString("hex")!==e.from(a).toString("hex"))throw new T.OneKeyInternalError("Invalid filecoin checksum network.");return c};var l=yield y.Transaction.fromJSON(s).serialize();e.concat=d;var f=yield r.filecoinSignTransaction(a,c,P({path:o,rawTx:e.from(l).toString("hex"),isTestnet:n.isTestnet},u));if(f.success){var p=f.payload.signature;return Promise.resolve({txid:"",rawTx:JSON.stringify({Message:s,Signature:{Data:e.from(p,"hex").toString("base64"),Type:b.ProtocolIndicator.SECP256K1}})})}throw Object(g.convertDeviceError)(f.payload)}));return function(e){return t.apply(this,arguments)}}(),o.signMessage=function(){throw new T.NotImplemented},u()(n)}(E.KeyringHardwareBase)}.call(this,r(26).Buffer)},4941:function(e,t){},4948:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringHd",(function(){return b}));var n=r(2),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(14),d=r.n(s),l=r(7),f=r.n(l),p=r(4080),h=r(610),y=r(748),v=r(11),w=r(23),g=r(1345),m=r(117),I=r(3914),T=r(4120);function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var o=f()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var E="m/44'/"+v.COINTYPE_FIL+"'/0'/0",b=function(e){u()(r,e);var t=O(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.signTransaction=function(){var e=o()((function*(e,t){var r=(yield this.getDbAccount()).addresses[this.networkId],n=(yield this.getSigners(t.password||"",[r]))[r];return Object(T.signTransaction)(e,n)}));return function(t,r){return e.apply(this,arguments)}}(),n.getSigners=function(){var e=o()((function*(e,t){var r,n=yield this.getDbAccount(),o=n.addresses[this.networkId];if(1!==t.length)throw new w.OneKeyInternalError("FIL signers number should be 1.");if(t[0]!==o)throw new w.OneKeyInternalError("Wrong address required for signing.");var i=(yield this.getPrivateKeys(e))[n.path];if("undefined"===typeof i)throw new w.OneKeyInternalError("Unable to get signer.");return(r={})[o]=new g.Signer(i,e,"secp256k1"),r}));return function(t,r){return e.apply(this,arguments)}}(),n.prepareAccounts=function(){var e=o()((function*(e){var t=e.password,r=e.indexes,n=e.names,o=(yield this.engine.dbApi.getCredential(this.walletId,t)).seed,i=yield this.getNetwork(),a=Object(h.batchGetPublicKeys)("secp256k1",o,t,E,r.map((function(e){return e.toString()})));if(a.length!==r.length)throw new w.OneKeyInternalError("Unable to get publick key.");var c=[],u=0;for(var s of a){var d,l=s.path,f=s.extendedKey.key,g=y.secp256k1.transformPublicKey(f),I=g.toString("hex"),T=Object(p.newSecp256k1Address)(g,i.isTestnet?p.CoinType.TEST:p.CoinType.MAIN).toString(),O=(n||[])[u]||"FIL #"+(r[u]+1);c.push({id:this.walletId+"--"+l,name:O,type:m.AccountType.VARIANT,path:l,coinType:v.COINTYPE_FIL,pub:I,address:T,addresses:(d={},d[this.networkId]=T,d)}),u+=1}return c}));return function(t){return e.apply(this,arguments)}}(),a()(r)}(I.KeyringHdBase)},4949:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringImported",(function(){return b}));var n=r(4),o=r.n(n),i=r(2),a=r.n(i),c=r(6),u=r.n(c),s=r(9),d=r.n(s),l=r(14),f=r.n(l),p=r(7),h=r.n(p),y=r(4080),v=r(748),w=r(11),g=r(23),m=r(1345),I=r(117),T=r(3915),O=r(4120);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var o=h()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return f()(this,r)}}var b=function(e){d()(r,e);var t=E(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getSigners=function(){var e=a()((function*(e,t){var r,n=(yield this.getDbAccount()).addresses[this.networkId];if(1!==t.length)throw new g.OneKeyInternalError("FIL signers number should be 1.");if(t[0]!==n)throw new g.OneKeyInternalError("Wrong address required for signing.");var i=Object.values(yield this.getPrivateKeys(e)),a=o()(i,1)[0];return(r={})[n]=new m.Signer(a,e,"secp256k1"),r}));return function(t,r){return e.apply(this,arguments)}}(),n.prepareAccounts=function(){var e=a()((function*(e){var t,r=e.name,n=e.privateKey,o=yield this.getNetwork();if(32!==n.length)throw new g.OneKeyInternalError("Invalid private key.");var i=v.secp256k1.publicFromPrivate(n),a=v.secp256k1.transformPublicKey(i),c=i.toString("hex"),u=Object(y.newSecp256k1Address)(a,o.isTestnet?y.CoinType.TEST:y.CoinType.MAIN).toString();return Promise.resolve([{id:"imported--"+w.COINTYPE_FIL+"--"+c,name:r||"",type:I.AccountType.VARIANT,path:"",coinType:w.COINTYPE_FIL,pub:c,address:u,addresses:(t={},t[this.networkId]=u,t)}])}));return function(t){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=a()((function*(e,t){var r=(yield this.getDbAccount()).addresses[this.networkId],n=(yield this.getSigners(t.password||"",[r]))[r];return Object(O.signTransaction)(e,n)}));return function(t,r){return e.apply(this,arguments)}}(),u()(r)}(T.KeyringImportedBase)},4950:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringWatching",(function(){return g}));var n=r(2),o=r.n(n),i=r(6),a=r.n(i),c=r(9),u=r.n(c),s=r(14),d=r.n(s),l=r(7),f=r.n(l),p=r(4080),h=r(11),y=r(23),v=r(117);function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f()(e);if(t){var o=f()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return d()(this,r)}}var g=function(e){u()(r,e);var t=w(r);function r(){return t.apply(this,arguments)}return r.prototype.prepareAccounts=function(){var e=o()((function*(e){var t,r=e.name,n=e.target,o=e.accountIdPrefix,i=yield this.getNetwork(),a=Object(p.validateAddressString)(n),c=a?n.toLowerCase():void 0;if(!a||"undefined"===typeof c)throw new y.InvalidAddress;var u=Object(p.decode)(c),s=Object(p.encode)(i.isTestnet?p.CoinType.TEST:p.CoinType.MAIN,u);return[{id:o+"--"+h.COINTYPE_FIL+"--"+s,name:r||"",type:v.AccountType.VARIANT,path:"",coinType:h.COINTYPE_FIL,pub:"",address:s,addresses:(t={},t[this.networkId]=s,t)}]}));return function(t){return e.apply(this,arguments)}}(),a()(r)}(r(3916).KeyringWatchingBase)},6083:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"default",(function(){return Y}));var n=r(4),o=r.n(n),i=r(60),a=r.n(i),c=r(3),u=r.n(c),s=r(433),d=r.n(s),l=r(2),f=r.n(l),p=r(6),h=r.n(p),y=r(9),v=r.n(y),w=r(14),g=r.n(w),m=r(7),I=r.n(m),T=r(4080),O=r(4938),E=r(4939),b=r(107),A=r.n(b),x=r(21),P=r.n(x),C=r(565),N=r(112),S=r(46),k=r(19),D=r(150),B=r(23),F=r(130),R=r(52),K=r(3912),j=r(4940),H=r(4948),M=r(4949),L=r(4950),U=r(2726),_=r(4237),G=r(4120);function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function V(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){u()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=I()(e);if(t){var o=I()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return g()(this,r)}}var J="0",Y=function(t){v()(n,t);var r=z(n);function n(){for(var e,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return(e=r.call.apply(r,[this].concat(n))).keyringMap={hd:H.KeyringHd,hw:j.KeyringHardware,imported:M.KeyringImported,watching:L.KeyringWatching,external:L.KeyringWatching},e.settings=U.default,e.getClientCache=Object(D.memoizee)(function(){var e=f()((function*(e,t){return new E.default({apiAddress:e,namespace:t})}));return function(t,r){return e.apply(this,arguments)}}(),{primitive:!0,maxAge:Object(S.getTimeDurationMs)({minute:3})}),e.getScanClient=Object(D.memoizee)(f()((function*(){var t=(yield e.engine.getNetwork(e.networkId)).isTestnet?"https://calibration-api.filscout.com":"https://api2.filscout.com";return A.a.create({baseURL:t})})),{promise:!0,maxAge:Object(S.getTimeDurationMs)({minute:3})}),e}var i=n.prototype;return i.getClient=function(){var e=f()((function*(e){var t=(yield this.engine.getNetwork(this.networkId)).rpcURL;return this.getClientCache(null!=e?e:t,"Filecoin")}));return function(t){return e.apply(this,arguments)}}(),i.buildEncodedTxFromTransfer=function(){var e=f()((function*(e){if(!e.to)throw new Error("Invalid transferInfo.to params");var t=e.from,r=e.to,n=e.amount,o=yield this.getNetwork(),i=r;C.ethers.utils.isAddress(i)&&(i=Object(T.delegatedFromEthAddress)(r,o.isTestnet?T.CoinType.TEST:T.CoinType.MAIN));var a=Number(i[1])===_.ProtocolIndicator.DELEGATED?_.TransferMethod.EVM:_.TransferMethod.FIL,c=new P.a(n);return c.isNaN()&&(c=new P.a("0")),new O.Message({from:t,to:i,nonce:0,value:c.shiftedBy(o.decimals),method:a,params:""}).toLotusType()}));return function(t){return e.apply(this,arguments)}}(),i.updateEncodedTx=function(){var e=f()((function*(e,t,r){if(r.type===R.IEncodedTxUpdateType.transfer){var n=yield this.getNetwork();e.Value=new P.a(t.amount).shiftedBy(n.decimals).toFixed()}return Promise.resolve(e)}));return function(t,r,n){return e.apply(this,arguments)}}(),i.decodeTx=function(){var e=f()((function*(e,t){var r=yield this.engine.getNetwork(this.networkId),n=yield this.getAccountAddress(),o=yield this.engine.getNativeTokenInfo(this.networkId);return{txid:(d()(e.CID)?e.CID["/"]:e.CID)||"",owner:n,signer:e.From||n,nonce:e.Nonce||0,actions:[{type:R.IDecodedTxActionType.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:o,from:e.From,to:e.To,amount:new P.a(e.Value).shiftedBy(-r.decimals).toFixed(),amountValue:e.Value,extraInfo:null},direction:e.To===n?R.IDecodedTxDirection.SELF:R.IDecodedTxDirection.OUT}],status:R.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,encodedTx:e,payload:t,extraInfo:null}}));return function(t,r){return e.apply(this,arguments)}}(),i.fetchFeeInfo=function(){var e=f()((function*(e){var t=yield this.getClient(),r=yield this.engine.getNetwork(this.networkId),n=yield t.request("GasEstimateMessageGas",e,{},[]);J=n.GasPremium;var o=P.a.max(e.GasLimit,n.GasLimit);return{customDisabled:!0,limit:new P.a(o).toFixed(),prices:[new P.a(n.GasFeeCap).shiftedBy(-r.feeDecimals).toFixed()],defaultPresetIndex:"0",feeSymbol:r.feeSymbol,feeDecimals:r.feeDecimals,nativeSymbol:r.symbol,nativeDecimals:r.decimals,tx:null}}));return function(t){return e.apply(this,arguments)}}(),i.attachFeeInfoToEncodedTx=function(){var e=f()((function*(e){var t=yield this.getNetwork(),r=e.encodedTx,n=e.feeInfoValue,o=n.limit,i=n.price,c=V({},r);return a()(o)||(c.GasLimit=new P.a(o).toNumber()),a()(i)||(c.GasFeeCap=new P.a(i||"0.000000001").shiftedBy(t.feeDecimals).toFixed()),a()(J)||(c.GasPremium=J),Promise.resolve(c)}));return function(t){return e.apply(this,arguments)}}(),i.buildUnsignedTxFromEncodedTx=function(){var e=f()((function*(e){var t=yield this.getClient(),r=yield t.request("MpoolGetNonce",e.From);return e.Nonce=Number(r),Promise.resolve({inputs:[],outputs:[],payload:{encodedTx:e},encodedTx:e})}));return function(t){return e.apply(this,arguments)}}(),i.decodedTxToLegacy=function(e){return Promise.resolve({})},i.getExportedCredential=function(){var t=f()((function*(t){var r=yield this.getDbAccount();if(r.id.startsWith("hd-")||r.id.startsWith("imported")){var n=this.keyring,i=Object.values(yield n.getPrivateKeys(t)),a=o()(i,1)[0],c=Object(N.decrypt)(t,a).toString("base64");return e.from(JSON.stringify({Type:"secp256k1",PrivateKey:c})).toString("hex")}throw new B.OneKeyInternalError("Only credential of HD or imported accounts can be exported")}));return function(e){return t.apply(this,arguments)}}(),i.getTransactionFeeInNative=function(){var e=f()((function*(e){try{var t=yield this.getScanClient(),r=yield t.get("/api/v1/transaction/"+e),n=o()(r.data.data,2),i=n[0],a=n[1],c=i.value.split(" "),u=o()(c,2),s=u[0],d=u[1],l=a.value.split(" "),f=o()(l,2),p=f[0],h=f[1],y=new P.a(s.replaceAll(",","")).shiftedBy(-_.FIL_UNIT_MAP[d]),v=new P.a(p.replaceAll(",","")).shiftedBy(-_.FIL_UNIT_MAP[h]);return y.plus(v).toFixed()}catch(w){return""}}));return function(t){return e.apply(this,arguments)}}(),i.getTransactionStatuses=function(){var e=f()((function*(e){var t=this;return Promise.all(e.map(function(){var e=f()((function*(e){var r=yield t.getScanClient(),n=(yield r.get("/api/v1/message/"+e)).data.data;return Object(G.getTxStatus)(n.exitCodeName,n.cid)}));return function(t){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=f()((function*(e){var t=this,r=yield this.getScanClient(),n=e.localHistory,i=yield this.getAccountAddress(),a=yield this.engine.getNativeTokenInfo(this.networkId),c=[];try{c=(yield r.post("/api/v1/message",{address:i,blockCid:"",idAddress:"",method:"",pageIndex:1,pageSize:50,timeEnd:0,timeStart:0})).data.data}catch(s){}var u=c.map(function(){var e=f()((function*(e){try{var r,c,u=n.find((function(t){return t.decodedTx.txid===e.cid}));if(u&&u.decodedTx.isFinal)return null;var d=R.IDecodedTxDirection.OUT;e.to===i&&(d=e.from===i?R.IDecodedTxDirection.SELF:R.IDecodedTxDirection.IN);var l=e.value.split(" "),f=o()(l,2),p=f[0],h=f[1],y=new P.a(p.replaceAll(",","")),v={txid:null!=(r=e.cid)?r:"",owner:e.from,signer:e.from,nonce:0,actions:[{type:R.IDecodedTxActionType.NATIVE_TRANSFER,direction:d,nativeTransfer:{tokenInfo:a,from:e.from,to:e.to,amount:y.shiftedBy(-_.FIL_UNIT_MAP[h]).toFixed(),amountValue:y.shiftedBy(_.FIL_UNIT_MAP[h]).toFixed(),extraInfo:null}}],status:Object(G.getDecodedTxStatus)(e.exitCodeName,e.cid),networkId:t.networkId,accountId:t.accountId,extraInfo:null};return v.updatedAt=new Date(e.timeFormat).getTime(),v.createdAt=null!=(c=null==u?void 0:u.decodedTx.createdAt)?c:v.updatedAt,v.isFinal=v.status===R.IDecodedTxStatus.Confirmed,yield t.buildHistoryTx({decodedTx:v,historyTxToMerge:u})}catch(s){return Promise.resolve(null)}}));return function(t){return e.apply(this,arguments)}}());return(yield Promise.all(u)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),i.validateImportedCredential=function(e){var t=!1;return this.settings.importedAccountEnabled&&(t=/^(0x)?([a-fA-F0-9]{64}|[a-fA-F0-9]{160})$/g.test(e)),Promise.resolve(t)},i.getOutputAccount=function(){var e=f()((function*(){var e,t=yield this.getDbAccount({noCache:!0}),r={id:t.id,name:t.name,type:t.type,path:t.path,coinType:t.coinType,tokens:[],address:(null==(e=t.addresses)?void 0:e[this.networkId])||"",template:t.template};if(0===r.address.length&&Object(F.isAccountCompatibleWithNetwork)(t.id,this.networkId))try{var n=yield this.getNetwork(),o=Object(T.decode)(t.address),i=Object(T.encode)(n.isTestnet?T.CoinType.TEST:T.CoinType.MAIN,o);r.address=i,yield this.engine.dbApi.updateAccountAddresses(t.id,this.networkId,i)}catch(a){}return r}));return function(){return e.apply(this,arguments)}}(),i.getAccountAddress=function(){var e=f()((function*(){return(yield this.getOutputAccount()).address}));return function(){return e.apply(this,arguments)}}(),i.getAccountBalance=function(){var e=f()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=yield this.getAccountAddress();return this.getBalances((t?[{address:r}]:[]).concat(e.map((function(e){return{address:r,tokenAddress:e}}))))}));return function(t){return e.apply(this,arguments)}}(),i.getBalances=function(){var e=f()((function*(e){var t=yield this.getClient();return yield Promise.all(e.map(function(){var e=f()((function*(e){var r=e.address;try{var n=yield t.request("WalletBalance",r);return new P.a(n)}catch(i){var o;if(null!=i&&null!=(o=i.message)&&null!=o.includes&&o.includes("Account not found"))return new P.a(0);throw i}}));return function(t){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),i.validateWatchingCredential=function(){var e=f()((function*(e){var t=Object(T.validateAddressString)(e),r=t?e.toLowerCase():void 0;return!(!t||"undefined"===typeof r)}));return function(t){return e.apply(this,arguments)}}(),i.validateAddress=function(){var e=f()((function*(e){if(Object(T.validateAddressString)(e))return e.toLowerCase();if(C.ethers.utils.isAddress(e)){var t=(yield this.getNetwork()).isTestnet;return Object(T.delegatedFromEthAddress)(e,t?T.CoinType.TEST:T.CoinType.MAIN).toLowerCase()}throw new B.InvalidAddress}));return function(t){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=f()((function*(e){k.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var t,r=yield this.getClient();try{t=yield r.request("MpoolPush",JSON.parse(e.rawTx))}catch(n){throw k.default.sendTx.info("broadcastTransaction ERROR:",n),n}return k.default.engine.info("broadcastTransaction END:",{txid:e.txid,rawTx:e.rawTx}),V(V({},e),{},{txid:d()(t)?t["/"]:t,encodedTx:e.encodedTx})}));return function(t){return e.apply(this,arguments)}}(),i.getPrivateKeyByCredential=function(){var t=f()((function*(t){var r;if(160===t.length)try{var n=JSON.parse(e.from(t,"hex").toString());n.PrivateKey&&(r=e.from(n.PrivateKey,"base64"))}catch(o){}else 64===t.length&&(r=e.from(t,"hex"));return Promise.resolve(r)}));return function(e){return t.apply(this,arguments)}}(),i.addressFromBase=function(){var e=f()((function*(e){var t=(yield this.getNetwork()).isTestnet;return Object(T.encode)(t?T.CoinType.TEST:T.CoinType.MAIN,Object(T.decode)(e.address))}));return function(t){return e.apply(this,arguments)}}(),i.getClientEndpointStatus=function(){var e=f()((function*(e){var t=yield this.getClient(e),r=performance.now(),n=(yield t.request("ChainHead")).Height;return{responseTime:Math.floor(performance.now()-r),latestBlock:n}}));return function(t){return e.apply(this,arguments)}}(),h()(n)}(K.VaultBase)}.call(this,r(26).Buffer)}}]);