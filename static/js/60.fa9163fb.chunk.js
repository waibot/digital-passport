(this.webpackJsonp=this.webpackJsonp||[]).push([[60],{3903:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringBase",(function(){return y})),n.d(t,"KeyringBaseMock",(function(){return h}));var r=n(2),o=n.n(r),i=n(6),a=n.n(i),c=n(9),u=n.n(c),s=n(14),d=n.n(s),l=n(7),f=n.n(l);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var y=function(e){u()(n,e);var t=p(n);function n(e){var n;return(n=t.call(this,e.options)).vault=e,n}return n.prototype.addressFromBase=function(){var e=o()((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),a()(n)}(n(1585).VaultContext),h=function(e){u()(n,e);var t=p(n);function n(){return t.apply(this,arguments)}return a()(n)}(y)},3905:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringSoftwareBase",(function(){return O}));var r=n(4),o=n.n(r),i=n(3),a=n.n(i),c=n(2),u=n.n(c),s=n(6),d=n.n(s),l=n(9),f=n.n(l),p=n(14),y=n.n(p),h=n(7),v=n.n(h),g=n(19),w=n(23);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var o=v()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y()(this,n)}}var O=function(e){f()(n,e);var t=I(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=u()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new w.OneKeyInternalError("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return g.default.engine.info("signTransaction",this.networkId,e),T(T({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=u()((function*(e,t){var n=this,r=t.password;if("undefined"===typeof r)throw new w.OneKeyInternalError("Software signing requires a password.");var i=yield this.getDbAccount(),a=Object.values(yield this.getSigners(r,[i.address])),c=o()(a,1)[0];return g.default.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return n.engine.providerManager.signMessage(n.networkId,e,c)})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},d()(n)}(n(3903).KeyringBase)},3912:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"VaultBaseChainOnly",(function(){return F})),n.d(t,"VaultBase",(function(){return j}));var r=n(202),o=n.n(r),i=n(3),a=n.n(i),c=n(60),u=n.n(c),s=n(2),d=n.n(s),l=n(6),f=n.n(l),p=n(9),y=n.n(p),h=n(14),v=n.n(h),g=n(7),w=n.n(g),m=n(21),T=n.n(m),I=n(167),O=n.n(I),b=n(11),A=n(19),E=n(24),P=n(68),x=n(23),S=n(182),N=n(947),C=n(52),k=n(1585);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function R(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}if(E.default.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var F=function(e){y()(n,e);var t=R(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.initProvider=function(){var e=d()((function*(){var e=(yield this.getNetwork()).impl;u()(N.IMPL_MAPPINGS[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=d()((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new x.NotImplemented},r.getEthersProvider=function(){var e=d()((function*(){throw new x.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=d()((function*(e){var t=this.createClientFromURL(e),n=performance.now(),r=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r.checkRpcBatchSupport=function(){var e=d()((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.getDisplayAddress=function(){var e=d()((function*(e){return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=d()((function*(e){var t=yield this.engineProvider.verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||!n)throw new x.InvalidAddress;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=d()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=d()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new x.InvalidTokenAddress;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateCanCreateNextAccount=function(){var e=d()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=d()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=d()((function*(e,t,n){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:B({},"string"===typeof n?{tokenAddress:n}:{})}})))}));return function(t,n,r){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=d()((function*(e){return 0}));return function(t){return e.apply(this,arguments)}}(),r.fetchBalanceDetails=function(){var e=d()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password;return Promise.resolve(void 0)}));return function(){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=d()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfoMap=function(){var e=d()((function*(){var e=yield this.getNetwork();return Object(S.getAccountNameInfoByImpl)(e.impl)}));return function(){return e.apply(this,arguments)}}(),r.canAutoCreateNextAccount=function(){var e=d()((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=d()((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(){var e=d()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=d()((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),r.checkIsUnlimitedAllowance=function(){var e=d()((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.checkIsApprovedForAll=function(){var e=d()((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.checkIsBatchTransfer=function(){var e=d()((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.getFeePricePerUnit=function(){var e=d()((function*(){throw new x.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.fetchRpcChainId=function(){var e=d()((function*(e){return null}));return function(t){return e.apply(this,arguments)}}(),r.getTxWaitingSeconds=function(){var e=d()((function*(){return[]}));return function(){return e.apply(this,arguments)}}(),r.getUserNFTAssets=function(){var e=d()((function*(e){e.serviceData;return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),f()(n)}(k.VaultContext),j=function(t){y()(r,t);var n=R(r);function r(){for(var e,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=n.call.apply(n,[this].concat(r))).uuid=O.a.v4().toString(),e}var i=r.prototype;return i.init=function(){var e=d()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),i.initKeyring=function(){var e=d()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),i.signTransaction=function(){var e=d()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),i.signAndSendTransaction=function(){var e=d()((function*(e,t,n){var r=yield this.signTransaction(e,t);return n?B(B({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(B(B({},r),{},{encodedTx:e.encodedTx}))}));return function(t,n,r){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=d()((function*(e,t){A.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var n=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return A.default.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),B(B({},e),{},{txid:n,encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),i.buildEncodedTxFromBatchTransfer=function(){var e=d()((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),i.buildEncodedTxsFromSetApproveForAll=function(){var e=d()((function*(e,t){throw new x.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),i.activateAccount=function(){var e=d()((function*(){throw new x.NotImplemented}));return function(){return e.apply(this,arguments)}}(),i.activateToken=function(){var e=d()((function*(e,t){throw new x.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),i.getTokenAllowance=function(){var e=d()((function*(e,t){throw new x.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),i.batchTokensAllowance=function(){var e=d()((function*(e,t){throw new x.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),i.getOutputAccount=function(){var e=d()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:o()(e,"pub","")}}));return function(){return e.apply(this,arguments)}}(),i.getAccountBalance=function(){var e=d()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=yield this.getDbAccount(),i=o.address;return this.getBalances((t?[{address:i}]:[]).concat(e.map((function(e){return{address:i,tokenAddress:e}}))),n,r)}));return function(t){return e.apply(this,arguments)}}(),i.updatePendingTxs=function(){var e=d()((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),i.getAccountNonce=function(){var e=d()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),i.fixActionDirection=function(){var e=d()((function*(e){var t,n,r,o,i=e.action,a=e.accountAddress;(i.direction=C.IDecodedTxDirection.OTHER,i.type===C.IDecodedTxActionType.NATIVE_TRANSFER)&&(i.direction=yield this.buildTxActionDirection({from:(null==(t=i.nativeTransfer)?void 0:t.from)||"",to:(null==(n=i.nativeTransfer)?void 0:n.to)||"",address:a}));i.type===C.IDecodedTxActionType.TOKEN_TRANSFER&&(i.direction=yield this.buildTxActionDirection({from:(null==(r=i.tokenTransfer)?void 0:r.from)||"",to:(null==(o=i.tokenTransfer)?void 0:o.to)||"",address:a}));return i}));return function(t){return e.apply(this,arguments)}}(),i.fixDecodedTx=function(){var e=d()((function*(e){var t,n;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var r=null==(n=e.encodedTx)?void 0:n.nonce;e.nonce=u()(r)?e.nonce:new T.a(r).toNumber();for(var o=e.owner,i=0;i<e.actions.length;i+=1){var a=e.actions[i];yield this.fixActionDirection({action:a,accountAddress:o})}if(e.outputActions)for(var c=0;c<e.outputActions.length;c+=1){var s=e.outputActions[c];yield this.fixActionDirection({action:s,accountAddress:o})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.fixHistoryTx=function(){var e=d()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),i.buildHistoryTx=function(){var e=d()((function*(e){var t=e.historyTxToMerge,n=(e.encodedTx,e.decodedTx),r=e.signedTx,o=e.isSigner,i=e.isLocalCreated,a=(null==r?void 0:r.txid)||(null==n?void 0:n.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var c=yield this.getAccountAddress();n.txid=a||n.txid,n.owner=c,o&&(n.signer=c),null!=r&&r.txKey&&(n.extraInfo?n.extraInfo.txKey=r.txKey:n.extraInfo={txKey:r.txKey});var u=B(B({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(i)},t),{},{decodedTx:n});return u=yield this.fixHistoryTx(u),Promise.resolve(u)}));return function(t){return e.apply(this,arguments)}}(),i.checkIsScamHistoryTx=function(){var e=d()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=d()((function*(e){throw new x.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),i.fixAddressCase=function(e){return Promise.resolve(e)},i.buildTxActionDirection=function(){var e=d()((function*(e){var t=e.from,n=e.to,r=e.address;return t=yield this.fixAddressCase(t||""),n=yield this.fixAddressCase(n),r=yield this.fixAddressCase(r),t===n&&t===r?C.IDecodedTxDirection.SELF:t&&t===r?C.IDecodedTxDirection.OUT:n&&n===r?C.IDecodedTxDirection.IN:C.IDecodedTxDirection.OTHER}));return function(t){return e.apply(this,arguments)}}(),i.getNextNonce=function(){var e=d()((function*(e,t){var n,r,o=null!=(n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce)?n:0,i=(yield this.engine.getHistory(e,t.id,void 0,!1),yield P.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),a=yield P.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),c=Math.max(u()(i)?0:i+1,o);if(Number.isNaN(c)&&(c=o),c>o)for(var s=o;s<c;s+=1)if(!a.includes(s)){c=s;break}if(c<o&&(c=o),c-o>=b.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new x.PendingQueueTooLong(b.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return c}));return function(t,n){return e.apply(this,arguments)}}(),i.validateSendAmount=function(e,t,n){return Promise.resolve(!0)},i.notifyChainChanged=function(e,t){},i.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},i.getPrivateKeyByCredential=function(t){return Promise.resolve(e.from(t.startsWith("0x")?t.slice(2):t,"hex"))},i.getMinDepositAmount=function(){var e=d()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),i.specialCheckEncodedTx=function(){var e=d()((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),i.getAllUsedAddress=function(){var e=d()((function*(){return Promise.resolve([])}));return function(){return e.apply(this,arguments)}}(),f()(r)}(F)}.call(this,n(26).Buffer)},3913:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"KeyringHardwareBase",(function(){return v}));var r=n(2),o=n.n(r),i=n(6),a=n.n(i),c=n(9),u=n.n(c),s=n(14),d=n.n(s),l=n(7),f=n.n(l),p=n(431),y=n(163);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var v=function(t){u()(r,t);var n=h(r);function r(){return n.apply(this,arguments)}var i=r.prototype;return i.getHardwareInfo=function(){var e=o()((function*(){var e,t,n,r=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==r?void 0:r.mac)?e:"",deviceId:null!=(t=null==r?void 0:r.deviceId)?t:"",deviceType:null!=(n=null==r?void 0:r.deviceType)?n:""}}));return function(){return e.apply(this,arguments)}}(),i.getWalletPassphraseState=function(){var e=o()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(y.isPassphraseWallet)(e)}}));return function(){return e.apply(this,arguments)}}(),i.getHardwareSDKInstance=function(){var t=o()((function*(){var t,n,r,o,i;return null!=(i=yield null==(t=e)||null==(n=t.$backgroundApiProxy)||null==(r=n.backgroundApi)||null==(o=r.serviceHardware)||null==o.getSDKInstance?void 0:o.getSDKInstance())?i:p.HardwareSDK}));return function(){return t.apply(this,arguments)}}(),i.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},a()(r)}(n(3903).KeyringBase)}.call(this,n(58))},3914:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringHdBase",(function(){return T}));var r=n(3),o=n.n(r),i=n(2),a=n.n(i),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(14),f=n.n(l),p=n(7),y=n.n(p),h=n(610),v=n(23);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f()(this,n)}}var T=function(e){d()(n,e);var t=m(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=a()((function*(e,t){var n=(yield this.getDbAccount()).path.split("/"),r=t||[n.pop()],o=n.join("/"),i=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof i)throw new v.OneKeyInternalError("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(h.batchGetPrivateKeys)(a,i,e,o,r).reduce((function(e,t){var n;return w(w({},e),{},((n={})[t.path]=t.extendedKey.key,n))}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},u()(n)}(n(3905).KeyringSoftwareBase)},3915:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringImportedBase",(function(){return h}));var r=n(2),o=n.n(r),i=n(6),a=n.n(i),c=n(9),u=n.n(c),s=n(14),d=n.n(s),l=n(7),f=n.n(l),p=n(23);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){u()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=o()((function*(e,t){if("undefined"!==typeof t)throw new p.NotImplemented("Getting private keys from extended private key");var n=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof n)throw new p.OneKeyInternalError("Unable to get credential.");return{"":n}}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(n)}(n(3905).KeyringSoftwareBase)},3916:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringWatchingBase",(function(){return h}));var r=n(2),o=n.n(r),i=n(6),a=n.n(i),c=n(9),u=n.n(c),s=n(14),d=n.n(s),l=n(7),f=n.n(l),p=n(23);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var o=f()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){u()(n,e);var t=y(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=o()((function*(e,t){throw new p.OneKeyInternalError("signTransaction is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=o()((function*(e,t){throw new p.OneKeyInternalError("signMessage is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(n)}(n(3903).KeyringBase)},3918:function(e,t,n){"use strict";n.r(t),n.d(t,"convertDeviceError",(function(){return c}));var r=n(70),o=n(90),i=n(19);n(24);function a(e,t){return"string"!==typeof t?null:e===r.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new o.ConnectTimeoutError({message:t}):t.includes("Bridge network error")?new o.BridgeNetworkError({message:t}):null}function c(e){var t,n=e||{},c=n.code,u=n.error,s=n.message,d=null!=(t=null!=u?u:s)?t:"Unknown error";if(a(c,d))return a(c,d);switch(i.default.hardwareSDK.info("Device Utils Convert Device Error:",c,d),c){case r.HardwareErrorCode.UnknownError:return new o.UnknownHardwareError(e);case r.HardwareErrorCode.DeviceFwException:return new o.FirmwareVersionTooLow(e);case r.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof d&&-1!==d.indexOf("ui-device_bootloader_mode")?new o.NotInBootLoaderMode(e):new o.UnknownHardwareError(e);case r.HardwareErrorCode.DeviceCheckDeviceIdError:return new o.DeviceNotSame(e);case r.HardwareErrorCode.DeviceNotFound:return new o.DeviceNotFind(e);case r.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new o.NotInBootLoaderMode(e);case r.HardwareErrorCode.DeviceInterruptedFromOutside:case r.HardwareErrorCode.DeviceInterruptedFromUser:return new o.UserCancelFromOutside(e);case r.HardwareErrorCode.DeviceNotSupportPassphrase:return new o.NotSupportPassphraseError(e);case r.HardwareErrorCode.IFrameLoadFail:return new o.InitIframeLoadFail(e);case r.HardwareErrorCode.IframeTimeout:return new o.InitIframeTimeout(e);case r.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new o.FirmwareDownloadFailed(e);case r.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new o.FirmwareUpdateManuallyEnterBoot(e);case r.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new o.FirmwareUpdateAutoEnterBootFailure(e);case r.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new o.FirmwareUpdateLimitOneDevice(e);case r.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new o.FirmwareVersionTooLow(e);case r.HardwareErrorCode.NewFirmwareUnRelease:return new o.NewFirmwareUnRelease(e);case r.HardwareErrorCode.NewFirmwareForceUpdate:return new o.NewFirmwareForceUpdate(e);case r.HardwareErrorCode.NetworkError:return new o.NetworkError(e);case r.HardwareErrorCode.BlePermissionError:return new o.NeedBluetoothTurnedOn(e);case r.HardwareErrorCode.BleLocationError:return new o.NeedBluetoothPermissions({message:d});case r.HardwareErrorCode.BleLocationServicesDisabled:return new o.BleLocationServiceError({message:d});case r.HardwareErrorCode.BleDeviceNotBonded:return new o.DeviceNotBonded(e);case r.HardwareErrorCode.BleDeviceBondError:return new o.DeviceBondError(e);case r.HardwareErrorCode.BleWriteCharacteristicError:return new o.BleWriteCharacteristicError(e);case r.HardwareErrorCode.BleScanError:return new o.BleScanError({message:d});case r.HardwareErrorCode.BleAlreadyConnected:return new o.BleAlreadyConnectedError(e);case r.HardwareErrorCode.RuntimeError:return-1!==d.indexOf("EIP712 blind sign is disabled")?new o.OpenBlindSign(e):-1!==d.indexOf("Unknown message")||-1!==d.indexOf("Failure_UnexpectedMessage")?new o.UnknownMethod(e):new o.UnknownHardwareError(e);case r.HardwareErrorCode.PinInvalid:return new o.InvalidPIN(e);case r.HardwareErrorCode.DeviceCheckPassphraseStateError:return new o.InvalidPassphrase(e);case r.HardwareErrorCode.DeviceOpenedPassphrase:return new o.DeviceOpenedPassphrase(e);case r.HardwareErrorCode.DeviceNotOpenedPassphrase:return new o.DeviceNotOpenedPassphrase(e);case r.HardwareErrorCode.PinCancelled:case r.HardwareErrorCode.ActionCancelled:return new o.UserCancel(e);case r.HardwareErrorCode.BridgeNotInstalled:case o.CustomOneKeyHardwareError.NeedOneKeyBridge:return new o.NeedOneKeyBridge(e);case r.HardwareErrorCode.BridgeNetworkError:return new o.BridgeNetworkError(e);case r.HardwareErrorCode.BridgeTimeoutError:return new o.BridgeTimeoutError(e);case r.HardwareErrorCode.PollingTimeout:return new o.ConnectTimeoutError(e);case r.HardwareErrorCode.PollingStop:return new o.ConnectPollingStopError(e);case r.HardwareErrorCode.BlindSignDisabled:return new o.OpenBlindSign(e);case r.HardwareErrorCode.FileAlreadyExists:return new o.FileAlreadyExistError(e);case r.HardwareErrorCode.CheckDownloadFileError:return new o.IncompleteFileError(e);case r.HardwareErrorCode.NotInSigningMode:return new o.NotInSigningModeError(e);default:return new o.UnknownHardwareError(e)}}},4385:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"KeyringHardware",(function(){return E}));var r=n(3),o=n.n(r),i=n(2),a=n.n(i),c=n(6),u=n.n(c),s=n(9),d=n.n(s),l=n(14),f=n.n(l),p=n(7),y=n.n(p),h=n(1344),v=n(3918),g=n(11),w=n(19),m=n(23),T=n(182),I=n(117);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var o=y()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return f()(this,n)}}var E=function(t){d()(r,t);var n=A(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.signTransaction=function(){var t=a()((function*(t,n){var r=yield this.getDbAccount(),o=yield this.getHardwareSDKInstance(),i=yield this.getHardwareInfo(),a=i.connectId,c=i.deviceId,u=yield this.getWalletPassphraseState(),s=t.payload,d=s.nativeTx,l=s.feePayer,f=d instanceof h.VersionedTransaction,p=yield o.solSignTransaction(a,c,b({path:r.path,rawTx:f?e.from(d.message.serialize()).toString("hex"):d.serializeMessage().toString("hex")},u));if(p.success&&p.payload.signature){var y=p.payload.signature;return d.addSignature(l,e.from(y,"hex")),{txid:y,rawTx:e.from(d.serialize({requireAllSignatures:!1})).toString("base64")}}throw Object(v.convertDeviceError)(p.payload)}));return function(e,n){return t.apply(this,arguments)}}(),o.signMessage=function(e,t){throw new m.NotImplemented("Signing solana message is not supported yet.")},o.prepareAccounts=function(){var e=a()((function*(e){var t,n=this,r=e.indexes,o=e.names,i=e.template,a=r.map((function(e){return i.replace(g.INDEX_PLACEHOLDER,""+e)})),c=yield this.getHardwareSDKInstance(),u=yield this.getHardwareInfo(),s=u.connectId,d=u.deviceId,l=yield this.getWalletPassphraseState();try{t=yield c.solGetAddress(s,d,b({bundle:a.map((function(e){return{path:e,showOnOneKey:!1}}))},l))}catch(y){throw w.default.common.error(y),new m.OneKeyHardwareError(y)}if(!t.success)throw w.default.common.error(t.payload),Object(v.convertDeviceError)(t.payload);var f=yield this.getNetworkImpl(),p=Object(T.getAccountNameInfoByTemplate)(f,i).prefix;return t.payload.map((function(e,t){var i=e.address,a=e.path;return{id:n.walletId+"--"+a,name:(o||[])[t]||p+" #"+(r[t]+1),type:I.AccountType.SIMPLE,path:a,coinType:g.COINTYPE_SOL,pub:null!=i?i:"",address:null!=i?i:""}})).filter((function(e){return!!e.address}))}));return function(t){return e.apply(this,arguments)}}(),o.getAddress=function(){var e=a()((function*(e){var t,n=yield this.getHardwareSDKInstance(),r=yield this.getHardwareInfo(),o=r.connectId,i=r.deviceId,a=yield this.getWalletPassphraseState(),c=yield n.solGetAddress(o,i,b({path:e.path,showOnOneKey:e.showOnOneKey},a));if(c.success&&null!=(t=c.payload)&&t.address)return c.payload.address;throw Object(v.convertDeviceError)(c.payload)}));return function(t){return e.apply(this,arguments)}}(),o.batchGetAddress=function(){var e=a()((function*(e){var t=yield this.getHardwareSDKInstance(),n=yield this.getHardwareInfo(),r=n.connectId,o=n.deviceId,i=yield this.getWalletPassphraseState(),a=yield t.solGetAddress(r,o,b(b({},i),{},{bundle:e.map((function(e){return{path:e.path,showOnOneKey:!!e.showOnOneKey}}))}));if(!a.success)throw Object(v.convertDeviceError)(a.payload);return a.payload.map((function(e){var t,n;return{path:null!=(t=e.path)?t:"",address:null!=(n=e.address)?n:""}}))}));return function(t){return e.apply(this,arguments)}}(),u()(r)}(n(3913).KeyringHardwareBase)}.call(this,n(26).Buffer)},4386:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"signTransaction",(function(){return d})),n.d(t,"signMessage",(function(){return f}));var r=n(4),o=n.n(r),i=n(2),a=n.n(i),c=n(1344),u=n(103),s=n.n(u);function d(e,t){return l.apply(this,arguments)}function l(){return(l=a()((function*(t,n){var r=t.payload,i=r.nativeTx,a=r.feePayer,u=i instanceof c.VersionedTransaction,d=yield n.sign(u?e.from(i.message.serialize()):i.serializeMessage()),l=o()(d,1)[0];return i.addSignature(a,l),{txid:s.a.encode(l),rawTx:e.from(i.serialize({requireAllSignatures:!1})).toString("base64")}}))).apply(this,arguments)}function f(e,t){return p.apply(this,arguments)}function p(){return(p=a()((function*(t,n){var r=yield n.sign(e.from(t)),i=o()(r,1)[0];return s.a.encode(i)}))).apply(this,arguments)}}.call(this,n(26).Buffer)},5308:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringHardware",(function(){return r.KeyringHardware})),n.d(t,"KeyringHd",(function(){return E})),n.d(t,"KeyringImported",(function(){return S})),n.d(t,"KeyringWatching",(function(){return C}));var r=n(4385),o=n(2),i=n.n(o),a=n(6),c=n.n(a),u=n(9),s=n.n(u),d=n(14),l=n.n(d),f=n(7),p=n.n(f),y=n(1344),h=n(610),v=n(11),g=n(23),w=n(317),m=n(182),T=n(1345),I=n(117),O=n(3914),b=n(4386);function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}var E=function(e){s()(n,e);var t=A(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getSigners=function(){var e=i()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new g.OneKeyInternalError("SOL signers number should be 1.");if(t[0]!==r.address)throw new g.OneKeyInternalError("Wrong address required for signing");var o=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof o)throw new g.OneKeyInternalError("Unable to get signer.");return(n={})[r.address]=new T.Signer(o,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),r.prepareAccounts=function(){var e=i()((function*(e){var t=this,n=e.password,r=e.indexes,o=e.names,i=e.template,a=(yield this.engine.dbApi.getCredential(this.walletId,n)).seed,c=Object(w.slicePathTemplate)(i),u=c.pathPrefix,s=c.pathSuffix,d=Object(h.batchGetPublicKeys)("ed25519",a,n,u,r.map((function(e){return s.replace("{index}",e.toString())})));if(d.length!==r.length)throw new g.OneKeyInternalError("Unable to get public keys");var l=yield this.getNetworkImpl(),f=Object(m.getAccountNameInfoByTemplate)(l,i).prefix;return d.map((function(e,n){var i=e.path,a=e.extendedKey.key,c=new y.PublicKey(a).toBase58();return{id:t.walletId+"--"+i,name:(o||[])[n]||f+" #"+(r[n]+1),type:I.AccountType.SIMPLE,path:i,coinType:v.COINTYPE_SOL,pub:c,address:c}}))}));return function(t){return e.apply(this,arguments)}}(),r.signTransaction=function(){var e=i()((function*(e,t){var n=yield this.getDbAccount(),r=(yield this.getSigners(t.password||"",[n.address]))[n.address];return Object(b.signTransaction)(e,r)}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=i()((function*(e,t){var n=yield this.getDbAccount(),r=(yield this.getSigners(t.password||"",[n.address]))[n.address];return Promise.all(e.map((function(e){var t=e.message;return Object(b.signMessage)(t,r)})))}));return function(t,n){return e.apply(this,arguments)}}(),c()(n)}(O.KeyringHdBase),P=n(748);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}var S=function(e){s()(n,e);var t=x(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.prepareAccounts=function(){var e=i()((function*(e){var t=e.name,n=e.privateKey;if(32!==n.length)throw new g.OneKeyInternalError("Invalid private key.");var r=new y.PublicKey(P.ed25519.publicFromPrivate(n)).toBase58();return Promise.resolve([{id:"imported--"+v.COINTYPE_SOL+"--"+r,name:t||"",type:I.AccountType.SIMPLE,path:"",coinType:v.COINTYPE_SOL,pub:r,address:r}])}));return function(t){return e.apply(this,arguments)}}(),r.getSigners=function(){var e=i()((function*(e,t){var n,r=yield this.getDbAccount();if(1!==t.length)throw new g.OneKeyInternalError("SOL signers number should be 1.");if(t[0]!==r.address)throw new g.OneKeyInternalError("Wrong address required for signing.");var o=(yield this.getPrivateKeys(e))[r.path];if("undefined"===typeof o)throw new g.OneKeyInternalError("Unable to get signer.");return(n={})[r.address]=new T.Signer(o,e,"ed25519"),n}));return function(t,n){return e.apply(this,arguments)}}(),r.signTransaction=function(){var e=i()((function*(e,t){var n=yield this.getDbAccount(),r=(yield this.getSigners(t.password||"",[n.address]))[n.address];return Object(b.signTransaction)(e,r)}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=i()((function*(e,t){var n=yield this.getDbAccount(),r=(yield this.getSigners(t.password||"",[n.address]))[n.address];return Promise.all(e.map((function(e){var t=e.message;return Object(b.signMessage)(t,r)})))}));return function(t,n){return e.apply(this,arguments)}}(),c()(n)}(n(3915).KeyringImportedBase);function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p()(e);if(t){var o=p()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l()(this,n)}}var C=function(e){s()(n,e);var t=N(n);function n(){return t.apply(this,arguments)}return n.prototype.prepareAccounts=function(){var e=i()((function*(e){var t=e.name,n=e.target;if(!(yield this.vault.validateWatchingCredential(n)))throw new g.InvalidAddress;return Promise.resolve([{id:"watching--"+v.COINTYPE_SOL+"--"+n,name:t||"",type:I.AccountType.SIMPLE,path:"",coinType:v.COINTYPE_SOL,pub:n,address:n}])}));return function(t){return e.apply(this,arguments)}}(),c()(n)}(n(3916).KeyringWatchingBase)},5318:function(e,t,n){"use strict";n.r(t),n.d(t,"RPC_METHODS",(function(){return r})),n.d(t,"PARAMS_ENCODINGS",(function(){return o})),n.d(t,"ClientSol",(function(){return x}));var r,o,i=n(4),a=n.n(i),c=n(3),u=n.n(c),s=n(2),d=n.n(s),l=n(6),f=n.n(l),p=n(9),y=n.n(p),h=n(14),v=n.n(h),g=n(7),w=n.n(g),m=n(21),T=n.n(m),I=n(765),O=n(1068),b=n(367);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var o=w()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return v()(this,n)}}!function(e){e.SEND_TRANSACTION="sendTransaction",e.GET_EPOCH_INFO="getEpochInfo",e.GET_HEALTH="getHealth",e.GET_ACCOUNT_INFO="getAccountInfo",e.GET_TOKEN_ACCOUNTS_BY_OWNER="getTokenAccountsByOwner",e.GET_FEES="getFees",e.GET_TRANSACTION="getTransaction"}(r||(r={})),function(e){e.BASE64="base64",e.JSON_PARSED="jsonParsed"}(o||(o={}));var x=function(e){y()(n,e);var t=P(n);function n(e){var n;return(n=t.call(this)).getTokenInfos=function(){var e=d()((function*(e){var t=e.map((function(e){return[r.GET_ACCOUNT_INFO,[e,{encoding:o.JSON_PARSED}]]})),i=yield n.rpc.batchCall(t),a=[];return i.forEach((function(t,n){if("undefined"!==typeof t)if(null!==t.value&&"mint"===t.value.data.parsed.type){var r=t.value.data.parsed.info.decimals,o=e[n].slice(0,4);a.push({name:o,symbol:o.toUpperCase(),decimals:r})}else a.push(void 0);else a.push(void 0)})),a}));return function(t){return e.apply(this,arguments)}}(),n.rpc=new O.JsonRPCRequest(e),n}var i=n.prototype;return i.broadcastTransaction=function(){var e=d()((function*(e,t){return this.rpc.call(r.SEND_TRANSACTION,[e,E({encoding:o.BASE64},t||{})])}));return function(t,n){return e.apply(this,arguments)}}(),i.getInfo=function(){var e=d()((function*(){var e=yield this.rpc.batchCall([[r.GET_EPOCH_INFO,[]],[r.GET_HEALTH,[]]]),t=a()(e,2),n=t[0],o=t[1];return{bestBlockNumber:n.absoluteSlot,isReady:"ok"===o}}));return function(){return e.apply(this,arguments)}}(),i.getAddresses=function(){var e=d()((function*(e){var t=e.map((function(e){return[r.GET_ACCOUNT_INFO,[e,{encoding:o.JSON_PARSED}]]})),n=yield this.rpc.batchCall(t),i=[];for(var a of n)if("undefined"!==typeof a){var c,u=new T.a(null==a||null==(c=a.value)?void 0:c.lamports),s=u.isFinite()&&u.gte(0);i.push({existing:s,balance:s?u:new T.a(0)})}else i.push(void 0);return i}));return function(t){return e.apply(this,arguments)}}(),i.getBalances=function(){var e=d()((function*(e){var t=e.map((function(e){var t;return null!=(t=e.coin)&&t.tokenAddress?[r.GET_TOKEN_ACCOUNTS_BY_OWNER,[e.address,{mint:e.coin.tokenAddress},{encoding:o.JSON_PARSED,commitment:"processed"}]]:[r.GET_ACCOUNT_INFO,[e.address,{encoding:o.JSON_PARSED,commitment:"processed"}]]})),n=yield this.rpc.batchCall(t),i=[];return n.forEach((function(t,n){if("undefined"!==typeof t){var r,o=new T.a(0);if(null!=(r=e[n].coin)&&r.tokenAddress)for(var a of t.value){var c=a.account.data.parsed.info;c.owner===e[n].address&&(o=T.a.sum(o,c.tokenAmount.amount))}else null!==t.value&&(o=new T.a(t.value.lamports));i.push(o)}else i.push(void 0)})),i}));return function(t){return e.apply(this,arguments)}}(),i.getAccountInfo=function(){var e=d()((function*(e){return(yield this.rpc.call(r.GET_ACCOUNT_INFO,[e,{encoding:o.JSON_PARSED}])).value}));return function(t){return e.apply(this,arguments)}}(),i.getFeePricePerUnit=function(){var e=d()((function*(){var e=yield this.getFees(),t=a()(e,1)[0];return{normal:{price:new T.a(t)}}}));return function(){return e.apply(this,arguments)}}(),i.getFees=function(){var e=d()((function*(){var e=yield this.rpc.call(r.GET_FEES);return[e.value.feeCalculator.lamportsPerSignature,e.value.blockhash]}));return function(){return e.apply(this,arguments)}}(),i.getTransactionStatuses=function(){var e=d()((function*(e){var t=e.map((function(e){return[r.GET_TRANSACTION,[e,{encoding:o.JSON_PARSED,maxSupportedTransactionVersion:0}]]})),n=[],i=yield this.rpc.batchCall(t);for(var a of i)"undefined"!==typeof a?null===a?n.push(b.TransactionStatus.NOT_FOUND):n.push(null===a.meta.err?b.TransactionStatus.CONFIRM_AND_SUCCESS:b.TransactionStatus.CONFIRM_BUT_FAILED):n.push(void 0);return n}));return function(t){return e.apply(this,arguments)}}(),f()(n)}(I.BaseClient)},6079:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return te}));var r=n(1077),o=n.n(r),i=n(316),a=n.n(i),c=n(237),u=n.n(c),s=n(13),d=n.n(s),l=n(3),f=n.n(l),p=n(60),y=n.n(p),h=n(4),v=n.n(h),g=n(2),w=n.n(g),m=n(6),T=n.n(m),I=n(9),O=n.n(I),b=n(14),A=n.n(b),E=n(7),P=n.n(E),x=n(4623),S=n(1344),N=n(107),C=n.n(N),k=n(21),D=n.n(k),B=n(103),R=n.n(B),F=n(748),j=n(112),K=n(46),H=n(11),_=n(19),M=n(150),U=n(68),L=n(23),G=n(182),W=n(391),V=n(1345),z=n(1069),J=n(52),Y=n(3912),q=n(5308),Q=n(5318),X=n(2715);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ee(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var o=P()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return A()(this,n)}}var te=function(t){O()(r,t);var n=ee(r);function r(){for(var e,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=n.call.apply(n,[this].concat(r))).keyringMap={hd:q.KeyringHd,hw:q.KeyringHardware,imported:q.KeyringImported,watching:q.KeyringWatching,external:q.KeyringWatching},e.settings=X.default,e.getApiExplorerCache=Object(M.memoizee)((function(e){return C.a.create({baseURL:e})}),{promise:!0,max:1,maxAge:Object(K.getTimeDurationMs)({minute:3})}),e.getAssociatedAccountInfo=Object(M.memoizee)(function(){var t=w()((function*(t){var n,r=yield e.getClient(),o=(null!=(n=yield r.getAccountInfo(t))?n:{}).data.parsed.info;return{mint:o.mint,owner:o.owner}}));return function(e){return t.apply(this,arguments)}}(),{promise:!0,primitive:!0,max:50,maxAge:Object(K.getTimeDurationMs)({minute:3})}),e.createClientFromURL=Object(M.memoizee)((function(e){return new Q.ClientSol(e)}),{max:1,maxAge:Object(K.getTimeDurationMs)({minute:3})}),e}var i=r.prototype;return i.getApiExplorer=function(){return this.getApiExplorerCache("https://api.solscan.io/")},i.getClient=function(){var e=w()((function*(){var e=yield this.getRpcUrl();return this.createClientFromURL(e)}));return function(){return e.apply(this,arguments)}}(),i.decodeNativeTxActions=function(){var e=w()((function*(e){var t=[],n={};if(!e.instructions)return[{type:J.IDecodedTxActionType.UNKNOWN}];for(var r of e.instructions)if(r.programId.toString()===S.SystemProgram.programId.toString())try{if("Transfer"===S.SystemInstruction.decodeInstructionType(r)){var o=yield this.engine.getNativeTokenInfo(this.networkId),i=S.SystemInstruction.decodeTransfer(r),a=i.fromPubkey,c=i.toPubkey,u=i.lamports,s=new D.a(u.toString());t.push({type:J.IDecodedTxActionType.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:o,from:a.toString(),to:c.toString(),amount:s.shiftedBy(-o.decimals).toFixed(),amountValue:s.toFixed(),extraInfo:null}})}}catch(H){}else if(r.programId.toString()===x.ASSOCIATED_TOKEN_PROGRAM_ID.toString()&&0===r.data.length&&7===r.keys.length&&r.keys[4].pubkey.toString()===S.SystemProgram.programId.toString()&&r.keys[5].pubkey.toString()===x.TOKEN_PROGRAM_ID.toString()){var d=v()(r.keys,4),l=d[1],f=d[2],p=d[3];l&&f&&p&&(n[l.pubkey.toString()]={owner:f.pubkey.toString(),mint:p.pubkey.toString()})}else if(r.programId.toString()===x.TOKEN_PROGRAM_ID.toString())try{var y=Object(x.decodeInstruction)(r).data.instruction,h=void 0,g=void 0,w=void 0,m=void 0;if(y===x.TokenInstruction.TransferChecked){var T=Object(x.decodeTransferCheckedInstruction)(r),I=T.data.amount,O=T.keys,b=O.owner,A=O.mint,E=O.destination;h=new D.a(I.toString()),g=b.pubkey.toString(),w=A.pubkey.toString(),m=E.pubkey.toString()}else if(y===x.TokenInstruction.Transfer){var P=Object(x.decodeTransferInstruction)(r),N=P.data.amount,C=P.keys,k=C.owner,B=C.destination;h=new D.a(N.toString()),g=k.pubkey.toString(),m=B.pubkey.toString()}if(h&&g&&m){var R=n[m]||(yield this.getAssociatedAccountInfo(m)),F=R.mint,j=R.owner;w=w||F;var K=yield this.engine.ensureTokenInDB(this.networkId,w);K&&t.push({type:J.IDecodedTxActionType.TOKEN_TRANSFER,tokenTransfer:{tokenInfo:K,from:g,to:null!=j?j:m,amount:h.shiftedBy(-K.decimals).toFixed(),amountValue:h.toFixed(),extraInfo:null}})}}catch(_){}return 0===t.length&&t.push({type:J.IDecodedTxActionType.UNKNOWN}),t}));return function(t){return e.apply(this,arguments)}}(),i.getTransactionStatuses=function(){var e=w()((function*(e){return(yield this.getClient()).getTransactionStatuses(e)}));return function(t){return e.apply(this,arguments)}}(),i.proxyJsonRPCCall=function(){var e=w()((function*(e){var t=yield this.getClient();try{return yield t.rpc.call(e.method,e.params)}catch(n){throw Object(V.extractResponseError)(n)}}));return function(t){return e.apply(this,arguments)}}(),i.getNextNonce=function(){var e=w()((function*(e,t){var n,r,o=yield this.getClient(),i=null!=(n=null==(r=(yield o.getAddresses([t.address]))[0])?void 0:r.nonce)?n:0,a=(yield this.engine.getHistory(e,t.id,void 0,!1),yield U.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),c=yield U.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),u=Math.max(y()(a)?0:a+1,i);if(Number.isNaN(u)&&(u=i),u>i)for(var s=i;s<u;s+=1)if(!c.includes(s)){u=s;break}if(u<i&&(u=i),u-i>=H.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new L.PendingQueueTooLong(H.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return u}));return function(t,n){return e.apply(this,arguments)}}(),i.getBalances=function(){var e=w()((function*(e){var t=e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:Z({},"string"===typeof n?{tokenAddress:n}:{})}}));return(yield this.getClient()).getBalances(t)}));return function(t){return e.apply(this,arguments)}}(),i.fetchTokenInfos=function(){var e=w()((function*(e){return(yield this.getClient()).getTokenInfos(e)}));return function(t){return e.apply(this,arguments)}}(),i.validateAddress=function(e){try{if(S.PublicKey.isOnCurve(e))return Promise.resolve(e)}catch(t){}return Promise.reject(new L.InvalidAddress)},i.validateTokenAddress=function(e){try{return new S.PublicKey(e),Promise.resolve(e)}catch(t){}return Promise.reject(new L.InvalidAddress)},i.validateImportedCredential=function(e){if(this.settings.importedAccountEnabled)try{var t=R.a.decode(e);if(64===t.length){var n=[t.slice(0,32),t.slice(32)],r=n[0],o=n[1];return Promise.resolve(F.ed25519.publicFromPrivate(r).toString("hex")===o.toString("hex"))}}catch(i){}return Promise.resolve(!1)},i.validateWatchingCredential=function(){var e=w()((function*(e){var t=!1;if(this.settings.watchingAccountEnabled)try{yield this.validateAddress(e),t=!0}catch(n){}return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),i.attachFeeInfoToEncodedTx=function(e){return Promise.resolve(e.encodedTx)},i.decodeTx=function(){var e=w()((function*(e,t){var n,r,o=yield this.helper.parseToNativeTx(e),i=yield this.decodeNativeTxActions(o),a=o instanceof S.VersionedTransaction?o.signatures[0]:o.signature;if(null!=(n=a)&&n.every((function(e){return 0===e}))&&(a=null),"InternalSwap"===(null==t?void 0:t.type)&&null!=t&&t.swapInfo&&(i=[{type:J.IDecodedTxActionType.INTERNAL_SWAP,internalSwap:Z(Z({},t.swapInfo),{},{extraInfo:null})}]),"Transfer"===(null==t?void 0:t.type)&&(null!=t&&t.nftInfo||null!=t&&t.nftInfos)){var c=t.nftInfos?t.nftInfos:[t.nftInfo];i=[],c.map((function(e){return i.push({type:J.IDecodedTxActionType.NFT_TRANSFER,nftTransfer:{asset:e.asset,amount:e.amount,send:e.from,receive:e.to,extraInfo:null}})}))}var u=yield this.getAccountAddress();return{txid:a?R.a.encode(a):"",owner:u,signer:(null==(r=o.feePayer)?void 0:r.toString())||u,nonce:0,actions:i,status:J.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,extraInfo:null,encodedTx:e}}));return function(t,n){return e.apply(this,arguments)}}(),i.decodedTxToLegacy=function(e){return Promise.resolve({})},i.buildEncodedTxFromTransfer=function(){var e=w()((function*(e){if(!e.to)throw new Error("Invalid transferInfo.to params");var t=e.from,n=e.to,r=e.amount,o=e.token,i=e.tokenSendAddress,a=(yield this.getNetwork(),yield this.getClient()),c=yield this.engine.ensureTokenInDB(this.networkId,null!=o?o:"");if(!c)throw new L.OneKeyInternalError("Token not found: "+(o||"main"));var u=new S.PublicKey(t),s=new S.PublicKey(n),d=new S.Transaction,l=yield a.getFees(),f=v()(l,2);if(d.recentBlockhash=f[1],d.feePayer=u,o){var p=new S.PublicKey(o),y=s;S.PublicKey.isOnCurve(s.toString())&&(y=yield Object(x.getAssociatedTokenAddress)(p,s)),null===(yield a.getAccountInfo(y.toString()))&&d.add(Object(x.createAssociatedTokenAccountInstruction)(u,y,s,p));var h=i?new S.PublicKey(i):yield Object(x.getAssociatedTokenAddress)(p,u);d.add(Object(x.createTransferCheckedInstruction)(h,p,y,u,BigInt(new D.a(r).shiftedBy(c.decimals).toFixed()),c.decimals))}else d.add(S.SystemProgram.transfer({fromPubkey:new S.PublicKey(t),toPubkey:new S.PublicKey(n),lamports:BigInt(new D.a(r).shiftedBy(c.decimals).toFixed())}));return R.a.encode(d.serialize({requireAllSignatures:!1}))}));return function(t){return e.apply(this,arguments)}}(),i.buildEncodedTxFromBatchTransfer=function(){var e=w()((function*(e){var t=e.transferInfos,n=0,r="",o=yield this.getClient(),i=t[0],a=i.from,c=i.to,u=(i.isNFT,new S.PublicKey(a)),s=new S.Transaction,d=function(){var e=w()((function*(){try{var e=yield o.getFees();return v()(e,2)[1]}catch(n){var t=null==n?void 0:n.data;n&&t&&(r=t.message)}}));return function(){return e.apply(this,arguments)}}();do{if((n+=1)>5)throw new Error("Solana getFees retry times exceeded: "+(r||""));var l=yield d();s.recentBlockhash=l,yield Object(K.wait)(1e3)}while(!s.recentBlockhash);s.feePayer=u;for(var f=0;f<t.length;f+=1){var p=t[f],y=p.token,h=p.amount,g=p.to,m=p.tokenSendAddress,T=new S.PublicKey(g||c),I=yield this.engine.ensureTokenInDB(this.networkId,null!=y?y:"");if(!I)throw new L.OneKeyInternalError("Token not found: "+(y||"main"));if(y){var O=new S.PublicKey(y),b=T;S.PublicKey.isOnCurve(T.toString())&&(b=yield Object(x.getAssociatedTokenAddress)(O,T)),null===(yield o.getAccountInfo(b.toString()))&&s.add(Object(x.createAssociatedTokenAccountInstruction)(u,b,T,O));var A=m?new S.PublicKey(m):yield Object(x.getAssociatedTokenAddress)(O,u);s.add(Object(x.createTransferCheckedInstruction)(A,O,b,u,BigInt(new D.a(h).shiftedBy(I.decimals).toFixed()),I.decimals))}else s.add(S.SystemProgram.transfer({fromPubkey:new S.PublicKey(a),toPubkey:new S.PublicKey(g),lamports:BigInt(new D.a(h).shiftedBy(I.decimals).toFixed())}))}return R.a.encode(s.serialize({requireAllSignatures:!1}))}));return function(t){return e.apply(this,arguments)}}(),i.buildEncodedTxFromApprove=function(e){throw new L.NotImplemented},i.updateEncodedTxTokenApprove=function(e,t){throw new L.NotImplemented},i.updateEncodedTx=function(){var e=w()((function*(e,t,n){if(n.type===J.IEncodedTxUpdateType.advancedSettings)return Promise.resolve(e);var r=yield this.helper.parseToNativeTx(e),o=v()(r.instructions,1)[0];if("transfer"===n.type&&1===r.instructions.length&&o.programId.toString()===S.SystemProgram.programId.toString()&&"Transfer"===S.SystemInstruction.decodeInstructionType(o)){var i=S.SystemInstruction.decodeTransfer(o),a=i.fromPubkey,c=i.toPubkey,u=yield this.engine.getNativeTokenInfo(this.networkId),s=t.amount;return r.instructions=[S.SystemProgram.transfer({fromPubkey:a,toPubkey:c,lamports:BigInt(new D.a(s).shiftedBy(u.decimals).toFixed())})],R.a.encode(r.serialize({requireAllSignatures:!1}))}return Promise.resolve(e)}));return function(t,n,r){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=w()((function*(e){var t=!1,n=0,r="",o=yield this.getClient(),i=function(){var n=w()((function*(){try{var n=t?{preflightCommitment:"confirmed"}:{};_.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var i=yield o.broadcastTransaction(e.rawTx,n||{});return _.default.engine.info("broadcastTransaction END:",{txid:i,rawTx:e.rawTx}),Z(Z({},e),{},{txid:i,encodedTx:e.encodedTx})}catch(c){_.default.engine.error("broadcastTransaction error:",c);var a=null==c?void 0:c.data;if(c&&a&&(-32005===a.code||-32002===a.code))return t=!0,void(r=a.message);throw c}}));return function(){return n.apply(this,arguments)}}();do{if((n+=1)>8)throw t=!1,new Error("Solana broadcastTransaction retry times exceeded: "+(r||""));var a=yield i();if(a)return a;yield Object(K.wait)(1e3)}while(t);throw new Error("Solana broadcastTransaction retry failed")}));return function(t){return e.apply(this,arguments)}}(),i.buildUnsignedTxFromEncodedTx=function(){var e=w()((function*(e){var t=yield this.getDbAccount(),n=yield this.helper.parseToNativeTx(e);yield this.getClient();return{inputs:[],outputs:[],payload:{nativeTx:n,feePayer:new S.PublicKey(t.pub)},encodedTx:e}}));return function(t){return e.apply(this,arguments)}}(),i.getFeePricePerUnit=function(){var e=w()((function*(){return(yield this.getClient()).getFeePricePerUnit()}));return function(){return e.apply(this,arguments)}}(),i.fetchFeeInfo=function(){var e=w()((function*(e){var t=yield Promise.all([this.getNetwork(),this.engine.getGasInfo(this.networkId),this.helper.parseToNativeTx(e)]),n=v()(t,3),r=n[0],o=n[1].prices,i=n[2];return{nativeSymbol:r.symbol,nativeDecimals:r.decimals,feeSymbol:r.feeSymbol,feeDecimals:r.feeDecimals,limit:i.signatures.length.toString(),prices:o,defaultPresetIndex:"0",tx:null}}));return function(t){return e.apply(this,arguments)}}(),i.getExportedCredential=function(){var t=w()((function*(t){var n=yield this.getDbAccount();if(n.id.startsWith("hd-")||n.id.startsWith("imported")){var r=this.keyring,o=Object.values(yield r.getPrivateKeys(t)),i=v()(o,1)[0];return R.a.encode(e.concat([Object(j.decrypt)(t,i),R.a.decode(n.pub)]))}throw new L.OneKeyInternalError("Only credential of HD or imported accounts can be exported")}));return function(e){return t.apply(this,arguments)}}(),i.mergeNFTTx=function(e){var t=e.address,n=e.decodedTx,r=e.nftTxs;if(r){var o=r.map((function(e){return Object(W.createOutputActionFromNFTTransaction)({transaction:e,address:t})})).filter(Boolean);n.actions=o}return n},i.mergeDecodedTx=function(){var e=w()((function*(e){var t=e.decodedTx,n=e.nftTxs,r=yield this.getAccountAddress();if(n&&n.length>0){var o=this.mergeNFTTx({address:r,decodedTx:t,nftTxs:n});return Promise.resolve(o)}return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=w()((function*(e){var t=this,n=e.localHistory,r=void 0===n?[]:n;if(e.tokenIdOnNetwork)return Promise.resolve([]);var o=yield this.getNetwork(),i=this.getApiExplorer(),c=yield this.getClient(),s=yield this.getDbAccount(),l=(yield this.engine.getNativeTokenInfo(this.networkId)).decimals,f=[];if(o.isTestnet)f=yield c.rpc.call("getSignaturesForAddress",[s.address,{limit:50}]);else{var p,y,h,g,m,T,I=i.get("/account/soltransfer/txs",{params:{address:s.address,offset:0,limit:25}}),O=i.get("/account/token/txs",{params:{address:s.address,offset:0,limit:25}}),b=yield Promise.all([I,O]),A=v()(b,2),E=A[0],P=A[1],x=(null==E||null==(p=E.data)||null==(y=p.data)||null==(h=y.tx)?void 0:h.transactions)||[],S=(null==P||null==(g=P.data)||null==(m=g.data)||null==(T=m.tx)?void 0:T.transactions)||[];f=[].concat(d()(x),d()(S))}var N=yield c.rpc.batchCall(f.map((function(e){var t=e.signature;return["getTransaction",[e.txHash||(u()(t)?t[0]:t),{encoding:"base58",maxSupportedTransactionVersion:0}]]}))),C=yield Object(W.getNFTTransactionHistory)(s.address,this.networkId),k=N.map(function(){var e=w()((function*(e,n){var o,i=f[n],c=i.txHash||(u()(i.signature)?i.signature&&i.signature[0]:i.signature)||"",s=r.find((function(e){return e.decodedTx.txid===c})),d=!0;if(s&&s.decodedTx.isFinal)return Promise.resolve(null);var p=C[c];i&&(0===i.decimals||0===(null==(o=i.change)?void 0:o.decimals))&&a()(p)&&(d=!1);try{var y,h,g=e.blockTime,w=v()(e.transaction,1)[0],m=e.meta,T=m.fee,I=m.err,O=1e3*g,b=Z(Z({},null!=(y=null==s?void 0:s.decodedTx)?y:yield t.decodeTx(w)),{},{txid:c,totalFeeInNative:new D.a(T).shiftedBy(-l).toFixed(),status:I?J.IDecodedTxStatus.Failed:J.IDecodedTxStatus.Confirmed,updatedAt:O,createdAt:null!=(h=null==s?void 0:s.decodedTx.createdAt)?h:O,isFinal:d});return b=yield t.mergeDecodedTx({decodedTx:b,nftTxs:p}),yield t.buildHistoryTx({decodedTx:b,historyTxToMerge:s})}catch(A){_.default.common.error(A)}return Promise.resolve(null)}));return function(t,n){return e.apply(this,arguments)}}());return(yield Promise.all(k)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),i.getPrivateKeyByCredential=function(){var e=w()((function*(e){var t,n=R.a.decode(e);return 64===n.length&&(t=n.slice(0,32)),Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),i.refreshRecentBlockBash=function(){var e=w()((function*(e){var t=yield this.helper.parseToNativeTx(e),n=yield this.getClient(),r=yield n.getFees(),o=v()(r,2);return t.recentBlockhash=o[1],R.a.encode(t.serialize({requireAllSignatures:!1}))}));return function(t){return e.apply(this,arguments)}}(),i.getAccountNameInfoMap=function(){var e=w()((function*(){var e=this.walletId.startsWith("hw"),t=yield this.getNetwork(),n=Object(G.getAccountNameInfoByImpl)(t.impl);return e||!this.walletId?o()(n,"ledgerLive"):n}));return function(){return e.apply(this,arguments)}}(),i.canAutoCreateNextAccount=function(){var e=w()((function*(e){return Promise.resolve(!0)}));return function(t){return e.apply(this,arguments)}}(),i.getUserNFTAssets=function(){var e=w()((function*(e){var t=e.serviceData;return Promise.resolve({type:z.NFTAssetType.SOL,data:t})}));return function(t){return e.apply(this,arguments)}}(),T()(r)}(Y.VaultBase)}.call(this,n(26).Buffer)}}]);