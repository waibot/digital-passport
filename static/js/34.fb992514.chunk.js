(this.webpackJsonp=this.webpackJsonp||[]).push([[34],{3903:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringBase",(function(){return h})),r.d(t,"KeyringBaseMock",(function(){return y}));var n=r(2),i=r.n(n),o=r(6),a=r.n(o),c=r(9),s=r.n(c),u=r(14),f=r.n(u),d=r(7),l=r.n(d);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l()(e);if(t){var i=l()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var h=function(e){s()(r,e);var t=p(r);function r(e){var r;return(r=t.call(this,e.options)).vault=e,r}return r.prototype.addressFromBase=function(){var e=i()((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),a()(r)}(r(1585).VaultContext),y=function(e){s()(r,e);var t=p(r);function r(){return t.apply(this,arguments)}return a()(r)}(h)},3905:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringSoftwareBase",(function(){return I}));var n=r(4),i=r.n(n),o=r(3),a=r.n(o),c=r(2),s=r.n(c),u=r(6),f=r.n(u),d=r(9),l=r.n(d),p=r(14),h=r.n(p),y=r(7),v=r.n(y),b=r(19),g=r(23);function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var i=v()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h()(this,r)}}var I=function(e){l()(r,e);var t=m(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.signTransaction=function(){var e=s()((function*(e,t){var r=t.password;if("undefined"===typeof r)throw new g.OneKeyInternalError("Software signing requires a password.");var n=yield this.getSigners(r,e.inputs.map((function(e){return e.address})));return b.default.engine.info("signTransaction",this.networkId,e),w(w({},yield this.engine.providerManager.signTransaction(this.networkId,e,n)),{},{encodedTx:e.encodedTx})}));return function(t,r){return e.apply(this,arguments)}}(),n.signMessage=function(){var e=s()((function*(e,t){var r=this,n=t.password;if("undefined"===typeof n)throw new g.OneKeyInternalError("Software signing requires a password.");var o=yield this.getDbAccount(),a=Object.values(yield this.getSigners(n,[o.address])),c=i()(a,1)[0];return b.default.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return r.engine.providerManager.signMessage(r.networkId,e,c)})))}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},f()(r)}(r(3903).KeyringBase)},3912:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"VaultBaseChainOnly",(function(){return C})),r.d(t,"VaultBase",(function(){return K}));var n=r(202),i=r.n(n),o=r(3),a=r.n(o),c=r(60),s=r.n(c),u=r(2),f=r.n(u),d=r(6),l=r.n(d),p=r(9),h=r.n(p),y=r(14),v=r.n(y),b=r(7),g=r.n(b),E=r(21),w=r.n(E),m=r(167),I=r.n(m),_=r(11),A=r(19),P=r(24),T=r(68),N=r(23),S=r(182),x=r(947),k=r(52),B=r(1585);function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=g()(e);if(t){var i=g()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return v()(this,r)}}if(P.default.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var C=function(e){h()(r,e);var t=O(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.initProvider=function(){var e=f()((function*(){var e=(yield this.getNetwork()).impl;s()(x.IMPL_MAPPINGS[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),n.proxyJsonRPCCall=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.createClientFromURL=function(e){throw new N.NotImplemented},n.getEthersProvider=function(){var e=f()((function*(){throw new N.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.getClientEndpointStatus=function(){var e=f()((function*(e){var t=this.createClientFromURL(e),r=performance.now(),n=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-r),latestBlock:n}}));return function(t){return e.apply(this,arguments)}}(),n.checkRpcBatchSupport=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.getDisplayAddress=function(){var e=f()((function*(e){return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),n.validateAddress=function(){var e=f()((function*(e){var t=yield this.engineProvider.verifyAddress(e),r=t.normalizedAddress;if(!t.isValid||!r)throw new N.InvalidAddress;return Promise.resolve(r)}));return function(t){return e.apply(this,arguments)}}(),n.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},n.validateWatchingCredential=function(){var e=f()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),n.validateTokenAddress=function(){var e=f()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),r=t.normalizedAddress;if(!t.isValid||"undefined"===typeof r)throw new N.InvalidTokenAddress;return Promise.resolve(r)}));return function(t){return e.apply(this,arguments)}}(),n.validateCanCreateNextAccount=function(){var e=f()((function*(e,t){return Promise.resolve(!0)}));return function(t,r){return e.apply(this,arguments)}}(),n.checkAccountExistence=function(){var e=f()((function*(e,t){return Promise.resolve(!0)}));return function(t,r){return e.apply(this,arguments)}}(),n.getBalances=function(){var e=f()((function*(e,t,r){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,r=e.tokenAddress;return{address:t,coin:D({},"string"===typeof r?{tokenAddress:r}:{})}})))}));return function(t,r,n){return e.apply(this,arguments)}}(),n.getFrozenBalance=function(){var e=f()((function*(e){return 0}));return function(t){return e.apply(this,arguments)}}(),n.fetchBalanceDetails=function(){var e=f()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password;return Promise.resolve(void 0)}));return function(){return e.apply(this,arguments)}}(),n.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},n.getTransactionFeeInNative=function(e){return Promise.resolve("")},n.isContractAddress=function(){var e=f()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNameInfoMap=function(){var e=f()((function*(){var e=yield this.getNetwork();return Object(S.getAccountNameInfoByImpl)(e.impl)}));return function(){return e.apply(this,arguments)}}(),n.canAutoCreateNextAccount=function(){var e=f()((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),n.filterAccounts=function(){var e=f()((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),n.shouldChangeAccountWhenNetworkChanged=function(){var e=f()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),n.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=f()((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),n.checkIsUnlimitedAllowance=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.checkIsApprovedForAll=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.checkIsBatchTransfer=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),n.getFeePricePerUnit=function(){var e=f()((function*(){throw new N.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.fetchRpcChainId=function(){var e=f()((function*(e){return null}));return function(t){return e.apply(this,arguments)}}(),n.getTxWaitingSeconds=function(){var e=f()((function*(){return[]}));return function(){return e.apply(this,arguments)}}(),n.getUserNFTAssets=function(){var e=f()((function*(e){e.serviceData;return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),l()(r)}(B.VaultContext),K=function(t){h()(n,t);var r=O(n);function n(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=r.call.apply(r,[this].concat(n))).uuid=I.a.v4().toString(),e}var o=n.prototype;return o.init=function(){var e=f()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),o.initKeyring=function(){var e=f()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var e=f()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,r){return e.apply(this,arguments)}}(),o.signAndSendTransaction=function(){var e=f()((function*(e,t,r){var n=yield this.signTransaction(e,t);return r?D(D({},n),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(D(D({},n),{},{encodedTx:e.encodedTx}))}));return function(t,r,n){return e.apply(this,arguments)}}(),o.broadcastTransaction=function(){var e=f()((function*(e,t){A.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var r=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return A.default.engine.info("broadcastTransaction END:",{txid:r,rawTx:e.rawTx}),D(D({},e),{},{txid:r,encodedTx:e.encodedTx})}));return function(t,r){return e.apply(this,arguments)}}(),o.buildEncodedTxFromBatchTransfer=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.buildEncodedTxsFromSetApproveForAll=function(){var e=f()((function*(e,t){throw new N.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),o.activateAccount=function(){var e=f()((function*(){throw new N.NotImplemented}));return function(){return e.apply(this,arguments)}}(),o.activateToken=function(){var e=f()((function*(e,t){throw new N.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),o.getTokenAllowance=function(){var e=f()((function*(e,t){throw new N.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),o.batchTokensAllowance=function(){var e=f()((function*(e,t){throw new N.NotImplemented}));return function(t,r){return e.apply(this,arguments)}}(),o.getOutputAccount=function(){var e=f()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:i()(e,"pub","")}}));return function(){return e.apply(this,arguments)}}(),o.getAccountBalance=function(){var e=f()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=yield this.getDbAccount(),o=i.address;return this.getBalances((t?[{address:o}]:[]).concat(e.map((function(e){return{address:o,tokenAddress:e}}))),r,n)}));return function(t){return e.apply(this,arguments)}}(),o.updatePendingTxs=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.getAccountNonce=function(){var e=f()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),o.fixActionDirection=function(){var e=f()((function*(e){var t,r,n,i,o=e.action,a=e.accountAddress;(o.direction=k.IDecodedTxDirection.OTHER,o.type===k.IDecodedTxActionType.NATIVE_TRANSFER)&&(o.direction=yield this.buildTxActionDirection({from:(null==(t=o.nativeTransfer)?void 0:t.from)||"",to:(null==(r=o.nativeTransfer)?void 0:r.to)||"",address:a}));o.type===k.IDecodedTxActionType.TOKEN_TRANSFER&&(o.direction=yield this.buildTxActionDirection({from:(null==(n=o.tokenTransfer)?void 0:n.from)||"",to:(null==(i=o.tokenTransfer)?void 0:i.to)||"",address:a}));return o}));return function(t){return e.apply(this,arguments)}}(),o.fixDecodedTx=function(){var e=f()((function*(e){var t,r;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var n=null==(r=e.encodedTx)?void 0:r.nonce;e.nonce=s()(n)?e.nonce:new w.a(n).toNumber();for(var i=e.owner,o=0;o<e.actions.length;o+=1){var a=e.actions[o];yield this.fixActionDirection({action:a,accountAddress:i})}if(e.outputActions)for(var c=0;c<e.outputActions.length;c+=1){var u=e.outputActions[c];yield this.fixActionDirection({action:u,accountAddress:i})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.fixHistoryTx=function(){var e=f()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.buildHistoryTx=function(){var e=f()((function*(e){var t=e.historyTxToMerge,r=(e.encodedTx,e.decodedTx),n=e.signedTx,i=e.isSigner,o=e.isLocalCreated,a=(null==n?void 0:n.txid)||(null==r?void 0:r.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var c=yield this.getAccountAddress();r.txid=a||r.txid,r.owner=c,i&&(r.signer=c),null!=n&&n.txKey&&(r.extraInfo?r.extraInfo.txKey=n.txKey:r.extraInfo={txKey:n.txKey});var s=D(D({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(o)},t),{},{decodedTx:r});return s=yield this.fixHistoryTx(s),Promise.resolve(s)}));return function(t){return e.apply(this,arguments)}}(),o.checkIsScamHistoryTx=function(){var e=f()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),o.fetchOnChainHistory=function(){var e=f()((function*(e){throw new N.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.fixAddressCase=function(e){return Promise.resolve(e)},o.buildTxActionDirection=function(){var e=f()((function*(e){var t=e.from,r=e.to,n=e.address;return t=yield this.fixAddressCase(t||""),r=yield this.fixAddressCase(r),n=yield this.fixAddressCase(n),t===r&&t===n?k.IDecodedTxDirection.SELF:t&&t===n?k.IDecodedTxDirection.OUT:r&&r===n?k.IDecodedTxDirection.IN:k.IDecodedTxDirection.OTHER}));return function(t){return e.apply(this,arguments)}}(),o.getNextNonce=function(){var e=f()((function*(e,t){var r,n,i=null!=(r=null==(n=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:n.nonce)?r:0,o=(yield this.engine.getHistory(e,t.id,void 0,!1),yield T.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),a=yield T.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),c=Math.max(s()(o)?0:o+1,i);if(Number.isNaN(c)&&(c=i),c>i)for(var u=i;u<c;u+=1)if(!a.includes(u)){c=u;break}if(c<i&&(c=i),c-i>=_.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new N.PendingQueueTooLong(_.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return c}));return function(t,r){return e.apply(this,arguments)}}(),o.validateSendAmount=function(e,t,r){return Promise.resolve(!0)},o.notifyChainChanged=function(e,t){},o.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},o.getPrivateKeyByCredential=function(t){return Promise.resolve(e.from(t.startsWith("0x")?t.slice(2):t,"hex"))},o.getMinDepositAmount=function(){var e=f()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),o.specialCheckEncodedTx=function(){var e=f()((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),o.getAllUsedAddress=function(){var e=f()((function*(){return Promise.resolve([])}));return function(){return e.apply(this,arguments)}}(),l()(n)}(C)}.call(this,r(26).Buffer)},3913:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"KeyringHardwareBase",(function(){return v}));var n=r(2),i=r.n(n),o=r(6),a=r.n(o),c=r(9),s=r.n(c),u=r(14),f=r.n(u),d=r(7),l=r.n(d),p=r(431),h=r(163);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l()(e);if(t){var i=l()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var v=function(t){s()(n,t);var r=y(n);function n(){return r.apply(this,arguments)}var o=n.prototype;return o.getHardwareInfo=function(){var e=i()((function*(){var e,t,r,n=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==n?void 0:n.mac)?e:"",deviceId:null!=(t=null==n?void 0:n.deviceId)?t:"",deviceType:null!=(r=null==n?void 0:n.deviceType)?r:""}}));return function(){return e.apply(this,arguments)}}(),o.getWalletPassphraseState=function(){var e=i()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(h.isPassphraseWallet)(e)}}));return function(){return e.apply(this,arguments)}}(),o.getHardwareSDKInstance=function(){var t=i()((function*(){var t,r,n,i,o;return null!=(o=yield null==(t=e)||null==(r=t.$backgroundApiProxy)||null==(n=r.backgroundApi)||null==(i=n.serviceHardware)||null==i.getSDKInstance?void 0:i.getSDKInstance())?o:p.HardwareSDK}));return function(){return t.apply(this,arguments)}}(),o.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},a()(n)}(r(3903).KeyringBase)}.call(this,r(58))},3914:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringHdBase",(function(){return w}));var n=r(3),i=r.n(n),o=r(2),a=r.n(o),c=r(6),s=r.n(c),u=r(9),f=r.n(u),d=r(14),l=r.n(d),p=r(7),h=r.n(p),y=r(610),v=r(23);function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=h()(e);if(t){var i=h()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l()(this,r)}}var w=function(e){f()(r,e);var t=E(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getPrivateKeys=function(){var e=a()((function*(e,t){var r=(yield this.getDbAccount()).path.split("/"),n=t||[r.pop()],i=r.join("/"),o=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof o)throw new v.OneKeyInternalError("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(y.batchGetPrivateKeys)(a,o,e,i,n).reduce((function(e,t){var r;return g(g({},e),{},((r={})[t.path]=t.extendedKey.key,r))}),{})}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},s()(r)}(r(3905).KeyringSoftwareBase)},3915:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringImportedBase",(function(){return y}));var n=r(2),i=r.n(n),o=r(6),a=r.n(o),c=r(9),s=r.n(c),u=r(14),f=r.n(u),d=r(7),l=r.n(d),p=r(23);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l()(e);if(t){var i=l()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var y=function(e){s()(r,e);var t=h(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getPrivateKeys=function(){var e=i()((function*(e,t){if("undefined"!==typeof t)throw new p.NotImplemented("Getting private keys from extended private key");var r=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof r)throw new p.OneKeyInternalError("Unable to get credential.");return{"":r}}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(r)}(r(3905).KeyringSoftwareBase)},3916:function(e,t,r){"use strict";r.r(t),r.d(t,"KeyringWatchingBase",(function(){return y}));var n=r(2),i=r.n(n),o=r(6),a=r.n(o),c=r(9),s=r.n(c),u=r(14),f=r.n(u),d=r(7),l=r.n(d),p=r(23);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l()(e);if(t){var i=l()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return f()(this,r)}}var y=function(e){s()(r,e);var t=h(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.signTransaction=function(){var e=i()((function*(e,t){throw new p.OneKeyInternalError("signTransaction is not supported for watching accounts")}));return function(t,r){return e.apply(this,arguments)}}(),n.signMessage=function(){var e=i()((function*(e,t){throw new p.OneKeyInternalError("signMessage is not supported for watching accounts")}));return function(t,r){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(r)}(r(3903).KeyringBase)},3925:function(e){e.exports=JSON.parse('{"COMPRESSED_TYPE_INVALID":"compressed should be a boolean","EC_PRIVATE_KEY_TYPE_INVALID":"private key should be a Buffer","EC_PRIVATE_KEY_LENGTH_INVALID":"private key length is invalid","EC_PRIVATE_KEY_RANGE_INVALID":"private key range is invalid","EC_PRIVATE_KEY_TWEAK_ADD_FAIL":"tweak out of range or resulting private key is invalid","EC_PRIVATE_KEY_TWEAK_MUL_FAIL":"tweak out of range","EC_PRIVATE_KEY_EXPORT_DER_FAIL":"couldn\'t export to DER format","EC_PRIVATE_KEY_IMPORT_DER_FAIL":"couldn\'t import from DER format","EC_PUBLIC_KEYS_TYPE_INVALID":"public keys should be an Array","EC_PUBLIC_KEYS_LENGTH_INVALID":"public keys Array should have at least 1 element","EC_PUBLIC_KEY_TYPE_INVALID":"public key should be a Buffer","EC_PUBLIC_KEY_LENGTH_INVALID":"public key length is invalid","EC_PUBLIC_KEY_PARSE_FAIL":"the public key could not be parsed or is invalid","EC_PUBLIC_KEY_CREATE_FAIL":"private was invalid, try again","EC_PUBLIC_KEY_TWEAK_ADD_FAIL":"tweak out of range or resulting public key is invalid","EC_PUBLIC_KEY_TWEAK_MUL_FAIL":"tweak out of range","EC_PUBLIC_KEY_COMBINE_FAIL":"the sum of the public keys is not valid","ECDH_FAIL":"scalar was invalid (zero or overflow)","ECDSA_SIGNATURE_TYPE_INVALID":"signature should be a Buffer","ECDSA_SIGNATURE_LENGTH_INVALID":"signature length is invalid","ECDSA_SIGNATURE_PARSE_FAIL":"couldn\'t parse signature","ECDSA_SIGNATURE_PARSE_DER_FAIL":"couldn\'t parse DER signature","ECDSA_SIGNATURE_SERIALIZE_DER_FAIL":"couldn\'t serialize signature to DER format","ECDSA_SIGN_FAIL":"nonce generation function failed or private key is invalid","ECDSA_RECOVER_FAIL":"couldn\'t recover public key from signature","MSG32_TYPE_INVALID":"message should be a Buffer","MSG32_LENGTH_INVALID":"message length is invalid","OPTIONS_TYPE_INVALID":"options should be an Object","OPTIONS_DATA_TYPE_INVALID":"options.data should be a Buffer","OPTIONS_DATA_LENGTH_INVALID":"options.data length is invalid","OPTIONS_NONCEFN_TYPE_INVALID":"options.noncefn should be a Function","RECOVERY_ID_TYPE_INVALID":"recovery should be a Number","RECOVERY_ID_VALUE_INVALID":"recovery should have value between -1 and 4","TWEAK_TYPE_INVALID":"tweak should be a Buffer","TWEAK_LENGTH_INVALID":"tweak length is invalid"}')},3926:function(e,t,r){(function(t){var n=r(1346);function i(e,t){if(void 0!==t&&e[0]!==t)throw new Error("Invalid network version");if(33===e.length)return{version:e[0],privateKey:e.slice(1,33),compressed:!1};if(34!==e.length)throw new Error("Invalid WIF length");if(1!==e[33])throw new Error("Invalid compression flag");return{version:e[0],privateKey:e.slice(1,33),compressed:!0}}function o(e,r,n){var i=new t(n?34:33);return i.writeUInt8(e,0),r.copy(i,1),n&&(i[33]=1),i}e.exports={decode:function(e,t){return i(n.decode(e),t)},decodeRaw:i,encode:function(e,t,r){return"number"===typeof e?n.encode(o(e,t,r)):n.encode(o(e.version,e.privateKey,e.compressed))},encodeRaw:o}}).call(this,r(26).Buffer)},3932:function(e,t,r){var n=r(313).Buffer;e.exports={check:function(e){if(e.length<8)return!1;if(e.length>72)return!1;if(48!==e[0])return!1;if(e[1]!==e.length-2)return!1;if(2!==e[2])return!1;var t=e[3];if(0===t)return!1;if(5+t>=e.length)return!1;if(2!==e[4+t])return!1;var r=e[5+t];return 0!==r&&(6+t+r===e.length&&(!(128&e[4])&&(!(t>1&&0===e[4]&&!(128&e[5]))&&(!(128&e[t+6])&&!(r>1&&0===e[t+6]&&!(128&e[t+7]))))))},decode:function(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(48!==e[0])throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(2!==e[2])throw new Error("Expected DER integer");var t=e[3];if(0===t)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(2!==e[4+t])throw new Error("Expected DER integer (2)");var r=e[5+t];if(0===r)throw new Error("S length is zero");if(6+t+r!==e.length)throw new Error("S length is invalid");if(128&e[4])throw new Error("R value is negative");if(t>1&&0===e[4]&&!(128&e[5]))throw new Error("R value excessively padded");if(128&e[t+6])throw new Error("S value is negative");if(r>1&&0===e[t+6]&&!(128&e[t+7]))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}},encode:function(e,t){var r=e.length,i=t.length;if(0===r)throw new Error("R length is zero");if(0===i)throw new Error("S length is zero");if(r>33)throw new Error("R length is too long");if(i>33)throw new Error("S length is too long");if(128&e[0])throw new Error("R value is negative");if(128&t[0])throw new Error("S value is negative");if(r>1&&0===e[0]&&!(128&e[1]))throw new Error("R value excessively padded");if(i>1&&0===t[0]&&!(128&t[1]))throw new Error("S value excessively padded");var o=n.allocUnsafe(6+r+i);return o[0]=48,o[1]=o.length-2,o[2]=2,o[3]=e.length,e.copy(o,4),o[4+r]=2,o[5+r]=t.length,t.copy(o,6+r),o}}},3936:function(e,t,r){"use strict";e.exports=r(3937)(r(3940))},3937:function(e,t,r){"use strict";var n=r(3938),i=r(3939),o=r(3925);function a(e,t){return void 0===e?t:(n.isBoolean(e,o.COMPRESSED_TYPE_INVALID),e)}e.exports=function(e){return{privateKeyVerify:function(t){return n.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),32===t.length&&e.privateKeyVerify(t)},privateKeyExport:function(t,r){n.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),r=a(r,!0);var c=e.privateKeyExport(t,r);return i.privateKeyExport(t,c,r)},privateKeyImport:function(t){if(n.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),(t=i.privateKeyImport(t))&&32===t.length&&e.privateKeyVerify(t))return t;throw new Error(o.EC_PRIVATE_KEY_IMPORT_DER_FAIL)},privateKeyNegate:function(t){return n.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyNegate(t)},privateKeyModInverse:function(t){return n.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyModInverse(t)},privateKeyTweakAdd:function(t,r){return n.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,o.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,o.TWEAK_LENGTH_INVALID),e.privateKeyTweakAdd(t,r)},privateKeyTweakMul:function(t,r){return n.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,o.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,o.TWEAK_LENGTH_INVALID),e.privateKeyTweakMul(t,r)},publicKeyCreate:function(t,r){return n.isBuffer(t,o.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),r=a(r,!0),e.publicKeyCreate(t,r)},publicKeyConvert:function(t,r){return n.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),r=a(r,!0),e.publicKeyConvert(t,r)},publicKeyVerify:function(t){return n.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),e.publicKeyVerify(t)},publicKeyTweakAdd:function(t,r,i){return n.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,o.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,o.TWEAK_LENGTH_INVALID),i=a(i,!0),e.publicKeyTweakAdd(t,r,i)},publicKeyTweakMul:function(t,r,i){return n.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,o.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,o.TWEAK_LENGTH_INVALID),i=a(i,!0),e.publicKeyTweakMul(t,r,i)},publicKeyCombine:function(t,r){n.isArray(t,o.EC_PUBLIC_KEYS_TYPE_INVALID),n.isLengthGTZero(t,o.EC_PUBLIC_KEYS_LENGTH_INVALID);for(var i=0;i<t.length;++i)n.isBuffer(t[i],o.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t[i],33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID);return r=a(r,!0),e.publicKeyCombine(t,r)},signatureNormalize:function(t){return n.isBuffer(t,o.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,o.ECDSA_SIGNATURE_LENGTH_INVALID),e.signatureNormalize(t)},signatureExport:function(t){n.isBuffer(t,o.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,o.ECDSA_SIGNATURE_LENGTH_INVALID);var r=e.signatureExport(t);return i.signatureExport(r)},signatureImport:function(t){n.isBuffer(t,o.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,o.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImport(t);if(r)return e.signatureImport(r);throw new Error(o.ECDSA_SIGNATURE_PARSE_DER_FAIL)},signatureImportLax:function(t){n.isBuffer(t,o.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,o.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImportLax(t);if(r)return e.signatureImport(r);throw new Error(o.ECDSA_SIGNATURE_PARSE_DER_FAIL)},sign:function(t,r,i){n.isBuffer(t,o.MSG32_TYPE_INVALID),n.isBufferLength(t,32,o.MSG32_LENGTH_INVALID),n.isBuffer(r,o.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,o.EC_PRIVATE_KEY_LENGTH_INVALID);var a=null,c=null;return void 0!==i&&(n.isObject(i,o.OPTIONS_TYPE_INVALID),void 0!==i.data&&(n.isBuffer(i.data,o.OPTIONS_DATA_TYPE_INVALID),n.isBufferLength(i.data,32,o.OPTIONS_DATA_LENGTH_INVALID),a=i.data),void 0!==i.noncefn&&(n.isFunction(i.noncefn,o.OPTIONS_NONCEFN_TYPE_INVALID),c=i.noncefn)),e.sign(t,r,c,a)},verify:function(t,r,i){return n.isBuffer(t,o.MSG32_TYPE_INVALID),n.isBufferLength(t,32,o.MSG32_LENGTH_INVALID),n.isBuffer(r,o.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,o.ECDSA_SIGNATURE_LENGTH_INVALID),n.isBuffer(i,o.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(i,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),e.verify(t,r,i)},recover:function(t,r,i,c){return n.isBuffer(t,o.MSG32_TYPE_INVALID),n.isBufferLength(t,32,o.MSG32_LENGTH_INVALID),n.isBuffer(r,o.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,o.ECDSA_SIGNATURE_LENGTH_INVALID),n.isNumber(i,o.RECOVERY_ID_TYPE_INVALID),n.isNumberInInterval(i,-1,4,o.RECOVERY_ID_VALUE_INVALID),c=a(c,!0),e.recover(t,r,i,c)},ecdh:function(t,r){return n.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,o.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),e.ecdh(t,r)},ecdhUnsafe:function(t,r,i){return n.isBuffer(t,o.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,o.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,o.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,o.EC_PRIVATE_KEY_LENGTH_INVALID),i=a(i,!0),e.ecdhUnsafe(t,r,i)}}}},3938:function(e,t,r){"use strict";(function(e){var r=Object.prototype.toString;t.isArray=function(e,t){if(!Array.isArray(e))throw TypeError(t)},t.isBoolean=function(e,t){if("[object Boolean]"!==r.call(e))throw TypeError(t)},t.isBuffer=function(t,r){if(!e.isBuffer(t))throw TypeError(r)},t.isFunction=function(e,t){if("[object Function]"!==r.call(e))throw TypeError(t)},t.isNumber=function(e,t){if("[object Number]"!==r.call(e))throw TypeError(t)},t.isObject=function(e,t){if("[object Object]"!==r.call(e))throw TypeError(t)},t.isBufferLength=function(e,t,r){if(e.length!==t)throw RangeError(r)},t.isBufferLength2=function(e,t,r,n){if(e.length!==t&&e.length!==r)throw RangeError(n)},t.isLengthGTZero=function(e,t){if(0===e.length)throw RangeError(t)},t.isNumberInInterval=function(e,t,r,n){if(e<=t||e>=r)throw RangeError(n)}}).call(this,r(26).Buffer)},3939:function(e,t,r){"use strict";var n=r(313).Buffer,i=r(3932),o=n.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),a=n.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);t.privateKeyExport=function(e,t,r){var i=n.from(r?o:a);return e.copy(i,r?8:9),t.copy(i,r?181:214),i},t.privateKeyImport=function(e){var t=e.length,r=0;if(!(t<r+1||48!==e[r])&&!(t<(r+=1)+1)&&128&e[r]){var n=127&e[r];if(r+=1,!(n<1||n>2)&&!(t<r+n)){var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);if(!(t<(r+=n)+i)&&!(t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2])&&!(t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]))return e.slice(r+2,r+2+e[r+1])}}},t.signatureExport=function(e){for(var t=n.concat([n.from([0]),e.r]),r=33,o=0;r>1&&0===t[o]&&!(128&t[o+1]);--r,++o);for(var a=n.concat([n.from([0]),e.s]),c=33,s=0;c>1&&0===a[s]&&!(128&a[s+1]);--c,++s);return i.encode(t.slice(o),a.slice(s))},t.signatureImport=function(e){var t=n.alloc(32,0),r=n.alloc(32,0);try{var o=i.decode(e);if(33===o.r.length&&0===o.r[0]&&(o.r=o.r.slice(1)),o.r.length>32)throw new Error("R length is too long");if(33===o.s.length&&0===o.s[0]&&(o.s=o.s.slice(1)),o.s.length>32)throw new Error("S length is too long")}catch(a){return}return o.r.copy(t,32-o.r.length),o.s.copy(r,32-o.s.length),{r:t,s:r}},t.signatureImportLax=function(e){var t=n.alloc(32,0),r=n.alloc(32,0),i=e.length,o=0;if(48===e[o++]){var a=e[o++];if(!(128&a&&(o+=a-128)>i)&&2===e[o++]){var c=e[o++];if(128&c){if(o+(a=c-128)>i)return;for(;a>0&&0===e[o];o+=1,a-=1);for(c=0;a>0;o+=1,a-=1)c=(c<<8)+e[o]}if(!(c>i-o)){var s=o;if(o+=c,2===e[o++]){var u=e[o++];if(128&u){if(o+(a=u-128)>i)return;for(;a>0&&0===e[o];o+=1,a-=1);for(u=0;a>0;o+=1,a-=1)u=(u<<8)+e[o]}if(!(u>i-o)){var f=o;for(o+=u;c>0&&0===e[s];c-=1,s+=1);if(!(c>32)){var d=e.slice(s,s+c);for(d.copy(t,32-d.length);u>0&&0===e[f];u-=1,f+=1);if(!(u>32)){var l=e.slice(f,f+u);return l.copy(r,32-l.length),{r:t,s:r}}}}}}}}}},3940:function(e,t,r){"use strict";var n=r(313).Buffer,i=r(746),o=r(166),a=r(521).ec,c=r(3925),s=new a("secp256k1"),u=s.curve;function f(e){var t=e[0];switch(t){case 2:case 3:return 33!==e.length?null:function(e,t){var r=new o(t);if(r.cmp(u.p)>=0)return null;var n=(r=r.toRed(u.red)).redSqr().redIMul(r).redIAdd(u.b).redSqrt();return 3===e!==n.isOdd()&&(n=n.redNeg()),s.keyPair({pub:{x:r,y:n}})}(t,e.slice(1,33));case 4:case 6:case 7:return 65!==e.length?null:function(e,t,r){var n=new o(t),i=new o(r);if(n.cmp(u.p)>=0||i.cmp(u.p)>=0)return null;if(n=n.toRed(u.red),i=i.toRed(u.red),(6===e||7===e)&&i.isOdd()!==(7===e))return null;var a=n.redSqr().redIMul(n);return i.redSqr().redISub(a.redIAdd(u.b)).isZero()?s.keyPair({pub:{x:n,y:i}}):null}(t,e.slice(1,33),e.slice(33,65));default:return null}}t.privateKeyVerify=function(e){var t=new o(e);return t.cmp(u.n)<0&&!t.isZero()},t.privateKeyExport=function(e,t){var r=new o(e);if(r.cmp(u.n)>=0||r.isZero())throw new Error(c.EC_PRIVATE_KEY_EXPORT_DER_FAIL);return n.from(s.keyFromPrivate(e).getPublic(t,!0))},t.privateKeyNegate=function(e){var t=new o(e);return t.isZero()?n.alloc(32):u.n.sub(t).umod(u.n).toArrayLike(n,"be",32)},t.privateKeyModInverse=function(e){var t=new o(e);if(t.cmp(u.n)>=0||t.isZero())throw new Error(c.EC_PRIVATE_KEY_RANGE_INVALID);return t.invm(u.n).toArrayLike(n,"be",32)},t.privateKeyTweakAdd=function(e,t){var r=new o(t);if(r.cmp(u.n)>=0)throw new Error(c.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);if(r.iadd(new o(e)),r.cmp(u.n)>=0&&r.isub(u.n),r.isZero())throw new Error(c.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);return r.toArrayLike(n,"be",32)},t.privateKeyTweakMul=function(e,t){var r=new o(t);if(r.cmp(u.n)>=0||r.isZero())throw new Error(c.EC_PRIVATE_KEY_TWEAK_MUL_FAIL);return r.imul(new o(e)),r.cmp(u.n)&&(r=r.umod(u.n)),r.toArrayLike(n,"be",32)},t.publicKeyCreate=function(e,t){var r=new o(e);if(r.cmp(u.n)>=0||r.isZero())throw new Error(c.EC_PUBLIC_KEY_CREATE_FAIL);return n.from(s.keyFromPrivate(e).getPublic(t,!0))},t.publicKeyConvert=function(e,t){var r=f(e);if(null===r)throw new Error(c.EC_PUBLIC_KEY_PARSE_FAIL);return n.from(r.getPublic(t,!0))},t.publicKeyVerify=function(e){return null!==f(e)},t.publicKeyTweakAdd=function(e,t,r){var i=f(e);if(null===i)throw new Error(c.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new o(t)).cmp(u.n)>=0)throw new Error(c.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);var a=u.g.mul(t).add(i.pub);if(a.isInfinity())throw new Error(c.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);return n.from(a.encode(!0,r))},t.publicKeyTweakMul=function(e,t,r){var i=f(e);if(null===i)throw new Error(c.EC_PUBLIC_KEY_PARSE_FAIL);if((t=new o(t)).cmp(u.n)>=0||t.isZero())throw new Error(c.EC_PUBLIC_KEY_TWEAK_MUL_FAIL);return n.from(i.pub.mul(t).encode(!0,r))},t.publicKeyCombine=function(e,t){for(var r=new Array(e.length),i=0;i<e.length;++i)if(r[i]=f(e[i]),null===r[i])throw new Error(c.EC_PUBLIC_KEY_PARSE_FAIL);for(var o=r[0].pub,a=1;a<r.length;++a)o=o.add(r[a].pub);if(o.isInfinity())throw new Error(c.EC_PUBLIC_KEY_COMBINE_FAIL);return n.from(o.encode(!0,t))},t.signatureNormalize=function(e){var t=new o(e.slice(0,32)),r=new o(e.slice(32,64));if(t.cmp(u.n)>=0||r.cmp(u.n)>=0)throw new Error(c.ECDSA_SIGNATURE_PARSE_FAIL);var i=n.from(e);return 1===r.cmp(s.nh)&&u.n.sub(r).toArrayLike(n,"be",32).copy(i,32),i},t.signatureExport=function(e){var t=e.slice(0,32),r=e.slice(32,64);if(new o(t).cmp(u.n)>=0||new o(r).cmp(u.n)>=0)throw new Error(c.ECDSA_SIGNATURE_PARSE_FAIL);return{r:t,s:r}},t.signatureImport=function(e){var t=new o(e.r);t.cmp(u.n)>=0&&(t=new o(0));var r=new o(e.s);return r.cmp(u.n)>=0&&(r=new o(0)),n.concat([t.toArrayLike(n,"be",32),r.toArrayLike(n,"be",32)])},t.sign=function(e,t,r,i){if("function"===typeof r){var a=r;r=function(r){var s=a(e,t,null,i,r);if(!n.isBuffer(s)||32!==s.length)throw new Error(c.ECDSA_SIGN_FAIL);return new o(s)}}var f=new o(t);if(f.cmp(u.n)>=0||f.isZero())throw new Error(c.ECDSA_SIGN_FAIL);var d=s.sign(e,t,{canonical:!0,k:r,pers:i});return{signature:n.concat([d.r.toArrayLike(n,"be",32),d.s.toArrayLike(n,"be",32)]),recovery:d.recoveryParam}},t.verify=function(e,t,r){var n={r:t.slice(0,32),s:t.slice(32,64)},i=new o(n.r),a=new o(n.s);if(i.cmp(u.n)>=0||a.cmp(u.n)>=0)throw new Error(c.ECDSA_SIGNATURE_PARSE_FAIL);if(1===a.cmp(s.nh)||i.isZero()||a.isZero())return!1;var d=f(r);if(null===d)throw new Error(c.EC_PUBLIC_KEY_PARSE_FAIL);return s.verify(e,n,{x:d.pub.x,y:d.pub.y})},t.recover=function(e,t,r,i){var a={r:t.slice(0,32),s:t.slice(32,64)},f=new o(a.r),d=new o(a.s);if(f.cmp(u.n)>=0||d.cmp(u.n)>=0)throw new Error(c.ECDSA_SIGNATURE_PARSE_FAIL);try{if(f.isZero()||d.isZero())throw new Error;var l=s.recoverPubKey(e,a,r);return n.from(l.encode(!0,i))}catch(p){throw new Error(c.ECDSA_RECOVER_FAIL)}},t.ecdh=function(e,r){var n=t.ecdhUnsafe(e,r,!0);return i("sha256").update(n).digest()},t.ecdhUnsafe=function(e,t,r){var i=f(e);if(null===i)throw new Error(c.EC_PUBLIC_KEY_PARSE_FAIL);var a=new o(t);if(a.cmp(u.n)>=0||a.isZero())throw new Error(c.ECDH_FAIL);return n.from(i.pub.mul(a).encode(!0,r))}},3947:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.BIP32Factory=void 0;const n=r(3948),i=r(3949),o=r(821),a=r(300),c=r(2684),s=r(3926),u=(0,o.base58check)(a.sha256),f=e=>u.encode(Uint8Array.from(e)),d=t=>e.from(u.decode(t));t.BIP32Factory=function(t){(0,i.testEcc)(t);const r=c.BufferN(32),o=c.compile({wif:c.UInt8,bip32:{public:c.UInt32,private:c.UInt32}}),a={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},u=Math.pow(2,31)-1;function l(e){return c.String(e)&&null!==e.match(/^(m\/)?(\d+'?\/)*\d+'?$/)}function p(e){return c.UInt32(e)&&e<=u}class h{constructor(e,t){this.__D=e,this.__Q=t,this.lowR=!1}get publicKey(){return void 0===this.__Q&&(this.__Q=e.from(t.pointFromScalar(this.__D,!0))),this.__Q}get privateKey(){return this.__D}sign(r,n){if(!this.privateKey)throw new Error("Missing private key");if(void 0===n&&(n=this.lowR),!1===n)return e.from(t.sign(r,this.privateKey));{let n=e.from(t.sign(r,this.privateKey));const i=e.alloc(32,0);let o=0;for(;n[0]>127;)o++,i.writeUIntLE(o,0,6),n=e.from(t.sign(r,this.privateKey,i));return n}}signSchnorr(r){if(!this.privateKey)throw new Error("Missing private key");if(!t.signSchnorr)throw new Error("signSchnorr not supported by ecc library");return e.from(t.signSchnorr(r,this.privateKey))}verify(e,r){return t.verify(e,this.publicKey,r)}verifySchnorr(e,r){if(!t.verifySchnorr)throw new Error("verifySchnorr not supported by ecc library");return t.verifySchnorr(e,this.publicKey.subarray(1,33),r)}}class y extends h{constructor(e,t,r,n,i=0,a=0,s=0){super(e,t),this.chainCode=r,this.network=n,this.__DEPTH=i,this.__INDEX=a,this.__PARENT_FINGERPRINT=s,c(o,n)}get depth(){return this.__DEPTH}get index(){return this.__INDEX}get parentFingerprint(){return this.__PARENT_FINGERPRINT}get identifier(){return n.hash160(this.publicKey)}get fingerprint(){return this.identifier.slice(0,4)}get compressed(){return!0}isNeutered(){return void 0===this.__D}neutered(){return g(this.publicKey,this.chainCode,this.network,this.depth,this.index,this.parentFingerprint)}toBase58(){const t=this.network,r=this.isNeutered()?t.bip32.public:t.bip32.private,n=e.allocUnsafe(78);return n.writeUInt32BE(r,0),n.writeUInt8(this.depth,4),n.writeUInt32BE(this.parentFingerprint,5),n.writeUInt32BE(this.index,9),this.chainCode.copy(n,13),this.isNeutered()?this.publicKey.copy(n,45):(n.writeUInt8(0,45),this.privateKey.copy(n,46)),f(n)}toWIF(){if(!this.privateKey)throw new TypeError("Missing private key");return s.encode(this.network.wif,this.privateKey,!0)}derive(r){c(c.UInt32,r);const i=r>=2147483648,o=e.allocUnsafe(37);if(i){if(this.isNeutered())throw new TypeError("Missing private key for hardened child key");o[0]=0,this.privateKey.copy(o,1),o.writeUInt32BE(r,33)}else this.publicKey.copy(o,0),o.writeUInt32BE(r,33);const a=n.hmacSHA512(this.chainCode,o),s=a.slice(0,32),u=a.slice(32);if(!t.isPrivate(s))return this.derive(r+1);let f;if(this.isNeutered()){const n=e.from(t.pointAddScalar(this.publicKey,s,!0));if(null===n)return this.derive(r+1);f=g(n,u,this.network,this.depth+1,r,this.fingerprint.readUInt32BE(0))}else{const n=e.from(t.privateAdd(this.privateKey,s));if(null==n)return this.derive(r+1);f=b(n,u,this.network,this.depth+1,r,this.fingerprint.readUInt32BE(0))}return f}deriveHardened(e){return c(p,e),this.derive(e+2147483648)}derivePath(e){c(l,e);let t=e.split("/");if("m"===t[0]){if(this.parentFingerprint)throw new TypeError("Expected master, got child");t=t.slice(1)}return t.reduce((e,t)=>{let r;return"'"===t.slice(-1)?(r=parseInt(t.slice(0,-1),10),e.deriveHardened(r)):(r=parseInt(t,10),e.derive(r))},this)}tweak(e){return this.privateKey?this.tweakFromPrivateKey(e):this.tweakFromPublicKey(e)}tweakFromPublicKey(r){const n=32===(i=this.publicKey).length?i:i.slice(1,33);var i;if(!t.xOnlyPointAddTweak)throw new Error("xOnlyPointAddTweak not supported by ecc library");const o=t.xOnlyPointAddTweak(n,r);if(!o||null===o.xOnlyPubkey)throw new Error("Cannot tweak public key!");const a=e.from([0===o.parity?2:3]),c=e.concat([a,o.xOnlyPubkey]);return new h(void 0,c)}tweakFromPrivateKey(r){const n=3===this.publicKey[0]||4===this.publicKey[0]&&1===(1&this.publicKey[64]),i=(()=>{if(n){if(t.privateNegate)return t.privateNegate(this.privateKey);throw new Error("privateNegate not supported by ecc library")}return this.privateKey})(),o=t.privateAdd(i,r);if(!o)throw new Error("Invalid tweaked private key!");return new h(e.from(o),void 0)}}function v(e,t,r){return b(e,t,r)}function b(e,n,i,o,s,u){if(c({privateKey:r,chainCode:r},{privateKey:e,chainCode:n}),i=i||a,!t.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return new y(e,void 0,n,i,o,s,u)}function g(e,n,i,o,s,u){if(c({publicKey:c.BufferN(33),chainCode:r},{publicKey:e,chainCode:n}),i=i||a,!t.isPoint(e))throw new TypeError("Point is not on the curve");return new y(void 0,e,n,i,o,s,u)}return{fromSeed:function(t,r){if(c(c.Buffer,t),t.length<16)throw new TypeError("Seed should be at least 128 bits");if(t.length>64)throw new TypeError("Seed should be at most 512 bits");r=r||a;const i=n.hmacSHA512(e.from("Bitcoin seed","utf8"),t);return v(i.slice(0,32),i.slice(32),r)},fromBase58:function(e,t){const r=d(e);if(78!==r.length)throw new TypeError("Invalid buffer length");t=t||a;const n=r.readUInt32BE(0);if(n!==t.bip32.private&&n!==t.bip32.public)throw new TypeError("Invalid network version");const i=r[4],o=r.readUInt32BE(5);if(0===i&&0!==o)throw new TypeError("Invalid parent fingerprint");const c=r.readUInt32BE(9);if(0===i&&0!==c)throw new TypeError("Invalid index");const s=r.slice(13,45);let u;if(n===t.bip32.private){if(0!==r.readUInt8(45))throw new TypeError("Invalid private key");u=b(r.slice(46,78),s,t,i,c,o)}else{u=g(r.slice(45,78),s,t,i,c,o)}return u},fromPublicKey:function(e,t,r){return g(e,t,r)},fromPrivateKey:v}}}).call(this,r(26).Buffer)},3948:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.hmacSHA512=t.hash160=void 0;const n=r(432),i=r(1591),o=r(300),a=r(370);t.hash160=function(t){const r=(0,o.sha256)(Uint8Array.from(t));return e.from((0,i.ripemd160)(r))},t.hmacSHA512=function(t,r){return e.from((0,n.hmac)(a.sha512,t,r))}}).call(this,r(26).Buffer)},3949:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.testEcc=void 0;const r=t=>e.from(t,"hex");function n(e){if(!e)throw new Error("ecc library invalid")}t.testEcc=function(t){if(n(t.isPoint(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(!t.isPoint(r("030000000000000000000000000000000000000000000000000000000000000005"))),n(t.isPrivate(r("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),n(!t.isPrivate(r("0000000000000000000000000000000000000000000000000000000000000000"))),n(!t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),n(!t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),n(e.from(t.pointFromScalar(r("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(r("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),t.xOnlyPointAddTweak){n(null===t.xOnlyPointAddTweak(r("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140")));let i=t.xOnlyPointAddTweak(r("1617d38ed8d8657da4d4761e8057bc396ea9e4b9d29776d4be096016dbd2509b"),r("a8397a935f0dfceba6ba9618f6451ef4d80637abf4e6af2669fbc9de6a8fd2ac"));n(e.from(i.xOnlyPubkey).equals(r("e478f99dab91052ab39a33ea35fd5e6e4933f4d28023cd597c9a1f6760346adf"))&&1===i.parity),i=t.xOnlyPointAddTweak(r("2c0b7cf95324a07d05398b240174dc0c2be444d96b159aa6c7f7b1e668680991"),r("823c3cd2142744b075a87eade7e1b8678ba308d566226a0056ca2b7a76f86b47"))}n(e.from(t.pointAddScalar(r("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),r("0000000000000000000000000000000000000000000000000000000000000003"))).equals(r("02c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5"))),n(e.from(t.privateAdd(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"),r("0000000000000000000000000000000000000000000000000000000000000002"))).equals(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),t.privateNegate&&(n(e.from(t.privateNegate(r("0000000000000000000000000000000000000000000000000000000000000001"))).equals(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),n(e.from(t.privateNegate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e"))).equals(r("0000000000000000000000000000000000000000000000000000000000000003"))),n(e.from(t.privateNegate(r("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(r("4eede1bf775995d70a494f0a7bb6bc11e0b8cccd41cce8009ab1132c8b0a3792")))),n(e.from(t.sign(r("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))).equals(r("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),n(t.verify(r("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),r("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),r("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),t.signSchnorr&&n(e.from(t.signSchnorr(r("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),r("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),r("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"))).equals(r("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),t.verifySchnorr&&n(t.verifySchnorr(r("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),r("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),r("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}}).call(this,r(26).Buffer)},3960:function(e,t,r){"use strict";for(var n="qpzry9x8gf2tvdw0s3jn54khce6mua7l",i={},o=0;o<n.length;o++){var a=n.charAt(o);if(void 0!==i[a])throw new TypeError(a+" is ambiguous");i[a]=o}function c(e){var t=e>>25;return(33554431&e)<<5^996825010&-(t>>0&1)^642813549&-(t>>1&1)^513874426&-(t>>2&1)^1027748829&-(t>>3&1)^705979059&-(t>>4&1)}function s(e){for(var t=1,r=0;r<e.length;++r){var n=e.charCodeAt(r);if(n<33||n>126)return"Invalid prefix ("+e+")";t=c(t)^n>>5}for(t=c(t),r=0;r<e.length;++r){var i=e.charCodeAt(r);t=c(t)^31&i}return t}function u(e,t){if(t=t||90,e.length<8)return e+" too short";if(e.length>t)return"Exceeds length limit";var r=e.toLowerCase(),n=e.toUpperCase();if(e!==r&&e!==n)return"Mixed-case string "+e;var o=(e=r).lastIndexOf("1");if(-1===o)return"No separator character for "+e;if(0===o)return"Missing prefix for "+e;var a=e.slice(0,o),u=e.slice(o+1);if(u.length<6)return"Data too short";var f=s(a);if("string"===typeof f)return f;for(var d=[],l=0;l<u.length;++l){var p=u.charAt(l),h=i[p];if(void 0===h)return"Unknown character "+p;f=c(f)^h,l+6>=u.length||d.push(h)}return 1!==f?"Invalid checksum for "+e:{prefix:a,words:d}}function f(e,t,r,n){for(var i=0,o=0,a=(1<<r)-1,c=[],s=0;s<e.length;++s)for(i=i<<t|e[s],o+=t;o>=r;)o-=r,c.push(i>>o&a);if(n)o>0&&c.push(i<<r-o&a);else{if(o>=t)return"Excess padding";if(i<<r-o&a)return"Non-zero padding"}return c}e.exports={decodeUnsafe:function(){var e=u.apply(null,arguments);if("object"===typeof e)return e},decode:function(e){var t=u.apply(null,arguments);if("object"===typeof t)return t;throw new Error(t)},encode:function(e,t,r){if(r=r||90,e.length+7+t.length>r)throw new TypeError("Exceeds length limit");var i=s(e=e.toLowerCase());if("string"===typeof i)throw new Error(i);for(var o=e+"1",a=0;a<t.length;++a){var u=t[a];if(u>>5!==0)throw new Error("Non 5-bit word");i=c(i)^u,o+=n.charAt(u)}for(a=0;a<6;++a)i=c(i);for(i^=1,a=0;a<6;++a){o+=n.charAt(i>>5*(5-a)&31)}return o},toWordsUnsafe:function(e){var t=f(e,8,5,!0);if(Array.isArray(t))return t},toWords:function(e){var t=f(e,8,5,!0);if(Array.isArray(t))return t;throw new Error(t)},fromWordsUnsafe:function(e){var t=f(e,5,8,!1);if(Array.isArray(t))return t},fromWords:function(e){var t=f(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}}},3961:function(e,t,r){"use strict";(function(t){e.exports=function(e,r){if(!t.isBuffer(e)||!t.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(e===r)return!0;if("function"===typeof e.equals)return e.equals(r);if(e.length!==r.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==r[n])return!1;return!0}}).call(this,r(26).Buffer)},3962:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.ECPairFactory=t.networks=void 0;const n=r(3963);t.networks=n;const i=r(3964),o=r(1589),a=r(3926),c=r(3965),s=i.typeforce.maybe(i.typeforce.compile({compressed:i.maybe(i.Boolean),network:i.maybe(i.Network)}));t.ECPairFactory=function(t){function r(e,r){if(i.typeforce(i.Buffer256bit,e),!t.isPrivate(e))throw new TypeError("Private key not in range [1, n)");return i.typeforce(s,r),new u(e,void 0,r)}(0,c.testEcc)(t);class u{constructor(r,i,o){this.__D=r,this.__Q=i,this.lowR=!1,void 0===o&&(o={}),this.compressed=void 0===o.compressed||o.compressed,this.network=o.network||n.bitcoin,void 0!==i&&(this.__Q=e.from(t.pointCompress(i,this.compressed)))}get privateKey(){return this.__D}get publicKey(){if(!this.__Q){const r=t.pointFromScalar(this.__D,this.compressed);this.__Q=e.from(r)}return this.__Q}toWIF(){if(!this.__D)throw new Error("Missing private key");return a.encode(this.network.wif,this.__D,this.compressed)}sign(r,n){if(!this.__D)throw new Error("Missing private key");if(void 0===n&&(n=this.lowR),!1===n)return e.from(t.sign(r,this.__D));{let n=t.sign(r,this.__D);const i=e.alloc(32,0);let o=0;for(;n[0]>127;)o++,i.writeUIntLE(o,0,6),n=t.sign(r,this.__D,i);return e.from(n)}}signSchnorr(r){if(!this.privateKey)throw new Error("Missing private key");if(!t.signSchnorr)throw new Error("signSchnorr not supported by ecc library");return e.from(t.signSchnorr(r,this.privateKey))}verify(e,r){return t.verify(e,this.publicKey,r)}verifySchnorr(e,r){if(!t.verifySchnorr)throw new Error("verifySchnorr not supported by ecc library");return t.verifySchnorr(e,this.publicKey.subarray(1,33),r)}}return{isPoint:function(e){return t.isPoint(e)},fromPrivateKey:r,fromPublicKey:function(e,r){return i.typeforce(t.isPoint,e),i.typeforce(s,r),new u(void 0,e,r)},fromWIF:function(e,t){const o=a.decode(e),c=o.version;if(i.Array(t)){if(!(t=t.filter(e=>c===e.wif).pop()))throw new Error("Unknown network version")}else if(t=t||n.bitcoin,c!==t.wif)throw new Error("Invalid network version");return r(o.privateKey,{compressed:o.compressed,network:t})},makeRandom:function(e){i.typeforce(s,e),void 0===e&&(e={});const n=e.rng||o;let a;do{a=n(32),i.typeforce(i.Buffer256bit,a)}while(!t.isPrivate(a));return r(a,e)}}}}).call(this,r(26).Buffer)},3963:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.testnet=t.bitcoin=void 0,t.bitcoin={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128},t.testnet={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:111,scriptHash:196,wif:239}},3964:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maybe=t.Boolean=t.Array=t.Buffer256bit=t.Network=t.typeforce=void 0,t.typeforce=r(2684),t.Network=t.typeforce.compile({messagePrefix:t.typeforce.oneOf(t.typeforce.Buffer,t.typeforce.String),bip32:{public:t.typeforce.UInt32,private:t.typeforce.UInt32},pubKeyHash:t.typeforce.UInt8,scriptHash:t.typeforce.UInt8,wif:t.typeforce.UInt8}),t.Buffer256bit=t.typeforce.BufferN(32),t.Array=t.typeforce.Array,t.Boolean=t.typeforce.Boolean,t.maybe=t.typeforce.maybe},3965:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.testEcc=void 0;const r=t=>e.from(t,"hex");function n(e){if(!e)throw new Error("ecc library invalid")}t.testEcc=function(t){n(t.isPoint(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(!t.isPoint(r("030000000000000000000000000000000000000000000000000000000000000005"))),n(t.isPrivate(r("79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))),n(!t.isPrivate(r("0000000000000000000000000000000000000000000000000000000000000000"))),n(!t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"))),n(!t.isPrivate(r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142"))),n(e.from(t.pointCompress(r("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!0)).equals(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(e.from(t.pointCompress(r("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"),!1)).equals(r("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),n(e.from(t.pointCompress(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!0)).equals(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"))),n(e.from(t.pointCompress(r("0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),!1)).equals(r("0479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"))),n(e.from(t.pointFromScalar(r("b1121e4088a66a28f5b6b0f5844943ecd9f610196d7bb83b25214b60452c09af"))).equals(r("02b07ba9dca9523b7ef4bd97703d43d20399eb698e194704791a25ce77a400df99"))),n(e.from(t.sign(r("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),r("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140"))).equals(r("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),n(t.verify(r("5e9f0a0d593efdcf78ac923bc3313e4e7d408d574354ee2b3288c0da9fbba6ed"),r("0379be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),r("54c4a33c6423d689378f160a7ff8b61330444abb58fb470f96ea16d99d4a2fed07082304410efa6b2943111b6a4e0aaa7b7db55a07e9861d1fb3cb1f421044a5"))),t.signSchnorr&&n(e.from(t.signSchnorr(r("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),r("c90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b14e5c9"),r("c87aa53824b4d7ae2eb035a2b5bbbccc080e76cdc6d1692c4b0b62d798e6d906"))).equals(r("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7"))),t.verifySchnorr&&n(t.verifySchnorr(r("7e2d58d8b3bcdf1abadec7829054f90dda9805aab56c77333024b9d0a508b75c"),r("dd308afec5777e13121fa72b9cc1b7cc0139715309b086c960e18fd969774eb8"),r("5831aaeed7b44bb74e5eab94ba9d4294c49bcf2a60728d8b4c200f50dd313c1bab745879a5ad954a72c45a91c3a51d3c7adea98d82f8481e0e1e03674a6f3fb7")))}}).call(this,r(26).Buffer)},3978:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BIP32Factory=t.default=void 0;var n=r(3947);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.BIP32Factory}}),Object.defineProperty(t,"BIP32Factory",{enumerable:!0,get:function(){return n.BIP32Factory}})},3979:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.networks=t.ECPairFactory=t.default=void 0;var n=r(3962);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.ECPairFactory}}),Object.defineProperty(t,"ECPairFactory",{enumerable:!0,get:function(){return n.ECPairFactory}}),Object.defineProperty(t,"networks",{enumerable:!0,get:function(){return n.networks}})},4004:function(e,t,r){(function(t){const n=r(1346),i=r(3960),o=r(3961),a=r(746),c=r(3936),s=r(2685),u="p2wpkh",f="p2sh(p2wpkh)";function d(e){return a("sha256").update(e).digest()}function l(e){return a("ripemd160").update(d(e)).digest()}function p(e,r,n,i){return void 0!==i?(r+=8,i===u&&(r+=4)):n&&(r+=4),t.concat([t.alloc(1,r+27),e])}function h(e,r){r=r||"\x18Bitcoin Signed Message:\n",t.isBuffer(r)||(r=t.from(r,"utf8")),t.isBuffer(e)||(e=t.from(e,"utf8"));const n=s.encodingLength(e.length),i=t.allocUnsafe(r.length+n+e.length);return r.copy(i,0),s.encode(e.length,i,r.length),e.copy(i,r.length+n),function(e){return d(d(e))}(i)}function y(e,t){"object"===typeof e&&void 0===t&&(t=e,e=void 0);let{segwitType:r,extraEntropy:n}=t||{};if(r&&("string"===typeof r||r instanceof String)&&(r=r.toLowerCase()),r&&r!==f&&r!==u)throw new Error('Unrecognized segwitType: use "'+f+'" or "'+u+'"');return{messagePrefixArg:e,segwitType:r,extraEntropy:n}}function v(e){return e&&"function"===typeof e.sign}function b(e){return l(t.concat([t.from("0014","hex"),e]))}function g(e){const r=i.decode(e),n=i.fromWords(r.words.slice(1));return t.from(n)}e.exports={magicHash:h,sign:function(e,t,r,n,i){const{messagePrefixArg:o,segwitType:a,extraEntropy:s}=y(n,i),u=h(e,o),f=v(t)?t.sign(u,s):c.sign(u,t,{data:s});return p(f.signature,f.recovery,r,a)},signAsync:function(e,t,r,n,i){let o,a,s;return Promise.resolve().then(()=>{({messagePrefixArg:o,segwitType:a,extraEntropy:s}=y(n,i));const r=h(e,o);return v(t)?t.sign(r,s):c.sign(r,t,{data:s})}).then(e=>p(e.signature,e.recovery,r,a))},verify:function(e,r,i,a,s){t.isBuffer(i)||(i=t.from(i,"base64"));const d=function(e){if(65!==e.length)throw new Error("Invalid signature length");const t=e.readUInt8(0)-27;if(t>15||t<0)throw new Error("Invalid signature parameter");return{compressed:!!(12&t),segwitType:8&t?4&t?u:f:null,recovery:3&t,signature:e.slice(1)}}(i);if(s&&!d.compressed)throw new Error("checkSegwitAlways can only be used with a compressed pubkey signature flagbyte");const p=h(e,a),y=l(c.recover(p,d.signature,d.recovery,d.compressed));let v,E;if(d.segwitType)d.segwitType===f?(v=b(y),E=n.decode(r).slice(1)):(v=y,E=g(r));else if(s)try{return E=g(r),o(y,E)}catch(w){const e=b(y);return E=n.decode(r).slice(1),o(y,E)||o(e,E)}else v=y,E=n.decode(r).slice(1);return o(v,E)}}}).call(this,r(26).Buffer)},4091:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"Provider",(function(){return R}));var n=r(13),i=r.n(n),o=r(4),a=r.n(o),c=r(2),s=r.n(c),u=r(3),f=r.n(u),d=r(6),l=r.n(d),p=r(21),h=r.n(p),y=r(3978),v=r(304),b=r(1064),g=r(4004),E=r.n(g),w=r(1346),m=r.n(w),I=r(3979),_=r(610),A=r(529),P=r(668),T=r(956),N=r(4169),S=r(758),x=r(4170);function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function B(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){f()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var L=Object(y.BIP32Factory)(S.default),D=Object(I.ECPairFactory)(S.default),O=function(e,t){if(!e)throw t||"Invalid statement",t instanceof Error?t:new Error(t)},C=function(e,t){return O("undefined"!==typeof e,t||"Expect defined but actually undefined"),e},K=function(e,t,r){return Object(_.verify)("secp256k1",e,t,r)};b.initEccLib(S.default);var R=function(){function t(e){this.chainInfo=e}var r=t.prototype;return r.decodeAddress=function(e){return e},r.encodeAddress=function(e){return e},r.xpubToAddresses=function(e,t,r){var n=m.a.decode(e),i=parseInt(n.slice(0,4).toString("hex"),16),o=null!=r?r:this.versionBytesToEncodings.public[i][0],a={},c={chainCode:n.slice(13,45),key:n.slice(45,78)},s=new Map;for(var u of t){var f=c,d="",l=u.split("/");for(var p of l)if(d+=""===d?p:"/"+p,s.has(d))f=s.get(d);else{var h=p.endsWith("'")?parseInt(p.slice(0,-1))+2**31:parseInt(p);f=Object(_.CKDPub)("secp256k1",f,h),s.set(d,f)}var y=this.pubkeyToPayment(f.key,o).address;"string"===typeof y&&y.length>0&&(y=this.encodeAddress(y),a[u]=y)}return a},r.pubkeyToPayment=function(e,t){var r={pubkey:e,network:this.network};switch(t){case A.AddressEncodings.P2PKH:r=b.payments.p2pkh(r);break;case A.AddressEncodings.P2WPKH:r=b.payments.p2wpkh(r);break;case A.AddressEncodings.P2SH_P2WPKH:r=b.payments.p2sh({redeem:b.payments.p2wpkh(r),network:this.network});break;case A.AddressEncodings.P2TR:r=b.payments.p2tr({internalPubkey:e.slice(1,33),network:this.network});break;default:throw new Error("Invalid encoding: "+t)}return r},r.parseAddressEncodings=function(e){var t=this;return Promise.all(e.map((function(e){return t.verifyAddress(e)}))).then((function(e){return e.filter((function(e){return e.isValid})).map((function(e){return e.encoding}))}))},r.getAccount=function(e,t){var r=this.getEncodingXpub(e,t),n={};switch(e.type){case"simple":n={details:"basic"};break;case"details":n={details:"tokenBalances",tokens:"derived"};break;case"history":n={details:"txs",pageSize:50,to:e.to};break;case"usedAddress":n={details:"tokenBalances",tokens:"used"};break;case"accountInfo":n={details:e.details,from:e.from,to:e.to,pageSize:e.pageSize};break;default:throw new Error("type not support: "+e.type)}return this.blockbook.then((function(e){return e.getAccount(r,n)}))},r.getAccountWithAddress=function(e){var t={};switch(e.type){case"simple":t={details:"basic"}}return this.blockbook.then((function(r){return r.getAccountWithAddress(e.address,t)}))},r.getEncodingXpub=function(e,t){var r=t;if(Object(P.isTaprootXpubSegwit)(e.xpub)||Object(P.isWatchAccountTaprootSegwit)(e.xpub))r=A.AddressEncodings.P2TR;else{var n=m.a.decode(e.xpub);O(this.isValidXpub(n));var i=parseInt(n.slice(0,4).toString("hex"),16);r=null!=t?t:this.versionBytesToEncodings.public[i][0]}O("undefined"!==typeof r);var o=e.xpub;switch(r){case A.AddressEncodings.P2PKH:o="pkh("+e.xpub+")";break;case A.AddressEncodings.P2SH_P2WPKH:o="sh(wpkh("+e.xpub+"))";break;case A.AddressEncodings.P2WPKH:o="wpkh("+e.xpub+")";break;case A.AddressEncodings.P2TR:o=e.xpub}return o},r.getHistory=function(e,t,r,n,i){var o=this.getEncodingXpub(e);return this.blockbook.then((function(e){return e.getHistory(t,r,o,n,i)}))},r.isValidXpub=function(e){return this.isValidExtendedKey(e,"pub")},r.isValidXprv=function(e){return this.isValidExtendedKey(e,"prv")},r.isValidExtendedKey=function(e,t){var r="string"===typeof e?m.a.decode(e):e;if(78!==r.length)return!1;var n=parseInt(r.slice(0,4).toString("hex"),16);return"pub"===t?"undefined"!==typeof this.versionBytesToEncodings.public[n]:"undefined"!==typeof this.versionBytesToEncodings.private[n]},r.verifyAddress=function(e){var t,r=this.decodeAddress(e);try{var n=b.address.fromBase58Check(r);n.version===this.network.pubKeyHash&&20===n.hash.length?t=A.AddressEncodings.P2PKH:n.version===this.network.scriptHash&&20===n.hash.length&&(t=A.AddressEncodings.P2SH_P2WPKH)}catch(o){try{var i=b.address.fromBech32(r);0===i.version&&i.prefix===this.network.bech32&&20===i.data.length?t=A.AddressEncodings.P2WPKH:0===i.version&&i.prefix===this.network.bech32&&32===i.data.length?t=A.AddressEncodings.P2WSH:1===i.version&&i.prefix===this.network.bech32&&32===i.data.length&&(t=A.AddressEncodings.P2TR)}catch(a){}}return t?{displayAddress:r,normalizedAddress:r,encoding:t,isValid:!0}:{isValid:!1}},r.buildUnsignedTx=function(e){var t=e.encodedTx,r=e.inputs,n=e.outputs,i=e.feeLimit,o=e.feePricePerUnit,a=(null!=t?t:{}).inputsForCoinSelect,c=null==a?void 0:a.filter((function(e){return r.some((function(t){var r;return(null==(r=t.utxo)?void 0:r.txid)===e.txId&&t.utxo.vout===e.vout}))}));if(Number(null==c?void 0:c.length)>0&&n.length>0){var s,u=Object(x.estimateTxSize)(null!=c?c:[],null!=(s=n.map((function(e){return{address:e.address,value:parseInt(e.value.toFixed())}})))?s:[]);i=i&&i.gte(u)?i:new h.a(u)}return i=i||new h.a(x.PLACEHOLDER_VSIZE),Promise.resolve(B(B({},e),{},{feeLimit:i,feePricePerUnit:o}))},r.getBalances=function(e){return this.blockbook.then((function(t){return Promise.all(e.map((function(e){var r=e.address;return t.getBalance(r)})))}))},r.getBalancesByAddress=function(e){return this.blockbook.then((function(t){return Promise.all(e.map((function(e){var r=e.address;return t.getBalanceWithAddress(r)})))}))},r.getUTXOs=function(){var e=s()((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.blockbook.then((function(r){return r.getUTXOs(e,t)}))}));return function(t){return e.apply(this,arguments)}}(),r.getPsbt=function(){return new b.Psbt({network:this.network})},r.getBitcoinSigner=function(){var e=s()((function*(e,t){return{publicKey:yield e.getPubkey(!0),sign:function(){var t=s()((function*(t){var r=yield e.sign(t);return a()(r,1)[0]}));return function(e){return t.apply(this,arguments)}}()}}));return function(t,r){return e.apply(this,arguments)}}(),r.signTransaction=function(){var e=s()((function*(e,t){for(var r=yield this.packTransaction(e,t),n=0;n<e.inputs.length;++n){var i=t[e.inputs[n].address],o=r.data.inputs[0],a=yield this.getBitcoinSigner(i,o);yield r.signInputAsync(n,a)}r.validateSignaturesOfAllInputs(K),r.finalizeAllInputs();var c=r.extractTransaction();return{txid:c.getId(),rawTx:c.toHex()}}));return function(t,r){return e.apply(this,arguments)}}(),r.packTransaction=function(){var t=s()((function*(t,r){for(var n=t.inputs,i=t.outputs,o=t.payload.opReturn,c=yield this.collectInfoForSoftwareSign(t),s=a()(c,2),u=s[0],f=s[1],d=this.getPsbt(),l=0;l<n.length;++l){var p=n[l],h=p.utxo;O(h);var y=u[l],v={};switch(y){case A.AddressEncodings.P2PKH:v.nonWitnessUtxo=e.from(f[h.txid],"hex");break;case A.AddressEncodings.P2WPKH:v.witnessUtxo={script:C(this.pubkeyToPayment(yield r[p.address].getPubkey(!0),y)).output,value:h.value.integerValue().toNumber()};break;case A.AddressEncodings.P2SH_P2WPKH:var g,E=C(this.pubkeyToPayment(yield r[p.address].getPubkey(!0),y));v.witnessUtxo={script:E.output,value:h.value.integerValue().toNumber()},v.redeemScript=null==(g=E.redeem)?void 0:g.output;break;case A.AddressEncodings.P2TR:var w=C(this.pubkeyToPayment(yield r[p.address].getPubkey(!0),y));v.witnessUtxo={script:w.output,value:h.value.integerValue().toNumber()},v.tapInternalKey=w.internalPubkey}d.addInput(B({hash:h.txid,index:h.vout},v))}if(i.forEach((function(e){d.addOutput({address:e.address,value:e.value.integerValue().toNumber()})})),"string"===typeof o){var m=b.payments.embed({data:[Object(x.loadOPReturn)(o)]});d.addOutput({script:C(m.output),value:0})}return d}));return function(e,r){return t.apply(this,arguments)}}(),r.collectInfoForSoftwareSign=function(){var e=s()((function*(e){var t=e.inputs,r=yield this.parseAddressEncodings(t.map((function(e){return e.address})));O(r.length===t.length,"Found invalid address from inputs");var n=Array.from(new Set(r.map((function(e,r){if(e===A.AddressEncodings.P2PKH)return C(t[r].utxo).txid})).filter((function(e){return!!e}))));return[r,yield this.collectTxs(n)]}));return function(t){return e.apply(this,arguments)}}(),r.collectTxs=function(){var e=s()((function*(e){for(var t=yield this.blockbook,r={},n=function*(){var n=e.slice(i,i+o),a=yield Promise.all(n.map((function(e){return t.getRawTransaction(e)})));n.forEach((function(e,t){return r[e]=a[t]}))},i=0,o=5;i<e.length;i+=o)yield*n();return r}));return function(t){return e.apply(this,arguments)}}(),r.broadcastTransaction=function(e){return this.blockbook.then((function(t){return t.broadcastTransaction(e)}))},r.getTransactionStatuses=function(e){return this.blockbook.then((function(t){return t.getTransactionStatuses(e)}))},r.signMessage=function(e,t,r,n){var i=Object(_.mnemonicFromEntropy)(t,e),o=Object(v.mnemonicToSeedSync)(i),a=L.fromSeed(o).derivePath(r),c=D.fromWIF(a.toWIF());return E.a.sign(n,c.privateKey,c.compressed,{segwitType:"p2wpkh"})},l()(t,[{key:"network",get:function(){return Object(N.getNetwork)(this.chainInfo.code)}},{key:"blockbook",get:function(){return Object(T.getBlockBook)(this.chainInfo)}},{key:"versionBytesToEncodings",get:function(){if("undefined"===typeof this._versionBytesToEncodings){var e,t,r=this.network,n={public:(e={},e[r.bip32.public]=[A.AddressEncodings.P2PKH],e),private:(t={},t[r.bip32.private]=[A.AddressEncodings.P2PKH],t)};Object.entries(r.segwitVersionBytes||{}).forEach((function(e){var t=a()(e,2),r=t[0],o=t[1],c=o.public,s=o.private;n.public[c]=[].concat(i()(n.public[c]||[]),[r]),n.private[s]=[].concat(i()(n.private[s]||[]),[r])})),this._versionBytesToEncodings=n}return this._versionBytesToEncodings}}]),t}()}.call(this,r(26).Buffer)},4169:function(e,t,r){"use strict";r.r(t),r.d(t,"isNetworkType",(function(){return E})),r.d(t,"getNetwork",(function(){return b}));var n,i,o,a,c=r(3),s=r.n(c),u=r(1064),f=r(2684),d=r.n(f),l=r(529);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){s()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var y={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128,forkId:0},v={btc:h(h({},u.networks.bitcoin),{},{segwitVersionBytes:(n={},n[l.AddressEncodings.P2SH_P2WPKH]={public:77429938,private:77428856},n[l.AddressEncodings.P2WPKH]={public:78792518,private:78791436},n[l.AddressEncodings.P2TR]={public:76067358,private:76066276},n)}),tbtc:h(h({},u.networks.testnet),{},{segwitVersionBytes:(i={},i[l.AddressEncodings.P2SH_P2WPKH]={public:71979618,private:71978536},i[l.AddressEncodings.P2WPKH]={public:73342198,private:73341116},i[l.AddressEncodings.P2TR]={public:70617039,private:70615956},i)}),rbtc:h(h({},u.networks.regtest),{},{segwitVersionBytes:(o={},o[l.AddressEncodings.P2SH_P2WPKH]={public:71979618,private:71978536},o[l.AddressEncodings.P2WPKH]={public:73342198,private:73341116},o)}),ltc:{messagePrefix:"\x19Litecoin Signed Message:\n",bech32:"ltc",bip32:{public:27108450,private:27106558},segwitVersionBytes:(a={},a[l.AddressEncodings.P2SH_P2WPKH]={public:28471030,private:28469138},a[l.AddressEncodings.P2WPKH]={public:78792518,private:78791436},a),pubKeyHash:48,scriptHash:50,wif:176},bch:y,doge:{messagePrefix:"\x19Dogecoin Signed Message:\n",bech32:"",bip32:{public:49990397,private:49988504},pubKeyHash:30,scriptHash:22,wif:158},btg:{messagePrefix:"\x1dBitcoin Gold Signed Message:\n",bech32:"btg",bip32:{public:76067358,private:76066276},pubKeyHash:38,scriptHash:23,wif:128},dgb:{messagePrefix:"\x19DigiByte Signed Message:\n",bech32:"dgb",bip32:{public:76067358,private:76066276},pubKeyHash:30,scriptHash:63,wif:176},nmc:{messagePrefix:"\x19Namecoin Signed Message:\n",bech32:"",bip32:{public:76067358,private:76066276},pubKeyHash:52,scriptHash:5,wif:128},vtc:{messagePrefix:"\x19Vertcoin Signed Message:\n",bech32:"vtc",bip32:{public:76067358,private:76066276},pubKeyHash:71,scriptHash:5,wif:128},dash:{messagePrefix:"\x19DarkCoin Signed Message:\n",bech32:"",bip32:{public:50221772,private:50221816},pubKeyHash:76,scriptHash:16,wif:204}},b=function(e){var t=v[e];if("undefined"===typeof t)throw new Error("Network not found. chainCode: "+e);return t},g={bitcoinCash:[y]};function E(e,t){if("string"!==typeof e||!t||!g[e])return!1;try{d()({bip32:{public:d.a.UInt32,private:d.a.UInt32},pubKeyHash:d.a.anyOf(d.a.UInt8,d.a.UInt16),scriptHash:d.a.anyOf(d.a.UInt8,d.a.UInt16)},t)}catch(r){return!1}return!!g[e].find((function(e){return e.bip32.public===t.bip32.public&&e.bip32.private===t.bip32.private&&(!e.bech32&&!t.bech32||e.bech32===t.bech32)&&(!e.forkId&&!t.forkId||e.forkId===t.forkId)&&e.pubKeyHash===t.pubKeyHash&&e.scriptHash===t.scriptHash}))}},4170:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"estimateVsize",(function(){return u})),r.d(t,"estimateTxSize",(function(){return f})),r.d(t,"loadOPReturn",(function(){return s})),r.d(t,"PLACEHOLDER_VSIZE",(function(){return c}));var n=r(310),i=r.n(n),o={P2PKH:148,P2WPKH:68,P2SH_P2WPKH:91},a={P2PKH:34,P2WPKH:31,P2SH_P2WPKH:32},c=79,s=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80,n=e.from(t);return n.slice(0,r)},u=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:80,i=10,c=e.filter((function(e){return e.includes("P2WPKH")})).length>=1;if(c&&(i+=.5),i+=e.map((function(e){return o[e]||0})).reduce((function(e,t){return e+t}),0),c&&(i+=.25),i+=t.map((function(e){return a[e]||0})).reduce((function(e,t){return e+t}),0),"string"===typeof r){var u=s(r,n).length;i+=12*Math.ceil(u/n),i+=u}return Math.ceil(i)},f=function(e,t){return i.a.transactionBytes(e,t)}}.call(this,r(26).Buffer)},4488:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"getBtcProvider",(function(){return h})),r.d(t,"generateNativeSegwitAccounts",(function(){return y}));var n=r(13),i=r.n(n),o=r(2),a=r.n(o),c=r(1346),s=r.n(c),u=r(4091),f=r(11),d=r(23),l=r(610),p=r(668),h=function(){var e=a()((function*(e,t){var r=yield e.providerManager.getChainInfoByNetworkId(t?"tbtc--0":"btc--0");return new u.Provider(r)}));return function(t,r){return e.apply(this,arguments)}}(),y=function(){var t=a()((function*(t){var r=t.engine,n=t.seed,o=t.password,a=t.indexes,c=t.names,u=t.isTestnet,y=yield h(r,u),v=y.network,b=u?f.IMPL_TBTC:f.IMPL_BTC,g=u?f.COINTYPE_TBTC:f.COINTYPE_BTC,E=Object(p.getAccountDefaultByPurpose)(84,b).addressEncoding,w=0!==a[0],m=[].concat(i()(w?[a[0]-1]:[]),i()(a)),I=Object(l.batchGetPublicKeys)("secp256k1",n,o,"m/84'/"+g+"'",m.map((function(e){return e.toString()+"'"})));if(I.length!==m.length)throw new d.OneKeyInternalError("Unable to get publick key.");var _=((v.segwitVersionBytes||{})[E]||v.bip32).public,A=[],P=0;for(var T of I){var N=T.path,S=T.parentFingerPrint,x=T.extendedKey,k=s.a.encode(e.concat([e.from(_.toString(16).padStart(8,"0"),"hex"),e.from([3]),S,e.from((m[P]+2**31).toString(16).padStart(8,"0"),"hex"),x.chainCode,x.key])),B=y.xpubToAddresses(k,["0/0"],E)["0/0"],L=u?"TLightning":"Lightning",D=(c||[])[P]||L+" #"+(m[P]+1);(!w||P>0)&&A.push({index:m[P],name:D,path:N,xpub:k,address:B}),P+=1}return A}));return function(e){return t.apply(this,arguments)}}()}.call(this,r(26).Buffer)},6105:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return ie}));var n=r(4),i=r.n(n),o=r(3),a=r.n(o),c=r(2),s=r.n(c),u=r(6),f=r.n(u),d=r(9),l=r.n(d),p=r(14),h=r.n(p),y=r(7),v=r.n(y),b=r(300),g=r(73),E=r(21),w=r.n(E),m=r(46),I=r(19),_=r(150),A=r(23),P=r(367),T=r(52),N=r(3912),S=r(107),x=r.n(S),k=r(68),B=r(118);function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var O,C=function(){function e(e){var t=this;this.specialInvoice=Object(_.memoizee)(function(){var e=s()((function*(e,r){return t.request.get("/invoices/invoice",{params:{paymentHash:r,testnet:t.testnet},headers:{Authorization:yield t.getAuthorization(e)}}).then((function(e){return e.data}))}));return function(t,r){return e.apply(this,arguments)}}(),{promise:!0,maxAge:Object(m.getTimeDurationMs)({seconds:1})}),this.testnet=e,this.request=x.a.create({baseURL:Object(B.getFiatEndpoint)()+"/lightning",timeout:2e4}),this.request.interceptors.response.use((function(e){return e}),(function(e){return 401===(e.response?e.response.status:null)?Promise.reject(new A.BadAuthError):Promise.reject(e)}))}var t=e.prototype;return t.getAuthorization=function(){var e=s()((function*(e){var t=yield k.default.utxoAccounts.getLndAccessToken(e);return t&&t.length?"Bearer "+t:""}));return function(t){return e.apply(this,arguments)}}(),t.refreshAccessToken=function(){var e=s()((function*(e){var t=e.hashPubKey,r=e.address,n=e.signature,i=e.timestamp,o=e.randomSeed;try{if(!t||!r||!n)throw new Error("Invalid exchange token params");return yield this.request.post("/account/auth",{hashPubKey:t,address:r,signature:n,timestamp:i,randomSeed:o,testnet:this.testnet}).then((function(e){return e.data}))}catch(a){throw a}}));return function(t){return e.apply(this,arguments)}}(),t.checkAccountExist=function(){var e=s()((function*(e){return this.request.get("/account/check",{params:{address:e,testnet:this.testnet}}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),t.createUser=function(){var e=s()((function*(e){var t=e.hashPubKey,r=e.address,n=e.signature,i=e.randomSeed;return this.request.post("/account/users",{hashPubKey:t,address:r,signature:n,randomSeed:i,testnet:this.testnet}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),t.batchGetBalance=function(){var e=s()((function*(e){try{return yield this.request.post("/account/balance",{addresses:e,testnet:this.testnet}).then((function(e){return e.data}))}catch(t){return[]}}));return function(t){return e.apply(this,arguments)}}(),t.createInvoice=function(){var e=s()((function*(e,t,r){return this.request.post("/invoices/create",{amount:t,description:r||"OneKey Invoice",testnet:this.testnet},{headers:{Authorization:yield this.getAuthorization(e)}}).then((function(e){return e.data}))}));return function(t,r,n){return e.apply(this,arguments)}}(),t.decodedInvoice=function(){var e=s()((function*(e){return this.request.get("/invoices/decoded",{params:{invoice:e,testnet:this.testnet}}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),t.getNextNonce=function(){var e=s()((function*(e){return this.request.get("/payments/getNonce",{params:{testnet:this.testnet},headers:{Authorization:yield this.getAuthorization(e)}}).then((function(e){return e.data+1}))}));return function(t){return e.apply(this,arguments)}}(),t.paymentBolt11=function(){var e=s()((function*(e,t){return this.request.post("/payments/bolt11",D(D({},e),{},{testnet:this.testnet}),{headers:{Authorization:yield this.getAuthorization(t)}}).then((function(e){return e.data}))}));return function(t,r){return e.apply(this,arguments)}}(),t.checkBolt11=function(){var e=s()((function*(e){var t=e.address,r=e.nonce;return this.request.get("/payments/checkBolt11",{params:{nonce:r,testnet:this.testnet},headers:{Authorization:yield this.getAuthorization(t)}}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),t.fetchHistory=function(){var e=s()((function*(e){return this.request.get("/invoices/history",{params:{testnet:this.testnet},headers:{Authorization:yield this.getAuthorization(e)}}).then((function(e){return e.data}))}));return function(t){return e.apply(this,arguments)}}(),t.fetchSignTemplate=function(){var e=s()((function*(e,t){return this.request.get("/account/getSignTemplate",{params:{address:e,signType:t,testnet:this.testnet},headers:{Authorization:yield this.getAuthorization(e)}}).then((function(e){return e.data}))}));return function(t,r){return e.apply(this,arguments)}}(),f()(e)}();!function(e){e.StateSettled="settled",e.StateInitialized="initialized",e.StateOpen="open",e.StateError="error"}(O||(O={}));var K=r(997),R=r.n(K),V=r(4488),H=function(){var e=s()((function*(e){var t=e.msgPayload,r=e.engine,n=e.path,i=e.password,o=e.entropy,a=e.isTestnet,c=(yield Object(V.getBtcProvider)(r,a)).signMessage(i,o,n+"/0/0",R()(t));return I.default.common.debug("Lightning Signature, msgPayload: "+R()(t)+", path: "+n+", result: "+c.toString("hex")),c.toString("hex")}));return function(t){return e.apply(this,arguments)}}();function U(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var i=v()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h()(this,r)}}var j=function(e){l()(r,e);var t=U(r);function r(){return t.apply(this,arguments)}return f()(r)}(r(3913).KeyringHardwareBase),F=r(1591),Y=r(11),M=r(117);function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var i=v()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h()(this,r)}}var q=function(e){l()(r,e);var t=z(r);function r(){return t.apply(this,arguments)}var n=r.prototype;return n.getSigners=function(){return Promise.resolve({})},n.prepareAccounts=function(){var e=s()((function*(e){var t=e.password,r=e.indexes,n=e.names,i=yield this.engine.dbApi.getCredential(this.walletId,t),o=i.seed,a=i.entropy,c=yield this.vault.getNetwork(),s=yield Object(V.generateNativeSegwitAccounts)({engine:this.engine,seed:o,password:t,indexes:r,names:n,isTestnet:c.isTestnet}),u=yield this.vault.getClient(),f=[];for(var d of s){if(!(yield u.checkAccountExist(d.address))){var l=Object(g.bytesToHex)(Object(b.sha256)(d.xpub)),p=yield u.fetchSignTemplate(d.address,"register");if("register"!==p.type)throw new Error("Wrong signature type");var h=yield H({msgPayload:W(W({},p),{},{pubkey:l,address:d.address}),engine:this.engine,path:d.path,password:t,entropy:a,isTestnet:c.isTestnet});yield u.createUser({hashPubKey:l,address:d.address,signature:h,randomSeed:p.randomSeed})}var y=c.isTestnet?Y.COINTYPE_LIGHTNING_TESTNET:Y.COINTYPE_LIGHTNING,v="m/44'/"+y+"'/"+d.index;f.push({id:this.walletId+"--"+v,name:d.name,type:M.AccountType.VARIANT,path:v,coinType:y,pub:d.xpub,address:"",addresses:{normalizedAddress:d.address,realPath:d.path,hashAddress:Object(g.bytesToHex)(Object(F.ripemd160)(d.address))}})}return f}));return function(t){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=s()((function*(e,t){I.default.sendTx.info("signTransaction result",e);var r=t.password,n=yield this.getDbAccount(),i=(yield this.engine.dbApi.getCredential(this.walletId,null!=r?r:"")).entropy,o=e.encodedTx,a=o.invoice,c=o.expired,s=o.created,u=o.paymentHash,f=yield this.vault.getClient(),d=yield f.fetchSignTemplate(n.addresses.normalizedAddress,"transfer");if("transfer"!==d.type)throw new Error("Wrong transfer signature type");var l=yield this.vault.getNetwork();return{txid:u,rawTx:yield H({msgPayload:W(W({},d),{},{paymentHash:u,invoice:a,expired:c,created:Number(s),nonce:d.nonce,randomSeed:d.randomSeed}),engine:this.engine,path:n.addresses.realPath,password:null!=r?r:"",entropy:i,isTestnet:l.isTestnet}),nonce:d.nonce,randomSeed:d.randomSeed}}));return function(t,r){return e.apply(this,arguments)}}(),f()(r)}(r(3914).KeyringHdBase);function Z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var i=v()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h()(this,r)}}var X=function(e){l()(r,e);var t=Z(r);function r(){return t.apply(this,arguments)}return f()(r)}(r(3915).KeyringImportedBase);function Q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var i=v()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h()(this,r)}}var J,$=function(e){l()(r,e);var t=Q(r);function r(){return t.apply(this,arguments)}return f()(r)}(r(3916).KeyringWatchingBase),ee=r(1440);function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function re(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ne(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v()(e);if(t){var i=v()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return h()(this,r)}}!function(e){e.NOT_FOUND_ORDER="NOT_FOUND_ORDER",e.SUCCESS="SUCCESS",e.FAILED="FAILED",e.PENDING="PENDING"}(J||(J={}));var ie=function(e){l()(r,e);var t=ne(r);function r(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).keyringMap={hd:q,hw:j,imported:X,watching:$,external:$},e.settings=ee.default,e.getClientCache=Object(_.memoizee)((function(e){return new C(e)}),{maxAge:Object(m.getTimeDurationMs)({minute:3})}),e._decodedInvoceCache=Object(_.memoizee)(function(){var t=s()((function*(t){return(yield e.getClient()).decodedInvoice(t)}));return function(e){return t.apply(this,arguments)}}(),{maxAge:Object(m.getTimeDurationMs)({seconds:30})}),e}var n=r.prototype;return n.getClient=function(){var e=s()((function*(){var e=yield this.getNetwork();return this.getClientCache(e.isTestnet)}));return function(){return e.apply(this,arguments)}}(),n.exchangeToken=function(){var e=s()((function*(e){try{if(!e)throw new Error("No Password");var t=yield this.getDbAccount(),r=t.addresses.normalizedAddress,n=Object(g.bytesToHex)(Object(b.sha256)(t.pub)),i=yield this.getNetwork(),o=(yield this.engine.dbApi.getCredential(this.walletId,null!=e?e:"")).entropy,a=yield this.getClient(),c=yield a.fetchSignTemplate(r,"auth");if("auth"!==c.type)throw new Error("Invalid auth sign template");var s=Date.now(),u=yield H({msgPayload:re(re({},c),{},{pubkey:n,address:r,timestamp:s}),engine:this.engine,path:t.addresses.realPath,password:null!=e?e:"",entropy:o,isTestnet:i.isTestnet});return yield a.refreshAccessToken({hashPubKey:n,address:r,signature:u,timestamp:s,randomSeed:c.randomSeed})}catch(f){throw I.default.common.info("exchangeToken error",f),f}}));return function(t){return e.apply(this,arguments)}}(),n.addressFromBase=function(e){return Promise.resolve("")},n.getFetchBalanceAddress=function(e){return Promise.resolve(e.addresses.normalizedAddress)},n.getCurrentBalanceAddress=function(){var e=s()((function*(){return(yield this.getDbAccount()).addresses.normalizedAddress}));return function(){return e.apply(this,arguments)}}(),n.getHashAddress=function(){var e=s()((function*(){return(yield this.getDbAccount()).addresses.hashAddress}));return function(){return e.apply(this,arguments)}}(),n.validateAddress=function(){var e=s()((function*(e){try{return yield this._decodedInvoceCache(e),e}catch(t){throw new A.InvalidLightningPaymentRequest}}));return function(t){return e.apply(this,arguments)}}(),n.fetchFeeInfo=function(){var e=s()((function*(e){var t,r=yield this.engine.getNetwork(this.networkId);return{customDisabled:!0,limit:new w.a(null!=(t=e.fee)?t:"0").toFixed(),prices:["1"],defaultPresetIndex:"0",feeSymbol:r.feeSymbol,feeDecimals:r.feeDecimals,nativeSymbol:r.symbol,nativeDecimals:r.decimals,tx:null}}));return function(t){return e.apply(this,arguments)}}(),n.buildEncodedTxFromTransfer=function(){var e=s()((function*(e){yield this.getClient(),yield this.getCurrentBalanceAddress();var t,r,n=yield this._decodedInvoceCache(e.to),i=n.tags.find((function(e){return"payment_hash"===e.tagName})),o=n.millisatoshis?new w.a(n.millisatoshis).dividedBy(1e3):new w.a(null!=(t=n.satoshis)?t:"0");if(!n.paymentRequest)throw new A.InvalidLightningPaymentRequest;var a=n.tags.find((function(e){return"description"===e.tagName}));return{invoice:n.paymentRequest,paymentHash:null==i?void 0:i.data,amount:o.toFixed(),expired:""+(null!=(r=n.timeExpireDate)?r:""),created:""+Math.floor(Date.now()/1e3),description:null==a?void 0:a.data,fee:0}}));return function(t){return e.apply(this,arguments)}}(),n.updateEncodedTx=function(e){return Promise.resolve(e)},n.attachFeeInfoToEncodedTx=function(e){return Promise.resolve(e.encodedTx)},n.buildUnsignedTxFromEncodedTx=function(){var e=s()((function*(e){return Promise.resolve({inputs:[],outputs:[],payload:{encodedTx:e},encodedTx:e})}));return function(t){return e.apply(this,arguments)}}(),n.decodeTx=function(){var e=s()((function*(e,t){yield this.engine.getNetwork(this.networkId);var r=yield this.getDbAccount(),n=yield this.getHashAddress(),i=yield this.engine.getNativeTokenInfo(this.networkId),o=null;return e.description&&(o={memo:e.description}),{txid:"",owner:r.name,signer:"",nonce:0,actions:[{type:T.IDecodedTxActionType.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:i,from:n,to:"",amount:new w.a(e.amount).toFixed(),amountValue:e.amount,extraInfo:null},direction:T.IDecodedTxDirection.OUT}],status:T.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,encodedTx:e,payload:t,extraInfo:o}}));return function(t,r){return e.apply(this,arguments)}}(),n.decodedTxToLegacy=function(e){return Promise.resolve({})},n.fetchOnChainHistory=function(){var e=s()((function*(e){var t=this,r=yield this.getDbAccount(),n=r.addresses.normalizedAddress,i=r.addresses.hashAddress,o=yield this.engine.getNetwork(this.networkId),a=o.decimals,c=(o.symbol,yield this.engine.getNativeTokenInfo(this.networkId)),s=yield this.getClient(),u=(yield s.fetchHistory(n)).map((function(n){try{var o,s,u=n.txid,f=(n.owner,n.signer),d=n.nonce,l=n.actions,p=n.fee,h=n.status,y=null==(o=e.localHistory)?void 0:o.find((function(e){return e.decodedTx.txid===u}));if(y&&y.decodedTx.isFinal)return null;var v=new w.a(n.amount).shiftedBy(-a).toFixed(),b=""+n.amount,g=l[0],E=g.direction,m=g.type,I=E===T.IDecodedTxDirection.IN?"":i,_=E===T.IDecodedTxDirection.IN?i:"",A={txid:u,owner:r.name,signer:f,nonce:d,actions:[{type:m,direction:E,nativeTransfer:{tokenInfo:c,from:I,to:_,amount:v,amountValue:b,extraInfo:null}}],status:h,networkId:t.networkId,accountId:t.accountId,extraInfo:{memo:n.description},totalFeeInNative:new w.a(p).shiftedBy(-a).toFixed()};return A.updatedAt=new Date(n.settled_at).getTime(),A.createdAt=null!=(s=null==y?void 0:y.decodedTx.createdAt)?s:new Date(n.settled_at).getTime(),A.isFinal=A.status===T.IDecodedTxStatus.Confirmed||A.status===T.IDecodedTxStatus.Failed,t.buildHistoryTx({decodedTx:A,historyTxToMerge:y})}catch(P){return Promise.resolve(null)}}));return(yield Promise.all(u)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),n.fixActionDirection=function(){var e=s()((function*(e){var t=e.action;e.accountAddress;return t}));return function(t){return e.apply(this,arguments)}}(),n.getAccountBalance=function(){var e=s()((function*(e,t){var r=e.map((function(e){}));if(!t)return r;var n=yield this.getDbAccount(),o=yield this.getBalances([{address:n.addresses.normalizedAddress}]);return[i()(o,1)[0]].concat(r)}));return function(t,r){return e.apply(this,arguments)}}(),n.getBalances=function(){var e=s()((function*(e){var t=yield this.getClient(),r=yield t.batchGetBalance(e.map((function(e){return e.address})));return e.map((function(e){var t,n=r.find((function(t){return t.address===e.address}));return new w.a(null!=(t=null==n?void 0:n.balance)?t:0)}))}));return function(t){return e.apply(this,arguments)}}(),n.createInvoice=function(){var e=s()((function*(e,t){var r=yield this.getClient(),n=yield this.getCurrentBalanceAddress();return r.createInvoice(n,e,t)}));return function(t,r){return e.apply(this,arguments)}}(),n.broadcastTransaction=function(){var e=s()((function*(e,t){var r;I.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});try{var n=yield this.getClient(),i=e.encodedTx,o=i.invoice,a=i.amount,c=i.expired,s=i.created,u=i.paymentHash,f=yield this.getCurrentBalanceAddress();if("number"!==typeof e.nonce||"number"!==typeof e.randomSeed)throw new Error("Invalid nonce or randomSeed");r=yield n.paymentBolt11({invoice:o,paymentHash:u,amount:a,expired:c,created:Number(s),signature:e.rawTx,nonce:e.nonce,randomSeed:e.randomSeed},f),yield this.pollBolt11Status(f,e.nonce)}catch(d){throw I.default.sendTx.info("broadcastTransaction ERROR:",d),d}return I.default.engine.info("broadcastTransaction END:",{txid:e.txid,rawTx:e.rawTx,result:r}),re(re(re({},e),r),{},{encodedTx:e.encodedTx})}));return function(t,r){return e.apply(this,arguments)}}(),n.pollBolt11Status=function(){var e=s()((function*(e,t){var r=this;return new Promise(function(){var n=s()((function*(n,i){var o=yield r.getClient(),a=setInterval(s()((function*(){try{var r=yield o.checkBolt11({address:e,nonce:Number(t)});if(r.status===J.NOT_FOUND_ORDER)return;if(r.status===J.SUCCESS&&(clearInterval(a),n(P.TransactionStatus.CONFIRM_AND_SUCCESS)),r.status===J.FAILED){var c;clearInterval(a);var s=null==r||null==(c=r.data)?void 0:c.message;if("invoice is already paid"===(null==s?void 0:s.toLowerCase()))i(new A.InvoiceAlreadPaid);else if("no_route"===s)i(new A.NoRouteFoundError);else{var u;i(new Error(null==(u=r.data)?void 0:u.message))}}}catch(f){clearInterval(a),i(f)}})),3e3)}));return function(e,t){return n.apply(this,arguments)}}())}));return function(t,r){return e.apply(this,arguments)}}(),n.getTransactionStatuses=function(){var e=s()((function*(e){var t=this,r=yield this.getCurrentBalanceAddress();return Promise.all(e.map(function(){var e=s()((function*(e){var n,i=yield t.getClient();try{var o=yield i.specialInvoice(r,e);return(n=o.status)===O.StateOpen||n===O.StateInitialized?P.TransactionStatus.PENDING:n===O.StateSettled?P.TransactionStatus.CONFIRM_AND_SUCCESS:n===O.StateError?P.TransactionStatus.CONFIRM_BUT_FAILED:void 0}catch(c){var a;return"Bad arguments"===(null==c||null==(a=c.response)?void 0:a.data.message)?P.TransactionStatus.CONFIRM_BUT_FAILED:P.TransactionStatus.PENDING}}));return function(t){return e.apply(this,arguments)}}()))}));return function(t){return e.apply(this,arguments)}}(),n.buildEncodedTxFromApprove=function(e){throw new Error("Method not implemented.")},n.updateEncodedTxTokenApprove=function(e,t){throw new Error("Method not implemented.")},n.getExportedCredential=function(e,t){throw new Error("Method not implemented.")},n.fetchTokenInfos=function(e){throw new Error("Method not implemented.")},n.specialCheckEncodedTx=function(){var e=s()((function*(e){var t=e.invoice,r=e.amount,n=yield this._decodedInvoceCache(t);if(n.millisatoshis&&+n.millisatoshis<=0||n.satoshis&&+n.satoshis<=0||!n.millisatoshis&&!n.satoshis)return Promise.resolve({success:!1,key:"msg__the_invoice_amount_cannot_be_0",params:{0:"stas"}});var i=yield this.getCurrentBalanceAddress(),o=yield this.getBalances([{address:i}]);if(new w.a(o[0]||"0").isLessThan(new w.a(r)))return Promise.resolve({success:!1,key:"form__amount_invalid",params:{0:"stas"}});var a=n.tags.find((function(e){return"payment_hash"===e.tagName}));if(null!=a&&a.data)try{var c=yield this.getClient();if((yield c.specialInvoice(i,a.data)).is_paid)throw new A.InvoiceAlreadPaid}catch(f){var s=f.key,u=void 0===s?"":s;if("msg__invoice_is_already_paid"===u||"msg__authentication_failed_verify_again"===u)return Promise.resolve({success:!1,key:u})}return Promise.resolve({success:!0})}));return function(t){return e.apply(this,arguments)}}(),n.fetchSpecialInvoice=function(){var e=s()((function*(e){var t=yield this.getCurrentBalanceAddress(),r=yield this.getClient();return yield r.specialInvoice(t,e)}));return function(t){return e.apply(this,arguments)}}(),f()(r)}(N.VaultBase)}}]);