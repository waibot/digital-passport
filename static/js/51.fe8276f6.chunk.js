(this.webpackJsonp=this.webpackJsonp||[]).push([[51],{3903:function(e,r,t){"use strict";t.r(r),t.d(r,"KeyringBase",(function(){return h})),t.d(r,"KeyringBaseMock",(function(){return y}));var n=t(2),o=t.n(n),i=t(6),a=t.n(i),c=t(9),s=t.n(c),u=t(14),d=t.n(u),l=t(7),f=t.n(l);function p(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=f()(e);if(r){var o=f()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return d()(this,t)}}var h=function(e){s()(t,e);var r=p(t);function t(e){var t;return(t=r.call(this,e.options)).vault=e,t}return t.prototype.addressFromBase=function(){var e=o()((function*(e){return this.vault.addressFromBase(e)}));return function(r){return e.apply(this,arguments)}}(),a()(t)}(t(1585).VaultContext),y=function(e){s()(t,e);var r=p(t);function t(){return r.apply(this,arguments)}return a()(t)}(h)},3905:function(e,r,t){"use strict";t.r(r),t.d(r,"KeyringSoftwareBase",(function(){return I}));var n=t(4),o=t.n(n),i=t(3),a=t.n(i),c=t(2),s=t.n(c),u=t(6),d=t.n(u),l=t(9),f=t.n(l),p=t(14),h=t.n(p),y=t(7),v=t.n(y),m=t(19),w=t(23);function g(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function T(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?g(Object(t),!0).forEach((function(r){a()(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function x(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=v()(e);if(r){var o=v()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return h()(this,t)}}var I=function(e){f()(t,e);var r=x(t);function t(){return r.apply(this,arguments)}var n=t.prototype;return n.signTransaction=function(){var e=s()((function*(e,r){var t=r.password;if("undefined"===typeof t)throw new w.OneKeyInternalError("Software signing requires a password.");var n=yield this.getSigners(t,e.inputs.map((function(e){return e.address})));return m.default.engine.info("signTransaction",this.networkId,e),T(T({},yield this.engine.providerManager.signTransaction(this.networkId,e,n)),{},{encodedTx:e.encodedTx})}));return function(r,t){return e.apply(this,arguments)}}(),n.signMessage=function(){var e=s()((function*(e,r){var t=this,n=r.password;if("undefined"===typeof n)throw new w.OneKeyInternalError("Software signing requires a password.");var i=yield this.getDbAccount(),a=Object.values(yield this.getSigners(n,[i.address])),c=o()(a,1)[0];return m.default.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return t.engine.providerManager.signMessage(t.networkId,e,c)})))}));return function(r,t){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},d()(t)}(t(3903).KeyringBase)},3912:function(e,r,t){"use strict";t.r(r),function(e){t.d(r,"VaultBaseChainOnly",(function(){return R})),t.d(r,"VaultBase",(function(){return _}));var n=t(202),o=t.n(n),i=t(3),a=t.n(i),c=t(60),s=t.n(c),u=t(2),d=t.n(u),l=t(6),f=t.n(l),p=t(9),h=t.n(p),y=t(14),v=t.n(y),m=t(7),w=t.n(m),g=t(21),T=t.n(g),x=t(167),I=t.n(x),b=t(11),E=t(19),O=t(24),A=t(68),k=t(23),B=t(182),C=t(947),P=t(52),N=t(1585);function D(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function S(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?D(Object(t),!0).forEach((function(r){a()(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):D(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function H(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=w()(e);if(r){var o=w()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return v()(this,t)}}if(O.default.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var R=function(e){h()(t,e);var r=H(t);function t(){return r.apply(this,arguments)}var n=t.prototype;return n.initProvider=function(){var e=d()((function*(){var e=(yield this.getNetwork()).impl;s()(C.IMPL_MAPPINGS[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),n.proxyJsonRPCCall=function(){var e=d()((function*(e){throw new k.NotImplemented}));return function(r){return e.apply(this,arguments)}}(),n.createClientFromURL=function(e){throw new k.NotImplemented},n.getEthersProvider=function(){var e=d()((function*(){throw new k.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.getClientEndpointStatus=function(){var e=d()((function*(e){var r=this.createClientFromURL(e),t=performance.now(),n=(yield r.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-t),latestBlock:n}}));return function(r){return e.apply(this,arguments)}}(),n.checkRpcBatchSupport=function(){var e=d()((function*(e){throw new k.NotImplemented}));return function(r){return e.apply(this,arguments)}}(),n.getDisplayAddress=function(){var e=d()((function*(e){return Promise.resolve(e)}));return function(r){return e.apply(this,arguments)}}(),n.validateAddress=function(){var e=d()((function*(e){var r=yield this.engineProvider.verifyAddress(e),t=r.normalizedAddress;if(!r.isValid||!t)throw new k.InvalidAddress;return Promise.resolve(t)}));return function(r){return e.apply(this,arguments)}}(),n.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},n.validateWatchingCredential=function(){var e=d()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(r){return e.apply(this,arguments)}}(),n.validateTokenAddress=function(){var e=d()((function*(e){var r=yield this.engineProvider.verifyTokenAddress(e),t=r.normalizedAddress;if(!r.isValid||"undefined"===typeof t)throw new k.InvalidTokenAddress;return Promise.resolve(t)}));return function(r){return e.apply(this,arguments)}}(),n.validateCanCreateNextAccount=function(){var e=d()((function*(e,r){return Promise.resolve(!0)}));return function(r,t){return e.apply(this,arguments)}}(),n.checkAccountExistence=function(){var e=d()((function*(e,r){return Promise.resolve(!0)}));return function(r,t){return e.apply(this,arguments)}}(),n.getBalances=function(){var e=d()((function*(e,r,t){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var r=e.address,t=e.tokenAddress;return{address:r,coin:S({},"string"===typeof t?{tokenAddress:t}:{})}})))}));return function(r,t,n){return e.apply(this,arguments)}}(),n.getFrozenBalance=function(){var e=d()((function*(e){return 0}));return function(r){return e.apply(this,arguments)}}(),n.fetchBalanceDetails=function(){var e=d()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password;return Promise.resolve(void 0)}));return function(){return e.apply(this,arguments)}}(),n.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},n.getTransactionFeeInNative=function(e){return Promise.resolve("")},n.isContractAddress=function(){var e=d()((function*(e){return!1}));return function(r){return e.apply(this,arguments)}}(),n.getAccountNameInfoMap=function(){var e=d()((function*(){var e=yield this.getNetwork();return Object(B.getAccountNameInfoByImpl)(e.impl)}));return function(){return e.apply(this,arguments)}}(),n.canAutoCreateNextAccount=function(){var e=d()((function*(e){return Promise.resolve(!1)}));return function(r){return e.apply(this,arguments)}}(),n.filterAccounts=function(){var e=d()((function*(e){var r=e.accounts;e.networkId;return Promise.resolve(r)}));return function(r){return e.apply(this,arguments)}}(),n.shouldChangeAccountWhenNetworkChanged=function(){var e=d()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(r){return e.apply(this,arguments)}}(),n.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=d()((function*(e){return Promise.resolve([])}));return function(r){return e.apply(this,arguments)}}(),n.checkIsUnlimitedAllowance=function(){var e=d()((function*(e){throw new k.NotImplemented}));return function(r){return e.apply(this,arguments)}}(),n.checkIsApprovedForAll=function(){var e=d()((function*(e){throw new k.NotImplemented}));return function(r){return e.apply(this,arguments)}}(),n.checkIsBatchTransfer=function(){var e=d()((function*(e){throw new k.NotImplemented}));return function(r){return e.apply(this,arguments)}}(),n.getFeePricePerUnit=function(){var e=d()((function*(){throw new k.NotImplemented}));return function(){return e.apply(this,arguments)}}(),n.fetchRpcChainId=function(){var e=d()((function*(e){return null}));return function(r){return e.apply(this,arguments)}}(),n.getTxWaitingSeconds=function(){var e=d()((function*(){return[]}));return function(){return e.apply(this,arguments)}}(),n.getUserNFTAssets=function(){var e=d()((function*(e){e.serviceData;return Promise.resolve(void 0)}));return function(r){return e.apply(this,arguments)}}(),f()(t)}(N.VaultContext),_=function(r){h()(n,r);var t=H(n);function n(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).uuid=I.a.v4().toString(),e}var i=n.prototype;return i.init=function(){var e=d()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(r){return e.apply(this,arguments)}}(),i.initKeyring=function(){var e=d()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(r){return e.apply(this,arguments)}}(),i.signTransaction=function(){var e=d()((function*(e,r){return this.keyring.signTransaction(e,r)}));return function(r,t){return e.apply(this,arguments)}}(),i.signAndSendTransaction=function(){var e=d()((function*(e,r,t){var n=yield this.signTransaction(e,r);return t?S(S({},n),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(S(S({},n),{},{encodedTx:e.encodedTx}))}));return function(r,t,n){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=d()((function*(e,r){E.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var t=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,r);return E.default.engine.info("broadcastTransaction END:",{txid:t,rawTx:e.rawTx}),S(S({},e),{},{txid:t,encodedTx:e.encodedTx})}));return function(r,t){return e.apply(this,arguments)}}(),i.buildEncodedTxFromBatchTransfer=function(){var e=d()((function*(e){throw new k.NotImplemented}));return function(r){return e.apply(this,arguments)}}(),i.buildEncodedTxsFromSetApproveForAll=function(){var e=d()((function*(e,r){throw new k.NotImplemented}));return function(r,t){return e.apply(this,arguments)}}(),i.activateAccount=function(){var e=d()((function*(){throw new k.NotImplemented}));return function(){return e.apply(this,arguments)}}(),i.activateToken=function(){var e=d()((function*(e,r){throw new k.NotImplemented}));return function(r,t){return e.apply(this,arguments)}}(),i.getTokenAllowance=function(){var e=d()((function*(e,r){throw new k.NotImplemented}));return function(r,t){return e.apply(this,arguments)}}(),i.batchTokensAllowance=function(){var e=d()((function*(e,r){throw new k.NotImplemented}));return function(r,t){return e.apply(this,arguments)}}(),i.getOutputAccount=function(){var e=d()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:o()(e,"pub","")}}));return function(){return e.apply(this,arguments)}}(),i.getAccountBalance=function(){var e=d()((function*(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=yield this.getDbAccount(),i=o.address;return this.getBalances((r?[{address:i}]:[]).concat(e.map((function(e){return{address:i,tokenAddress:e}}))),t,n)}));return function(r){return e.apply(this,arguments)}}(),i.updatePendingTxs=function(){var e=d()((function*(e){throw new k.NotImplemented}));return function(r){return e.apply(this,arguments)}}(),i.getAccountNonce=function(){var e=d()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),i.fixActionDirection=function(){var e=d()((function*(e){var r,t,n,o,i=e.action,a=e.accountAddress;(i.direction=P.IDecodedTxDirection.OTHER,i.type===P.IDecodedTxActionType.NATIVE_TRANSFER)&&(i.direction=yield this.buildTxActionDirection({from:(null==(r=i.nativeTransfer)?void 0:r.from)||"",to:(null==(t=i.nativeTransfer)?void 0:t.to)||"",address:a}));i.type===P.IDecodedTxActionType.TOKEN_TRANSFER&&(i.direction=yield this.buildTxActionDirection({from:(null==(n=i.tokenTransfer)?void 0:n.from)||"",to:(null==(o=i.tokenTransfer)?void 0:o.to)||"",address:a}));return i}));return function(r){return e.apply(this,arguments)}}(),i.fixDecodedTx=function(){var e=d()((function*(e){var r,t;e.createdAt=null!=(r=e.createdAt)?r:Date.now();var n=null==(t=e.encodedTx)?void 0:t.nonce;e.nonce=s()(n)?e.nonce:new T.a(n).toNumber();for(var o=e.owner,i=0;i<e.actions.length;i+=1){var a=e.actions[i];yield this.fixActionDirection({action:a,accountAddress:o})}if(e.outputActions)for(var c=0;c<e.outputActions.length;c+=1){var u=e.outputActions[c];yield this.fixActionDirection({action:u,accountAddress:o})}return Promise.resolve(e)}));return function(r){return e.apply(this,arguments)}}(),i.fixHistoryTx=function(){var e=d()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),Promise.resolve(e)}));return function(r){return e.apply(this,arguments)}}(),i.buildHistoryTx=function(){var e=d()((function*(e){var r=e.historyTxToMerge,t=(e.encodedTx,e.decodedTx),n=e.signedTx,o=e.isSigner,i=e.isLocalCreated,a=(null==n?void 0:n.txid)||(null==t?void 0:t.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var c=yield this.getAccountAddress();t.txid=a||t.txid,t.owner=c,o&&(t.signer=c),null!=n&&n.txKey&&(t.extraInfo?t.extraInfo.txKey=n.txKey:t.extraInfo={txKey:n.txKey});var s=S(S({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(i)},r),{},{decodedTx:t});return s=yield this.fixHistoryTx(s),Promise.resolve(s)}));return function(r){return e.apply(this,arguments)}}(),i.checkIsScamHistoryTx=function(){var e=d()((function*(e){return!1}));return function(r){return e.apply(this,arguments)}}(),i.fetchOnChainHistory=function(){var e=d()((function*(e){throw new k.NotImplemented}));return function(r){return e.apply(this,arguments)}}(),i.fixAddressCase=function(e){return Promise.resolve(e)},i.buildTxActionDirection=function(){var e=d()((function*(e){var r=e.from,t=e.to,n=e.address;return r=yield this.fixAddressCase(r||""),t=yield this.fixAddressCase(t),n=yield this.fixAddressCase(n),r===t&&r===n?P.IDecodedTxDirection.SELF:r&&r===n?P.IDecodedTxDirection.OUT:t&&t===n?P.IDecodedTxDirection.IN:P.IDecodedTxDirection.OTHER}));return function(r){return e.apply(this,arguments)}}(),i.getNextNonce=function(){var e=d()((function*(e,r){var t,n,o=null!=(t=null==(n=(yield this.engine.providerManager.getAddresses(e,[r.address]))[0])?void 0:n.nonce)?t:0,i=(yield this.engine.getHistory(e,r.id,void 0,!1),yield A.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),a=yield A.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),c=Math.max(s()(i)?0:i+1,o);if(Number.isNaN(c)&&(c=o),c>o)for(var u=o;u<c;u+=1)if(!a.includes(u)){c=u;break}if(c<o&&(c=o),c-o>=b.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new k.PendingQueueTooLong(b.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return c}));return function(r,t){return e.apply(this,arguments)}}(),i.validateSendAmount=function(e,r,t){return Promise.resolve(!0)},i.notifyChainChanged=function(e,r){},i.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},i.getPrivateKeyByCredential=function(r){return Promise.resolve(e.from(r.startsWith("0x")?r.slice(2):r,"hex"))},i.getMinDepositAmount=function(){var e=d()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),i.specialCheckEncodedTx=function(){var e=d()((function*(e){return{success:!0}}));return function(r){return e.apply(this,arguments)}}(),i.getAllUsedAddress=function(){var e=d()((function*(){return Promise.resolve([])}));return function(){return e.apply(this,arguments)}}(),f()(n)}(R)}.call(this,t(26).Buffer)},3913:function(e,r,t){"use strict";t.r(r),function(e){t.d(r,"KeyringHardwareBase",(function(){return v}));var n=t(2),o=t.n(n),i=t(6),a=t.n(i),c=t(9),s=t.n(c),u=t(14),d=t.n(u),l=t(7),f=t.n(l),p=t(431),h=t(163);function y(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=f()(e);if(r){var o=f()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return d()(this,t)}}var v=function(r){s()(n,r);var t=y(n);function n(){return t.apply(this,arguments)}var i=n.prototype;return i.getHardwareInfo=function(){var e=o()((function*(){var e,r,t,n=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==n?void 0:n.mac)?e:"",deviceId:null!=(r=null==n?void 0:n.deviceId)?r:"",deviceType:null!=(t=null==n?void 0:n.deviceType)?t:""}}));return function(){return e.apply(this,arguments)}}(),i.getWalletPassphraseState=function(){var e=o()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(h.isPassphraseWallet)(e)}}));return function(){return e.apply(this,arguments)}}(),i.getHardwareSDKInstance=function(){var r=o()((function*(){var r,t,n,o,i;return null!=(i=yield null==(r=e)||null==(t=r.$backgroundApiProxy)||null==(n=t.backgroundApi)||null==(o=n.serviceHardware)||null==o.getSDKInstance?void 0:o.getSDKInstance())?i:p.HardwareSDK}));return function(){return r.apply(this,arguments)}}(),i.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},a()(n)}(t(3903).KeyringBase)}.call(this,t(58))},3914:function(e,r,t){"use strict";t.r(r),t.d(r,"KeyringHdBase",(function(){return T}));var n=t(3),o=t.n(n),i=t(2),a=t.n(i),c=t(6),s=t.n(c),u=t(9),d=t.n(u),l=t(14),f=t.n(l),p=t(7),h=t.n(p),y=t(610),v=t(23);function m(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function w(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?m(Object(t),!0).forEach((function(r){o()(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function g(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=h()(e);if(r){var o=h()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return f()(this,t)}}var T=function(e){d()(t,e);var r=g(t);function t(){return r.apply(this,arguments)}var n=t.prototype;return n.getPrivateKeys=function(){var e=a()((function*(e,r){var t=(yield this.getDbAccount()).path.split("/"),n=r||[t.pop()],o=t.join("/"),i=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof i)throw new v.OneKeyInternalError("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(y.batchGetPrivateKeys)(a,i,e,o,n).reduce((function(e,r){var t;return w(w({},e),{},((t={})[r.path]=r.extendedKey.key,t))}),{})}));return function(r,t){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},s()(t)}(t(3905).KeyringSoftwareBase)},3915:function(e,r,t){"use strict";t.r(r),t.d(r,"KeyringImportedBase",(function(){return y}));var n=t(2),o=t.n(n),i=t(6),a=t.n(i),c=t(9),s=t.n(c),u=t(14),d=t.n(u),l=t(7),f=t.n(l),p=t(23);function h(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=f()(e);if(r){var o=f()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return d()(this,t)}}var y=function(e){s()(t,e);var r=h(t);function t(){return r.apply(this,arguments)}var n=t.prototype;return n.getPrivateKeys=function(){var e=o()((function*(e,r){if("undefined"!==typeof r)throw new p.NotImplemented("Getting private keys from extended private key");var t=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof t)throw new p.OneKeyInternalError("Unable to get credential.");return{"":t}}));return function(r,t){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(t)}(t(3905).KeyringSoftwareBase)},3916:function(e,r,t){"use strict";t.r(r),t.d(r,"KeyringWatchingBase",(function(){return y}));var n=t(2),o=t.n(n),i=t(6),a=t.n(i),c=t(9),s=t.n(c),u=t(14),d=t.n(u),l=t(7),f=t.n(l),p=t(23);function h(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=f()(e);if(r){var o=f()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return d()(this,t)}}var y=function(e){s()(t,e);var r=h(t);function t(){return r.apply(this,arguments)}var n=t.prototype;return n.signTransaction=function(){var e=o()((function*(e,r){throw new p.OneKeyInternalError("signTransaction is not supported for watching accounts")}));return function(r,t){return e.apply(this,arguments)}}(),n.signMessage=function(){var e=o()((function*(e,r){throw new p.OneKeyInternalError("signMessage is not supported for watching accounts")}));return function(r,t){return e.apply(this,arguments)}}(),n.getAddress=function(){throw new Error("Method not implemented.")},n.batchGetAddress=function(){throw new Error("Method not implemented.")},n.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(t)}(t(3903).KeyringBase)},3918:function(e,r,t){"use strict";t.r(r),t.d(r,"convertDeviceError",(function(){return c}));var n=t(70),o=t(90),i=t(19);t(24);function a(e,r){return"string"!==typeof r?null:e===n.HardwareErrorCode.DeviceInitializeFailed&&r.includes("ECONNABORTED")?new o.ConnectTimeoutError({message:r}):r.includes("Bridge network error")?new o.BridgeNetworkError({message:r}):null}function c(e){var r,t=e||{},c=t.code,s=t.error,u=t.message,d=null!=(r=null!=s?s:u)?r:"Unknown error";if(a(c,d))return a(c,d);switch(i.default.hardwareSDK.info("Device Utils Convert Device Error:",c,d),c){case n.HardwareErrorCode.UnknownError:return new o.UnknownHardwareError(e);case n.HardwareErrorCode.DeviceFwException:return new o.FirmwareVersionTooLow(e);case n.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof d&&-1!==d.indexOf("ui-device_bootloader_mode")?new o.NotInBootLoaderMode(e):new o.UnknownHardwareError(e);case n.HardwareErrorCode.DeviceCheckDeviceIdError:return new o.DeviceNotSame(e);case n.HardwareErrorCode.DeviceNotFound:return new o.DeviceNotFind(e);case n.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new o.NotInBootLoaderMode(e);case n.HardwareErrorCode.DeviceInterruptedFromOutside:case n.HardwareErrorCode.DeviceInterruptedFromUser:return new o.UserCancelFromOutside(e);case n.HardwareErrorCode.DeviceNotSupportPassphrase:return new o.NotSupportPassphraseError(e);case n.HardwareErrorCode.IFrameLoadFail:return new o.InitIframeLoadFail(e);case n.HardwareErrorCode.IframeTimeout:return new o.InitIframeTimeout(e);case n.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new o.FirmwareDownloadFailed(e);case n.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new o.FirmwareUpdateManuallyEnterBoot(e);case n.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new o.FirmwareUpdateAutoEnterBootFailure(e);case n.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new o.FirmwareUpdateLimitOneDevice(e);case n.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new o.FirmwareVersionTooLow(e);case n.HardwareErrorCode.NewFirmwareUnRelease:return new o.NewFirmwareUnRelease(e);case n.HardwareErrorCode.NewFirmwareForceUpdate:return new o.NewFirmwareForceUpdate(e);case n.HardwareErrorCode.NetworkError:return new o.NetworkError(e);case n.HardwareErrorCode.BlePermissionError:return new o.NeedBluetoothTurnedOn(e);case n.HardwareErrorCode.BleLocationError:return new o.NeedBluetoothPermissions({message:d});case n.HardwareErrorCode.BleLocationServicesDisabled:return new o.BleLocationServiceError({message:d});case n.HardwareErrorCode.BleDeviceNotBonded:return new o.DeviceNotBonded(e);case n.HardwareErrorCode.BleDeviceBondError:return new o.DeviceBondError(e);case n.HardwareErrorCode.BleWriteCharacteristicError:return new o.BleWriteCharacteristicError(e);case n.HardwareErrorCode.BleScanError:return new o.BleScanError({message:d});case n.HardwareErrorCode.BleAlreadyConnected:return new o.BleAlreadyConnectedError(e);case n.HardwareErrorCode.RuntimeError:return-1!==d.indexOf("EIP712 blind sign is disabled")?new o.OpenBlindSign(e):-1!==d.indexOf("Unknown message")||-1!==d.indexOf("Failure_UnexpectedMessage")?new o.UnknownMethod(e):new o.UnknownHardwareError(e);case n.HardwareErrorCode.PinInvalid:return new o.InvalidPIN(e);case n.HardwareErrorCode.DeviceCheckPassphraseStateError:return new o.InvalidPassphrase(e);case n.HardwareErrorCode.DeviceOpenedPassphrase:return new o.DeviceOpenedPassphrase(e);case n.HardwareErrorCode.DeviceNotOpenedPassphrase:return new o.DeviceNotOpenedPassphrase(e);case n.HardwareErrorCode.PinCancelled:case n.HardwareErrorCode.ActionCancelled:return new o.UserCancel(e);case n.HardwareErrorCode.BridgeNotInstalled:case o.CustomOneKeyHardwareError.NeedOneKeyBridge:return new o.NeedOneKeyBridge(e);case n.HardwareErrorCode.BridgeNetworkError:return new o.BridgeNetworkError(e);case n.HardwareErrorCode.BridgeTimeoutError:return new o.BridgeTimeoutError(e);case n.HardwareErrorCode.PollingTimeout:return new o.ConnectTimeoutError(e);case n.HardwareErrorCode.PollingStop:return new o.ConnectPollingStopError(e);case n.HardwareErrorCode.BlindSignDisabled:return new o.OpenBlindSign(e);case n.HardwareErrorCode.FileAlreadyExists:return new o.FileAlreadyExistError(e);case n.HardwareErrorCode.CheckDownloadFileError:return new o.IncompleteFileError(e);case n.HardwareErrorCode.NotInSigningMode:return new o.NotInSigningModeError(e);default:return new o.UnknownHardwareError(e)}}},4162:function(e,r,t){"use strict";var n,o;t.r(r),t.d(r,"BatchTransferMethods",(function(){return n})),t.d(r,"BatchTransferSelectors",(function(){return o})),function(e){e.disperseNFT="disperseNFT(address,address[],uint256[],uint256[])",e.disperseEther="disperseEther(address[],uint256[])",e.disperseToken="disperseToken(address,address[],uint256[])",e.disperseTokenSimple="disperseTokenSimple(address,address[],uint256[])",e.disperseEtherSameValue="disperseEtherSameValue(address[],uint256)",e.disperseTokenSameValue="disperseTokenSameValue(address,address[],uint256)"}(n||(n={})),function(e){e.disperseNFT="0x39039af6",e.disperseEther="0xe63d38ed",e.disperseToken="0xc73a2d60",e.disperseTokenSimple="0x51ba162c",e.disperseEtherSameValue="0xc263a3e4",e.disperseTokenSameValue="0x17546c6c"}(o||(o={}))},4402:function(e,r,t){"use strict";t.r(r),function(e){t.d(r,"publicKeyToAddress",(function(){return y})),t.d(r,"signTransaction",(function(){return v}));var n=t(3),o=t.n(n),i=t(4),a=t.n(i),c=t(2),s=t.n(c),u=t(138),d=t(4190),l=t.n(d),f=t(610);function p(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function h(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?p(Object(t),!0).forEach((function(r){o()(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function y(r){var t=Object(f.uncompressPublicKey)("secp256k1",e.from(r,"hex"));return l.a.address.fromHex("41"+Object(u.keccak256)(t.slice(-64)).slice(-40))}function v(e,r){return m.apply(this,arguments)}function m(){return(m=s()((function*(r,t){var n=r.payload.encodedTx,o=yield t.sign(e.from(n.txID,"hex")),i=a()(o,2),c=i[0],s=i[1];return Promise.resolve({txid:n.txID,rawTx:JSON.stringify(h(h({},n),{},{signature:[e.concat([c,e.from([s])]).toString("hex")]}))})}))).apply(this,arguments)}}.call(this,t(26).Buffer)},4752:function(e,r,t){"use strict";t.r(r),t.d(r,"KeyringHardware",(function(){return k}));var n=t(3),o=t.n(n),i=t(2),a=t.n(i),c=t(6),s=t.n(c),u=t(9),d=t.n(u),l=t(14),f=t.n(l),p=t(7),h=t.n(p),y=t(4190),v=t.n(y),m=t(3918),w=t(11),g=t(19),T=t(23),x=t(117),I=t(3913);function b(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function E(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?b(Object(t),!0).forEach((function(r){o()(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function O(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=h()(e);if(r){var o=h()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return f()(this,t)}}var A="m/44'/"+w.COINTYPE_TRON+"'/0'/0",k=function(e){d()(t,e);var r=O(t);function t(){return r.apply(this,arguments)}var n=t.prototype;return n.signTransaction=function(){var e=a()((function*(e,r){var t,n=e.payload.encodedTx,o=n.raw_data,i=o.ref_block_bytes,a=o.ref_block_hash,c=o.expiration,s=o.timestamp,u=o.fee_limit;switch(n.raw_data.contract[0].type){case"TransferContract":var d=n.raw_data.contract[0].parameter.value,l=d.amount,f=d.to_address;t={transferContract:{amount:l,toAddress:v.a.address.fromHex(f)}};break;case"TriggerSmartContract":var p=n.raw_data.contract[0].parameter.value,h=p.contract_address,y=p.call_value,w=p.data;t={triggerSmartContract:{contractAddress:v.a.address.fromHex(h),data:w,callValue:y}};break;case"FreezeBalanceV2Contract":var g=n.raw_data.contract[0].parameter.value,x=g.frozen_balance,I=g.resource;t={freezeBalanceV2Contract:E({frozenBalance:x},"BANDWIDTH"===(void 0===I?"BANDWIDTH":I)?null:{resource:1})};break;case"UnfreezeBalanceV2Contract":var b=n.raw_data.contract[0].parameter.value,O=b.unfreeze_balance,A=b.resource;t={unfreezeBalanceV2Contract:E({unfreezeBalance:O},"BANDWIDTH"===(void 0===A?"BANDWIDTH":A)?null:{resource:1})};break;case"DelegateResourceContract":var k=n.raw_data.contract[0].parameter.value,B=k.receiver_address,C=k.resource,P=void 0===C?"BANDWIDTH":C,N=k.balance,D=k.lock;t={delegateResourceContract:E(E({balance:N,receiverAddress:v.a.address.fromHex(B)},D?{lock:D}:null),"BANDWIDTH"===P?null:{resource:1})};break;case"UnDelegateResourceContract":var S=n.raw_data.contract[0].parameter.value,H=S.receiver_address,R=S.resource,_=void 0===R?"BANDWIDTH":R;t={unDelegateResourceContract:E({balance:S.balance,receiverAddress:v.a.address.fromHex(H)},"BANDWIDTH"===_?null:{resource:1})};break;case"WithdrawBalanceContract":var F=n.raw_data.contract[0].parameter.value.owner_address;t={withdrawBalanceContract:{ownerAddress:v.a.address.fromHex(F)}};break;case"WithdrawExpireUnfreezeContract":t={withdrawExpireUnfreezeContract:void 0}}if("undefined"===typeof t)throw new T.NotImplemented;var j=yield this.getDbAccount(),K=yield this.getHardwareSDKInstance(),M=yield this.getHardwareInfo(),U=M.connectId,W=M.deviceId,V=yield this.getWalletPassphraseState(),L=yield K.tronSignTransaction(U,W,E({path:j.path,transaction:{refBlockBytes:i,refBlockHash:a,expiration:c,timestamp:s,feeLimit:u,contract:t}},V));if(L.success&&L.payload.signature){var z=L.payload,G=z.signature,q=z.serialized_tx;return Promise.resolve({txid:n.txID,rawTx:JSON.stringify(E(E({},n),{},{raw_data_hex:q||n.raw_data_hex,signature:[G]}))})}throw Object(m.convertDeviceError)(L.payload)}));return function(r,t){return e.apply(this,arguments)}}(),n.signMessage=function(e,r){throw new T.NotImplemented("Signing tron message is not supported yet.")},n.prepareAccounts=function(){var e=a()((function*(e){var r,t=this,n=e.indexes,o=e.names,i=n.map((function(e){return A+"/"+e})),a=yield this.getHardwareSDKInstance(),c=yield this.getHardwareInfo(),s=c.connectId,u=c.deviceId,d=yield this.getWalletPassphraseState();try{r=yield a.tronGetAddress(s,u,E({bundle:i.map((function(e){return{path:e,showOnOneKey:!1}}))},d))}catch(l){throw g.default.common.error(l),new T.OneKeyHardwareError(l)}if(!r.success)throw g.default.common.error(r.payload),Object(m.convertDeviceError)(r.payload);return r.payload.map((function(e,r){var i=e.address,a=e.path;return{id:t.walletId+"--"+a,name:(o||[])[r]||"TRON #"+(n[r]+1),type:x.AccountType.SIMPLE,path:a,coinType:w.COINTYPE_TRON,pub:"",address:null!=i?i:""}})).filter((function(e){return!!e.address}))}));return function(r){return e.apply(this,arguments)}}(),n.getAddress=function(){var e=a()((function*(e){var r,t=yield this.getHardwareSDKInstance(),n=yield this.getHardwareInfo(),o=n.connectId,i=n.deviceId,a=yield this.getWalletPassphraseState(),c=yield t.tronGetAddress(o,i,E({path:e.path,showOnOneKey:e.showOnOneKey},a));if(c.success&&null!=(r=c.payload)&&r.address)return c.payload.address;throw Object(m.convertDeviceError)(c.payload)}));return function(r){return e.apply(this,arguments)}}(),n.batchGetAddress=function(){var e=a()((function*(e){var r=yield this.getHardwareSDKInstance(),t=yield this.getHardwareInfo(),n=t.connectId,o=t.deviceId,i=yield this.getWalletPassphraseState(),a=yield r.tronGetAddress(n,o,E(E({},i),{},{bundle:e.map((function(e){return{path:e.path,showOnOneKey:!!e.showOnOneKey}}))}));if(!a.success)throw Object(m.convertDeviceError)(a.payload);return a.payload.map((function(e){var r,t;return{path:null!=(r=e.path)?r:"",address:null!=(t=e.address)?t:""}}))}));return function(r){return e.apply(this,arguments)}}(),s()(t)}(I.KeyringHardwareBase)},4753:function(e,r,t){"use strict";t.r(r),t.d(r,"KeyringHd",(function(){return I}));var n=t(2),o=t.n(n),i=t(6),a=t.n(i),c=t(9),s=t.n(c),u=t(14),d=t.n(u),l=t(7),f=t.n(l),p=t(610),h=t(11),y=t(23),v=t(1345),m=t(117),w=t(3914),g=t(4402);function T(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=f()(e);if(r){var o=f()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return d()(this,t)}}var x="m/44'/"+h.COINTYPE_TRON+"'/0'/0",I=function(e){s()(t,e);var r=T(t);function t(){return r.apply(this,arguments)}var n=t.prototype;return n.getSigners=function(){var e=o()((function*(e,r){var t,n=yield this.getDbAccount();if(1!==r.length)throw new y.OneKeyInternalError("TRON signers number should be 1.");if(r[0]!==n.address)throw new y.OneKeyInternalError("Wrong address required for signing.");var o=(yield this.getPrivateKeys(e))[n.path];if("undefined"===typeof o)throw new y.OneKeyInternalError("Unable to get signer.");return(t={})[n.address]=new v.Signer(o,e,"secp256k1"),t}));return function(r,t){return e.apply(this,arguments)}}(),n.prepareAccounts=function(){var e=o()((function*(e){var r=e.password,t=e.indexes,n=e.names,o=(yield this.engine.dbApi.getCredential(this.walletId,r)).seed,i=Object(p.batchGetPublicKeys)("secp256k1",o,r,x,t.map((function(e){return e.toString()})));if(i.length!==t.length)throw new y.OneKeyInternalError("Unable to get publick key.");var a=[],c=0;for(var s of i){var u=s.path,d=s.extendedKey.key.toString("hex"),l=Object(g.publicKeyToAddress)(d),f=(n||[])[c]||"TRON #"+(t[c]+1);a.push({id:this.walletId+"--"+u,name:f,type:m.AccountType.SIMPLE,path:u,coinType:h.COINTYPE_TRON,pub:d,address:l}),c+=1}return a}));return function(r){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=o()((function*(e,r){var t=yield this.getDbAccount(),n=(yield this.getSigners(r.password||"",[t.address]))[t.address];return Object(g.signTransaction)(e,n)}));return function(r,t){return e.apply(this,arguments)}}(),a()(t)}(w.KeyringHdBase)},4754:function(e,r,t){"use strict";t.r(r),t.d(r,"KeyringImported",(function(){return b}));var n=t(4),o=t.n(n),i=t(2),a=t.n(i),c=t(6),s=t.n(c),u=t(9),d=t.n(u),l=t(14),f=t.n(l),p=t(7),h=t.n(p),y=t(748),v=t(11),m=t(23),w=t(1345),g=t(117),T=t(3915),x=t(4402);function I(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=h()(e);if(r){var o=h()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return f()(this,t)}}var b=function(e){d()(t,e);var r=I(t);function t(){return r.apply(this,arguments)}var n=t.prototype;return n.getSigners=function(){var e=a()((function*(e,r){var t,n=yield this.getDbAccount();if(1!==r.length)throw new m.OneKeyInternalError("TRON signers number should be 1.");if(r[0]!==n.address)throw new m.OneKeyInternalError("Wrong address required for signing.");var i=Object.values(yield this.getPrivateKeys(e)),a=o()(i,1)[0];return(t={})[n.address]=new w.Signer(a,e,"secp256k1"),t}));return function(r,t){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=a()((function*(e,r){var t=yield this.getDbAccount(),n=(yield this.getSigners(r.password||"",[t.address]))[t.address];return Object(x.signTransaction)(e,n)}));return function(r,t){return e.apply(this,arguments)}}(),n.prepareAccounts=function(){var e=a()((function*(e){var r=e.name,t=e.privateKey;if(32!==t.length)throw new m.OneKeyInternalError("Invalid private key.");var n=y.secp256k1.publicFromPrivate(t).toString("hex"),o=Object(x.publicKeyToAddress)(n);return Promise.resolve([{id:"imported--"+v.COINTYPE_TRON+"--"+n,name:r||"",type:g.AccountType.SIMPLE,path:"",coinType:v.COINTYPE_TRON,pub:n,address:o}])}));return function(r){return e.apply(this,arguments)}}(),s()(t)}(T.KeyringImportedBase)},4755:function(e,r,t){"use strict";t.r(r),t.d(r,"KeyringWatching",(function(){return v}));var n=t(2),o=t.n(n),i=t(6),a=t.n(i),c=t(9),s=t.n(c),u=t(14),d=t.n(u),l=t(7),f=t.n(l),p=t(11),h=t(117);function y(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=f()(e);if(r){var o=f()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return d()(this,t)}}var v=function(e){s()(t,e);var r=y(t);function t(){return r.apply(this,arguments)}return t.prototype.prepareAccounts=function(){var e=o()((function*(e){var r=e.name,t=e.target,n=e.accountIdPrefix,o=yield this.vault.validateAddress(t);return Promise.resolve([{id:n+"--"+p.COINTYPE_TRON+"--"+o,name:r||"",type:h.AccountType.SIMPLE,path:"",coinType:p.COINTYPE_TRON,pub:"",address:o}])}));return function(r){return e.apply(this,arguments)}}(),a()(t)}(t(3916).KeyringWatchingBase)},6080:function(e,r,t){"use strict";t.r(r),function(e){t.d(r,"default",(function(){return oe}));var n=t(3),o=t.n(n),i=t(4159),a=t.n(i),c=t(13),s=t.n(c),u=t(4),d=t.n(u),l=t(887),f=t.n(l),p=t(455),h=t.n(p),y=t(378),v=t.n(y),m=t(2),w=t.n(m),g=t(6),T=t.n(g),x=t(9),I=t.n(x),b=t(14),E=t.n(b),O=t(7),A=t.n(O),k=t(554),B=t(107),C=t.n(B),P=t(21),N=t.n(P),D=t(4190),S=t.n(D),H=t(112),R=t(367),_=t(46),F=t(163),j=t(19),K=t(150),M=t(376),U=t(23),W=t(1070),V=t(1345),L=t(4162),z=t(52),G=t(3912),q=t(453),Y=t(4752),J=t(4753),X=t(4754),Q=t(4755),$=t(2716);function Z(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function ee(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Z(Object(t),!0).forEach((function(r){o()(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function re(e){var r=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var t,n=A()(e);if(r){var o=A()(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return E()(this,t)}}var te="0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",ne=/\(([^)]+)\)/,oe=function(r){I()(n,r);var t=re(n);function n(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).keyringMap={hd:J.KeyringHd,hw:Y.KeyringHardware,imported:X.KeyringImported,watching:Q.KeyringWatching,external:Q.KeyringWatching},e.settings=$.default,e.getTronWeb=Object(K.memoizee)((function(e){var r=new S.a({fullHost:e});return r.setAddress("T9yD14Nj9j7xAB4dbGeiX9h8unkKHxuWwb"),r}),{promise:!0,max:3,maxAge:Object(_.getTimeDurationMs)({minute:3})}),e.getApiExplorerCache=Object(K.memoizee)(function(){var e=w()((function*(e){return C.a.create({baseURL:e})}));return function(r){return e.apply(this,arguments)}}(),{primitive:!0,promise:!0,max:1,maxAge:Object(_.getTimeDurationMs)({minute:3})}),e.getTokenInfo=Object(K.memoizee)(function(){var r=w()((function*(r){var t=yield e.getApiExplorer(),n=new N.a(r).isInteger(),o=n?"api/token":"api/token_trc20",i=n?{id:r}:{contract:r};try{var a,c=yield t.get(o,{params:i});if(n){var s,u=null==(s=c.data.data)?void 0:s[0],d=c.data.total;if(u&&1===d)return{name:u.name,symbol:u.abbr,decimals:u.precision,logoURI:u.imgUrl}}var l=null==(a=c.data.trc20_tokens)?void 0:a[0];if(l)return{name:l.name,symbol:l.symbol,decimals:l.decimals,logoURI:l.icon_url}}catch(f){}}));return function(e){return r.apply(this,arguments)}}(),{promise:!0,max:100,maxAge:Object(_.getTimeDurationMs)({minute:3})}),e.getParameters=Object(K.memoizee)(w()((function*(){var r=yield e.getClient();return Object.fromEntries((yield r.trx.getChainParameters()).map((function(e){return[e.key,e.value]})))})),{promise:!0,maxAge:Object(_.getTimeDurationMs)({minute:3})}),e}var o=n.prototype;return o.getApiExplorer=function(){var e=w()((function*(){var e=yield this.getClientApi();return this.getApiExplorerCache(e.tronscan)}));return function(){return e.apply(this,arguments)}}(),o.getClient=function(){var e=w()((function*(){var e=(yield this.engine.getNetwork(this.networkId)).rpcURL;return this.getTronWeb(e)}));return function(){return e.apply(this,arguments)}}(),o.getAccountTokens=function(){var e=w()((function*(e){try{var r,t=yield this.getApiExplorer(),n=yield t.get("api/account/tokens",{params:{address:e}});return(null==n||null==(r=n.data)?void 0:r.data)||[]}catch(o){}}));return function(r){return e.apply(this,arguments)}}(),o.getConsumableResource=function(){var e=w()((function*(e){var r=yield this.getClient(),t=yield r.trx.getAccountResources(e),n=t.freeNetUsed,o=void 0===n?0:n,i=t.freeNetLimit,a=void 0===i?0:i,c=t.NetUsed,s=void 0===c?0:c,u=t.NetLimit,d=void 0===u?0:u,l=t.EnergyUsed,f=void 0===l?0:l,p=t.EnergyLimit;return{freeBandwidth:a-o,stakedBandwidth:d-s,stakedEnergy:(void 0===p?0:p)-f}}));return function(r){return e.apply(this,arguments)}}(),o.getClientEndpointStatus=function(){var e=w()((function*(e){var r=this.getTronWeb(e),t=performance.now(),n=(yield r.fullNode.request("jsonrpc",{jsonrpc:"2.0",id:1,method:"eth_getBlockByNumber",params:["latest",!1]},"post")).result.number,o=parseInt(n);return{responseTime:Math.floor(performance.now()-t),latestBlock:o}}));return function(r){return e.apply(this,arguments)}}(),o.fetchTokenInfos=function(){var e=w()((function*(e){var r=this;return Promise.all(e.map(function(){var e=w()((function*(e){try{return yield r.getTokenInfo(e)}catch(t){}}));return function(r){return e.apply(this,arguments)}}()))}));return function(r){return e.apply(this,arguments)}}(),o.validateAddress=function(){var e=w()((function*(e){return new N.a(e).isInteger()?(yield this.getTokenInfo(e))?e:Promise.reject(new U.InvalidAddress):S.a.isAddress(e)?Promise.resolve(S.a.address.fromHex(e)):Promise.reject(new U.InvalidAddress)}));return function(r){return e.apply(this,arguments)}}(),o.validateWatchingCredential=function(e){return Promise.resolve(this.settings.watchingAccountEnabled&&S.a.isAddress(e))},o.validateTokenAddress=function(e){return this.validateAddress(e)},o.checkAccountExistence=function(){var e=w()((function*(e){var r=yield this.getClient();return"undefined"!==typeof(yield r.trx.getAccount(e)).address}));return function(r){return e.apply(this,arguments)}}(),o.getBalances=function(){var e=w()((function*(e){var r=this,t=v()(h()(e,"address")),n=yield Promise.all(t.map(function(){var e=w()((function*(e){try{var t=yield r.getAccountTokens(e);return t?{address:e,tokens:t}:null}catch(n){return null}}));return function(r){return e.apply(this,arguments)}}()));return e.map((function(e){var r,t,o=e.address,i=e.tokenAddress,a=(null==(r=f()(n,{address:o}))?void 0:r.tokens)||[],c=f()(a,{tokenId:null!=i?i:"_"});return c?new N.a(null!=(t=c.balance)?t:0):new N.a(0)}))}));return function(r){return e.apply(this,arguments)}}(),o.getTransactionStatuses=function(){var e=w()((function*(e){var r=yield this.getClient();return Promise.all(e.map((function(e){return r.trx.getConfirmedTransaction(e).then((function(e){var r=d()(e.ret,1)[0].contractRet;return"SUCCESS"===(void 0===r?"":r)?R.TransactionStatus.CONFIRM_AND_SUCCESS:R.TransactionStatus.CONFIRM_BUT_FAILED}),(function(t){return"Transaction not found"===t?r.trx.getTransaction(e).then((function(){return R.TransactionStatus.PENDING}),(function(e){return"Transaction not found"===e?R.TransactionStatus.NOT_FOUND:void 0})):void 0}))})))}));return function(r){return e.apply(this,arguments)}}(),o.attachFeeInfoToEncodedTx=function(e){return Promise.resolve(e.encodedTx)},o.decodeTx=function(){var e=w()((function*(e,r){var t=e,n={type:z.IDecodedTxActionType.UNKNOWN};if("TransferContract"===t.raw_data.contract[0].type){var o=t.raw_data.contract[0].parameter.value,i=o.amount,a=o.owner_address,c=o.to_address,s=yield this.engine.getNativeTokenInfo(this.networkId);n={type:z.IDecodedTxActionType.NATIVE_TRANSFER,nativeTransfer:{tokenInfo:s,from:S.a.address.fromHex(a),to:S.a.address.fromHex(c),amount:new N.a(i).shiftedBy(-s.decimals).toFixed(),amountValue:i.toString(),extraInfo:null}}}else if("TriggerSmartContract"===t.raw_data.contract[0].type){var u=t.raw_data.contract[0].parameter.value,l=u.contract_address,f=u.data,p=u.owner_address;try{var h=S.a.address.fromHex(p),y=S.a.address.fromHex(l);if(y===W.batchTransferContractAddress[this.networkId]){var v=yield this.decodeBatchTransferTx(t);if(v)return v}var m=yield this.fetchTokenInfos([y]),w=d()(m,1)[0],g=yield this.engine.ensureTokenInDB(this.networkId,y),T="0x"+f.slice(0,8);if(w&&g)if(T===q.Erc20MethodSelectors.tokenTransfer){var x=k.defaultAbiCoder.decode(["address","uint256"],"0x"+f.slice(8)),I=d()(x,2),b=I[0],E=I[1],O=new N.a(E._hex);"undefined"!==typeof g&&(n={type:z.IDecodedTxActionType.TOKEN_TRANSFER,tokenTransfer:{tokenInfo:g,from:h,to:S.a.address.fromHex(b),amount:O.shiftedBy(-g.decimals).toFixed(),amountValue:O.toFixed(),extraInfo:null}})}else if(T===q.Erc20MethodSelectors.tokenApprove){var A=k.defaultAbiCoder.decode(["address","uint256"],"0x"+f.slice(8)),B=d()(A,2),C=B[0],P=B[1],D=new N.a(P._hex);n={type:z.IDecodedTxActionType.TOKEN_APPROVE,tokenApprove:{tokenInfo:g,owner:h,spender:S.a.address.fromHex(C),isMax:Object(F.toBigIntHex)(D)===te,amount:D.shiftedBy(-g.decimals).toFixed(),amountValue:D.toFixed(),extraInfo:null}}}}catch(R){}}var H=yield this.getAccountAddress();return{txid:t.txID,owner:H,signer:H,nonce:0,actions:[n],status:z.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,extraInfo:null,encodedTx:t}}));return function(r,t){return e.apply(this,arguments)}}(),o.decodeBatchTransferTx=function(){var e=w()((function*(e){var r=yield this.getAccountAddress(),t=e.raw_data.contract[0].parameter.value,n=t.data,o=t.owner_address,i=S.a.address.fromHex(o),a="0x"+n.slice(0,8),c=[],s=yield this.getAccountAddress();switch(a){case L.BatchTransferSelectors.disperseEtherSameValue:case L.BatchTransferSelectors.disperseEther:var u=a===L.BatchTransferSelectors.disperseEtherSameValue,l=yield this.engine.getNativeTokenInfo(this.networkId),f=[],p=[];if(u){var h=k.defaultAbiCoder.decode(["address[]","uint256"],"0x"+n.slice(8));f=d()(h,1)[0],p=[h[1]]}else{var y=k.defaultAbiCoder.decode(["address[]","uint256[]"],"0x"+n.slice(8)),v=d()(y,2);f=v[0],p=v[1]}for(var m=0;m<f.length;m+=1){var w=S.a.address.fromHex(f[m]),g=new N.a(u?p[0]._hex:p[m]._hex);i!==r&&w!==r||c.push({type:z.IDecodedTxActionType.NATIVE_TRANSFER,direction:yield this.buildTxActionDirection({from:i,to:f[m],address:s}),nativeTransfer:{tokenInfo:l,from:i,to:w,amount:g.shiftedBy(-l.decimals).toFixed(),amountValue:g.toFixed(),extraInfo:null}})}break;case L.BatchTransferSelectors.disperseTokenSameValue:case L.BatchTransferSelectors.disperseTokenSimple:var T=a===L.BatchTransferSelectors.disperseTokenSameValue,x="",I=[],b=[];if(T){var E=k.defaultAbiCoder.decode(["address","address[]","uint256"],"0x"+n.slice(8)),O=d()(E,2);x=O[0],I=O[1],b=[E[2]]}else{var A=k.defaultAbiCoder.decode(["address","address[]","uint256[]"],"0x"+n.slice(8)),B=d()(A,3);x=B[0],I=B[1],b=B[2]}var C=yield this.engine.ensureTokenInDB(this.networkId,S.a.address.fromHex(x));if(!C)break;for(var P=0;P<I.length;P+=1){var D=S.a.address.fromHex(I[P]),H=new N.a(T?b[0]._hex:b[P]._hex);c.push({type:z.IDecodedTxActionType.TOKEN_TRANSFER,direction:yield this.buildTxActionDirection({from:i,to:D,address:s}),tokenTransfer:{tokenInfo:C,from:i,to:D,amount:H.shiftedBy(-C.decimals).toFixed(),amountValue:H.toFixed(),extraInfo:null}})}break;default:return null}return{txid:e.txID,owner:r,signer:i||r,nonce:0,actions:[].concat(c),status:z.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,extraInfo:null,encodedTx:e}}));return function(r){return e.apply(this,arguments)}}(),o.decodedTxToLegacy=function(e){return Promise.resolve({})},o.buildEncodedTxFromTransfer=function(){var e=w()((function*(e){if(!e.to)throw new Error("Invalid transferInfo.to params");var r=e.from,t=e.to,n=e.amount,o=e.token,i=yield this.getClient(),a=yield this.engine.ensureTokenInDB(this.networkId,o||"");if(!a)throw new U.OneKeyInternalError("Token not found: "+(o||"TRX"));if(o){if(!new N.a(o).isInteger()){var c=yield i.transactionBuilder.triggerSmartContract(o,"transfer(address,uint256)",{},[{type:"address",value:t},{type:"uint256",value:new N.a(n).shiftedBy(a.decimals).toFixed(0)}],r),s=c.result.result,u=c.transaction;if(!s)throw new U.OneKeyInternalError("Unable to build token transfer transaction");return u}try{return yield i.transactionBuilder.sendToken(t,parseInt(new N.a(n).shiftedBy(a.decimals).toFixed()),o,r)}catch(d){throw"string"===typeof d&&d.endsWith("is not sufficient.")?new U.InsufficientBalance:"string"===typeof d?new Error(d):d}}try{return yield i.transactionBuilder.sendTrx(t,parseInt(new N.a(n).shiftedBy(a.decimals).toFixed()),r)}catch(d){throw"string"===typeof d&&d.endsWith("balance is not sufficient.")?new U.InsufficientBalance:"string"===typeof d?new Error(d):d}}));return function(r){return e.apply(this,arguments)}}(),o.buildEncodedTxFromBatchTransfer=function(){var e=w()((function*(e){var r,t,n,o=e.transferInfos,i=yield this.getClient(),c=yield this.getNetwork(),u=yield this.getDbAccount(),d=o[0],l=Boolean(d.token),f=W.batchTransferContractAddress[c.id];if(!f)throw new Error(c.name+" has not deployed a batch transfer contract");var p=new N.a(0),h=o.every((function(e){return new N.a(e.amount).isEqualTo(d.amount)}));if(l){var y,v=yield this.engine.ensureTokenInDB(this.networkId,null!=(y=d.token)?y:"");if(!v)throw new Error("Token not found: "+d.token);t=(r=h?L.BatchTransferMethods.disperseTokenSameValue:L.BatchTransferMethods.disperseTokenSimple).match(ne)[1].split(","),n=[v.tokenIdOnNetwork].concat(s()(a()(o,(function(e,r){var t=new N.a(r.amount);return e[0].push(r.to),e[1].push(t.shiftedBy(v.decimals).toNumber()),e}),[[],[]]))),h&&(n=[n[0],n[1],n[2][0]])}else t=(r=h?L.BatchTransferMethods.disperseEtherSameValue:L.BatchTransferMethods.disperseEther).match(ne)[1].split(","),n=a()(o,(function(e,r){var t=new N.a(r.amount).shiftedBy(c.decimals);return p=p.plus(t),e[0].push(r.to),e[1].push(t.toNumber()),e}),[[],[]]),h&&(n=[n[0],n[1][0]]);var m=t.map((function(e,r){return{type:e,value:n[r]}})),w=yield i.transactionBuilder.triggerSmartContract(i.address.toHex(f),r,{callValue:l?0:p.toNumber(),feeLimit:15e9},m,i.address.toHex(u.address)),g=w.result.result,T=w.transaction;if(!g)throw new U.OneKeyInternalError("Unable to build batch transfer token transaction");return T}));return function(r){return e.apply(this,arguments)}}(),o.getBatchTransferBaseEnergy=function(){var e=w()((function*(){var e=yield this.getNetwork(),r=yield this.getDbAccount(),t=W.batchTransferContractAddress[e.id],n=yield this.getClient(),o=L.BatchTransferMethods.disperseEther,i=new N.a(1).shiftedBy(e.decimals).toNumber(),a=[[r.address],[i]],c=["address[]","uint256[]"].map((function(e,r){return{type:e,value:a[r]}}));try{var s=yield n.transactionBuilder.estimateEnergy(n.address.toHex(t),o,{callValue:i},c,n.address.toHex(r.address)),u=s.result.result,d=s.energy_required;if(u)return d}catch(l){return 0}return 0}));return function(){return e.apply(this,arguments)}}(),o.checkIsUnlimitedAllowance=function(){var e=w()((function*(e){var r=e.owner,t=e.spender,n=e.token;try{var o,i=yield this.getClient(),a=yield i.contract().at(n),c=yield a.allowance(r,t).call(),s=null!=(o=c.remaining)?o:c,u=new N.a(s._hex),d=(yield a.totalSupply().call())._hex;return{isUnlimited:u.gt(d),allowance:u.toFixed()}}catch(l){return{isUnlimited:!1,allowance:"0"}}}));return function(r){return e.apply(this,arguments)}}(),o.checkIsBatchTransfer=function(){var e=w()((function*(e){var r=yield this.getClient();if("TriggerSmartContract"===e.raw_data.contract[0].type){var t=e.raw_data.contract[0].parameter.value.contract_address;return r.address.toHex(W.batchTransferContractAddress[this.networkId])===t}return!1}));return function(r){return e.apply(this,arguments)}}(),o.buildEncodedTxFromApprove=function(){var e=w()((function*(e){var r=yield this.getClient(),t=yield this.engine.ensureTokenInDB(this.networkId,e.token);if("undefined"===typeof t)throw new Error("Token not found: "+e.token);var n=[{type:"address",value:e.spender},{type:"uint256",value:"Infinite"===e.amount?te:new N.a(e.amount).shiftedBy(t.decimals).toFixed()}],o=yield r.transactionBuilder.triggerSmartContract(e.token,"approve(address,uint256)",{call_value:0},n,e.from),i=o.result.result,a=o.transaction;if(!i)throw new U.OneKeyInternalError("Unable to build token approve transaction");return a}));return function(r){return e.apply(this,arguments)}}(),o.getTokenAllowance=function(){var e=w()((function*(e,r){var t=yield Promise.all([this.getDbAccount(),this.engine.ensureTokenInDB(this.networkId,e)]),n=d()(t,2),o=n[0],i=n[1];if("undefined"===typeof i)throw new Error;var a=yield this.getClient(),c=yield a.contract([{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"remaining",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"}],e),s=yield c.allowance(o.address,r).call(),u=d()(s,1)[0];return u?new N.a(u.toHexString()).shiftedBy(-i.decimals):new N.a(0)}));return function(r,t){return e.apply(this,arguments)}}(),o.updateEncodedTxTokenApprove=function(e,r){throw new U.NotImplemented},o.updateEncodedTx=function(){var e=w()((function*(e,r,t){var n=e;if("transfer"===t.type&&"TransferContract"===n.raw_data.contract[0].type){var o=yield this.getClient(),i=(yield this.engine.getNativeTokenInfo(this.networkId)).decimals,a=n.raw_data.contract[0].parameter.value,c=a.owner_address,s=a.to_address,u=r.amount;return o.transactionBuilder.sendTrx(S.a.address.fromHex(s),parseInt(new N.a(u).shiftedBy(i).toFixed()),S.a.address.fromHex(c))}return Promise.resolve(n)}));return function(r,t,n){return e.apply(this,arguments)}}(),o.buildUnsignedTxFromEncodedTx=function(e){return Promise.resolve({inputs:[],outputs:[],payload:{encodedTx:e},encodedTx:e})},o.fetchFeeInfo=function(){var e=w()((function*(e,r,t,n){var o=0,i=yield this.getNetwork(),a=e,c=yield this.getParameters(),s=yield this.getConsumableResource(yield this.getAccountAddress()),u=s.freeBandwidth,d=s.stakedBandwidth,l=s.stakedEnergy,f=a.raw_data_hex.length/2+65+64+5;if(o+=(f>u&&f>d?f:0)*c.getTransactionFee,"TransferContract"===a.raw_data.contract[0].type){var p=a.raw_data.contract[0].parameter.value.to_address;(yield this.checkAccountExistence(S.a.address.fromHex(p)))||(o=c.getCreateNewAccountFeeInSystemContract,o+=c.getCreateAccountFee>d?c.getCreateAccountFee:0)}else if("TriggerSmartContract"===a.raw_data.contract[0].type){var h=a.raw_data.contract[0].parameter.value,y=h.contract_address,v=h.data,m=h.call_value,w=h.owner_address,g=0,T=yield this.getClient(),x=yield T.fullNode.request("jsonrpc",{jsonrpc:"2.0",id:1,method:"eth_estimateGas",params:[{from:w,to:y,gas:"0x01",gasPrice:"0x01",value:Object(F.toBigIntHex)(new N.a(null!=m?m:0)),data:v}]},"post");if(x.error&&x.error.message){if(!x.error.message.startsWith("Not enough energy for 'CALL'")||S.a.address.fromHex(y)!==W.batchTransferContractAddress[this.networkId])throw new Error(x.error.message);g=(yield this.getBatchTransferBaseEnergy())*n}else g=parseInt(x.result);g>l&&(o+=g*c.getEnergyFee)}return{nativeSymbol:i.symbol,nativeDecimals:i.decimals,feeSymbol:i.feeSymbol,feeDecimals:i.feeDecimals,limit:"0",prices:["0"],defaultPresetIndex:"0",tx:null,baseFeeValue:new N.a(o.toString()).shiftedBy(-i.feeDecimals).toFixed()}}));return function(r,t,n,o){return e.apply(this,arguments)}}(),o.broadcastTransaction=function(){var r=w()((function*(r){j.default.engine.info("broadcastTransaction START:",{rawTx:r.rawTx});var t=yield this.getClient(),n=yield t.trx.sendRawTransaction(JSON.parse(r.rawTx));if("undefined"!==typeof n.code)throw new U.OneKeyInternalError(n.code+" "+e.from(n.message||"","hex").toString());return j.default.engine.info("broadcastTransaction END:",{txid:r.txid,rawTx:r.rawTx}),r}));return function(e){return r.apply(this,arguments)}}(),o.getExportedCredential=function(){var e=w()((function*(e){var r=yield this.getDbAccount();if(r.id.startsWith("hd-")||r.id.startsWith("imported")){var t=this.keyring,n=Object.values(yield t.getPrivateKeys(e)),o=d()(n,1)[0];return Object(H.decrypt)(e,o).toString("hex")}throw new U.OneKeyInternalError("Only credential of HD or imported accounts can be exported")}));return function(r){return e.apply(this,arguments)}}(),o.fetchOnChainHistory=function(){var e=w()((function*(e){var r=this,t=e.localHistory,n=void 0===t?[]:t,o=e.tokenIdOnNetwork,i=[],a=[],c=[],u=yield this.getClient(),l=yield this.getApiExplorer(),f=yield this.getDbAccount(),p=(yield this.engine.getNativeTokenInfo(this.networkId)).decimals;i=(yield u.fullNode.request("v1/accounts/"+f.address+"/transactions/trc20?only_confirmed=true"+(o?"&&contract_address="+o:""))).data,o||(a=(yield u.fullNode.request("v1/accounts/"+f.address+"/transactions/?only_confirmed=true")).data,c=(yield l.get("api/internal-transaction",{params:{address:f.address,start:0,limit:20}})).data.data);var h=i.map(function(){var e=w()((function*(e){var t=n.find((function(r){return r.decodedTx.txid===e.transaction_id}));if(t&&t.decodedTx.isFinal)return Promise.resolve(null);if(e.from===f.address)return Promise.resolve(null);var o=yield r.engine.ensureTokenInDB(r.networkId,e.token_info.address);if(!o)return Promise.resolve(null);var i=yield u.trx.getTransactionInfo(e.transaction_id),a=new N.a(e.value),c={type:z.IDecodedTxActionType.UNKNOWN};"Transfer"===e.type&&(c={type:z.IDecodedTxActionType.TOKEN_TRANSFER,tokenTransfer:{tokenInfo:o,from:e.from,to:e.to,amount:a.shiftedBy(-o.decimals).toFixed(),amountValue:a.toFixed(),extraInfo:null}});try{var s,d,l={txid:e.transaction_id,owner:e.from,signer:e.from,totalFeeInNative:new N.a(null!=(s=i.fee)?s:0).shiftedBy(-p).toFixed(),actions:[c],accountId:r.accountId,networkId:r.networkId,status:z.IDecodedTxStatus.Confirmed,updatedAt:e.block_timestamp,createdAt:null!=(d=null==t?void 0:t.decodedTx.createdAt)?d:e.block_timestamp,isFinal:!0,extraInfo:null,nonce:0};return yield r.buildHistoryTx({decodedTx:l,historyTxToMerge:t})}catch(h){j.default.common.error(h)}return Promise.resolve(null)}));return function(r){return e.apply(this,arguments)}}()),y=a.map(function(){var e=w()((function*(e){var t=n.find((function(r){return r.decodedTx.txid===e.txID}));if(t&&t.decodedTx.isFinal)return Promise.resolve(null);try{var o,i=e.block_timestamp,a=d()(e.ret,1)[0],c=a.contractRet,s=a.fee,u=ee(ee({},yield r.decodeTx(e)),{},{txid:e.txID,totalFeeInNative:new N.a(s).shiftedBy(-p).toFixed(),status:"SUCCESS"===c?z.IDecodedTxStatus.Confirmed:z.IDecodedTxStatus.Failed,updatedAt:i,createdAt:null!=(o=null==t?void 0:t.decodedTx.createdAt)?o:i,isFinal:!0});return yield r.buildHistoryTx({decodedTx:u,historyTxToMerge:t})}catch(l){j.default.common.error(l)}return Promise.resolve(null)}));return function(r){return e.apply(this,arguments)}}()),v=c.map(function(){var e=w()((function*(e){var t=n.find((function(r){return r.decodedTx.txid===e.hash}));if(t&&t.decodedTx.isFinal)return Promise.resolve(null);try{var o,i=yield Promise.all([u.trx.getTransaction(e.hash),u.trx.getTransactionInfo(e.hash)]),a=d()(i,2),c=a[0],s=a[1],l=d()(c.ret,1)[0].contractRet,f=ee(ee({},yield r.decodeTx(c)),{},{txid:e.hash,totalFeeInNative:new N.a(s.fee).shiftedBy(-p).toFixed(),status:"SUCCESS"===l?z.IDecodedTxStatus.Confirmed:z.IDecodedTxStatus.Failed,updatedAt:e.timestamp,createdAt:null!=(o=null==t?void 0:t.decodedTx.createdAt)?o:e.timestamp,isFinal:!0});return yield r.buildHistoryTx({decodedTx:f,historyTxToMerge:t})}catch(h){j.default.common.error(h)}}));return function(r){return e.apply(this,arguments)}}()),m=(yield Promise.all(h)).filter(Boolean),g=(yield Promise.all(y)).filter(Boolean),T=(yield Promise.all(v)).filter(Boolean);return[].concat(s()(m),s()(g),s()(T))}));return function(r){return e.apply(this,arguments)}}(),o.proxyJsonRPCCall=function(){var e=w()((function*(e){try{var r=yield this.getClient();return yield r.fullNode.request("jsonrpc",e,"post")}catch(t){throw Object(V.extractResponseError)(t)}}));return function(r){return e.apply(this,arguments)}}(),o.getFeePricePerUnit=function(){var e=w()((function*(){var e=(yield this.proxyJsonRPCCall({id:1,jsonrpc:"2.0",method:"eth_gasPrice",params:[]})).result,r=Object(M.fromBigIntHex)(e),t=r.isFinite()&&r.gt(1)?r:new N.a(1),n=t.multipliedBy(1.25).integerValue(N.a.ROUND_CEIL),o=n.multipliedBy(1.2).integerValue(N.a.ROUND_CEIL);return{normal:{price:n},others:[{price:t},{price:o}]}}));return function(){return e.apply(this,arguments)}}(),T()(n)}(G.VaultBase)}.call(this,t(26).Buffer)}}]);