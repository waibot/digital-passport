(this.webpackJsonp=this.webpackJsonp||[]).push([[89],{4295:function(e,t,s){"use strict";var a;s.r(t),s.d(t,"PasswordRoutes",(function(){return a})),function(e){e.PasswordRoutes="PasswordRoutes"}(a||(a={}))},5322:function(e,t,s){"use strict";s.r(t);var a=s(50),n=s(57),r=s(51),o=s(48),d=s(4),i=s.n(d),u=s(225),c=s(12),l=s(54),f=s(47),m=s(27),_=s(2),b=s.n(_),j=s(126),g=s(1),w=s(44),p=s(88),h=s(112),O=(s(24),s(17)),x=(s(1209),s(25)),v=s(45),M=s(86),y=s(274),P=s(0),S=function(e){var t=e.onNext,s=Object(p.default)(),a=Object(j.default)({defaultValues:{password:""},mode:"onChange"}),n=a.control,r=a.handleSubmit,o=a.setError,d=a.formState.isValid,i=Object(g.useCallback)(function(){var e=b()((function*(e){var a=yield O.default.servicePassword.getBgSensitiveTextEncodeKey(),n=Object(h.encodeSensitiveText)({text:e.password,key:a});(yield O.default.engine.verifyMasterPassword(n))?null==t||t(n):o("password",{message:s.formatMessage({id:"msg__wrong_password",defaultMessage:"Wrong password."})})}));return function(t){return e.apply(this,arguments)}}(),[t,s,o]);return Object(P.jsxs)(u.default,{px:{base:4,md:0},children:[Object(P.jsx)(m.default.DisplayLarge,{textAlign:"center",mb:2,children:s.formatMessage({id:"title__enter_password",defaultMessage:"Enter Password"})}),Object(P.jsx)(m.default.Body1,{textAlign:"center",color:"text-subdued",children:s.formatMessage({id:"content__enter_current_password_before_resetting_it",defaultMessage:"Enter the old password before resetting it"})}),Object(P.jsxs)(f.default,{mt:"8",children:[Object(P.jsx)(f.default.Item,{name:"password",control:n,rules:{required:s.formatMessage({id:"form__field_is_required"})},children:Object(P.jsx)(f.default.PasswordInput,{autoFocus:!0,onSubmitEditing:r(i)})}),Object(P.jsx)(l.default,{size:"xl",type:"primary",isDisabled:!d,onPress:r(i),children:s.formatMessage({id:"action__continue",defaultMessage:"Continue"})}),null]})]})},A=function(e){var t=e.oldPassword,s=Object(p.default)(),a=Object(g.useState)(!1),n=i()(a,2),d=n[0],c=n[1],_=Object(w.useNavigation)(),S=O.default.dispatch,A=Object(g.useRef)({unmount:!1}),k=Object(v.useAppSelector)((function(e){return e.status.authenticationType})),C=Object(v.useAppSelector)((function(e){return e.settings.enableLocalAuthentication})),E=Object(x.useLocalAuthentication)().isOk,L=Object(j.default)({defaultValues:{password:"",confirmPassword:""},mode:"onChange"}),I=L.control,B=L.handleSubmit,V=L.getValues,q=L.setValue,R=L.watch,T=L.formState.isValid,D=Object(g.useCallback)((function(){setTimeout((function(){A.current.unmount||c(!0)}),2e3)}),[]),N=Object(g.useCallback)(function(){var e=b()((function*(e){var a=yield O.default.servicePassword.getBgSensitiveTextEncodeKey(),n=Object(h.encodeSensitiveText)({text:e.password,key:a});try{D(),yield O.default.serviceApp.updatePassword(t,n)}catch(d){var r=d.key;return void o.default.show({title:s.formatMessage({id:r})})}e.withEnableAuthentication&&(S(Object(M.setEnableLocalAuthentication)(!0)),Object(y.savePassword)(n)),C&&Object(y.savePassword)(n),t?o.default.show({title:s.formatMessage({id:"msg__password_changed"})}):o.default.show({title:s.formatMessage({id:"msg__password_has_been_set"})}),_.goBack()}));return function(t){return e.apply(this,arguments)}}(),[_,s,t,S,C,D]),F=R(["password","confirmPassword"]);Object(g.useEffect)((function(){var e=F.map((function(e){return e.split("").filter((function(e){return e.charCodeAt(0)>=32&&e.charCodeAt(0)<=126})).join("")})),t=i()(e,2),s=t[0],a=t[1];s!==F[0]&&q("password",s),a!==F[1]&&q("confirmPassword",a)}),[F,q]),Object(g.useEffect)((function(){return function(){A.current.unmount=!0}}),[]);var z="FACIAL"===k?s.formatMessage({id:"content__face_id"}):s.formatMessage({id:"content__touch_id"});return Object(P.jsxs)(u.default,{px:{base:4,md:0},children:[Object(P.jsx)(m.default.DisplayLarge,{textAlign:"center",mb:2,children:s.formatMessage({id:"title__set_password",defaultMessage:"Set Password"})}),Object(P.jsx)(m.default.Body1,{textAlign:"center",color:"text-subdued",children:s.formatMessage({id:"Only_you_can_unlock_your_wallet",defaultMessage:"Only you can unlock your wallet"})}),Object(P.jsxs)(f.default,{mt:"8",children:[Object(P.jsx)(f.default.Item,{name:"password",label:s.formatMessage({id:"form__password",defaultMessage:"Password"}),control:I,rules:{required:s.formatMessage({id:"form__field_is_required"}),minLength:{value:8,message:s.formatMessage({id:"msg__password_validation"})},maxLength:{value:128,message:s.formatMessage({id:"msg__password_validation"})},validate:function(e){var t=V("confirmPassword");if(t)return t!==e?s.formatMessage({id:"msg__password_needs_to_be_the_same"}):void 0}},children:Object(P.jsx)(f.default.PasswordInput,{autoFocus:!0})}),Object(P.jsx)(f.default.Item,{name:"confirmPassword",label:s.formatMessage({id:"Confirm_password",defaultMessage:"Confirm Password"}),control:I,rules:{required:s.formatMessage({id:"form__field_is_required"}),minLength:{value:8,message:s.formatMessage({id:"msg__password_validation"})},maxLength:{value:128,message:s.formatMessage({id:"msg__password_validation"})},validate:function(e){var t=V("password");if(t)return t!==e?s.formatMessage({id:"msg__password_needs_to_be_the_same"}):void 0}},children:Object(P.jsx)(f.default.PasswordInput,{onSubmitEditing:B(N)})}),E&&!t?Object(P.jsx)(f.default.Item,{name:"withEnableAuthentication",defaultValue:E,control:I,children:Object(P.jsx)(f.default.CheckBox,{title:s.formatMessage({id:"content__authentication_with"},{0:z})})}):null,Object(P.jsx)(l.default,{size:"xl",type:"primary",isDisabled:!T,onPromise:B(N),children:s.formatMessage({id:"action__continue",defaultMessage:"Continue"})}),d?Object(P.jsx)(r.default,{children:Object(P.jsx)(m.default.Body2,{color:"text-subdued",children:s.formatMessage({id:"content__change_password_attention"})})}):null]})]})},k=function(){var e=Object(g.useState)(""),t=i()(e,2),s=t[0],a=t[1];return s?Object(P.jsx)(A,{oldPassword:s}):Object(P.jsx)(S,{onNext:a})},C=function(){var e=Object(v.useData)().isPasswordSet,t=Object(g.useState)(e),s=i()(t,1)[0];return Object(P.jsx)(n.default,{footer:null,children:Object(P.jsx)(c.default,{children:s?Object(P.jsx)(k,{}):Object(P.jsx)(A,{oldPassword:""})})})},E=s(4295),L=s(234),I=Object(L.default)(),B=[{name:E.PasswordRoutes.PasswordRoutes,component:C}];t.default=function(){var e=Object(a.default)();return Object(P.jsx)(I.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:B.map((function(e){return Object(P.jsx)(I.Screen,{name:e.name,component:e.component},e.name)}))})}}}]);