(this.webpackJsonp=this.webpackJsonp||[]).push([[1],{3903:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringBase",(function(){return h})),n.d(t,"KeyringBaseMock",(function(){return v}));var r=n(2),i=n.n(r),o=n(6),a=n.n(o),s=n(9),u=n.n(s),c=n(14),d=n.n(c),l=n(7),f=n.n(l);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var h=function(e){u()(n,e);var t=p(n);function n(e){var n;return(n=t.call(this,e.options)).vault=e,n}return n.prototype.addressFromBase=function(){var e=i()((function*(e){return this.vault.addressFromBase(e)}));return function(t){return e.apply(this,arguments)}}(),a()(n)}(n(1585).VaultContext),v=function(e){u()(n,e);var t=p(n);function n(){return t.apply(this,arguments)}return a()(n)}(h)},3905:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringSoftwareBase",(function(){return T}));var r=n(4),i=n.n(r),o=n(3),a=n.n(o),s=n(2),u=n.n(s),c=n(6),d=n.n(c),l=n(9),f=n.n(l),p=n(14),h=n.n(p),v=n(7),y=n.n(v),g=n(19),w=n(23);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var T=function(e){f()(n,e);var t=x(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=u()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new w.OneKeyInternalError("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return g.default.engine.info("signTransaction",this.networkId,e),b(b({},yield this.engine.providerManager.signTransaction(this.networkId,e,r)),{},{encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=u()((function*(e,t){var n=this,r=t.password;if("undefined"===typeof r)throw new w.OneKeyInternalError("Software signing requires a password.");var o=yield this.getDbAccount(),a=Object.values(yield this.getSigners(r,[o.address])),s=i()(a,1)[0];return g.default.engine.info("signMessage",this.networkId,e),Promise.all(e.map((function(e){return n.engine.providerManager.signMessage(n.networkId,e,s)})))}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},d()(n)}(n(3903).KeyringBase)},3912:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"VaultBaseChainOnly",(function(){return H})),n.d(t,"VaultBase",(function(){return R}));var r=n(202),i=n.n(r),o=n(3),a=n.n(o),s=n(60),u=n.n(s),c=n(2),d=n.n(c),l=n(6),f=n.n(l),p=n(9),h=n.n(p),v=n(14),y=n.n(v),g=n(7),w=n.n(g),m=n(21),b=n.n(m),x=n(167),T=n.n(x),I=n(11),P=n(19),A=n(24),O=n(68),E=n(23),k=n(182),B=n(947),S=n(52),C=n(1585);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var i=w()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y()(this,n)}}if(A.default.isExtensionUi)throw new Error("engine/VaultBase is not allowed imported from ui");var H=function(e){h()(n,e);var t=F(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.initProvider=function(){var e=d()((function*(){var e=(yield this.getNetwork()).impl;u()(B.IMPL_MAPPINGS[e])||(this.engineProvider=yield this.engine.providerManager.getProvider(this.networkId))}));return function(){return e.apply(this,arguments)}}(),r.proxyJsonRPCCall=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.createClientFromURL=function(e){throw new E.NotImplemented},r.getEthersProvider=function(){var e=d()((function*(){throw new E.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.getClientEndpointStatus=function(){var e=d()((function*(e){var t=this.createClientFromURL(e),n=performance.now(),r=(yield t.getInfo()).bestBlockNumber;return{responseTime:Math.floor(performance.now()-n),latestBlock:r}}));return function(t){return e.apply(this,arguments)}}(),r.checkRpcBatchSupport=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.getDisplayAddress=function(){var e=d()((function*(e){return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),r.validateAddress=function(){var e=d()((function*(e){var t=yield this.engineProvider.verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||!n)throw new E.InvalidAddress;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateImportedCredential=function(e){return Promise.resolve(this.settings.importedAccountEnabled&&/^(0x)?[0-9a-zA-Z]{64}$/.test(e))},r.validateWatchingCredential=function(){var e=d()((function*(e){return Promise.resolve(this.settings.watchingAccountEnabled&&(yield this.engineProvider.verifyAddress(e)).isValid)}));return function(t){return e.apply(this,arguments)}}(),r.validateTokenAddress=function(){var e=d()((function*(e){var t=yield this.engineProvider.verifyTokenAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new E.InvalidTokenAddress;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),r.validateCanCreateNextAccount=function(){var e=d()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.checkAccountExistence=function(){var e=d()((function*(e,t){return Promise.resolve(!0)}));return function(t,n){return e.apply(this,arguments)}}(),r.getBalances=function(){var e=d()((function*(e,t,n){return(yield this.engine.providerManager.getClient(this.networkId)).getBalances(e.map((function(e){var t=e.address,n=e.tokenAddress;return{address:t,coin:N({},"string"===typeof n?{tokenAddress:n}:{})}})))}));return function(t,n,r){return e.apply(this,arguments)}}(),r.getFrozenBalance=function(){var e=d()((function*(e){return 0}));return function(t){return e.apply(this,arguments)}}(),r.fetchBalanceDetails=function(){var e=d()((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.password;return Promise.resolve(void 0)}));return function(){return e.apply(this,arguments)}}(),r.getTransactionStatuses=function(e){return this.engine.providerManager.getTransactionStatuses(this.networkId,e)},r.getTransactionFeeInNative=function(e){return Promise.resolve("")},r.isContractAddress=function(){var e=d()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfoMap=function(){var e=d()((function*(){var e=yield this.getNetwork();return Object(k.getAccountNameInfoByImpl)(e.impl)}));return function(){return e.apply(this,arguments)}}(),r.canAutoCreateNextAccount=function(){var e=d()((function*(e){return Promise.resolve(!1)}));return function(t){return e.apply(this,arguments)}}(),r.filterAccounts=function(){var e=d()((function*(e){var t=e.accounts;e.networkId;return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),r.shouldChangeAccountWhenNetworkChanged=function(){var e=d()((function*(e){e.previousNetwork,e.newNetwork,e.activeAccountId;return Promise.resolve({shouldReloadAccountList:!1,shouldChangeActiveAccount:!1})}));return function(t){return e.apply(this,arguments)}}(),r.getAccountNameInfosByImportedOrWatchingCredential=function(){var e=d()((function*(e){return Promise.resolve([])}));return function(t){return e.apply(this,arguments)}}(),r.checkIsUnlimitedAllowance=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.checkIsApprovedForAll=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.checkIsBatchTransfer=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),r.getFeePricePerUnit=function(){var e=d()((function*(){throw new E.NotImplemented}));return function(){return e.apply(this,arguments)}}(),r.fetchRpcChainId=function(){var e=d()((function*(e){return null}));return function(t){return e.apply(this,arguments)}}(),r.getTxWaitingSeconds=function(){var e=d()((function*(){return[]}));return function(){return e.apply(this,arguments)}}(),r.getUserNFTAssets=function(){var e=d()((function*(e){e.serviceData;return Promise.resolve(void 0)}));return function(t){return e.apply(this,arguments)}}(),f()(n)}(C.VaultContext),R=function(t){h()(r,t);var n=F(r);function r(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).uuid=T.a.v4().toString(),e}var o=r.prototype;return o.init=function(){var e=d()((function*(e){yield this.initProvider(),yield this.initKeyring(e)}));return function(t){return e.apply(this,arguments)}}(),o.initKeyring=function(){var e=d()((function*(e){this.keyring=yield e.keyringCreator(this)}));return function(t){return e.apply(this,arguments)}}(),o.signTransaction=function(){var e=d()((function*(e,t){return this.keyring.signTransaction(e,t)}));return function(t,n){return e.apply(this,arguments)}}(),o.signAndSendTransaction=function(){var e=d()((function*(e,t,n){var r=yield this.signTransaction(e,t);return n?N(N({},r),{},{encodedTx:e.encodedTx}):this.broadcastTransaction(N(N({},r),{},{encodedTx:e.encodedTx}))}));return function(t,n,r){return e.apply(this,arguments)}}(),o.broadcastTransaction=function(){var e=d()((function*(e,t){P.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var n=yield this.engine.providerManager.broadcastTransaction(this.networkId,e.rawTx,t);return P.default.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),N(N({},e),{},{txid:n,encodedTx:e.encodedTx})}));return function(t,n){return e.apply(this,arguments)}}(),o.buildEncodedTxFromBatchTransfer=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.buildEncodedTxsFromSetApproveForAll=function(){var e=d()((function*(e,t){throw new E.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.activateAccount=function(){var e=d()((function*(){throw new E.NotImplemented}));return function(){return e.apply(this,arguments)}}(),o.activateToken=function(){var e=d()((function*(e,t){throw new E.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.getTokenAllowance=function(){var e=d()((function*(e,t){throw new E.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.batchTokensAllowance=function(){var e=d()((function*(e,t){throw new E.NotImplemented}));return function(t,n){return e.apply(this,arguments)}}(),o.getOutputAccount=function(){var e=d()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,template:e.template,pubKey:i()(e,"pub","")}}));return function(){return e.apply(this,arguments)}}(),o.getAccountBalance=function(){var e=d()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=yield this.getDbAccount(),o=i.address;return this.getBalances((t?[{address:o}]:[]).concat(e.map((function(e){return{address:o,tokenAddress:e}}))),n,r)}));return function(t){return e.apply(this,arguments)}}(),o.updatePendingTxs=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.getAccountNonce=function(){var e=d()((function*(){return Promise.resolve(null)}));return function(){return e.apply(this,arguments)}}(),o.fixActionDirection=function(){var e=d()((function*(e){var t,n,r,i,o=e.action,a=e.accountAddress;(o.direction=S.IDecodedTxDirection.OTHER,o.type===S.IDecodedTxActionType.NATIVE_TRANSFER)&&(o.direction=yield this.buildTxActionDirection({from:(null==(t=o.nativeTransfer)?void 0:t.from)||"",to:(null==(n=o.nativeTransfer)?void 0:n.to)||"",address:a}));o.type===S.IDecodedTxActionType.TOKEN_TRANSFER&&(o.direction=yield this.buildTxActionDirection({from:(null==(r=o.tokenTransfer)?void 0:r.from)||"",to:(null==(i=o.tokenTransfer)?void 0:i.to)||"",address:a}));return o}));return function(t){return e.apply(this,arguments)}}(),o.fixDecodedTx=function(){var e=d()((function*(e){var t,n;e.createdAt=null!=(t=e.createdAt)?t:Date.now();var r=null==(n=e.encodedTx)?void 0:n.nonce;e.nonce=u()(r)?e.nonce:new b.a(r).toNumber();for(var i=e.owner,o=0;o<e.actions.length;o+=1){var a=e.actions[o];yield this.fixActionDirection({action:a,accountAddress:i})}if(e.outputActions)for(var s=0;s<e.outputActions.length;s+=1){var c=e.outputActions[s];yield this.fixActionDirection({action:c,accountAddress:i})}return Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.fixHistoryTx=function(){var e=d()((function*(e){return e.decodedTx=yield this.fixDecodedTx(e.decodedTx),Promise.resolve(e)}));return function(t){return e.apply(this,arguments)}}(),o.buildHistoryTx=function(){var e=d()((function*(e){var t=e.historyTxToMerge,n=(e.encodedTx,e.decodedTx),r=e.signedTx,i=e.isSigner,o=e.isLocalCreated,a=(null==r?void 0:r.txid)||(null==n?void 0:n.txid)||"";if(!a)throw new Error("buildHistoryTx txid not found");var s=yield this.getAccountAddress();n.txid=a||n.txid,n.owner=s,i&&(n.signer=s),null!=r&&r.txKey&&(n.extraInfo?n.extraInfo.txKey=r.txKey:n.extraInfo={txKey:r.txKey});var u=N(N({id:this.networkId+"_"+a+"_"+this.accountId,isLocalCreated:Boolean(o)},t),{},{decodedTx:n});return u=yield this.fixHistoryTx(u),Promise.resolve(u)}));return function(t){return e.apply(this,arguments)}}(),o.checkIsScamHistoryTx=function(){var e=d()((function*(e){return!1}));return function(t){return e.apply(this,arguments)}}(),o.fetchOnChainHistory=function(){var e=d()((function*(e){throw new E.NotImplemented}));return function(t){return e.apply(this,arguments)}}(),o.fixAddressCase=function(e){return Promise.resolve(e)},o.buildTxActionDirection=function(){var e=d()((function*(e){var t=e.from,n=e.to,r=e.address;return t=yield this.fixAddressCase(t||""),n=yield this.fixAddressCase(n),r=yield this.fixAddressCase(r),t===n&&t===r?S.IDecodedTxDirection.SELF:t&&t===r?S.IDecodedTxDirection.OUT:n&&n===r?S.IDecodedTxDirection.IN:S.IDecodedTxDirection.OTHER}));return function(t){return e.apply(this,arguments)}}(),o.getNextNonce=function(){var e=d()((function*(e,t){var n,r,i=null!=(n=null==(r=(yield this.engine.providerManager.getAddresses(e,[t.address]))[0])?void 0:r.nonce)?n:0,o=(yield this.engine.getHistory(e,t.id,void 0,!1),yield O.default.history.getMaxPendingNonce({accountId:this.accountId,networkId:e})),a=yield O.default.history.getPendingNonceList({accountId:this.accountId,networkId:e}),s=Math.max(u()(o)?0:o+1,i);if(Number.isNaN(s)&&(s=i),s>i)for(var c=i;c<s;c+=1)if(!a.includes(c)){s=c;break}if(s<i&&(s=i),s-i>=I.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH)throw new E.PendingQueueTooLong(I.HISTORY_CONSTS.PENDING_QUEUE_MAX_LENGTH);return s}));return function(t,n){return e.apply(this,arguments)}}(),o.validateSendAmount=function(e,t,n){return Promise.resolve(!0)},o.notifyChainChanged=function(e,t){},o.getFetchBalanceAddress=function(e){return Promise.resolve(e.address)},o.getPrivateKeyByCredential=function(t){return Promise.resolve(e.from(t.startsWith("0x")?t.slice(2):t,"hex"))},o.getMinDepositAmount=function(){var e=d()((function*(){return"0"}));return function(){return e.apply(this,arguments)}}(),o.specialCheckEncodedTx=function(){var e=d()((function*(e){return{success:!0}}));return function(t){return e.apply(this,arguments)}}(),o.getAllUsedAddress=function(){var e=d()((function*(){return Promise.resolve([])}));return function(){return e.apply(this,arguments)}}(),f()(r)}(H)}.call(this,n(26).Buffer)},3913:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"KeyringHardwareBase",(function(){return y}));var r=n(2),i=n.n(r),o=n(6),a=n.n(o),s=n(9),u=n.n(s),c=n(14),d=n.n(c),l=n(7),f=n.n(l),p=n(431),h=n(163);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var y=function(t){u()(r,t);var n=v(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.getHardwareInfo=function(){var e=i()((function*(){var e,t,n,r=yield this.engine.getHWDeviceByWalletId(this.vault.walletId);return{connectId:null!=(e=null==r?void 0:r.mac)?e:"",deviceId:null!=(t=null==r?void 0:r.deviceId)?t:"",deviceType:null!=(n=null==r?void 0:r.deviceType)?n:""}}));return function(){return e.apply(this,arguments)}}(),o.getWalletPassphraseState=function(){var e=i()((function*(){var e=yield this.engine.getWallet(this.vault.walletId);return{passphraseState:null==e?void 0:e.passphraseState,useEmptyPassphrase:!Object(h.isPassphraseWallet)(e)}}));return function(){return e.apply(this,arguments)}}(),o.getHardwareSDKInstance=function(){var t=i()((function*(){var t,n,r,i,o;return null!=(o=yield null==(t=e)||null==(n=t.$backgroundApiProxy)||null==(r=n.backgroundApi)||null==(i=r.serviceHardware)||null==i.getSDKInstance?void 0:i.getSDKInstance())?o:p.HardwareSDK}));return function(){return t.apply(this,arguments)}}(),o.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},a()(r)}(n(3903).KeyringBase)}.call(this,n(58))},3914:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringHdBase",(function(){return b}));var r=n(3),i=n.n(r),o=n(2),a=n.n(o),s=n(6),u=n.n(s),c=n(9),d=n.n(c),l=n(14),f=n.n(l),p=n(7),h=n.n(p),v=n(610),y=n(23);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var i=h()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f()(this,n)}}var b=function(e){d()(n,e);var t=m(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=a()((function*(e,t){var n=(yield this.getDbAccount()).path.split("/"),r=t||[n.pop()],i=n.join("/"),o=(yield this.engine.dbApi.getCredential(this.walletId,e)).seed;if("undefined"===typeof o)throw new y.OneKeyInternalError("Unable to get credential.");var a=(yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId)).curve;return Object(v.batchGetPrivateKeys)(a,o,e,i,r).reduce((function(e,t){var n;return w(w({},e),{},((n={})[t.path]=t.extendedKey.key,n))}),{})}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(e){throw new Error("Method not implemented.")},u()(n)}(n(3905).KeyringSoftwareBase)},3915:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringImportedBase",(function(){return v}));var r=n(2),i=n.n(r),o=n(6),a=n.n(o),s=n(9),u=n.n(s),c=n(14),d=n.n(c),l=n(7),f=n.n(l),p=n(23);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var v=function(e){u()(n,e);var t=h(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.getPrivateKeys=function(){var e=i()((function*(e,t){if("undefined"!==typeof t)throw new p.NotImplemented("Getting private keys from extended private key");var n=(yield this.engine.dbApi.getCredential(this.accountId,e)).privateKey;if("undefined"===typeof n)throw new p.OneKeyInternalError("Unable to get credential.");return{"":n}}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(n)}(n(3905).KeyringSoftwareBase)},3916:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringWatchingBase",(function(){return v}));var r=n(2),i=n.n(r),o=n(6),a=n.n(o),s=n(9),u=n.n(s),c=n(14),d=n.n(c),l=n(7),f=n.n(l),p=n(23);function h(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var v=function(e){u()(n,e);var t=h(n);function n(){return t.apply(this,arguments)}var r=n.prototype;return r.signTransaction=function(){var e=i()((function*(e,t){throw new p.OneKeyInternalError("signTransaction is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.signMessage=function(){var e=i()((function*(e,t){throw new p.OneKeyInternalError("signMessage is not supported for watching accounts")}));return function(t,n){return e.apply(this,arguments)}}(),r.getAddress=function(){throw new Error("Method not implemented.")},r.batchGetAddress=function(){throw new Error("Method not implemented.")},r.prepareAccountByAddressIndex=function(){throw new Error("Method not implemented.")},a()(n)}(n(3903).KeyringBase)},3918:function(e,t,n){"use strict";n.r(t),n.d(t,"convertDeviceError",(function(){return s}));var r=n(70),i=n(90),o=n(19);n(24);function a(e,t){return"string"!==typeof t?null:e===r.HardwareErrorCode.DeviceInitializeFailed&&t.includes("ECONNABORTED")?new i.ConnectTimeoutError({message:t}):t.includes("Bridge network error")?new i.BridgeNetworkError({message:t}):null}function s(e){var t,n=e||{},s=n.code,u=n.error,c=n.message,d=null!=(t=null!=u?u:c)?t:"Unknown error";if(a(s,d))return a(s,d);switch(o.default.hardwareSDK.info("Device Utils Convert Device Error:",s,d),s){case r.HardwareErrorCode.UnknownError:return new i.UnknownHardwareError(e);case r.HardwareErrorCode.DeviceFwException:return new i.FirmwareVersionTooLow(e);case r.HardwareErrorCode.DeviceUnexpectedMode:return"string"===typeof d&&-1!==d.indexOf("ui-device_bootloader_mode")?new i.NotInBootLoaderMode(e):new i.UnknownHardwareError(e);case r.HardwareErrorCode.DeviceCheckDeviceIdError:return new i.DeviceNotSame(e);case r.HardwareErrorCode.DeviceNotFound:return new i.DeviceNotFind(e);case r.HardwareErrorCode.DeviceUnexpectedBootloaderMode:return new i.NotInBootLoaderMode(e);case r.HardwareErrorCode.DeviceInterruptedFromOutside:case r.HardwareErrorCode.DeviceInterruptedFromUser:return new i.UserCancelFromOutside(e);case r.HardwareErrorCode.DeviceNotSupportPassphrase:return new i.NotSupportPassphraseError(e);case r.HardwareErrorCode.IFrameLoadFail:return new i.InitIframeLoadFail(e);case r.HardwareErrorCode.IframeTimeout:return new i.InitIframeTimeout(e);case r.HardwareErrorCode.FirmwareUpdateDownloadFailed:return new i.FirmwareDownloadFailed(e);case r.HardwareErrorCode.FirmwareUpdateManuallyEnterBoot:return new i.FirmwareUpdateManuallyEnterBoot(e);case r.HardwareErrorCode.FirmwareUpdateAutoEnterBootFailure:return new i.FirmwareUpdateAutoEnterBootFailure(e);case r.HardwareErrorCode.FirmwareUpdateLimitOneDevice:return new i.FirmwareUpdateLimitOneDevice(e);case r.HardwareErrorCode.CallMethodNeedUpgradeFirmware:return new i.FirmwareVersionTooLow(e);case r.HardwareErrorCode.NewFirmwareUnRelease:return new i.NewFirmwareUnRelease(e);case r.HardwareErrorCode.NewFirmwareForceUpdate:return new i.NewFirmwareForceUpdate(e);case r.HardwareErrorCode.NetworkError:return new i.NetworkError(e);case r.HardwareErrorCode.BlePermissionError:return new i.NeedBluetoothTurnedOn(e);case r.HardwareErrorCode.BleLocationError:return new i.NeedBluetoothPermissions({message:d});case r.HardwareErrorCode.BleLocationServicesDisabled:return new i.BleLocationServiceError({message:d});case r.HardwareErrorCode.BleDeviceNotBonded:return new i.DeviceNotBonded(e);case r.HardwareErrorCode.BleDeviceBondError:return new i.DeviceBondError(e);case r.HardwareErrorCode.BleWriteCharacteristicError:return new i.BleWriteCharacteristicError(e);case r.HardwareErrorCode.BleScanError:return new i.BleScanError({message:d});case r.HardwareErrorCode.BleAlreadyConnected:return new i.BleAlreadyConnectedError(e);case r.HardwareErrorCode.RuntimeError:return-1!==d.indexOf("EIP712 blind sign is disabled")?new i.OpenBlindSign(e):-1!==d.indexOf("Unknown message")||-1!==d.indexOf("Failure_UnexpectedMessage")?new i.UnknownMethod(e):new i.UnknownHardwareError(e);case r.HardwareErrorCode.PinInvalid:return new i.InvalidPIN(e);case r.HardwareErrorCode.DeviceCheckPassphraseStateError:return new i.InvalidPassphrase(e);case r.HardwareErrorCode.DeviceOpenedPassphrase:return new i.DeviceOpenedPassphrase(e);case r.HardwareErrorCode.DeviceNotOpenedPassphrase:return new i.DeviceNotOpenedPassphrase(e);case r.HardwareErrorCode.PinCancelled:case r.HardwareErrorCode.ActionCancelled:return new i.UserCancel(e);case r.HardwareErrorCode.BridgeNotInstalled:case i.CustomOneKeyHardwareError.NeedOneKeyBridge:return new i.NeedOneKeyBridge(e);case r.HardwareErrorCode.BridgeNetworkError:return new i.BridgeNetworkError(e);case r.HardwareErrorCode.BridgeTimeoutError:return new i.BridgeTimeoutError(e);case r.HardwareErrorCode.PollingTimeout:return new i.ConnectTimeoutError(e);case r.HardwareErrorCode.PollingStop:return new i.ConnectPollingStopError(e);case r.HardwareErrorCode.BlindSignDisabled:return new i.OpenBlindSign(e);case r.HardwareErrorCode.FileAlreadyExists:return new i.FileAlreadyExistError(e);case r.HardwareErrorCode.CheckDownloadFileError:return new i.IncompleteFileError(e);case r.HardwareErrorCode.NotInSigningMode:return new i.NotInSigningModeError(e);default:return new i.UnknownHardwareError(e)}}},4044:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return $}));var r=n(3),i=n.n(r),o=n(15),a=n.n(o),s=n(60),u=n.n(s),c=n(13),d=n.n(c),l=n(4),f=n.n(l),p=n(340),h=n.n(p),v=n(2),y=n.n(v),g=n(6),w=n.n(g),m=n(9),b=n.n(m),x=n(14),T=n.n(x),I=n(7),P=n.n(I),A=n(21),O=n.n(A),E=n(1346),k=n.n(E),B=n(68),S=n(112),C=n(185),D=n(11),N=n(19),F=n(150),H=n(311),R=n(23),j=n(317),K=n(182),U=n(391),M=n(1069),V=n(312),_=n(120),W=n(52),L=n(3912),X=n(196),z=n(4045),G=n(956),q=n(668),Y=["txId","value"];function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=P()(e);if(t){var i=P()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return T()(this,n)}}var $=function(t){b()(r,t);var n=Z(r);function r(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).keyringMap={},e.settings={},e.providerClass=z.Provider,e.collectUTXOsInfo=Object(F.memoizee)(y()((function*(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=yield e.getProvider(),r=yield e.getDbAccount();try{var i=yield n.getUTXOs(e.getAccountXpub(r),t);if("ERROR"===i.ordQueryStatus&&h()(n.getUTXOs.clear))try{n.getUTXOs.clear()}catch(o){}return i}catch(a){throw new R.OneKeyInternalError("Failed to get UTXOs of the account.")}})),{promise:!0,max:4,maxAge:3e4}),e.getFeeRate=Object(F.memoizee)(y()((function*(){var t=yield(yield e.getProvider()).blockbook,n=e.getDefaultBlockNums();try{var r=yield Promise.all(n.map((function(e){return t.estimateFee(e).then((function(e){return new O.a(e).toFixed(0)}))}))),i=r.findIndex((function(e){return new O.a(e).lt(0)}));if(i>=0){for(var o=i;o<r.length-1&&new O.a(r[o]).lt(0);)o+=1;for(;o>0&&new O.a(r[o]).lt(0);)o-=1;r.splice(i,1,r[o])}return r.sort((function(e,t){return new O.a(e).comparedTo(new O.a(t))}))}catch(a){throw new R.OneKeyInternalError("Failed to get fee rates.")}})),{promise:!0,max:1,maxAge:3e4}),e}var i=r.prototype;return i.getDefaultPurpose=function(){return Object(j.getDefaultPurpose)(D.IMPL_BTC)},i.getCoinName=function(){return"BTC"},i.getCoinType=function(){return D.COINTYPE_BTC},i.getXprvReg=function(){return/^[xyz]prv/},i.getXpubReg=function(){return/^[xyz]pub/},i.getDefaultBlockNums=function(){return[5,2,1]},i.getDefaultBlockTime=function(){return 600},i.getAccountXpub=function(e){return e.xpub},i.getProvider=function(){var e=y()((function*(){var e,t,n=yield this.getRpcUrl(),r="";null!=(e=this.provider)&&e.chainInfo&&(r=Object(G.getRpcUrlFromChainInfo)(null==(t=this.provider)?void 0:t.chainInfo));if(!this.provider||r!==n){var i=yield this.engine.providerManager.getChainInfoByNetworkId(this.networkId),o=this.providerClass;this.provider=new o(i)}return this.provider}));return function(){return e.apply(this,arguments)}}(),i.getOutputAccount=function(){var e=y()((function*(){var e=yield this.getDbAccount({noCache:!0});return{id:e.id,name:e.name,type:e.type,path:e.path,coinType:e.coinType,tokens:[],address:e.address,xpub:this.getAccountXpub(e),template:e.template,customAddresses:JSON.stringify(e.customAddresses)}}));return function(){return e.apply(this,arguments)}}(),i.getFetchBalanceAddress=function(e){return Promise.resolve(this.getAccountXpub(e))},i.validateAddress=function(){var e=y()((function*(e){var t=(yield this.getProvider()).verifyAddress(e),n=t.normalizedAddress;if(!t.isValid||"undefined"===typeof n)throw new R.InvalidAddress;return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),i.validateImportedCredential=function(){var e=y()((function*(e){var t=this.getXprvReg(),n=!1;try{n=this.settings.importedAccountEnabled&&t.test(e)&&(yield this.getProvider()).isValidXprv(e)}catch(r){}return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),i.validateWatchingCredential=function(){var e=y()((function*(e){var t=this.getXpubReg(),n=!1;try{n=this.settings.watchingAccountEnabled&&t.test(e)&&(yield this.getProvider()).isValidXpub(e)}catch(r){}return Promise.resolve(n)}));return function(t){return e.apply(this,arguments)}}(),i.validateCanCreateNextAccount=function(){var e=y()((function*(e,t){var n=yield Promise.all([this.engine.getWallet(e),this.engine.getNetwork(this.networkId)]),r=f()(n,2),i=r[0],o=r[1],a=Object(j.getLastAccountId)(i,o.impl,t);if(!a)return!0;var s=yield this.engine.dbApi.getAccounts([a]),u=f()(s,1)[0];if("undefined"!==typeof u&&!(yield this.checkAccountExistence(this.getAccountXpub(u)))){var c=Object(K.getAccountNameInfoByTemplate)(o.impl,t).label;throw new R.PreviousAccountIsEmpty(c)}return!0}));return function(t,n){return e.apply(this,arguments)}}(),i.checkAccountExistence=function(){var e=y()((function*(e,t){var n=!1,r=0;try{var i=yield this.getProvider();if(t)r=(yield i.getAccountWithAddress({type:"simple",address:e})).txs;else r=(yield i.getAccount({type:"simple",xpub:e})).txs;n=r>0}catch(o){}return Promise.resolve(n)}));return function(t,n){return e.apply(this,arguments)}}(),i.getAccountBalance=function(){var e=y()((function*(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.map((function(e){}));if(!t)return n;var r=yield this.getDbAccount(),i=this.getAccountXpub(r);if(!i)return[new O.a("0")].concat(d()(n));var o=yield this.getBalances([{address:i}]),a=f()(o,1),s=a[0];return[s].concat(n)}));return function(t){return e.apply(this,arguments)}}(),i.getBalances=function(){var e=y()((function*(e){return(yield this.getProvider()).getBalances(e)}));return function(t){return e.apply(this,arguments)}}(),i.getBalancesByAddress=function(){var e=y()((function*(e){return(yield this.getProvider()).getBalancesByAddress(e)}));return function(t){return e.apply(this,arguments)}}(),i.getExportedCredential=function(){var t=y()((function*(t){var n=yield this.getDbAccount();if(n.id.startsWith("hd-")){var r=parseInt(n.path.split("/")[1]),i=Object(q.getAccountDefaultByPurpose)(r,this.getCoinName()).addressEncoding,o=(yield this.getProvider()).network,a=((o.segwitVersionBytes||{})[i]||o.bip32).private,s=this.keyring,u=Object.values(yield s.getPrivateKeys(t)),c=f()(u,1)[0];return k.a.encode(k.a.decode(n.xpub).fill(e.from(a.toString(16).padStart(8,"0"),"hex"),0,4).fill(e.concat([e.from([0]),Object(S.decrypt)(t,c)]),45,78))}if(n.id.startsWith("imported-")){var d=(yield this.engine.dbApi.getCredential(this.accountId,t)).privateKey;if("undefined"===typeof d)throw new R.OneKeyInternalError("Unable to get credential.");return k.a.encode(Object(S.decrypt)(t,d))}throw new R.OneKeyInternalError("Only credential of HD or imported accounts can be exported")}));return function(e){return t.apply(this,arguments)}}(),i.attachFeeInfoToEncodedTx=function(){var e=y()((function*(e){var t=yield this.engine.getNetwork(this.networkId),n=e.encodedTx,r=e.feeInfoValue,i=r.feeRate?new O.a(r.feeRate).shiftedBy(-t.feeDecimals).toFixed():r.price;return"string"===typeof i?n.transferInfos?this.buildEncodedTxFromBatchTransfer({transferInfos:n.transferInfos,specifiedFeeRate:i}):this.buildEncodedTxFromTransfer(n.transferInfo,i):Promise.resolve(e.encodedTx)}));return function(t){return e.apply(this,arguments)}}(),i.decodedTxToLegacy=function(e){var t=e.actions[0],n=t.type,r=t.nativeTransfer;t.inscriptionInfo;return n===W.IDecodedTxActionType.NATIVE_TRANSFER&&r?Promise.resolve({txType:_.EVMDecodedTxType.NATIVE_TRANSFER,symbol:"UNKNOWN",amount:r.amount,value:r.amountValue,fromAddress:r.from,toAddress:r.to,data:"",totalFeeInNative:e.totalFeeInNative,total:O.a.sum.apply(null,(r.utxoFrom||[]).map((function(e){return e.balanceValue}))).toFixed()}):Promise.resolve({})},i.decodeTx=function(){var e=y()((function*(e,t){var n=e.inputs,r=e.outputs,i=e.transferInfo,o=yield this.engine.getNetwork(this.networkId),a=yield this.getDbAccount(),s=yield this.engine.getNativeTokenInfo(this.networkId),u=null;null!=t&&t.nftInfo&&(u=null==t?void 0:t.nftInfo);var c,d,l=i.isNFT?n.find((function(e){return Boolean(e.forceSelect)})):void 0,f=n.map((function(e){return{address:e.address,balance:new O.a(e.value).shiftedBy(-o.decimals).toFixed(),balanceValue:e.value,symbol:o.symbol,isMine:!0}})),p=r.filter((function(e){var t;return!(null!=(t=e.payload)&&t.isCharge)})).map((function(e){return{address:e.address,balance:new O.a(e.value).shiftedBy(-o.decimals).toFixed(),balanceValue:e.value,symbol:o.symbol,isMine:e.address===a.address}})),h=[];l&&u?h=[{type:W.IDecodedTxActionType.NFT_TRANSFER_BTC,direction:W.IDecodedTxDirection.OUT,inscriptionInfo:{send:u.from,receive:null==(c=u)?void 0:c.to,asset:null==(d=u)?void 0:d.asset,extraInfo:null}}]:h=p.map((function(e){return{type:W.IDecodedTxActionType.NATIVE_TRANSFER,direction:r[0].address===a.address?W.IDecodedTxDirection.OUT:W.IDecodedTxDirection.SELF,utxoFrom:f,utxoTo:p,nativeTransfer:{tokenInfo:s,from:a.address,to:e.address,amount:e.balance,amountValue:e.balanceValue,extraInfo:null}}}));return{txid:"",owner:a.address,signer:a.address,nonce:0,actions:h,status:W.IDecodedTxStatus.Pending,networkId:this.networkId,accountId:this.accountId,extraInfo:null,totalFeeInNative:e.totalFeeInNative}}));return function(t,n){return e.apply(this,arguments)}}(),i.buildEncodedTxFromTransfer=function(){var e=y()((function*(e,t){if(!e.to)throw new Error("Invalid transferInfo.to params");return this.buildEncodedTxFromBatchTransfer({transferInfos:[e],specifiedFeeRate:t})}));return function(t,n){return e.apply(this,arguments)}}(),i.buildEncodedTxFromBatchTransfer=function(){var e=y()((function*(e){var t=e.transferInfos,n=e.specifiedFeeRate,r=t[0],i=yield this.engine.getNetwork(this.networkId),o=yield this.getDbAccount(),s=yield this.buildTransferParamsWithCoinSelector({transferInfos:t,specifiedFeeRate:n}),c=s.inputs,d=s.outputs,l=s.fee,f=s.inputsForCoinSelect,p=s.outputsForCoinSelect,h=s.feeRate;if(!c||!d||u()(l))throw new R.InsufficientBalance("Failed to select UTXOs");var v=l.toString(),y=new O.a(v).shiftedBy(-1*i.feeDecimals).toFixed();return{inputs:c.map((function(e){var t=e.txId,n=e.value;return J(J({address:"",path:""},a()(e,Y)),{},{txid:t,value:n.toString()})})),outputs:d.map((function(e){var t=e.value,n=e.address,r=n||o.address;if(!r)throw new Error("buildEncodedTxFromBatchTransfer ERROR: Invalid change address");var i=null==t?void 0:t.toString();if(!i||new O.a(i).lte(0))throw new Error("buildEncodedTxFromBatchTransfer ERROR: Invalid value");return{address:r,value:i,payload:n?void 0:{isCharge:!0,bip44Path:Object(q.getBIP44Path)(o,o.address)}}})),totalFee:v,totalFeeInNative:y,transferInfo:r,transferInfos:t,feeRate:h,inputsForCoinSelect:f,outputsForCoinSelect:p}}));return function(t){return e.apply(this,arguments)}}(),i.buildEncodedTxFromApprove=function(e){throw new R.NotImplemented},i.updateEncodedTxTokenApprove=function(e,t){throw new R.NotImplemented},i.updateEncodedTx=function(){var e=y()((function*(e,t,n){if(n.type===W.IEncodedTxUpdateType.advancedSettings&&Array.isArray(t.selectedUtxos)&&t.selectedUtxos.length){var r=yield this.engine.getNetwork(this.networkId);return this.buildEncodedTxFromTransfer(J(J({},e.transferInfo),{},{selectedUtxos:t.selectedUtxos}),new O.a(e.feeRate).shiftedBy(-r.feeDecimals).toFixed())}return Promise.resolve(e)}));return function(t,n,r){return e.apply(this,arguments)}}(),i.buildUnsignedTxFromEncodedTx=function(e){var t=e.inputs,n=e.outputs,r=[];for(var i of t){var o=new O.a(i.value);r.push({address:i.address,value:o,utxo:{txid:i.txid,vout:i.vout,value:o}})}var a={inputs:r,outputs:n.map((function(e){var t=e.address,n=e.value,r=e.payload;return{address:t,value:new O.a(n),payload:r}})),payload:{},encodedTx:e};return Promise.resolve(a)},i.fetchFeeInfo=function(){var e=y()((function*(e,t,n){var r=yield this.engine.getNetwork(this.networkId),i=yield this.getProvider(),o=(yield i.buildUnsignedTx(J(J({},yield this.buildUnsignedTxFromEncodedTx(e)),{},{feePricePerUnit:new O.a(1),encodedTx:e}))).feeLimit,a=(n?[n]:yield this.getFeeRate()).map((function(e){return new O.a(e).shiftedBy(-r.feeDecimals).toFixed()})),s=a.map((function(t){return Object(q.coinSelect)({inputsForCoinSelect:e.inputsForCoinSelect,outputsForCoinSelect:e.outputsForCoinSelect,feeRate:new O.a(t).shiftedBy(r.feeDecimals).toFixed()}).fee})).filter(Boolean);return{isBtcForkChain:!0,limit:(null!=o?o:new O.a(0)).toFixed(),prices:a,feeList:s,waitingSeconds:yield this.getTxWaitingSeconds(),defaultPresetIndex:"1",feeSymbol:"BTC",feeDecimals:r.feeDecimals,nativeSymbol:r.symbol,nativeDecimals:r.decimals,tx:null}}));return function(t,n,r){return e.apply(this,arguments)}}(),i.getTxWaitingSeconds=function(){var e=y()((function*(){var e=this;return this.getDefaultBlockNums().map((function(t){return t*e.getDefaultBlockTime()}))}));return function(){return e.apply(this,arguments)}}(),i.getFeePricePerUnit=function(){var e=y()((function*(){var e=(yield this.getFeeRate()).map((function(e){return new O.a(e)}));return{normal:{price:e[1]},others:[{price:e[0]},{price:e[2]}]}}));return function(){return e.apply(this,arguments)}}(),i.broadcastTransaction=function(){var e=y()((function*(e){N.default.engine.info("broadcastTransaction START:",{rawTx:e.rawTx});var t=yield this.getProvider(),n=yield t.broadcastTransaction(e.rawTx);return N.default.engine.info("broadcastTransaction END:",{txid:n,rawTx:e.rawTx}),J(J({},e),{},{txid:n})}));return function(t){return e.apply(this,arguments)}}(),i.getTransactionStatuses=function(){var e=y()((function*(e){return(yield this.getProvider()).getTransactionStatuses(e)}));return function(t){return e.apply(this,arguments)}}(),i.buildActionsFromBTCTransaction=function(e){var t=e.transaction,n=e.address,r=W.IDecodedTxActionType.UNKNOWN,i=t.send,o=t.receive,a=t.event_type,s=t.asset;if(!s)return[];var u={send:i,receive:o,asset:s,extraInfo:null};return"Transfer"===a?r=W.IDecodedTxActionType.NFT_TRANSFER_BTC:"Mint"===a&&(r=W.IDecodedTxActionType.NFT_INSCRIPTION),[{type:r,hidden:!(i===n||o===n),direction:W.IDecodedTxDirection.IN,extraInfo:null,inscriptionInfo:u}]},i.mergeNFTTransaction=function(e){var t=this,n=e.nftTxs,r=e.nativeActions,i=e.address,o=null==n?void 0:n.map((function(e){return t.buildActionsFromBTCTransaction({transaction:e,address:i})})).flat().filter(Boolean);return(null==o?void 0:o.length)>0?o:r},i.fetchOnChainHistory=function(){var e=y()((function*(e){var t=this,n=e.localHistory,r=void 0===n?[]:n,i=(e.tokenIdOnNetwork,yield this.getProvider()),o=yield this.getDbAccount(),a=yield this.engine.getNetwork(this.networkId),s=a.decimals,u=a.symbol,c=a.impl,d=yield this.engine.getNativeTokenInfo(this.networkId),l=[];try{var f;l=null!=(f=(yield i.getHistory({type:"history",xpub:this.getAccountXpub(o)},c,o.address,u,s)).transactions)?f:[]}catch(v){}var p={};try{p=yield Object(U.getNFTTransactionHistory)(o.address,this.networkId)}catch(v){}var h=l.map((function(e){try{var n,i,a=r.find((function(t){return t.decodedTx.txid===e.txid}));if(a&&a.decodedTx.isFinal)return null;var u=e.direction,c=e.utxoFrom,l=e.utxoTo,f=e.from,h=e.to,y=e.amount,g=e.amountValue,w=null==l?void 0:l.filter((function(e){return!e.isMine})),m=w&&w.length?w.filter((function(e){return!e.isMine})).map((function(e){return{type:W.IDecodedTxActionType.NATIVE_TRANSFER,direction:u,nativeTransfer:{tokenInfo:d,utxoFrom:c,utxoTo:l,from:f,to:e.address,amount:e.balance,amountValue:e.balanceValue,extraInfo:null}}})):[{type:W.IDecodedTxActionType.NATIVE_TRANSFER,direction:u,nativeTransfer:{tokenInfo:d,utxoFrom:c,utxoTo:l,from:f,to:h,amount:y,amountValue:g,extraInfo:null}}],b=p[e.txid],x=t.mergeNFTTransaction({nftTxs:b,nativeActions:m,address:o.address}),T={txid:e.txid,owner:o.address,signer:o.address,nonce:0,actions:x,status:(null!=(n=e.confirmations)?n:0)>0?W.IDecodedTxStatus.Confirmed:W.IDecodedTxStatus.Pending,networkId:t.networkId,accountId:t.accountId,extraInfo:null,totalFeeInNative:new O.a(e.fees).shiftedBy(-s).toFixed()};return T.updatedAt="undefined"!==typeof e.blockTime?1e3*e.blockTime:Date.now(),T.createdAt=null!=(i=null==a?void 0:a.decodedTx.createdAt)?i:T.updatedAt,T.isFinal=T.status===W.IDecodedTxStatus.Confirmed,t.buildHistoryTx({decodedTx:T,historyTxToMerge:a})}catch(v){return Promise.resolve(null)}}));return(yield Promise.all(h)).filter(Boolean)}));return function(t){return e.apply(this,arguments)}}(),i.fixActionDirection=function(){var e=y()((function*(e){var t,n,r=e.action,i=e.accountAddress;r.type!==W.IDecodedTxActionType.NATIVE_TRANSFER||r.direction||(r.direction=yield this.buildTxActionDirection({from:(null==(t=r.nativeTransfer)?void 0:t.from)||"",to:(null==(n=r.nativeTransfer)?void 0:n.to)||"",address:i}));return r}));return function(t){return e.apply(this,arguments)}}(),i.createClientFromURL=function(e){return new G.BlockBook(e)},i.fetchTokenInfos=function(e){throw new R.NotImplemented},i.getPrivateKeyByCredential=function(){var e=y()((function*(e){var t=k.a.decode(e);return Promise.resolve(t)}));return function(t){return e.apply(this,arguments)}}(),i.getAllUsedAddress=function(){var e=y()((function*(){var e=yield this.getDbAccount(),t=this.getAccountXpub(e);if(!t)return[];var n=yield this.getProvider(),r=(yield n.getAccount({type:"usedAddress",xpub:t})).tokens;return(void 0===r?[]:r).filter((function(e){var t=e.path.split("/"),n=Number.isSafeInteger(+t[4])&&1===+t[4];return e.transfers>0&&!n})).map((function(e){return J(J({},e),{},{displayTotalReceived:new O.a(e.totalReceived).shiftedBy(-8).toFixed()})}))}));return function(){return e.apply(this,arguments)}}(),i.getAccountInfo=function(){var e=y()((function*(e){var t=e.details,n=void 0===t?"txs":t,r=e.from,i=e.to,o=e.pageSize,a=yield this.getDbAccount(),s=this.getAccountXpub(a);return s?(yield this.getProvider()).getAccount({type:"accountInfo",xpub:s,details:n,from:r,to:i,pageSize:o}):[]}));return function(t){return e.apply(this,arguments)}}(),i.getFrozenUtxos=function(){var e=y()((function*(e,t){var n,r=this,i=[];if(!(null==(n=Object(C.appSelector)((function(e){var t;return null==(t=e.settings.advancedSettings)?void 0:t.useDustUtxo})))||n)){var o,a=yield this.getNetwork(),s=new O.a((null!=(o=this.settings.dust)?o:this.settings.minTransferAmount)||0).shiftedBy(a.decimals);i=t.filter((function(e){return new O.a(e.value).isLessThanOrEqualTo(s)})).map((function(e){return J(J({},e),{},{id:Object(H.getUtxoId)(r.networkId,e),key:Object(H.getUtxoUniqueKey)(e)})}))}return(yield B.default.utxoAccounts.getCoinControlList(this.networkId,e)).filter((function(e){return e.frozen})).concat(i)}));return function(t,n){return e.apply(this,arguments)}}(),i.buildTransferParamsWithCoinSelector=function(){var e=y()((function*(e){var t=this,n=e.transferInfos,r=e.specifiedFeeRate;if(!n.length)throw new Error("buildTransferParamsWithCoinSelector ERROR: transferInfos is required");var i=n.length>1,o=Boolean(n.find((function(e){return e.isNFT||e.nftInscription}))),a=[];if(o){if(i)throw new Error("BTC nft transfer is not supported in batch transfer");var s=n[0].nftInscription;if(!s)throw new Error("nftInscription is required for nft transfer");var u=s.output,c=s.address,l=u.split(":"),p=f()(l,2),h=p[0],v=p[1];if(!h||!v||!c)throw new Error("invalid nftInscription output");var y=parseInt(v,10);if(Number.isNaN(y))throw new Error("invalid nftInscription output: vout");a.push({txId:h,vout:y,address:c})}var g=yield this.engine.getNetwork(this.networkId),w=yield this.getDbAccount(),m=(yield this.collectUTXOsInfo(a.length?{forceSelectUtxos:a}:void 0)).utxos,b="undefined"!==typeof r?new O.a(r).shiftedBy(g.feeDecimals).toFixed():(yield this.getFeeRate())[1],x=yield this.getFrozenUtxos(w.xpub,m),T=m.filter((function(e){return x.findIndex((function(n){return n.id===Object(H.getUtxoId)(t.networkId,e)}))<0}));m=T;var I=n.reduce((function(e,t){return Array.isArray(t.selectedUtxos)&&t.selectedUtxos.length&&e.push.apply(e,d()(t.selectedUtxos)),e}),[]);Array.isArray(I)&&I.length&&(m=m.filter((function(e){return(null!=I?I:[]).includes(Object(H.getUtxoUniqueKey)(e))})));var P=m.map((function(e){var t=e.txid,n=e.vout,r=e.value,i=e.address,o=e.path;return{txId:t,vout:n,value:parseInt(r),address:i,path:o}})),A=[];if(i)A=n.map((function(e){var t=e.to,n=e.amount;if(o)throw new Error("NFT Inscription transfer can only be single transfer");return{address:t,value:parseInt(new O.a(n).shiftedBy(g.decimals).toFixed())}}));else{var E=n[0],k=E.to,B=E.amount,S=T.reduce((function(e,t){var n=t.value;return e.plus(n)}),new O.a("0")).shiftedBy(-g.decimals);if(S.lt(B))throw new R.InsufficientBalance;var C=S.lte(B),D=parseInt(new O.a(B).shiftedBy(g.decimals).toFixed());if(o){var N;E.coinControlDisabled=!0,C=!1,D=V.INSCRIPTION_PADDING_SATS_VALUES.default;var F=function*(e){if(a.find((function(t){return t.address===e.address&&t.txId===e.txId&&t.vout===e.vout})))return e.forceSelect=!0,N=e,"break"};for(var j of P){if("break"===(yield*F(j)))break}if(!N)throw new R.UtxoNotFoundError}A=[C?{address:k,isMax:!0}:{address:k,value:D}]}var K=i?void 0:n[0].coinSelectAlgorithm;if(!i&&A.length>1)throw new Error("single transfer should only have one output");var U=o?Object(q.coinSelectForOrdinal)({inputsForCoinSelect:P,outputsForCoinSelect:A,feeRate:b}):Object(q.coinSelect)({inputsForCoinSelect:P,outputsForCoinSelect:A,feeRate:b,algorithm:K});return{inputs:U.inputs,outputs:U.outputs,fee:U.fee,inputsForCoinSelect:P,outputsForCoinSelect:A,feeRate:b}}));return function(t){return e.apply(this,arguments)}}(),i.getFrozenBalance=function(){var e=y()((function*(){var e=yield this.fetchBalanceDetails();if(e&&!u()(null==e?void 0:e.unavailable))return new O.a(e.unavailable).toNumber();throw new Error("getFrozenBalance ERROR")}));return function(){return e.apply(this,arguments)}}(),i.fetchBalanceDetails=function(){var e=y()((function*(){var e,t=this,n=yield this.collectUTXOsInfo(),r=n.utxos,i=n.valueDetails,o=n.ordQueryStatus;"ERROR"===o&&this.collectUTXOsInfo.clear();var a=yield Promise.all([this.getDbAccount(),this.getNetwork()]),s=f()(a,2),u=s[0],c=s[1],d=yield this.getFrozenUtxos(u.xpub,r),l=r.filter((function(e){return d.find((function(n){return n.id===Object(H.getUtxoId)(t.networkId,e)}))})).reduce((function(e,t){return e.plus(t.value)}),new O.a(0)),p=l;null!=i&&i.unavailableValue&&(p=p.plus(null==i?void 0:i.unavailableValue));var h,v,y,g=Object(X.convertFeeValueToNative)({value:l,network:c}),w=Object(X.convertFeeValueToNative)({value:p,network:c}),m=r.reduce((function(e,t){return e.plus(t.value)}),new O.a(0)),b=Object(X.convertFeeValueToNative)({value:null!=(e=null==i?void 0:i.totalValue)?e:m,network:c}),x=new O.a(b).minus(w).toFixed();if(i){var T=i.unavailableValueOfUnchecked,I=i.unavailableValueOfUnconfirmed,P=i.unavailableValueOfInscription,A=function(e){return e&&new O.a(e).gt(0)};A(T)&&(y=Object(X.convertFeeValueToNative)({value:T,network:c})),A(I)&&(h=Object(X.convertFeeValueToNative)({value:I,network:c})),A(P)&&(v=Object(X.convertFeeValueToNative)({value:P,network:c}))}var E={errorMessageKey:"ERROR"===o?"msg__the_ordinal_service_failure_refresh_and_try_again":void 0,total:b,available:x,unavailable:w,unavailableOfLocalFrozen:g,unavailableOfInscription:v,unavailableOfUnconfirmed:h,unavailableOfUnchecked:y};return Promise.resolve(E)}));return function(){return e.apply(this,arguments)}}(),i.getUserNFTAssets=function(){var e=y()((function*(e){var t=e.serviceData;return Promise.resolve({type:M.NFTAssetType.BTC,data:t})}));return function(t){return e.apply(this,arguments)}}(),w()(r)}(L.VaultBase)}.call(this,n(26).Buffer)},4045:function(e,t,n){"use strict";n.r(t);var r=n(956);n.d(t,"BlockBook",(function(){return r.BlockBook}));var i=n(4091);n.d(t,"Provider",(function(){return i.Provider}))},4046:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"KeyringHardware",(function(){return C}));var r=n(13),i=n.n(r),o=n(3),a=n.n(o),s=n(2),u=n.n(s),c=n(6),d=n.n(c),l=n(9),f=n.n(l),p=n(14),h=n.n(p),v=n(7),y=n.n(v),g=n(1064),w=n(3918),m=n(431),b=n(11),x=n(19),T=n(23),I=n(317),P=n(182),A=n(117),O=n(3913),E=n(668);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var C=function(t){f()(r,t);var n=S(r);function r(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return(e=n.call.apply(n,[this].concat(r))).buildHardwareInput=function(){var e=u()((function*(e,t){var n=yield Object(m.CoreSDKLoader)(),r=n.getHDPath,i=n.getScriptType,o=r(t),a=i(o),s=e.utxo;return{prev_index:s.vout,prev_hash:s.txid,amount:s.value.integerValue().toString(),address_n:o,script_type:a}}));return function(t,n){return e.apply(this,arguments)}}(),e.buildHardwareOutput=function(){var e=u()((function*(e){var t=e.payload||{},n=t.isCharge,r=t.bip44Path;if(n&&r){var i=yield Object(m.CoreSDKLoader)(),o=i.getHDPath,a=i.getOutputScriptType,s=o(r);return{script_type:a(s),address_n:s,amount:e.value.integerValue().toString()}}return{script_type:"PAYTOADDRESS",address:e.address,amount:e.value.integerValue().toString()}}));return function(t){return e.apply(this,arguments)}}(),e.buildPrevTx=function(e){var t=g.Transaction.fromHex(e);return{hash:t.getId(),version:t.version,inputs:t.ins.map((function(e){return{prev_hash:e.hash.reverse().toString("hex"),prev_index:e.index,script_sig:e.script.toString("hex"),sequence:e.sequence}})),bin_outputs:t.outs.map((function(e){return{amount:e.value,script_pubkey:e.script.toString("hex")}})),lock_time:t.locktime}},e}var o=r.prototype;return o.signTransaction=function(){var e=u()((function*(e){var t=this,n=this.vault.getCoinName(),r=e.inputs.map((function(e){return e.address})),i=(yield this.vault.collectUTXOsInfo()).utxos,o={};for(var a of i){var s=a.address,c=a.path;r.includes(s)&&(o[s]=c)}var d=yield this.vault.getProvider(),l=e.inputs,f=e.outputs,p=Array.from(new Set(l.map((function(e){return e.utxo.txid})))),h=yield d.collectTxs(p),v=yield this.getHardwareInfo(),y=v.connectId,b=v.deviceId,x=yield this.getWalletPassphraseState();yield this.getHardwareSDKInstance();var T=yield m.HardwareSDK.btcSignTransaction(y,b,B({coin:n.toLowerCase(),inputs:yield Promise.all(l.map(function(){var e=u()((function*(e){return t.buildHardwareInput(e,o[e.address])}));return function(t){return e.apply(this,arguments)}}())),outputs:yield Promise.all(f.map(function(){var e=u()((function*(e){return t.buildHardwareOutput(e)}));return function(t){return e.apply(this,arguments)}}())),refTxs:Object.values(h).map((function(e){return t.buildPrevTx(e)}))},x));if(T.success){var I=T.payload.serializedTx;return{txid:g.Transaction.fromHex(I).getId(),rawTx:I}}throw Object(w.convertDeviceError)(T.payload)}));return function(t){return e.apply(this,arguments)}}(),o.prepareAccounts=function(){var e=u()((function*(e){var t=e.indexes,n=e.purpose,r=e.names,i=e.template,o=e.skipCheckAccountExist,a=e.confirmOnDevice,s=yield this.vault.getProvider();return yield this.createAccount({indexes:t,purpose:n,names:r,template:i,addressIndex:0,isChange:!1,isCustomAddress:!1,confirmOnDevice:a,validator:o?void 0:function(){var e=u()((function*(e){var t=e.xpub,n=e.addressEncoding;return(yield s.getAccount({type:"simple",xpub:t},n)).txs>0}));return function(t){return e.apply(this,arguments)}}()})}));return function(t){return e.apply(this,arguments)}}(),o.createAccount=function(){var e=u()((function*(e){var t,n=e.indexes,r=e.purpose,o=e.names,a=e.template,s=e.addressIndex,u=e.isChange,c=e.isCustomAddress,d=e.confirmOnDevice,l=e.validator,f=yield this.getNetworkImpl(),p=this.vault,h=p.getDefaultPurpose(),v=p.getCoinName(),y=p.getCoinType(),g=r||h,x=0!==n[0],O=[].concat(i()(x?[n[0]-1]:[]),i()(n)),k=Object(E.getAccountDefaultByPurpose)(g,v).addressEncoding,S=Object(P.getAccountNameInfoByTemplate)(f,a).prefix,C=yield this.vault.getProvider();try{var D=yield this.getHardwareInfo(),N=D.connectId,F=D.deviceId,H=yield this.getWalletPassphraseState();yield this.getHardwareSDKInstance();var R=Object(I.slicePathTemplate)(a).pathPrefix;t=yield m.HardwareSDK.btcGetPublicKey(N,F,B({bundle:O.map((function(e){return{path:R+"/"+e+"'",coin:v.toLowerCase(),showOnOneKey:!!d&&e===O[O.length-1]}}))},H))}catch(Q){throw new T.OneKeyHardwareError(Q)}if(!t.success||!t.payload)throw Object(w.convertDeviceError)(t.payload);if(t.payload.length!==O.length)throw new T.OneKeyInternalError("Unable to get publick key.");var j=[],K=0;for(var U of t.payload){var M,V,_=U.path,W=U.xpub,L=U.xpubSegwit,X=(u?"1":"0")+"/"+s,z=C.xpubToAddresses(W,[X],k)[X],G=c?((M={})[X]=z,M):void 0,q=[b.COINTYPE_DOGE,b.COINTYPE_BCH].includes(y)?v:S,Y=(o||[])[K]||q+" #"+(O[K]+1);if(!x||K>0)j.push({id:this.walletId+"--"+_,name:Y,type:A.AccountType.UTXO,path:_,coinType:y,xpub:W,xpubSegwit:L||W,address:z,addresses:(V={},V[X]=z,V),customAddresses:G,template:a});if(1===O.length)break;if(l){if(!(yield null==l?void 0:l({xpub:L||W,address:z,addressEncoding:k})))break;K+=1,yield new Promise((function(e){return setTimeout(e,200)}))}else K+=1}return j}));return function(t){return e.apply(this,arguments)}}(),o.prepareAccountByAddressIndex=function(){var e=u()((function*(e){var t,n=e.template,r=e.accountIndex,i=e.addressIndex,o=parseInt(null==(t=n.split("/"))?void 0:t[1],10);return this.createAccount({indexes:[r],purpose:o,template:n,addressIndex:i,isChange:!1,isCustomAddress:!0})}));return function(t){return e.apply(this,arguments)}}(),o.getAddress=function(){var e=u()((function*(e){var t=this.vault.getCoinName(),n="";if(e.isTemplatePath)n=e.path;else{var r=yield this.getDbAccount({noCache:!0}),i=r.addresses,o=r.address,a=Object.keys(r.addresses).find((function(e){return i[e]===o}));if(!a)return"";n=r.path+"/"+a}yield this.getHardwareSDKInstance();var s=yield this.getHardwareInfo(),u=s.connectId,c=s.deviceId,d=yield this.getWalletPassphraseState(),l=yield m.HardwareSDK.btcGetAddress(u,c,B({path:n,showOnOneKey:e.showOnOneKey,coin:t.toLowerCase()},d));if(l.success)return l.payload.address;throw Object(w.convertDeviceError)(l.payload)}));return function(t){return e.apply(this,arguments)}}(),o.batchGetAddress=function(){var e=u()((function*(e){var t=this.vault.getCoinName(),n=yield this.getHardwareInfo(),r=n.connectId,i=n.deviceId,o=yield this.getWalletPassphraseState(),a=yield m.HardwareSDK.btcGetAddress(r,i,B(B({},o),{},{bundle:e.map((function(e){return{path:e.path,showOnOneKey:!!e.showOnOneKey,coin:t.toLowerCase()}}))}));if(!a.success)throw Object(w.convertDeviceError)(a.payload);return a.payload.map((function(e){var t,n;return{path:null!=(t=e.path)?t:"",address:null!=(n=e.address)?n:""}}))}));return function(t){return e.apply(this,arguments)}}(),o.signMessage=function(){var t=u()((function*(t){x.default.common.info("BTCFork signMessage",t);var n=this.vault.getCoinName(),r=yield this.getDbAccount(),i=yield this.getHardwareInfo(),o=i.connectId,a=i.deviceId,s=yield this.getWalletPassphraseState();return yield this.getHardwareSDKInstance(),(yield Promise.all(t.map(function(){var t=u()((function*(t){var i=yield m.HardwareSDK.btcSignMessage(o,a,B(B({},s),{},{path:r.path+"/0/0",coin:n,messageHex:e.from(t.message).toString("hex")}));if(!i.success)throw Object(w.convertDeviceError)(i.payload);return i.payload}));return function(e){return t.apply(this,arguments)}}()))).map((function(e){return e.signature}))}));return function(e){return t.apply(this,arguments)}}(),d()(r)}(O.KeyringHardwareBase)}.call(this,n(26).Buffer)},4047:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"KeyringHd",(function(){return S}));var r=n(13),i=n.n(r),o=n(4),a=n.n(o),s=n(2),u=n.n(s),c=n(6),d=n.n(c),l=n(9),f=n.n(l),p=n(14),h=n.n(p),v=n(7),y=n.n(v),g=n(1346),w=n.n(g),m=n(610),b=n(11),x=n(19),T=n(23),I=n(317),P=n(182),A=n(1345),O=n(117),E=n(3914),k=n(668);function B(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var S=function(t){f()(r,t);var n=B(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.signTransaction=function(){var e=u()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new T.OneKeyInternalError("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return x.default.engine.info("signTransaction",this.networkId,e),(yield this.vault.getProvider()).signTransaction(e,r)}));return function(t,n){return e.apply(this,arguments)}}(),o.getSigners=function(){var e=u()((function*(e,t){var n={},r=(yield this.vault.collectUTXOsInfo()).utxos;for(var i of r){var o=i.address,s=i.path;t.includes(o)&&(n[s]=o)}var u=Object.keys(n).map((function(e){return e.split("/").slice(-2).join("/")}));if(0===u.length)throw new T.OneKeyInternalError("No signers would be chosen.");var c=yield this.getPrivateKeys(e,u),d={};for(var l of Object.entries(c)){var f=a()(l,2),p=f[0],h=f[1],v=n[p];if((yield this.getNetworkImpl())===b.IMPL_TBTC){if(!v)v=n[p.replace("m/86'/0'/","m/86'/1'/")];if(!v)v=n[p.replace("m/86'/1'/","m/86'/0'/")]}var y=new A.Signer(h,e,"secp256k1");if(v!==v)throw new Error("addressFromPrivateKey and utxoAddress not matched");d[v]=y}return d}));return function(t,n){return e.apply(this,arguments)}}(),o.prepareAccounts=function(){var e=u()((function*(e){var t=e.password,n=e.indexes,r=e.purpose,i=e.names,o=e.template,a=e.skipCheckAccountExist,s=yield this.vault.getProvider();return yield this.createAccount({password:t,indexes:n,purpose:r,names:i,template:o,addressIndex:0,isChange:!1,isCustomAddress:!1,validator:a?void 0:function(){var e=u()((function*(e){var t=e.xpub,n=e.addressEncoding;return(yield s.getAccount({type:"simple",xpub:t},n)).txs>0}));return function(t){return e.apply(this,arguments)}}()})}));return function(t){return e.apply(this,arguments)}}(),o.createAccount=function(){var t=u()((function*(t){var n=t.password,r=t.indexes,o=t.purpose,a=t.names,s=t.template,u=t.addressIndex,c=t.isChange,d=t.isCustomAddress,l=t.validator,f=yield this.getNetworkImpl(),p=this.vault,h=p.getDefaultPurpose(),v=p.getCoinName(),y=p.getCoinType(),g=o||h,x=0!==r[0],A=[].concat(i()(x?[r[0]-1]:[]),i()(r)),E=Object(k.getAccountDefaultByPurpose)(g,v).addressEncoding,B=Object(P.getAccountNameInfoByTemplate)(f,s).prefix,S=(yield this.engine.dbApi.getCredential(this.walletId,n)).seed,C=yield this.vault.getProvider(),D=C.network,N=Object(I.slicePathTemplate)(s).pathPrefix,F=Object(m.batchGetPublicKeys)("secp256k1",S,n,N,A.map((function(e){return e.toString()+"'"})));if(F.length!==A.length)throw new T.OneKeyInternalError("Unable to get publick key.");var H=((D.segwitVersionBytes||{})[E]||D.bip32).public,R=[],j=0;for(var K of F){var U,M,V=K.path,_=K.parentFingerPrint,W=K.extendedKey,L=w.a.encode(e.concat([e.from(H.toString(16).padStart(8,"0"),"hex"),e.from([3]),_,e.from((A[j]+2**31).toString(16).padStart(8,"0"),"hex"),W.chainCode,W.key])),X=(c?"1":"0")+"/"+u,z=C.xpubToAddresses(L,[X],E)[X],G=d?((U={})[X]=z,U):void 0,q=[b.COINTYPE_DOGE,b.COINTYPE_BCH].includes(y)?v:B,Y=(a||[])[j]||q+" #"+(A[j]+1);if(!x||j>0)R.push({id:this.walletId+"--"+V,name:Y,type:O.AccountType.UTXO,path:V,coinType:y,xpub:L,address:z,addresses:(M={},M[X]=z,M),customAddresses:G,template:s});if(1===A.length)break;if(l){if(!(yield null==l?void 0:l({xpub:L,address:z,addressEncoding:E})))break;j+=1,yield new Promise((function(e){return setTimeout(e,200)}))}else j+=1}return R}));return function(e){return t.apply(this,arguments)}}(),o.prepareAccountByAddressIndex=function(){var e=u()((function*(e){var t,n=e.password,r=e.template,i=e.accountIndex,o=e.addressIndex,a=parseInt(null==(t=r.split("/"))?void 0:t[1],10);return yield this.createAccount({password:n,indexes:[i],purpose:a,template:r,addressIndex:o,isChange:!1,isCustomAddress:!0})}));return function(t){return e.apply(this,arguments)}}(),o.signMessage=function(){var e=u()((function*(e,t){x.default.common.info("BTCFork signMessage",e);var n=t.password,r=void 0===n?"":n,i=(yield this.engine.dbApi.getCredential(this.walletId,r)).entropy,o=(yield this.getDbAccount()).path+"/0/0",a=yield this.vault.getProvider();return e.map((function(e){return a.signMessage(r,i,o,e.message)})).map((function(e){return e.toString("hex")}))}));return function(t,n){return e.apply(this,arguments)}}(),d()(r)}(E.KeyringHdBase)}.call(this,n(26).Buffer)},4048:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"KeyringImported",(function(){return B}));var r=n(13),i=n.n(r),o=n(4),a=n.n(o),s=n(2),u=n.n(s),c=n(6),d=n.n(c),l=n(9),f=n.n(l),p=n(14),h=n.n(p),v=n(7),y=n.n(v),g=n(1346),w=n.n(g),m=n(895),b=n(748),x=n(112),T=n(19),I=n(23),P=n(1345),A=n(117),O=n(3915);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=y()(e);if(t){var i=y()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var k=new m.BaseBip32KeyDeriver(e.from("Bitcoin seed"),b.secp256k1),B=function(t){f()(r,t);var n=E(r);function r(){return n.apply(this,arguments)}var o=r.prototype;return o.signTransaction=function(){var e=u()((function*(e,t){var n=t.password;if("undefined"===typeof n)throw new I.OneKeyInternalError("Software signing requires a password.");var r=yield this.getSigners(n,e.inputs.map((function(e){return e.address})));return T.default.engine.info("signTransaction",this.networkId,e),(yield this.vault.getProvider()).signTransaction(e,r)}));return function(t,n){return e.apply(this,arguments)}}(),o.getSigners=function(){var e=u()((function*(e,t){var n={},r=(yield this.vault.collectUTXOsInfo()).utxos;for(var i of r){var o=i.address,s=i.path;if(t.includes(o)){var u=s.split("/").slice(-2).join("/");n[u]=o}}var c=Object.keys(n);if(0===c.length)throw new I.OneKeyInternalError("No signers would be chosen.");var d={},l={},f=Object.values(yield this.getPrivateKeys(e)),p=a()(f,1)[0],h=Object(x.decrypt)(e,p),v={chainCode:h.slice(13,45),key:h.slice(46,78)};return c.forEach((function(t){var r=t.split("/"),i="",o=v;r.forEach((function(e){if(i=i.length>0?i+"/"+e:e,"undefined"===typeof l[i]){var t=e.endsWith("'")?parseInt(e.slice(0,-1))+2**31:parseInt(e),n=k.CKDPriv(o,t);l[i]=n}o=l[i]}));var a=n[t];d[a]=new P.Signer(Object(x.encrypt)(e,l[t].key),e,"secp256k1")})),d}));return function(t,n){return e.apply(this,arguments)}}(),o.prepareAccounts=function(){var t=u()((function*(t){var n,r=t.privateKey,o=t.name,a=yield this.vault.getProvider(),s=this.vault.getCoinType(),u="",c=a.network,d=parseInt(r.slice(0,4).toString("hex"),16);for(var l of[].concat(i()(Object.values(c.segwitVersionBytes||{})),[c.bip32]))if(l.private===d){var f=b.secp256k1.publicFromPrivate(r.slice(46,78)),p=e.from(l.public.toString(16).padStart(8,"0"),"hex");try{u=w.a.encode(r.fill(p,0,4).fill(f,45,78))}catch(v){}}if(""===u)throw new I.OneKeyInternalError("Invalid private key.");var h=a.xpubToAddresses(u,["0/0"])["0/0"];return Promise.resolve([{id:"imported--"+s+"--"+u,name:o||"",type:A.AccountType.UTXO,path:"",coinType:s,xpub:u,address:h,addresses:(n={},n["0/0"]=h,n)}])}));return function(e){return t.apply(this,arguments)}}(),d()(r)}(O.KeyringImportedBase)}.call(this,n(26).Buffer)},4049:function(e,t,n){"use strict";n.r(t),n.d(t,"KeyringWatching",(function(){return y}));var r=n(2),i=n.n(r),o=n(6),a=n.n(o),s=n(9),u=n.n(s),c=n(14),d=n.n(c),l=n(7),f=n.n(l),p=n(23),h=n(117);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var i=f()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d()(this,n)}}var y=function(e){u()(n,e);var t=v(n);function n(){return t.apply(this,arguments)}return n.prototype.prepareAccounts=function(){var e=i()((function*(e){var t,n=e.target,r=e.name,i=e.accountIdPrefix,o=yield this.vault.getProvider(),a=this.vault.getCoinType();if(!o.isValidXpub(n))throw new p.InvalidAddress;var s=o.xpubToAddresses(n,["0/0"])["0/0"];return[{id:i+"--"+a+"--"+n,name:r||"",type:h.AccountType.UTXO,path:"",coinType:a,xpub:n,address:s,addresses:(t={},t["0/0"]=s,t)}]}));return function(t){return e.apply(this,arguments)}}(),a()(n)}(n(3916).KeyringWatchingBase)},4091:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"Provider",(function(){return j}));var r=n(13),i=n.n(r),o=n(4),a=n.n(o),s=n(2),u=n.n(s),c=n(3),d=n.n(c),l=n(6),f=n.n(l),p=n(21),h=n.n(p),v=n(3978),y=n(304),g=n(1064),w=n(4004),m=n.n(w),b=n(1346),x=n.n(b),T=n(3979),I=n(610),P=n(529),A=n(668),O=n(956),E=n(4169),k=n(758),B=n(4170);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){d()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D=Object(v.BIP32Factory)(k.default),N=Object(T.ECPairFactory)(k.default),F=function(e,t){if(!e)throw t||"Invalid statement",t instanceof Error?t:new Error(t)},H=function(e,t){return F("undefined"!==typeof e,t||"Expect defined but actually undefined"),e},R=function(e,t,n){return Object(I.verify)("secp256k1",e,t,n)};g.initEccLib(k.default);var j=function(){function t(e){this.chainInfo=e}var n=t.prototype;return n.decodeAddress=function(e){return e},n.encodeAddress=function(e){return e},n.xpubToAddresses=function(e,t,n){var r=x.a.decode(e),i=parseInt(r.slice(0,4).toString("hex"),16),o=null!=n?n:this.versionBytesToEncodings.public[i][0],a={},s={chainCode:r.slice(13,45),key:r.slice(45,78)},u=new Map;for(var c of t){var d=s,l="",f=c.split("/");for(var p of f)if(l+=""===l?p:"/"+p,u.has(l))d=u.get(l);else{var h=p.endsWith("'")?parseInt(p.slice(0,-1))+2**31:parseInt(p);d=Object(I.CKDPub)("secp256k1",d,h),u.set(l,d)}var v=this.pubkeyToPayment(d.key,o).address;"string"===typeof v&&v.length>0&&(v=this.encodeAddress(v),a[c]=v)}return a},n.pubkeyToPayment=function(e,t){var n={pubkey:e,network:this.network};switch(t){case P.AddressEncodings.P2PKH:n=g.payments.p2pkh(n);break;case P.AddressEncodings.P2WPKH:n=g.payments.p2wpkh(n);break;case P.AddressEncodings.P2SH_P2WPKH:n=g.payments.p2sh({redeem:g.payments.p2wpkh(n),network:this.network});break;case P.AddressEncodings.P2TR:n=g.payments.p2tr({internalPubkey:e.slice(1,33),network:this.network});break;default:throw new Error("Invalid encoding: "+t)}return n},n.parseAddressEncodings=function(e){var t=this;return Promise.all(e.map((function(e){return t.verifyAddress(e)}))).then((function(e){return e.filter((function(e){return e.isValid})).map((function(e){return e.encoding}))}))},n.getAccount=function(e,t){var n=this.getEncodingXpub(e,t),r={};switch(e.type){case"simple":r={details:"basic"};break;case"details":r={details:"tokenBalances",tokens:"derived"};break;case"history":r={details:"txs",pageSize:50,to:e.to};break;case"usedAddress":r={details:"tokenBalances",tokens:"used"};break;case"accountInfo":r={details:e.details,from:e.from,to:e.to,pageSize:e.pageSize};break;default:throw new Error("type not support: "+e.type)}return this.blockbook.then((function(e){return e.getAccount(n,r)}))},n.getAccountWithAddress=function(e){var t={};switch(e.type){case"simple":t={details:"basic"}}return this.blockbook.then((function(n){return n.getAccountWithAddress(e.address,t)}))},n.getEncodingXpub=function(e,t){var n=t;if(Object(A.isTaprootXpubSegwit)(e.xpub)||Object(A.isWatchAccountTaprootSegwit)(e.xpub))n=P.AddressEncodings.P2TR;else{var r=x.a.decode(e.xpub);F(this.isValidXpub(r));var i=parseInt(r.slice(0,4).toString("hex"),16);n=null!=t?t:this.versionBytesToEncodings.public[i][0]}F("undefined"!==typeof n);var o=e.xpub;switch(n){case P.AddressEncodings.P2PKH:o="pkh("+e.xpub+")";break;case P.AddressEncodings.P2SH_P2WPKH:o="sh(wpkh("+e.xpub+"))";break;case P.AddressEncodings.P2WPKH:o="wpkh("+e.xpub+")";break;case P.AddressEncodings.P2TR:o=e.xpub}return o},n.getHistory=function(e,t,n,r,i){var o=this.getEncodingXpub(e);return this.blockbook.then((function(e){return e.getHistory(t,n,o,r,i)}))},n.isValidXpub=function(e){return this.isValidExtendedKey(e,"pub")},n.isValidXprv=function(e){return this.isValidExtendedKey(e,"prv")},n.isValidExtendedKey=function(e,t){var n="string"===typeof e?x.a.decode(e):e;if(78!==n.length)return!1;var r=parseInt(n.slice(0,4).toString("hex"),16);return"pub"===t?"undefined"!==typeof this.versionBytesToEncodings.public[r]:"undefined"!==typeof this.versionBytesToEncodings.private[r]},n.verifyAddress=function(e){var t,n=this.decodeAddress(e);try{var r=g.address.fromBase58Check(n);r.version===this.network.pubKeyHash&&20===r.hash.length?t=P.AddressEncodings.P2PKH:r.version===this.network.scriptHash&&20===r.hash.length&&(t=P.AddressEncodings.P2SH_P2WPKH)}catch(o){try{var i=g.address.fromBech32(n);0===i.version&&i.prefix===this.network.bech32&&20===i.data.length?t=P.AddressEncodings.P2WPKH:0===i.version&&i.prefix===this.network.bech32&&32===i.data.length?t=P.AddressEncodings.P2WSH:1===i.version&&i.prefix===this.network.bech32&&32===i.data.length&&(t=P.AddressEncodings.P2TR)}catch(a){}}return t?{displayAddress:n,normalizedAddress:n,encoding:t,isValid:!0}:{isValid:!1}},n.buildUnsignedTx=function(e){var t=e.encodedTx,n=e.inputs,r=e.outputs,i=e.feeLimit,o=e.feePricePerUnit,a=(null!=t?t:{}).inputsForCoinSelect,s=null==a?void 0:a.filter((function(e){return n.some((function(t){var n;return(null==(n=t.utxo)?void 0:n.txid)===e.txId&&t.utxo.vout===e.vout}))}));if(Number(null==s?void 0:s.length)>0&&r.length>0){var u,c=Object(B.estimateTxSize)(null!=s?s:[],null!=(u=r.map((function(e){return{address:e.address,value:parseInt(e.value.toFixed())}})))?u:[]);i=i&&i.gte(c)?i:new h.a(c)}return i=i||new h.a(B.PLACEHOLDER_VSIZE),Promise.resolve(C(C({},e),{},{feeLimit:i,feePricePerUnit:o}))},n.getBalances=function(e){return this.blockbook.then((function(t){return Promise.all(e.map((function(e){var n=e.address;return t.getBalance(n)})))}))},n.getBalancesByAddress=function(e){return this.blockbook.then((function(t){return Promise.all(e.map((function(e){var n=e.address;return t.getBalanceWithAddress(n)})))}))},n.getUTXOs=function(){var e=u()((function*(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.blockbook.then((function(n){return n.getUTXOs(e,t)}))}));return function(t){return e.apply(this,arguments)}}(),n.getPsbt=function(){return new g.Psbt({network:this.network})},n.getBitcoinSigner=function(){var e=u()((function*(e,t){return{publicKey:yield e.getPubkey(!0),sign:function(){var t=u()((function*(t){var n=yield e.sign(t);return a()(n,1)[0]}));return function(e){return t.apply(this,arguments)}}()}}));return function(t,n){return e.apply(this,arguments)}}(),n.signTransaction=function(){var e=u()((function*(e,t){for(var n=yield this.packTransaction(e,t),r=0;r<e.inputs.length;++r){var i=t[e.inputs[r].address],o=n.data.inputs[0],a=yield this.getBitcoinSigner(i,o);yield n.signInputAsync(r,a)}n.validateSignaturesOfAllInputs(R),n.finalizeAllInputs();var s=n.extractTransaction();return{txid:s.getId(),rawTx:s.toHex()}}));return function(t,n){return e.apply(this,arguments)}}(),n.packTransaction=function(){var t=u()((function*(t,n){for(var r=t.inputs,i=t.outputs,o=t.payload.opReturn,s=yield this.collectInfoForSoftwareSign(t),u=a()(s,2),c=u[0],d=u[1],l=this.getPsbt(),f=0;f<r.length;++f){var p=r[f],h=p.utxo;F(h);var v=c[f],y={};switch(v){case P.AddressEncodings.P2PKH:y.nonWitnessUtxo=e.from(d[h.txid],"hex");break;case P.AddressEncodings.P2WPKH:y.witnessUtxo={script:H(this.pubkeyToPayment(yield n[p.address].getPubkey(!0),v)).output,value:h.value.integerValue().toNumber()};break;case P.AddressEncodings.P2SH_P2WPKH:var w,m=H(this.pubkeyToPayment(yield n[p.address].getPubkey(!0),v));y.witnessUtxo={script:m.output,value:h.value.integerValue().toNumber()},y.redeemScript=null==(w=m.redeem)?void 0:w.output;break;case P.AddressEncodings.P2TR:var b=H(this.pubkeyToPayment(yield n[p.address].getPubkey(!0),v));y.witnessUtxo={script:b.output,value:h.value.integerValue().toNumber()},y.tapInternalKey=b.internalPubkey}l.addInput(C({hash:h.txid,index:h.vout},y))}if(i.forEach((function(e){l.addOutput({address:e.address,value:e.value.integerValue().toNumber()})})),"string"===typeof o){var x=g.payments.embed({data:[Object(B.loadOPReturn)(o)]});l.addOutput({script:H(x.output),value:0})}return l}));return function(e,n){return t.apply(this,arguments)}}(),n.collectInfoForSoftwareSign=function(){var e=u()((function*(e){var t=e.inputs,n=yield this.parseAddressEncodings(t.map((function(e){return e.address})));F(n.length===t.length,"Found invalid address from inputs");var r=Array.from(new Set(n.map((function(e,n){if(e===P.AddressEncodings.P2PKH)return H(t[n].utxo).txid})).filter((function(e){return!!e}))));return[n,yield this.collectTxs(r)]}));return function(t){return e.apply(this,arguments)}}(),n.collectTxs=function(){var e=u()((function*(e){for(var t=yield this.blockbook,n={},r=function*(){var r=e.slice(i,i+o),a=yield Promise.all(r.map((function(e){return t.getRawTransaction(e)})));r.forEach((function(e,t){return n[e]=a[t]}))},i=0,o=5;i<e.length;i+=o)yield*r();return n}));return function(t){return e.apply(this,arguments)}}(),n.broadcastTransaction=function(e){return this.blockbook.then((function(t){return t.broadcastTransaction(e)}))},n.getTransactionStatuses=function(e){return this.blockbook.then((function(t){return t.getTransactionStatuses(e)}))},n.signMessage=function(e,t,n,r){var i=Object(I.mnemonicFromEntropy)(t,e),o=Object(y.mnemonicToSeedSync)(i),a=D.fromSeed(o).derivePath(n),s=N.fromWIF(a.toWIF());return m.a.sign(r,s.privateKey,s.compressed,{segwitType:"p2wpkh"})},f()(t,[{key:"network",get:function(){return Object(E.getNetwork)(this.chainInfo.code)}},{key:"blockbook",get:function(){return Object(O.getBlockBook)(this.chainInfo)}},{key:"versionBytesToEncodings",get:function(){if("undefined"===typeof this._versionBytesToEncodings){var e,t,n=this.network,r={public:(e={},e[n.bip32.public]=[P.AddressEncodings.P2PKH],e),private:(t={},t[n.bip32.private]=[P.AddressEncodings.P2PKH],t)};Object.entries(n.segwitVersionBytes||{}).forEach((function(e){var t=a()(e,2),n=t[0],o=t[1],s=o.public,u=o.private;r.public[s]=[].concat(i()(r.public[s]||[]),[n]),r.private[u]=[].concat(i()(r.private[u]||[]),[n])})),this._versionBytesToEncodings=r}return this._versionBytesToEncodings}}]),t}()}.call(this,n(26).Buffer)},4169:function(e,t,n){"use strict";n.r(t),n.d(t,"isNetworkType",(function(){return m})),n.d(t,"getNetwork",(function(){return g}));var r,i,o,a,s=n(3),u=n.n(s),c=n(1064),d=n(2684),l=n.n(d),f=n(529);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){u()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"",bip32:{public:76067358,private:76066276},pubKeyHash:0,scriptHash:5,wif:128,forkId:0},y={btc:h(h({},c.networks.bitcoin),{},{segwitVersionBytes:(r={},r[f.AddressEncodings.P2SH_P2WPKH]={public:77429938,private:77428856},r[f.AddressEncodings.P2WPKH]={public:78792518,private:78791436},r[f.AddressEncodings.P2TR]={public:76067358,private:76066276},r)}),tbtc:h(h({},c.networks.testnet),{},{segwitVersionBytes:(i={},i[f.AddressEncodings.P2SH_P2WPKH]={public:71979618,private:71978536},i[f.AddressEncodings.P2WPKH]={public:73342198,private:73341116},i[f.AddressEncodings.P2TR]={public:70617039,private:70615956},i)}),rbtc:h(h({},c.networks.regtest),{},{segwitVersionBytes:(o={},o[f.AddressEncodings.P2SH_P2WPKH]={public:71979618,private:71978536},o[f.AddressEncodings.P2WPKH]={public:73342198,private:73341116},o)}),ltc:{messagePrefix:"\x19Litecoin Signed Message:\n",bech32:"ltc",bip32:{public:27108450,private:27106558},segwitVersionBytes:(a={},a[f.AddressEncodings.P2SH_P2WPKH]={public:28471030,private:28469138},a[f.AddressEncodings.P2WPKH]={public:78792518,private:78791436},a),pubKeyHash:48,scriptHash:50,wif:176},bch:v,doge:{messagePrefix:"\x19Dogecoin Signed Message:\n",bech32:"",bip32:{public:49990397,private:49988504},pubKeyHash:30,scriptHash:22,wif:158},btg:{messagePrefix:"\x1dBitcoin Gold Signed Message:\n",bech32:"btg",bip32:{public:76067358,private:76066276},pubKeyHash:38,scriptHash:23,wif:128},dgb:{messagePrefix:"\x19DigiByte Signed Message:\n",bech32:"dgb",bip32:{public:76067358,private:76066276},pubKeyHash:30,scriptHash:63,wif:176},nmc:{messagePrefix:"\x19Namecoin Signed Message:\n",bech32:"",bip32:{public:76067358,private:76066276},pubKeyHash:52,scriptHash:5,wif:128},vtc:{messagePrefix:"\x19Vertcoin Signed Message:\n",bech32:"vtc",bip32:{public:76067358,private:76066276},pubKeyHash:71,scriptHash:5,wif:128},dash:{messagePrefix:"\x19DarkCoin Signed Message:\n",bech32:"",bip32:{public:50221772,private:50221816},pubKeyHash:76,scriptHash:16,wif:204}},g=function(e){var t=y[e];if("undefined"===typeof t)throw new Error("Network not found. chainCode: "+e);return t},w={bitcoinCash:[v]};function m(e,t){if("string"!==typeof e||!t||!w[e])return!1;try{l()({bip32:{public:l.a.UInt32,private:l.a.UInt32},pubKeyHash:l.a.anyOf(l.a.UInt8,l.a.UInt16),scriptHash:l.a.anyOf(l.a.UInt8,l.a.UInt16)},t)}catch(n){return!1}return!!w[e].find((function(e){return e.bip32.public===t.bip32.public&&e.bip32.private===t.bip32.private&&(!e.bech32&&!t.bech32||e.bech32===t.bech32)&&(!e.forkId&&!t.forkId||e.forkId===t.forkId)&&e.pubKeyHash===t.pubKeyHash&&e.scriptHash===t.scriptHash}))}},4170:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"estimateVsize",(function(){return c})),n.d(t,"estimateTxSize",(function(){return d})),n.d(t,"loadOPReturn",(function(){return u})),n.d(t,"PLACEHOLDER_VSIZE",(function(){return s}));var r=n(310),i=n.n(r),o={P2PKH:148,P2WPKH:68,P2SH_P2WPKH:91},a={P2PKH:34,P2WPKH:31,P2SH_P2WPKH:32},s=79,u=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:80,r=e.from(t);return r.slice(0,n)},c=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:80,i=10,s=e.filter((function(e){return e.includes("P2WPKH")})).length>=1;if(s&&(i+=.5),i+=e.map((function(e){return o[e]||0})).reduce((function(e,t){return e+t}),0),s&&(i+=.25),i+=t.map((function(e){return a[e]||0})).reduce((function(e,t){return e+t}),0),"string"===typeof n){var c=u(n,r).length;i+=12*Math.ceil(c/r),i+=c}return Math.ceil(i)},d=function(e,t){return i.a.transactionBytes(e,t)}}.call(this,n(26).Buffer)}}]);