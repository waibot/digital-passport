(this.webpackJsonp=this.webpackJsonp||[]).push([[72],{4033:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"HistoryRequestRoutes",(function(){return r})),function(e){e.HistoryRequestModal="HistoryRequestModal",e.TicketDetailModal="TicketDetailModal",e.ReplyTicketModel="ReplyTicketModel",e.SubmitRequestModal="SubmitRequestModal"}(r||(r={}))},5309:function(e,t,n){"use strict";n.r(t);var r=n(50),a=n(57),o=n(100),i=n(64),c=n(40),s=n(20),u=n(76),l=n(12),d=n(201),f=n(183),p=n(4),b=n.n(p),m=n(1),j=n(44),O=n(107),h=n.n(O),g=n(649),y=n(1035),x=n(88),_=n(24),v=n(17),w=n(45),P=n(819),R=n(16),M=n(1155),k=n(4033),S=n(0),q=function(){var e=Object(x.default)(),t=Object(w.useSettings)().instanceId,n=Object(P.default)().formatDate,r=Object(j.useNavigation)(),p=Object(m.useState)([]),O=b()(p,2),q=O[0],C=O[1],A=Object(m.useState)("loading"),E=b()(A,2),D=E[0],I=E[1],T=Object(m.useCallback)((function(){I("loading"),h.a.get(Object(M.listUri)(t)).then((function(e){if(e.data.success){var t=e.data.data;I(t.length>0?"data":"empty"),C(t)}})).catch((function(){I("network")}))}),[t]),H=function(){_.default.isExtensionUiPopup?(v.default.serviceApp.openExtensionExpandTab({routes:[R.RootRoutes.Modal,R.ModalRoutes.SubmitRequest],params:{screen:R.SubmitRequestModalRoutes.SubmitRequestModal}}),setTimeout((function(){window.close()}),300)):r.navigate(k.HistoryRequestRoutes.SubmitRequestModal)},B=Object(m.useMemo)((function(){return Object(S.jsx)(f.default,{dismiss:!0,alertType:"info",title:e.formatMessage({id:"conten__please_be_patient_as_net_work"})})}),[e]),z=Object(m.useCallback)((function(t){var a=t.item,o="";return a.custom_fields.forEach((function(e){360013393195===e.id&&(o=e.value)})),Object(S.jsx)(i.default,{onPress:function(){r.navigate(k.HistoryRequestRoutes.TicketDetailModal,{order:a})},children:Object(S.jsx)(g.default,{bgColor:"surface-default",height:"96px",padding:"16px",borderRadius:"12px",children:Object(S.jsxs)(g.default,{flex:1,alignItems:"center",space:"12px",children:[Object(S.jsxs)(y.default,{flex:1,children:[Object(S.jsx)(s.default,{typography:{sm:"Body1Strong",md:"Body2Strong"},children:function(t){switch(t){case"hardware":return e.formatMessage({id:"form__hardware"});case"app_on_android":return e.formatMessage({id:"form__app_on_android"});case"app_on_ios":return e.formatMessage({id:"form__app_on_ios"});case"app_on_desktop":return e.formatMessage({id:"form__app_on_desktop"});case"app_on_browser":return e.formatMessage({id:"form__app_on_browser"});default:return t}}(o)}),Object(S.jsx)(s.default,{typography:"Body2",numberOfLines:1,color:"text-subdued",children:a.description}),Object(S.jsx)(s.default,{typography:"Body2",color:"text-subdued",children:n(a.created_at,{hideYear:!0})})]}),Object(S.jsx)(c.default,{name:"ChevronRightMini",color:"icon-subdued",size:20})]})})},a.id)}),[n,e,r]);Object(m.useEffect)((function(){T()}),[T]);var L=Object(m.useCallback)((function(){return Object(S.jsx)(l.default,{mb:"16px",children:B})}),[B]),N=Object(m.useCallback)((function(){return Object(S.jsx)(o.default,{height:"24px",bgColor:"surface-subdued"})}),[]);return Object(S.jsx)(a.default,{height:"560px",header:e.formatMessage({id:"form__s_request_history"}),footer:"data"===D?void 0:null,hideSecondaryAction:!0,hidePrimaryAction:!("data"===D),primaryActionProps:{type:"basic"},onPrimaryActionPress:H,primaryActionTranslationId:"form__submit_a_request",flatListProps:"data"===D?{height:"560px",data:q,renderItem:z,ListHeaderComponent:L,ItemSeparatorComponent:N,keyExtractor:function(e){return e.created_at}}:void 0,children:"data"!==D?Object(S.jsx)(l.default,{flex:1,alignItems:"center",justifyContent:"center",position:"relative",children:function(){switch(D){case"network":return Object(S.jsx)(d.default,{emoji:"\ud83c\udf10",title:e.formatMessage({id:"title__no_connection"}),subTitle:e.formatMessage({id:"title__no_connection_desc"}),actionTitle:e.formatMessage({id:"action__retry"}),handleAction:function(){return T()}});case"empty":return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(l.default,{position:"absolute",top:0,left:0,right:0,children:B}),Object(S.jsx)(d.default,{emoji:"\ud83d\udcac",title:e.formatMessage({id:"title__no_request_history"}),subTitle:e.formatMessage({id:"title__no_request_history_desc"}),actionTitle:e.formatMessage({id:"form__submit_a_request"}),handleAction:H})]});case"loading":return Object(S.jsx)(u.default,{size:"sm"});default:return null}}()}):null})},C=n(47),A=n(82),E=n(51),D=n(3),I=n.n(D),T=n(13),H=n.n(T),B=n(48),z=n(2),L=n.n(z),N=n(126),F=n(1638),U=n(651),W=n(301),V=n(167),Y=n.n(V),X=n(305),J=n(1662);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=function(){var e,t=Object(x.default)(),n=Object(W.default)().width,o=Object(r.default)(),s=Object(j.useNavigation)(),u=Object(w.useSettings)().instanceId,l=Object(j.useRoute)(),d=((null==l?void 0:l.params.order)||{}).id,f=null==l?void 0:l.params.order.submitter_id,p=((o?n:400)-2*(o?16:24))/4,O=Object(N.default)({mode:"onChange"}),y=O.control,_=O.handleSubmit,v=O.formState.isValid,P=Object(m.useState)([]),R=b()(P,2),k=R[0],q=R[1],D=Object(m.useCallback)(function(){var e=L()((function*(e){return h.a.post(Object(M.updateTicketUri)(d,u),{comment:{body:e.comment,author_id:f,uploads:function(){var e=[];return k.forEach((function(t){t.token&&e.push(t.token)})),e}()}}).then((function(e){e.data.success&&(B.default.show({title:t.formatMessage({id:"msg__submitted_successfully"})}),s.goBack())})).catch((function(e){}))}));return function(t){return e.apply(this,arguments)}}(),[d,k,u,t,s,f]),I=Object(m.useCallback)(L()((function*(){var e=yield Object(F.launchImageLibraryAsync)({mediaTypes:U.MediaTypeOptions.Images,allowsEditing:!1,base64:!0,aspect:[4,3],quality:.3});if(!e.canceled){var n=Y.a.v4()+".png",r=e.assets[0],a={loading:!0,localPath:r.uri,filename:n},o=r.uri;0,q((function(e){return[].concat(H()(e),[a])})),Object(M.uploadImage)({filename:n,image:o},u,(function(e,r){e?(q((function(e){var t=e.findIndex((function(e){return e.filename===n}));return t<0?e:[].concat(H()(e.slice(0,t)),H()(e.slice(t+1)))})),B.default.show({title:t.formatMessage({id:"msg__upload_failed"})},{type:"error"})):q((function(e){var t=e.findIndex((function(e){return e.filename===n}));return t<0?e:[].concat(H()(e.slice(0,t)),[K(K({},e[t]),{},{loading:!1,token:r.data.upload.token})],H()(e.slice(t+1)))}))}))}})),[u]);return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(X.SkipAppLock,{}),Object(S.jsx)(a.default,{header:t.formatMessage({id:"action__reply"}),hideSecondaryAction:!0,primaryActionProps:{isDisabled:!(v&&(null==(e=k.filter((function(e){return!(null!=e&&e.token)})))||!e.length)),onPromise:function(){return _(D)()}},primaryActionTranslationId:"action__submit",scrollViewProps:{height:"560px",children:Object(S.jsxs)(C.default,{children:[Object(S.jsx)(C.default.Item,{label:t.formatMessage({id:"form__your_reply"}),control:y,labelAddon:Object(S.jsx)(A.default,{type:"plain",size:"xs",name:"PhotoMini",onPress:function(){k.length<4&&I()}}),rules:{required:t.formatMessage({id:"form__field_is_required"}),maxLength:{value:1e3,message:t.formatMessage({id:"msg__exceeding_the_maximum_word_limit"})},validate:function(e){}},name:"comment",formControlProps:{width:"full"},defaultValue:"",children:Object(S.jsx)(C.default.Textarea,{borderRadius:"12px"})}),Object(S.jsxs)(g.default,{children:[k.map((function(e,t){return Object(S.jsx)(J.ImageView,{imageModel:e,onDelete:function(e){q((function(t){var n=t.findIndex((function(t){return t.filename===e.filename}));return n<0?t:[].concat(H()(t.slice(0,n)),H()(t.slice(n+1)))}))}},t)})),k.length<4?Object(S.jsx)(i.default,{onPress:I,children:Object(S.jsx)(E.default,{mt:"8px",width:p-8+"px",height:p-8+"px",borderRadius:"12px",borderWidth:1,borderColor:"border-default",children:Object(S.jsx)(c.default,{size:20,name:"PlusMini"})})}):null]})]})}})]})},Z=n(747),$=n(6092);function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){I()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=function(e){var t=e.id,n=e.size,r=Object(w.useSettings)().instanceId,a=Object(m.useState)(""),o=b()(a,2),i=o[0],c=o[1];return Object(m.useEffect)((function(){h.a.get(Object(M.attachmentUri)(t,r)).then((function(e){e.data&&c(e.data.data)}))}),[t]),Object(S.jsx)(S.Fragment,{children:i.length>0?Object(S.jsx)(Z.default,{width:n+"px",height:n+"px",src:i,borderRadius:"12px",preview:!0,bgColor:"surface-selected"},i):Object(S.jsx)(l.default,{width:n,height:n,bgColor:"surface-selected",borderRadius:"12px"})})};var re=function(){var e=Object(x.default)(),t=Object(j.useIsFocused)(),n=Object(j.useRoute)(),r=((null==n?void 0:n.params.order)||{}).id,o=n.params.order.submitter_id,i=Object(j.useNavigation)(),c=Object(w.useSettings)().version,u=Object(w.useSettings)().instanceId,d=Object(P.default)().formatDate,f=Object(m.useState)([]),p=b()(f,2),O=p[0],g=p[1],y=Object(m.useCallback)((function(e){var t=e.item,n=e.index,r=function(e,t){return e===t}(t.author_id,o),a=t.body;0===n&&(a=a+"\n\n"+(_.default.isNativeIOS?"App on iOS":_.default.isNativeAndroid?"App on Android":_.default.isRuntimeBrowser?"App on Browser":"Hardware")+"\nAppVersion: "+c);return Object(S.jsx)(l.default,{flex:1,flexDirection:"row",justifyContent:r?"flex-end":"flex-start",children:Object(S.jsxs)(l.default,{flexDirection:"column",paddingBottom:"24px",children:[Object(S.jsxs)(l.default,{flexDirection:"column",bgColor:"surface-default",padding:"16px",borderRadius:"12px",flex:1,children:[Object(S.jsx)(s.default,{selectable:!0,maxWidth:"260px",typography:{sm:"Body1",md:"Body2"},mb:t.attachments.length>0?"12px":"0px",children:a}),t.attachments.length>0?Object(S.jsx)($.default,{columns:3,spacingX:2,spacingY:3,mt:"12px",children:t.attachments.map((function(e,t){return Object(S.jsx)(l.default,{size:244/3,children:Object(S.jsx)(ne,te(te({},e),{},{size:244/3}))},"attachment"+t)}))}):null]}),Object(S.jsx)(s.default,{mt:"8px",typography:"Body2",color:"text-subdued",textAlign:r?"right":"left",children:d(t.created_at,{hideYear:!0})})]})})}),[d,244/3,o,c]),v=Object(m.useCallback)((function(){h.a.get(Object(M.commentsUri)(r,u)).then((function(e){g(e.data.data)})).catch((function(){}))}),[r,u]);return Object(m.useEffect)((function(){t&&v()}),[v,t]),Object(S.jsx)(a.default,{header:e.formatMessage({id:"title__request_details"}),hideSecondaryAction:!0,primaryActionProps:{type:"basic"},primaryActionTranslationId:"action__reply",onPrimaryActionPress:function(){i.navigate(k.HistoryRequestRoutes.ReplyTicketModel,{order:null==n?void 0:n.params.order})},flatListProps:{height:"420px",data:O,renderItem:y,keyExtractor:function(e){return e.created_at}}})},ae=n(234),oe=Object(ae.default)(),ie=[{name:k.HistoryRequestRoutes.HistoryRequestModal,component:q},{name:k.HistoryRequestRoutes.TicketDetailModal,component:re},{name:k.HistoryRequestRoutes.ReplyTicketModel,component:Q},{name:k.HistoryRequestRoutes.SubmitRequestModal,component:J.SubmitRequest}];t.default=function(){var e=Object(r.default)();return Object(S.jsx)(oe.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:ie.map((function(e){return Object(S.jsx)(oe.Screen,{name:e.name,component:e.component},e.name)}))})}},6092:function(e,t,n){"use strict";n.r(t);var r=n(15),a=n.n(r),o=n(1),i=n.n(o),c=n(1035),s=n(649),u=n(81),l=n(6120),d=n(62),f=["columns","space","spacingX","spacingY","minChildWidth","children"];function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var b={rows:{},cols:{}};t.default=i.a.memo(i.a.forwardRef((function(e,t){var n=Object(l.useThemeProps)("SimpleGrid",e),r=n.columns,o=n.space,m=n.spacingX,j=n.spacingY,O=n.minChildWidth,h=n.children,g=a()(n,f);if(Object(d.useHasResponsiveProps)(e))return i.a.createElement(i.a.Fragment,null);var y=null!==o&&void 0!==o?o:0,x=null!==m&&void 0!==m?m:y,_=null!==j&&void 0!==j?j:y,v=i.a.Children.toArray(h);if(r){for(var w=[],P=0;P<v.length;P+=r)w.push(v.slice(P,P+r));return i.a.createElement(c.default,p({},b.rows,{space:_},g,{ref:t}),w.map((function(e,t){return i.a.createElement(s.default,{space:x,key:t},e.map((function(e){return i.a.createElement(u.default,p({},b.cols,{key:e.key}),e)})))})))}return O?i.a.createElement(u.default,p({flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},g,{ref:t}),v.map((function(e){return i.a.createElement(u.default,p({},b.cols,{mx:x,my:_,key:e.key,minWidth:O}),e)}))):i.a.createElement(i.a.Fragment,null)})))},6120:function(e,t,n){"use strict";n.r(t),n.d(t,"useThemeProps",(function(){return w}));var r=n(15),a=n.n(r),o=n(4),i=n.n(o),c=n(211),s=n.n(c),u=n(705),l=n.n(u),d=n(301),f=n(28),p=n(1508),b=n(153),m=n(3),j=n.n(m),O=n(693),h=n.n(O);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){j()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=n(1167),_=["theme"],v=function(e,t,n,r,a){var o=Object(b.extractInObject)(r,["children","style","onPress","icon","onOpen","onClose"]),c=i()(o,2),s=c[0],u=c[1],l=function(e,t,n){var r;if("web"!==n)return y(y({},t),e);var a=null!==(r=t.style)&&void 0!==r?r:{},o=Object(b.extractInObject)(e,["shadowColor","shadowOffset","shadowOpacity","shadowRadius"]),c=i()(o,2),s=c[0],u=c[1];return h()(s)||(a=y(y({},a),s)),y(y(y({},u),t),{},{style:a})}(Object(x.calculateProps)(e,t,n,u,a),s,f.default.OS);return Object(b.omitUndefined)(l)};function w(e,t){var n,r=Object(p.useNativeBase)(),o=r.theme,i=a()(r,_),c=s()(o,"components.".concat(e)),u=null===(n=Object(d.default)())||void 0===n?void 0:n.width;return v(l()(o,["components"]),i,c,t,u)}}}]);