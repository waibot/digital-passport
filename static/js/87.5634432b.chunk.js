(this.webpackJsonp=this.webpackJsonp||[]).push([[87],{4037:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"GasPanelRoutes",(function(){return r})),function(e){e.GasPanelModal="GasPanelModal"}(r||(r={}))},5299:function(e,t,n){"use strict";n.r(t);var r,i,o=n(50),c=n(57),s=n(51),l=n(76),a=n(41),u=n(353),d=n(2),b=n.n(d),f=n(4),p=n.n(f),j=n(1),O=n(44),m=n(88),y=n(36),g=n(17),v=n(25),h=n(185),w=n(86),x=[y.OnekeyNetwork.btc,y.OnekeyNetwork.eth,y.OnekeyNetwork.polygon],P=((r={})[y.OnekeyNetwork.btc]={supportOverview:!1,EIP1559Enabled:!1},r[y.OnekeyNetwork.eth]={supportOverview:!0,EIP1559Enabled:!0},r[y.OnekeyNetwork.polygon]={supportOverview:!0,EIP1559Enabled:!0},r),k=((i={})[y.OnekeyNetwork.eth]={low:0,stable:100,busy:200},i[y.OnekeyNetwork.polygon]={low:0,stable:200,busy:300},i),I=n(12),E=n(1087),N=n(63),S=n(3),_=n.n(S),D=n(15),F=n.n(D),B=n(21),M=n.n(B),T=n(596),C=n(1018),G=n(1526),A=n(922),L=n(0),z=["selectedNetworkId","gasInfo","isEIP1559Enabled"];function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J={marginTop:4,paddingLeft:"0px",paddingRight:"0px",paddingTop:"4px",paddingBottom:"4px",alignItems:"center",height:"48px",bgColor:"transparent"};function V(e,t){return t?e:"object"===typeof e?null!=(n=e.gasPrice)?n:e.price:e;var n}function W(e){var t=e.selectedNetworkId,n=e.gasInfo,r=e.isEIP1559Enabled,i=F()(e,z),o=(n||{}).prices,c=g.default.serviceGas,u=Object(j.useState)([]),d=p()(u,2),f=d[0],O=d[1],m=Object(v.useNetworkSimple)(t),y=null==m?void 0:m.settings.isBtcForkChain,h=Object(j.useMemo)((function(){var e;if(!o||!m)return[];var n=String(null!=(e=null==m?void 0:m.settings.minGasLimit)?e:21e3),i={prices:o,defaultPresetIndex:"1",eip1559:r&&!y,limit:n=y?"340":n,feeDecimals:m.feeDecimals,nativeDecimals:m.decimals,isBtcForkChain:y,feeList:y?o.map((function(e){return new M.a(e).times(n).shiftedBy(m.decimals).toNumber()})).filter(Boolean):[]};return o.map((function(e,c){return U({value:c.toString(),title:Object(L.jsx)(T.FeeSpeedLabel,{index:c,iconSize:28,space:2,prices:o}),describe:Object(L.jsxs)(a.default,{space:"10px",alignItems:"center",children:[Object(L.jsxs)(N.default,{children:[Object(L.jsx)(A.SendEditFeeOverview,{accountId:"",networkId:t,price:V(e,r&&!y),feeInfo:i,limit:n,currencyProps:{typography:"Body1",textAlign:"right"},onlyCurrency:!0}),Object(L.jsx)(C.FeeSpeedTime,{index:c,waitingSeconds:f[c]})]}),Object(L.jsx)(G.FeeSpeedTip,{index:c,isEIP1559:r&&!y,price:V(e,r&&!y),limit:n,feeInfo:i})]})},J)}))}),[y,r,m,o,t,f]);return Object(j.useEffect)((function(){(function(){var e=b()((function*(){var e=yield c.getTxWaitingSeconds({networkId:t});O(e)}));return function(){return e.apply(this,arguments)}})()()}),[t,c]),Object(L.jsx)(I.default,U(U({},i),{},{children:n?Object(L.jsx)(E.default,{mt:2,padding:"0px",items:h,name:"standard fee group"}):Object(L.jsx)(s.default,{w:"full",py:16,children:Object(L.jsx)(l.default,{size:"lg"})})}))}var q,H=n(20),K=n(455),Q=n.n(K),X=n(13),Y=n.n(X),Z=n(2418),$=n(196),ee=n(125),te=["gasInfo","selectedNetworkId","isEIP1559Enabled"];function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.low="low",e.stable="stable",e.busy="busy"}(q||(q={}));var ie=["\ud83c\udf43","\u2615\ufe0f","\ud83d\udd25"];function oe(e){var t=e.gasInfo,n=e.selectedNetworkId,r=e.isEIP1559Enabled,i=F()(e,te),o=t||{},c=o.estimatedTransactionCount,s=o.networkCongestion,l=o.prices,u=Object(m.default)(),d=Object(v.useNetworkSimple)(n),b=Object(j.useMemo)((function(){if(r&&d){var e,t,n=(null==l?void 0:l.length)||1,i=B.BigNumber.sum.apply(B.BigNumber,Y()(Q()(l,"baseFee"))).dividedBy(n).toFixed(),o=B.BigNumber.sum.apply(B.BigNumber,Y()(Q()(l,"maxFeePerGas"))).dividedBy(n).toFixed(),c=B.BigNumber.sum.apply(B.BigNumber,Y()(Q()(l,"maxPriorityFeePerGas"))).dividedBy(n).toFixed(),s=String(d.settings.minGasLimit||21e3),a=Object($.calculateTotalFeeRange)({eip1559:!0,price1559:{baseFee:i,maxFeePerGas:o,maxPriorityFeePerGas:c},limit:s}).max;return new B.BigNumber(a).shiftedBy(null!=(e=d.feeDecimals)?e:0).shiftedBy(-(null!=(t=d.decimals)?t:0)).toFixed(8)}return"0"}),[r,d,l]);if(!t)return null;if(void 0===s&&void 0===c)return null;var f=q.stable;s?f=function(e){return e<Z.NetworkCongestionThresholds.stable?q.low:e>=Z.NetworkCongestionThresholds.stable&&e<Z.NetworkCongestionThresholds.busy?q.stable:q.busy}(s):c&&(f=function(e){var t=e.estimatedTransactionCount,n=e.networkId;return t<k[n].stable?q.low:t>=k[n].stable&&t<k[n].busy?q.stable:q.busy}({estimatedTransactionCount:c,networkId:n}));var p=function(e){switch(e){case q.low:return{label:ie[0]};case q.stable:return{label:ie[1]};case q.busy:return{label:ie[2]};default:return{label:ie[1]}}}(f);return Object(L.jsxs)(I.default,re(re({},i),{},{children:[Object(L.jsx)(H.default,{fontSize:56,textAlign:"center",children:p.label}),Object(L.jsx)(H.default,{typography:"DisplayMedium",textAlign:"center",children:u.formatMessage({id:"title__current_gas_fee"})}),r?Object(L.jsxs)(a.default,{alignItems:"center",mt:1,justifyContent:"center",children:[Object(L.jsxs)(H.default,{color:"text-subdued",children:[" ",u.formatMessage({id:"form__max_fee"}),":"]}),Object(L.jsx)(ee.FormatCurrencyNativeOfAccount,{networkId:n,accountId:"",value:b,render:function(e){return Object(L.jsx)(H.default,{color:"text-subdued",children:e})}}),Object(L.jsx)(H.default,{color:"text-subdued",children:"("+b+" "+((null==d?void 0:d.symbol)||"")+")"})]}):Object(L.jsx)(H.default,{typography:"Body2",mt:1,color:"text-subdued",textAlign:"center",children:u.formatMessage({id:"title__current_gas_fee_desc"},{0:(null==d?void 0:d.symbol)||""})})]}))}var ce=n(100),se=["leftSeconds","setLeftSeconds"];function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=null,de=function(e){return Object(L.jsx)(H.default,{color:"text-success",children:e})};function be(e){var t=e.leftSeconds,n=e.setLeftSeconds,r=F()(e,se),i=Object(m.default)();return Object(j.useEffect)((function(){return 6===t&&ue&&clearTimeout(ue),ue=setInterval((function(){var e=t-1;e<0&&(e=0),n(e)}),1e3),function(){ue&&clearTimeout(ue)}}),[t,n]),Object(L.jsxs)(I.default,ae(ae({},r),{},{children:[Object(L.jsx)(ce.default,{}),Object(L.jsx)(H.default,{color:"text-subdued",textAlign:"center",mt:4,children:i.formatMessage({id:"content__gas_fee_will_automatically_update_after_str"},{0:i.formatMessage({id:"content__str_seconds_plural"},{0:t}),a:de})})]}))}var fe=n(627),pe=n(64),je=n(40),Oe=n(121);function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){_()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e){var t=e.selectedNetworkId,n=e.setSelectedNetworkId,r=Object(v.useManageNetworks)().allNetworks,i=Object(j.useMemo)((function(){return r.filter((function(e){return x.includes(e.id)}))}),[r]),o=Object(v.useNetworkSimple)(t),c=Object(j.useMemo)((function(){return{label:null==o?void 0:o.name,value:null==o?void 0:o.id,tokenProps:{token:{logoURI:null==o?void 0:o.logoURI,name:null==o?void 0:o.shortName}},badge:"evm"===(null==o?void 0:o.impl)?"EVM":void 0}}),[null==o?void 0:o.id,null==o?void 0:o.impl,null==o?void 0:o.logoURI,null==o?void 0:o.name,null==o?void 0:o.shortName]);return Object(L.jsx)(fe.default,{w:"190",trigger:function(e){return Object(L.jsx)(pe.default,ye(ye({accessibilityLabel:"More options menu"},e),{},{children:Object(L.jsxs)(a.default,{alignItems:"center",space:3,children:[Object(L.jsx)(Oe.default,ye({size:6},c.tokenProps)),Object(L.jsx)(H.default,{typography:"Body1",children:null==o?void 0:o.name}),Object(L.jsx)(je.default,{size:20,name:"ChevronDownMini",color:"icon-subdued"})]})}))},children:i.map((function(e){return Object(L.jsx)(fe.default.Item,{onPress:function(){return n(e.id)},children:Object(L.jsxs)(a.default,{space:4,alignItems:"center",children:[Object(L.jsx)(I.default,{width:"20px",children:t===e.id&&Object(L.jsx)(je.default,{name:"CheckMini",size:20,color:"interactive-default"})}),Object(L.jsx)(H.default,{typography:"Body1",children:e.name})]})},e.id)}))})}var ve=y.OnekeyNetwork.eth,he=null;var we=n(4037),xe=n(234),Pe=Object(xe.default)(),ke=[{name:we.GasPanelRoutes.GasPanelModal,component:function(){var e,t=Object(m.default)(),n=Object(O.useRoute)().params.networkId,r=void 0===n?"":n,i=Object(h.appSelector)((function(e){return e.settings})).selectedFiatMoneySymbol,o=Object(j.useState)(x.includes(r)?r:ve),d=p()(o,2),f=d[0],y=d[1],k=Object(j.useState)(!1),I=p()(k,2),E=I[0],N=I[1],S=Object(j.useState)(null),_=p()(S,2),D=_[0],F=_[1],B=Object(j.useState)(6),M=p()(B,2),T=M[0],C=M[1],G=Object(v.useSettings)(),A=Object(v.useNativeToken)(f),z=g.default.serviceGas,R=Object(j.useMemo)((function(){return!(!D||!D.prices[0])&&("object"===typeof D.prices[0]&&"maxFeePerGas"in D.prices[0]&&"maxPriorityFeePerGas"in D.prices[0])}),[D]),U=null==(e=null==G?void 0:G.gasPanelEIP1559Enabled)||e,J=Object(j.useCallback)((function(e){g.default.dispatch(Object(w.setGasPanelEIP1559Enabled)(e))}),[]);return Object(j.useEffect)((function(){F(null),he&&clearTimeout(he);var e=function(){var t=b()((function*(){var t=yield z.getGasInfo({networkId:f});5===t.prices.length&&(t.prices=[t.prices[0],t.prices[2],t.prices[4]]),F(t),N(!0),he=setTimeout((function(){return e()}),6e3),C(6)}));return function(){return t.apply(this,arguments)}}();return e(),function(){he&&clearTimeout(he)}}),[f,z]),Object(j.useEffect)((function(){r&&x.includes(r)&&y(r)}),[r]),Object(j.useEffect)((function(){var e;g.default.servicePrice.fetchSimpleTokenPrice({networkId:f,tokenIds:[null!=(e=null==A?void 0:A.tokenIdOnNetwork)?e:""],vsCurrency:i})}),[r,i,f,null==A?void 0:A.tokenIdOnNetwork]),Object(L.jsx)(c.default,{header:t.formatMessage({id:"content__gas_fee"}),height:"560px",hideSecondaryAction:!0,onPrimaryActionPress:function(e){return(0,e.close)()},primaryActionProps:{type:"primary"},primaryActionTranslationId:"action__i_got_it",scrollViewProps:{children:E?Object(L.jsxs)(L.Fragment,{children:[Object(L.jsxs)(a.default,{justifyContent:"space-between",alignItems:"center",children:[Object(L.jsx)(ge,{selectedNetworkId:f,setSelectedNetworkId:y}),R&&P[f].EIP1559Enabled?Object(L.jsx)(u.default,{onToggle:function(){J(!U)},isChecked:U,label:"EIP 1559",size:"mini"}):null]}),P[f].supportOverview?Object(L.jsx)(oe,{mt:8,gasInfo:D,isEIP1559Enabled:U,selectedNetworkId:f}):null,Object(L.jsx)(W,{mt:6,gasInfo:D,isEIP1559Enabled:U,selectedNetworkId:f}),D?Object(L.jsx)(be,{mt:12,leftSeconds:T,setLeftSeconds:C}):null]}):Object(L.jsx)(s.default,{w:"full",py:10,children:Object(L.jsx)(l.default,{size:"lg"})})}})}}];t.default=function(){var e=Object(o.default)();return Object(L.jsx)(Pe.Navigator,{screenOptions:{headerShown:!1,animationEnabled:!!e},children:ke.map((function(e){return Object(L.jsx)(Pe.Screen,{name:e.name,component:e.component},e.name)}))})}}}]);